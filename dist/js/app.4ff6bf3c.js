(function(e){function t(t){for(var r,a,c=t[0],u=t[1],s=t[2],l=0,p=[];l<c.length;l++)a=c[l],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&p.push(o[a][0]),o[a]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);d&&d(t);while(p.length)p.shift()();return i.push.apply(i,s||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,c=1;c<n.length;c++){var u=n[c];0!==o[u]&&(r=!1)}r&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},o={app:0},i=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var s=0;s<c.length;s++)t(c[s]);var d=u;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"0622":function(e,t,n){e.exports=n.p+"img/sign-in.857c8105.svg"},"0be9":function(e,t,n){e.exports={searchBox:"Textsearch_searchBox_1SbLb"}},"0c69":function(e,t,n){"use strict";n("c02a")},"10b7":function(e,t,n){e.exports=n.p+"img/chat.b54d0730.svg"},"175a":function(e,t,n){"use strict";n("c4c4")},"187b":function(e,t,n){"use strict";var r=n("a652"),o=n.n(r);n.d(t,"default",(function(){return o.a}))},"1d0f":function(e,t,n){"use strict";n("32db")},"1fec":function(e,t,n){e.exports=n.p+"img/plugin.71b16b67.svg"},"229a":function(e,t,n){"use strict";n("4472")},3069:function(e,t,n){},3163:function(e,t,n){},"31f3":function(e,t,n){e.exports=n.p+"img/log.2b2ea6d0.svg"},"32db":function(e,t,n){},"334d":function(e,t,n){e.exports=n.p+"img/eye-on.e881e189.svg"},4030:function(e,t,n){e.exports={wrapperContentMobile:"Index_wrapperContentMobile_3O52m",wrapperContent:"Index_wrapperContent_1bUq4",title:"Index_title_1kpia",list:"Index_list_3qW8z",icon:"Index_icon_2jnZk",section:"Index_section_bVQDf"}},4472:function(e,t,n){},4612:function(e,t,n){e.exports=n.p+"img/switch-off.17f7401d.svg"},4623:function(e,t,n){e.exports=n.p+"img/remove-off.9d54941e.svg"},"46b4":function(e,t,n){"use strict";n("3163")},"4fbc":function(e,t,n){e.exports=n.p+"img/revert.3fe2bc78.svg"},"533a":function(e,t,n){"use strict";var r=n("ad1d"),o=n.n(r);n.d(t,"default",(function(){return o.a}))},"5bca":function(e,t,n){"use strict";var r=n("4030"),o=n.n(r);n.d(t,"default",(function(){return o.a}))},"62a5":function(e,t,n){"use strict";n("3069")},"67c1":function(e,t,n){e.exports=n.p+"img/remove-on.9d54941e.svg"},6951:function(e,t,n){"use strict";n("d470")},"70bb":function(e,t,n){e.exports=n.p+"img/paste.c9ceeece.svg"},7835:function(e,t,n){e.exports=n.p+"img/add-on.5a83fc0e.svg"},"7ccc":function(e,t,n){"use strict";n("9816")},8423:function(e,t,n){e.exports=n.p+"img/switch-on.70cdd4b4.svg"},"8a8b":function(e,t,n){e.exports={wrapper:"Index_wrapper_1nXRC",textWrapperSearch:"Index_textWrapperSearch_2ATIr",textWrapperSearchMobile:"Index_textWrapperSearchMobile_gVXaI",customSvgIcon:"Index_customSvgIcon_3R9kx"}},"8b59":function(e,t,n){"use strict";var r=n("8a8b"),o=n.n(r);n.d(t,"default",(function(){return o.a}))},9233:function(e,t,n){e.exports=n.p+"img/cut.5b0b166e.svg"},9816:function(e,t,n){},"99ba":function(e,t,n){e.exports=n.p+"img/goal.dfe3dc4c.svg"},a652:function(e,t,n){e.exports={title:"UsedBy_title_3F9En",precondition:"UsedBy_precondition_1vpBY",preconditionPath:"UsedBy_preconditionPath_3XvY1"}},ad1d:function(e,t,n){e.exports={title:"Preconditions_title_1ANO_",precondition:"Preconditions_precondition_XjUJT",preconditionPath:"Preconditions_preconditionPath_1K70l"}},b969:function(e,t,n){e.exports=n.p+"img/pin-off.addc500f.svg"},bc82:function(e,t,n){e.exports=n.p+"img/pin-on.ae33cffa.svg"},c02a:function(e,t,n){},c4c4:function(e,t,n){},c8fa:function(e,t,n){e.exports=n.p+"img/menu.4256f039.svg"},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23");function o(e,t,n,o,i,a){var c=Object(r["J"])("router-view");return Object(r["A"])(),Object(r["g"])(c)}n("a4d3"),n("e01a"),n("99af"),n("d3b7"),n("96cf");var i,a,c,u=n("1da1"),s=n("ade3"),d=n("3835"),l=n("5502"),p=(n("c975"),n("a434"),n("b85c")),b={SET_PINS:"SET_PINS",ADD_TO_PINS:"ADD_TO_PINS",REMOVE_PIN:"REMOVE_PIN",ADD_TO_PINS_REVERSE:"ADD_TO_PINS_REVERSE"},f={AddPin:"AddPin",RemovePin:"RemovePin"},m={namespaced:!0,state:{pins:{},pinsReverse:{}},actions:(i={},Object(s["a"])(i,f.AddPin,(function(e,t){var n=e.commit,r=e.rootState,o=r.tree.nodeRecord[t.nodeId].parent;if(o){var i=[];while(o&&o.id!=t.parentId)i.push(o.id),o=r.tree.nodeRecord[o.id].parent;i.push(t.parentId),n(b.ADD_TO_PINS,{nodeId:t.nodeId,parentIds:i});for(var a=0,c=i;a<c.length;a++){var u=c[a];n(b.ADD_TO_PINS_REVERSE,{nodeId:u,pinId:t.nodeId})}}})),Object(s["a"])(i,f.RemovePin,(function(e,t){var n=e.commit;n(b.REMOVE_PIN,t)})),i),mutations:(a={},Object(s["a"])(a,b.SET_PINS,(function(e,t){for(var n in e.pins=t,e.pinsReverse={},t){var r,o=Object(p["a"])(t[n]);try{for(o.s();!(r=o.n()).done;){var i=r.value;e.pinsReverse[i]||(e.pinsReverse[i]=[]),e.pinsReverse[i].push(n)}}catch(a){o.e(a)}finally{o.f()}}})),Object(s["a"])(a,b.ADD_TO_PINS,(function(e,t){e.pins[t.nodeId]=t.parentIds})),Object(s["a"])(a,b.ADD_TO_PINS_REVERSE,(function(e,t){e.pinsReverse[t.nodeId]||(e.pinsReverse[t.nodeId]=[]),e.pinsReverse[t.nodeId].push(t.pinId)})),Object(s["a"])(a,b.REMOVE_PIN,(function(e,t){var n,r=Object(p["a"])(e.pins[t]);try{for(r.s();!(n=r.n()).done;){var o=n.value,i=e.pinsReverse[o].indexOf(t);e.pinsReverse[o].splice(i,1)}}catch(a){r.e(a)}finally{r.f()}delete e.pins[t]})),a)},O=(n("25f0"),n("ddb0"),n("e6de")),v=function(e,t,n){var r=new Error(e);return{error:r,kv:t,code:n}},h=n("bc3a"),g=n.n(h),j={SET_PRECONDITIONS:"SET_PRECONDITIONS",UPDATE_PRECONDITIONS:"UPDATE_PRECONDITIONS",REMOVE_PRECONDITION:"REMOVE_PRECONDITION"},y={namespaced:!0,state:{preconditions:{},reverseIndex:{}},mutations:(c={},Object(s["a"])(c,j.SET_PRECONDITIONS,(function(e,t){for(var n in e.preconditions=t,e.reverseIndex={},t){var r,o=Object(p["a"])(t[n]);try{for(o.s();!(r=o.n()).done;){var i=r.value;"undefined"===typeof e.reverseIndex[i]&&(e.reverseIndex[i]=[]),e.reverseIndex[i].push(n)}}catch(a){o.e(a)}finally{o.f()}}})),Object(s["a"])(c,j.UPDATE_PRECONDITIONS,(function(e,t){e.preconditions[t.nodeID]||(e.preconditions[t.nodeID]=[]);var n,r=Object(p["a"])(e.preconditions[t.nodeID]);try{for(r.s();!(n=r.n()).done;){var o=n.value;e.reverseIndex[o]&&-1!=e.reverseIndex[o].indexOf(t.nodeID)&&e.reverseIndex[o].splice(e.reverseIndex[o].indexOf(t.nodeID),1)}}catch(u){r.e(u)}finally{r.f()}e.preconditions[t.nodeID]=t.preconditionIDs;var i,a=Object(p["a"])(e.preconditions[t.nodeID]);try{for(a.s();!(i=a.n()).done;){var c=i.value;e.reverseIndex[c]||(e.reverseIndex[c]=[]),e.reverseIndex[c].push(t.nodeID)}}catch(u){a.e(u)}finally{a.f()}})),Object(s["a"])(c,j.REMOVE_PRECONDITION,(function(e,t){if(e.preconditions[t.nodeID]){var n=e.preconditions[t.nodeID];n&&-1!=n.indexOf(t.preconditionID)&&(n.splice(n.indexOf(t.preconditionID),1),e.reverseIndex[t.preconditionID]&&-1!=e.reverseIndex[t.preconditionID].indexOf(t.nodeID)&&e.reverseIndex[t.preconditionID].splice(e.reverseIndex[t.preconditionID].indexOf(t.nodeID),1))}})),c)},x={UPDATE_IMAGES:"UPDATE_IMAGES"},I={namespaced:!0,state:{images:{}},mutations:Object(s["a"])({},x.UPDATE_IMAGES,(function(e,t){e.images[t.nodeID]=t.images}))};n("4de4"),n("4160"),n("b0c0"),n("07ac"),n("159b");function N(e){var t;return e?Array.isArray(e)?(t=e.filter((function(e){return!!e})).sort(),t.forEach((function(e,t,n){return n[t]=e.toString()}))):(t=Object.values(e).filter((function(e){return!!e})).sort(),t.forEach((function(e,t,n){return n[t]=e.toString()}))):t=[],t}function w(e){var t={id:e["0"].id.toString(),title:e["0"].name,position:e["0"].position,children:[]},n=[t];while(n.length>0){var r=n.pop();if(r){if(!e[r.id])return[null,v("Cannot find id in dbNodes",{"node.id":r.id,dbNodes:e})];if(e[r.id].children=N(e[r.id].children),e[r.id].children.length){var o,i=[],a=Object(p["a"])(e[r.id].children);try{for(a.s();!(o=a.n()).done;){var c=o.value;if(!e[c])return[null,v("Cannot find child id in dbNodes",{childID:c,parentID:r.id})];i.push({id:c.toString(),title:e[c].name,position:e[c].position,children:[]})}}catch(u){a.e(u)}finally{a.f()}r.children=i,n.push.apply(n,i)}}}return[t,null]}n("d6b6");var D,k,T=n("2ef0"),E=n("1494"),_="https://us-central1-sci-map-1982.cloudfunctions.net/",C=function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O["a"].database().ref().update(t);case 3:return e.abrupt("return",null);case 6:return e.prev=6,e.t0=e["catch"](0),e.abrupt("return",v("api: error in update",{err:e.t0}));case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),R=Object(T["debounce"])(C,2e3),S={ROOT_WIDTH:window.innerWidth>window.innerHeight?window.innerWidth:1.5*.95*window.innerWidth,ROOT_HEIGHT:window.innerWidth>window.innerHeight?.95*window.innerHeight:1.5*window.innerHeight,ROOT_CENTER_X:window.innerWidth>window.innerHeight?.3*window.innerWidth+.7*window.innerWidth/2:window.innerWidth/2,ROOT_CENTER_Y:window.innerWidth>window.innerHeight?window.innerHeight/2:.75*window.innerHeight/2,ST_WIDTH:1e3,ST_HEIGHT:1e3,initFirebase:function(){var e={apiKey:"AIzaSyCP50k-WOkTeG8BYvRtu4Bo_x3T2RnVsxU",authDomain:"sci-map-1982.firebaseapp.com",databaseURL:"https://sci-map-1982.firebaseio.com",projectId:"sci-map-1982",storageBucket:"sci-map-1982.appspot.com",messagingSenderId:"340899060236",appId:"1:340899060236:web:b136e9289e342a8bb62c29",measurementId:"G-TV74Q61H9P"};O["a"].initializeApp(e),O["a"].analytics()},callFunction:function(e,t){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=O["a"].auth().currentUser,r){n.next=3;break}return n.abrupt("return",["",v("callFunction: cannot determine current user",{})]);case 3:return n.next=5,r.getIdToken(!0);case 5:return t.idToken=n.sent,n.prev=6,n.next=9,g.a.get(_+e,{params:t});case 9:return o=n.sent,n.abrupt("return",[o.data,null]);case 13:return n.prev=13,n.t0=n["catch"](6),n.abrupt("return",["",v("Error in callFunction",{method:e,params:t,e:n.t0})]);case 16:case"end":return n.stop()}}),n,null,[[6,13]])})))()},getMapFromDB:function(){return Object(u["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,O["a"].database().ref("map").get();case 2:if(t=e.sent,t.exists()){e.next=5;break}return e.abrupt("return",[null,v("!snapshot.exists",{})]);case 5:return n=t.val(),e.abrupt("return",[n,null]);case 7:case"end":return e.stop()}}),e)})))()},getMapFromStorage:function(e){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,i,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=O["a"].storage().ref(),o=r.child("/map.json"),e&&(o=r.child("/user/".concat(e.uid,"/map.json"))),n.next=5,o.getDownloadURL();case 5:return i=n.sent,n.next=8,g.a.get(i);case 8:return a=n.sent,n.abrupt("return",[{id:"0",title:"",position:{x:t.ROOT_WIDTH/2,y:t.ROOT_HEIGHT/2},children:a.data},null]);case 10:case"end":return n.stop()}}),n)})))()},getMap:function(e){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.getMapFromDB();case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e["catch"](0),e.abrupt("return",[null,v(e.t0.message,{e:e.t0})]);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))()},getPins:function(e){return Object(u["a"])(regeneratorRuntime.mark((function t(){var n,r,o,i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,null!=e){t.next=13;break}return n=O["a"].storage().ref(),r=n.child("/pins.json"),t.next=6,r.getDownloadURL();case 6:return o=t.sent,t.next=9,g.a.get(o);case 9:return i=t.sent,t.abrupt("return",[i.data,null]);case 13:return t.next=15,O["a"].database().ref("user_data/".concat(e.uid,"/pins")).get();case 15:if(a=t.sent,a.exists()){t.next=18;break}return t.abrupt("return",[null,v("!snapshot.exists",{})]);case 18:return t.abrupt("return",[a.val(),null]);case 19:t.next=24;break;case 21:return t.prev=21,t.t0=t["catch"](0),t.abrupt("return",[null,v(t.t0.message,{e:t.t0})]);case 24:case"end":return t.stop()}}),t,null,[[0,21]])})))()},savePins:function(e,t){return Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,O["a"].database().ref("user_data/".concat(e.uid,"/pins")).set(t);case 4:case"end":return n.stop()}}),n)})))()},getSubscriptions:function(e){return Object(u["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return",[null,null]);case 2:return t.prev=2,t.next=5,O["a"].database().ref("user_subscription/".concat(e.uid)).get();case 5:if(n=t.sent,n.exists()){t.next=8;break}return t.abrupt("return",[null,v("!snapshot.exists",{})]);case 8:return t.abrupt("return",[n.val(),null]);case 11:return t.prev=11,t.t0=t["catch"](2),t.abrupt("return",[null,v(t.t0.message,{e:t.t0})]);case 14:case"end":return t.stop()}}),t,null,[[2,11]])})))()},setSubscription:function(e,t){return Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,O["a"].database().ref("user_subscription/".concat(e.uid,"/").concat(t.nodeID)).set(t.mode);case 4:case"end":return n.stop()}}),n)})))()},getPreconditions:function(e){return Object(u["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O["a"].database().ref("precondition").get();case 3:if(t=e.sent,t.exists()){e.next=6;break}return e.abrupt("return",[null,v("!snapshot.exists",{})]);case 6:return n=t.val(),e.abrupt("return",[n,null]);case 10:return e.prev=10,e.t0=e["catch"](0),e.abrupt("return",[null,v(e.t0.message,{e:e.t0})]);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()},savePreconditions:function(e,t){return Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,O["a"].database().ref("precondition/"+t.nodeId).set(t.preconditionIds);case 4:case"end":return n.stop()}}),n)})))()},subscribeMapNodeChange:function(e,t){this.subscribeDBChange("map/".concat(e),(function(e){if(e.exists()){var n=e.val();n.id=n.id.toString(),n.children=N(n.children),t(n)}}))},subscribeNodeContentChange:function(e,t){this.subscribeDBChange("node_content/".concat(e),(function(e){if(e.exists()){var n=e.val();t(n)}}))},subscribePreconditionNodeChange:function(e){this.subscribeDBChange("precondition/".concat(e),(function(t){if(t.exists()){var n=t.val();zt.commit("precondition/".concat(j.UPDATE_PRECONDITIONS),{nodeID:e,preconditionIDs:n})}}))},subscribeNodeImageChange:function(e){this.subscribeDBChange("node_image/".concat(e),(function(t){if(t.exists()){var n=t.val();zt.commit("image/".concat(x.UPDATE_IMAGES),{nodeID:e,images:n})}}))},subscribeDBChange:function(e,t){O["a"].database().ref(e).on("value",t)},unsubscribeDBChange:function(e,t){O["a"].database().ref(e).off("value",t)},transaction:function(e,t){return Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,O["a"].database().ref("map/"+e).transaction(t,(function(){}),!1);case 2:case"end":return n.stop()}}),n)})))()},setPublicUserData:function(e,t,n){return Object(u["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,O["a"].database().ref("public_user_data/"+e).set({displayName:t,discordName:n});case 3:r.next=8;break;case 5:r.prev=5,r.t0=r["catch"](0),console.error(r.t0);case 8:case"end":return r.stop()}}),r,null,[[0,5]])})))()},getMapNode:function(e){return Object(u["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,O["a"].database().ref("map/"+e).get();case 2:if(n=t.sent,r=n.val(),r){t.next=7;break}return console.error("got null fetching from map/nodeID",e),t.abrupt("return",null);case 7:return r.id=r.id.toString(),r.children=N(r.children),t.abrupt("return",r);case 10:case"end":return t.stop()}}),t)})))()},getTrashNode:function(e,t){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,O["a"].database().ref("trash/".concat(e,"/").concat(t)).get();case 2:return r=n.sent,n.abrupt("return",r.val());case 4:case"end":return n.stop()}}),n)})))()},generateKey:function(){return O["a"].database().ref().push().key},findKeyInList:function(e,t){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,O["a"].database().ref(e).orderByValue().equalTo(t).limitToFirst(1).get();case 2:return r=n.sent,n.abrupt("return",r.key);case 4:case"end":return n.stop()}}),n)})))()},findKeyOfChild:function(e,t){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,O["a"].database().ref("map/"+e).get();case 2:if(r=n.sent,o=r.val(),o.children){n.next=6;break}return n.abrupt("return",null);case 6:n.t0=regeneratorRuntime.keys(o.children);case 7:if((n.t1=n.t0()).done){n.next=13;break}if(i=n.t1.value,o.children[i].toString()!==t){n.next=11;break}return n.abrupt("return",i);case 11:n.next=7;break;case 13:return n.abrupt("return",null);case 14:case"end":return n.stop()}}),n)})))()},update:C,debouncedUpdate:R,getUserSubscribePeriod:function(e){return Object(u["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return","");case 2:return n=e.uid,t.next=5,O["a"].database().ref("user_data/".concat(n,"/subscribe_period")).get();case 5:if(r=t.sent,r.exists()){t.next=8;break}return t.abrupt("return","");case 8:return t.abrupt("return",r.val());case 9:case"end":return t.stop()}}),t)})))()},setUserSubscribePeriod:function(e,t){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.uid,n.next=3,O["a"].database().ref("user_data/".concat(r,"/subscribe_period")).set(t);case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n)})))()},setUserLastSearch:function(e,t){return Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,O["a"].database().ref("user_data/".concat(e,"/last_search")).set(t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))()},getUserComments:function(e){return Object(u["a"])(regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.uid,t.next=3,O["a"].database().ref("user_data/".concat(n,"/comment")).get();case 3:if(r=t.sent,r.exists()){t.next=6;break}return t.abrupt("return",[null,v("!snapshot.exists",{})]);case 6:return o=r.val(),t.abrupt("return",[o,null]);case 8:case"end":return t.stop()}}),t)})))()},getNodeContent:function(){return Object(u["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,O["a"].database().ref("node_content").get();case 2:if(t=e.sent,t.exists()){e.next=5;break}return e.abrupt("return",[{},null]);case 5:return e.abrupt("return",[t.val(),null]);case 6:case"end":return e.stop()}}),e)})))()}},P={SET_SUBSCRIPTIONS:"SET_SUBSCRIPTIONS",SET_SUBSCRIPTION:"SET_SUBSCRIPTION"},A={ToggleSubscription:"ToggleSubscription"},M={namespaced:!0,state:{subscriptions:{}},actions:Object(s["a"])({},A.ToggleSubscription,(function(e,t){var n=e.commit,r=e.state,o=e.rootState,i={nodeID:t,mode:0};r.subscriptions[t]&&0!=r.subscriptions[t]?1==r.subscriptions[t]&&(i.mode=null):i.mode=1,n(P.SET_SUBSCRIPTION,i),S.setSubscription(o.user.user,i)})),mutations:(D={},Object(s["a"])(D,P.SET_SUBSCRIPTIONS,(function(e,t){e.subscriptions=t||{}})),Object(s["a"])(D,P.SET_SUBSCRIPTION,(function(e,t){t.mode>0?e.subscriptions[t.nodeID]=t.mode:delete e.subscriptions[t.nodeID]})),D)},B={SET_MAP:"SET_MAP"},L={namespaced:!0,state:{layerMap:{}},mutations:Object(s["a"])({},B.SET_MAP,(function(e,t){e.layerMap[t.layerName]=t.titleBoxMap}))},V=36e5,U={ADD_NODES:"ADD_NODES",REMOVE_NODES:"REMOVE_NODES"},H={CheckNodeID:"CheckNodeID"},z={namespaced:!0,state:{permittedNodeIDs:{}},mutations:(k={},Object(s["a"])(k,U.ADD_NODES,(function(e,t){var n,r=Object(p["a"])(t);try{for(r.s();!(n=r.n()).done;){var o=n.value;e.permittedNodeIDs[o]=(new Date).getTime()}}catch(i){r.e(i)}finally{r.f()}})),Object(s["a"])(k,U.REMOVE_NODES,(function(e,t){var n,r=Object(p["a"])(t);try{for(r.s();!(n=r.n()).done;){var o=n.value;delete e.permittedNodeIDs[o]}}catch(i){r.e(i)}finally{r.f()}})),k),actions:Object(s["a"])({},H.CheckNodeID,(function(e,t){var n=e.commit,r=e.state;return!!(r.permittedNodeIDs[t]&&(new Date).getTime()<r.permittedNodeIDs[t]+V)||(r.permittedNodeIDs[t]&&n(U.REMOVE_NODES,[t]),!1)}))},G=(n("c740"),n("caad"),n("d81d"),n("2532"),n("3ca3"),n("2909")),J=n("53ca"),W=(n("a15b"),n("13d5"),n("a9e3"),n("b64b"),n("595b")),$=n("9fe2"),q=n("dcbe"),Y=n.n(q),F=0;function X(e,t){return(e%t+t)%t}function Z(e){var t=Math.pow(10,F);return Math.round(e*t)/t}function K(e){return Object(T["cloneDeep"])(e)}function Q(e,t){var n;t||console.error(e);var r=[];for(var o in t)r.push(o,t[o]);(n=console).error.apply(n,[e].concat(r))}var ee=n("ec26");function te(e,t){for(var n in t){var r=t[Number(n)];if(r&&r[e])return[r[e],Number(n)]}return[null,null]}function ne(e,t){var n,r=[],o=Object(p["a"])(t);try{for(o.s();!(n=o.n()).done;){var i=n.value;if(i){var a,c=Object(p["a"])(e);try{for(c.s();!(a=c.n()).done;){var u=a.value;i[u]&&r.push(i[u])}}catch(s){c.e(s)}finally{c.f()}}}}catch(s){o.e(s)}finally{o.f()}return r}function re(e,t){return{id:Object(ee["a"])(),position:t,title:e,children:[]}}function oe(e,t,n){var r=te(e.id,t),o=Object(d["a"])(r,1),i=o[0];if(null===i)return[null,null,v("getNewNodeCenter: cannot find mapNode for parent",{parentId:e.id,mapNodeLayers:t})];if(0===e.children.length){var a,c=i.border.map((function(e){return{from:i.center,to:e}})),u=c[0],s=Object(p["a"])(c);try{for(s.s();!(a=s.n()).done;){var l=a.value;se(l)>se(u)&&(u=l)}}catch(V){s.e(V)}finally{s.f()}var b=.5;return n&&(b=.5*Math.random()+1/4),[{x:u.from.x+b*(u.to.x-u.from.x),y:u.from.y+b*(u.to.y-u.from.y)},null,null]}var f=e.children[0],m=te(f.id,t),O=Object(d["a"])(m,1),h=O[0];if(null===h)return[null,null,v("getNewNodeCenter: cannot find maxDiagChild in layers",{maxDiagChildId:f.id,mapNodeLayers:t})];var g,j=Object(p["a"])(e.children);try{for(j.s();!(g=j.n()).done;){var y=g.value,x=te(y.id,t),I=Object(d["a"])(x,1),N=I[0];if(null===N)return[null,null,v("getNewNodeCenter: cannot find child in layers",{childId:y.id,mapNodeLayers:t})];var w=Ee(N.border),D=Object(d["a"])(w,2),k=D[0],T=D[1];if(T)return[null,null,v("getNewNodeCenter: error getMaxDiagonal",{childMapNode:N,err1:T})];var E=Ee(h.border),_=Object(d["a"])(E,2),C=_[0],R=_[1];if(R)return[null,null,v("getNewNodeCenter: error getMaxDiagonal",{maxDiagChildMapNode:h,err2:R})];se(k)>se(C)&&(h=N)}}catch(V){j.e(V)}finally{j.f()}var S=3/4;n&&(S=Math.random()*(1/4)+.625);var P=Ee(h.border),A=Object(d["a"])(P,1),M=A[0],B=Ne(M,S).to,L=K(f);return L.position=Ne(M,1/4).to,[B,L,null]}function ie(e,t){if(null==e.tree)return v("state.tree == null",{});var n=e.nodeRecord[t.nodeId];if(!n)return v("updateNodePosition: cannot find node in nodeRecord",{"v.nodeId":t.nodeId,"state.nodeRecord":e.nodeRecord});if(!n.parent)return v("updateNodePosition: cannot move root of tree",{"v.nodeId":t.nodeId});var r=_e("normalize",t.position,n.parent.id,e.mapNodeLayers),o=Object(d["a"])(r,1),i=o[0];n.node.position=i;var a=te(n.parent.id,e.mapNodeLayers),c=Object(d["a"])(a,2),u=c[0],s=c[1];if(!u||null===s)return v("updateNodePosition: cannot find mapNode for parent",{id:n.parent.id,"state.mapNodeLayers":e.mapNodeLayers});var l=Ce(n.parent,u.border,u.center),p=Object(d["a"])(l,2),b=p[0],f=p[1];return null==b||null!=f?v("updateNodePosition: create layers for parent",{id:n.parent.id,parentMapNode:u}):Re(e.mapNodeLayers,b,s)}var ae,ce,ue=[{x:0,y:0},{x:0,y:S.ST_HEIGHT},{x:S.ST_WIDTH,y:S.ST_HEIGHT},{x:S.ST_WIDTH,y:0}];function se(e){return Math.sqrt(Math.pow(e.from.x-e.to.x,2)+Math.pow(e.from.y-e.to.y,2))}function de(e){if(!e)throw new Error("polygonToTurf: p is empty");var t=e.map((function(e){return[e.x,e.y]}));return t.push([e[0].x,e[0].y]),W["polygon"]([t])}function le(e,t){return W["booleanPointInPolygon"](W["point"]([e.x,e.y]),de(t))}function pe(e){var t=e.map((function(e){return[e.x,e.y]}));return t.push([e[0].x,e[0].y]),[t]}function be(e){return Math.abs(Object($["a"])(e.map((function(e){return[e.x,e.y]}))))}function fe(e,t){var n=K(e),r=K(t),o=1;while(be(n)<1e3&&be(r)<1e3)o*=10,n=e.map((function(e){return{x:e.x*o,y:e.y*o}})),r=t.map((function(e){return{x:e.x*o,y:e.y*o}}));n=n.map((function(e){return{x:Z(e.x),y:Z(e.y)}})),r=r.map((function(e){return{x:Z(e.x),y:Z(e.y)}}));var i=pe(n),a=pe(r);if(null==i||null==a)return[null,v("intersect: error in polygonToPCPolygon",{p1:e,p2:t})];var c=Y.a.intersection(i,a);if(null==c||!c.length)return[[],null];var u,s=[],d=Object(p["a"])(c[0]);try{for(d.s();!(u=d.n()).done;){var l,b=u.value,f=[],m=Object(p["a"])(b);try{for(m.s();!(l=m.n()).done;){var O=l.value;f.push({x:O[0]/o,y:O[1]/o})}}catch(h){m.e(h)}finally{m.f()}f.pop(),s.push(f)}}catch(h){d.e(h)}finally{d.f()}return[s,null]}function me(e){e||console.error("bad border",e);var t=e.reduce((function(e,t){return e.x>t.x?t:e})).x,n=e.reduce((function(e,t){return e.y>t.y?t:e})).y,r=e.reduce((function(e,t){return e.x<t.x?t:e})).x,o=e.reduce((function(e,t){return e.y<t.y?t:e})).y;return{leftBottom:{x:t,y:n},rightTop:{x:r,y:o}}}function Oe(e,t,n){var r,o=e.map((function(e){return W["point"]([e.x,e.y])})),i=W["featureCollection"](o),a=W["voronoi"](i,{bbox:[t.x,t.y,n.x,n.y]}),c={},u=0,s=Object(p["a"])(a.features);try{for(s.s();!(r=s.n()).done;){var d=r.value;if(!d)return[{},v("getVoronoiCellsInSquare: undefined cell",{centers:e,leftBottom:t,rightTop:n,cells:a})];var l=d.geometry.coordinates[0].map((function(e){return{x:e[0],y:e[1]}}));l.pop(),c[u]=l,u++}}catch(b){s.e(b)}finally{s.f()}return[c,null]}function ve(e,t){if(!e)return[[],v("getVoronoiCells: bad outerBorder",{outerBorder:e,centers:t})];var n=me(e),r=Oe(t,n.leftBottom,n.rightTop),o=Object(d["a"])(r,2),i=o[0],a=o[1];if(a)return[[],v("getVoronoiCells: error in getVoronoiCellsInSquare",{err:a,bb:n,centers:t})];var c=[];for(var u in t){if(!i[u])return[[],v("Cannot find index in cellMap",{index:u,centers:t,cellMap:i,BoundingBorders:n,outerBorder:e})];var s=fe(i[u],e),l=Object(d["a"])(s,2),p=l[0],b=l[1];if(null==p||null!=b)return[[],v("getVoronoiCells error",{err:b,cellBorder:i[u],outerBorder:e})];if(p==[])return[[],v("Voronoi cell has no intersection with outerBorder",{point:t[u]})];if(p.length>1)return[[],v("Voronoi cell has more than one intersection with outerBorder",{point:t[u]})];c.push({border:p[0],center:t[u]})}return[c,null]}function he(e,t,n){return e&&e==t?"#f3afaf":n&&-1!=n.indexOf(t)?"#62f363":"transparent"}function ge(e,t,n){return e&&e==t||n&&-1!=n.indexOf(t)?"0.2":"0"}function je(e){return e.map((function(e){return"".concat(e.x," ").concat(e.y)})).join(",")}function ye(e){var t={},n=[{node:e,parent:null}],r=function(){var e=n.pop();if(!e)return"break";t[e.node.id]=e,n.push.apply(n,Object(G["a"])(e.node.children.map((function(t){return{node:t,parent:e.node}}))))};while(n.length){var o=r();if("break"===o)break}return t}function xe(e,t){return{from:{x:t.x,y:t.y},to:{x:t.x+(e.to.x-e.from.x),y:t.y+(e.to.y-e.from.y)}}}function Ie(e,t){var n=xe(t,e.to);return{from:{x:e.from.x,y:e.from.y},to:{x:n.to.x,y:n.to.y}}}function Ne(e,t){var n=xe(e,{x:0,y:0});return xe({from:{x:0,y:0},to:{x:n.to.x*t,y:n.to.y*t}},e.from)}function we(e,t){return xe(t,e).to}function De(e,t){var n=e.from.x,r=e.from.y,o=e.to.x,i=e.to.y,a=t.from.x,c=t.from.y,u=t.to.x,s=t.to.y,d=(s-c)*(o-n)-(u-a)*(i-r),l=(u-a)*(r-c)-(s-c)*(n-a),p=(o-n)*(r-c)-(i-r)*(n-a);if(0==d)return null;var b=l/d,f=p/d;return b>=0&&b<=1&&f>=0&&f<=1?{x:n+b*(o-n),y:r+b*(i-r)}:null}function ke(e,t,n){var r=W["centerOfMass"](de(e)).geometry;if(null==r)return[null,v("morphChildrenPoints oldBorder centerOfMass error",{oldBorder:e,oldPoints:n})];var o=W["centerOfMass"](de(t)).geometry;if(null==o)return[null,v("morphChildrenPoints newBorder centerOfMass error",{newBorder:t,oldPoints:n})];var i={x:r.coordinates[0],y:r.coordinates[1]},a={x:o.coordinates[0],y:o.coordinates[1]};for(var c in e=e.map((function(e){return we(e,{from:i,to:a})})),n)n[c]=we(n[c],{from:i,to:a});var u=Math.max(se({from:me(e).leftBottom,to:me(e).rightTop}),se({from:me(t).leftBottom,to:me(t).rightTop})),s={};for(var d in n){var l=n[d];if(a.x!=l.x||a.y!=l.y){var p={from:a,to:n[d]};p=Ne(p,u/se(p));var b=null;for(var f in e){var m={from:e[f],to:e[(Number(f)+1)%e.length]},O=De(p,m);if(null!=O){b=O;break}}if(null==b)return[null,v("morphChildrenPoints cannot find intersection with oldBorder",{centerToPoint:p,oldBorder:e})];var h=null;for(var g in t){var j={from:t[g],to:t[(Number(g)+1)%t.length]},y=De(p,j);if(null!=y){h=y;break}}if(null==h)return[null,v("morphChildrenPoints cannot find intersection with newBorder",{centerToPoint:p,newBorder:t})];if(b.x!=h.x||b.y!=h.y){var x=se({from:a,to:h})/se({from:a,to:b});s[d]=Ne({from:a,to:l},x).to}else s[d]=l}else s[d]=l}return[s,null]}function Te(){return{from:{x:0,y:0},to:{x:0,y:0}}}function Ee(e){if(!e||e.length<3)return[Te(),v("getMaxDiagonal: bad polygon",{polygon:e})];var t=[];if(3==e.length)for(var n in e){var r=Ne({from:e[X(Number(n)-1,e.length)],to:e[X(Number(n)+1,e.length)]},.5);t.push({from:e[n],to:r.to})}else for(var o in e)for(var i in e)Number(i)!=X(Number(o)-1,e.length)&&Number(i)!=Number(o)&&Number(i)!=X(Number(o)+1,e.length)&&t.push({from:e[o],to:e[i]});for(var a=t[0],c=0,u=t;c<u.length;c++){var s=u[c];se(s)>se(a)&&(a=s)}return[a,null]}function _e(e,t,n,r){var o;if(n){var i,a,c=te(n,r),u=Object(d["a"])(c,1),s=u[0];if(!s)return[null,v("UPDATE_NODE: Cannot findMapNode",{id:n})];if("denormalize"===e){if(!le(t,ue))return[null,v("convertPosition: position outside NORMALIZED_BORDER",{normalizedBorder:ue,position:t,parentID:n})];var l=ke(ue,s.border,{tmp:t}),p=Object(d["a"])(l,2);i=p[0],a=p[1]}else{if(!le(t,s.border))return[null,v("convertPosition: position outside parentMapNode.border",{"parentMapNode.border":s.border,"parentMapNode.center":s.center,position:t,parentID:n})];var b=ke(s.border,ue,{tmp:t}),f=Object(d["a"])(b,2);if(i=f[0],a=f[1],null!==a)return[null,v("UPDATE_NODE: Cannot morphChildrenPoints",{type:e,normalizedBorder:ue,"parentMapNode.border":s.border,"dbNode.position":t})];i["tmp"].x<0&&(i["tmp"].x=1),i["tmp"].x>S.ST_WIDTH&&(i["tmp"].x=S.ST_WIDTH-1),i["tmp"].y<0&&(i["tmp"].y=1),i["tmp"].y>S.ST_HEIGHT&&(i["tmp"].y=S.ST_HEIGHT-1)}if(null!==a)return[null,v("UPDATE_NODE: Cannot morphChildrenPoints",{type:e,normalizedBorder:ue,"parentMapNode.border":s.border,"dbNode.position":t})];o=i["tmp"]}else o="denormalize"===e?{x:S.ROOT_CENTER_X,y:S.ROOT_CENTER_Y}:{x:S.ST_WIDTH/2,y:S.ST_HEIGHT/2};return[o,null]}function Ce(e,t,n){if(0==Object.keys(e).length)return[[],null];var r=[[e]],o=[Object(s["a"])({},e.id,{id:e.id,border:t,title:e.title,center:n})];while(1){var i,a=r[r.length-1],c=o[r.length-1],u=[],l={},b=Object(p["a"])(a);try{for(b.s();!(i=b.n()).done;){var f=i.value;if(!f.children)return[null,v("treeToMapNodeLayers: treeNode with children undefined",{treeNode:f})];if(f.children.length){var m={},O="";for(var h in f.children){if(O=JSON.stringify(f.children[h].position),m[O]&&m[O].length>0)return[null,v("two children has the same center",{firstId:m[O],secondId:f.children[h].id})];m[O]=f.children[h].id}if(u.push.apply(u,Object(G["a"])(f.children)),!c[f.id])return[null,v("Cannot find node in mapNodeLayers",{layer:o[o.length-1],treeNode:f})];var g,j=K(f.children),y=Object(p["a"])(j);try{for(y.s();!(g=y.n()).done;){var x=g.value,I=_e("denormalize",x.position,f.id,[c]),N=Object(d["a"])(I,2),w=N[0],D=N[1];if(D)return[null,D];x.position=w}}catch(B){y.e(B)}finally{y.f()}var k=ve(c[f.id].border,j.map((function(e){return{x:e.position.x,y:e.position.y}}))),T=Object(d["a"])(k,2),E=T[0],_=T[1];if(null!=_)return[null,_];var C,R=Object(p["a"])(E);try{for(R.s();!(C=R.n()).done;){var S,P=C.value,A=Object(p["a"])(j);try{for(A.s();!(S=A.n()).done;){var M=S.value;M.position.x==P.center.x&&M.position.y==P.center.y&&(l[M.id]={id:M.id,title:M.title,center:M.position,border:P.border})}}catch(B){A.e(B)}finally{A.f()}}}catch(B){R.e(B)}finally{R.f()}}}}catch(B){b.e(B)}finally{b.f()}if(!u.length)return[o,null];r.push(u),o.push(l)}}function Re(e,t,n){if(n>=e.length||n<0)return v("startFromLevel >= recipientLayers.length or startFromLevel < 0",{startFromLevel:n,"recipientLayers.length":e.length});var r=n;while(r<n+t.length){for(var o in t[r-n])e[r][o]=t[r-n][o];r++}return null}var Se={SET_CONTENTS:"SET_CONTENTS",SET_USER_COMMENTS:"SET_USER_COMMENTS",SET_NODE_CONTENT:"SET_NODE_CONTENT",SET_NODE_COMMENT:"SET_NODE_COMMENT"},Pe={getNodeContent:"getNodeContent",setNodeContent:"setNodeContent",setNodeComment:"setNodeComment"},Ae={nodeID:"",content:""};function Me(e,t){e[t]||(e[t]=K(Ae),e[t].nodeID=t)}var Be={nodeID:"",comment:""};function Le(e,t){e[t]||(e[t]=K(Be),e[t].nodeID=t)}var Ve,Ue,He={namespaced:!0,state:{nodeContents:{},userNodeComments:{}},actions:(ae={},Object(s["a"])(ae,Pe.getNodeContent,(function(e,t){var n=e.state;return n.nodeContents[t]})),Object(s["a"])(ae,Pe.setNodeComment,(function(e,t){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,i,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(o=e.commit,i=e.rootState,i.user.user&&!i.user.user.isAnonymous){n.next=3;break}return n.abrupt("return",null);case 3:return n.next=5,S.debouncedUpdate((r={},Object(s["a"])(r,"user_data/".concat(i.user.user.uid,"/comment/").concat(t.nodeID,"/nodeID"),t.nodeID),Object(s["a"])(r,"user_data/".concat(i.user.user.uid,"/comment/").concat(t.nodeID,"/comment"),t.comment),r));case 5:if(a=n.sent,!a){n.next=8;break}return n.abrupt("return",a);case 8:return o("".concat(Se.SET_NODE_COMMENT),t),n.abrupt("return",null);case 10:case"end":return n.stop()}}),n)})))()})),Object(s["a"])(ae,Pe.setNodeContent,(function(e,t){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=e.commit,e.state,o("".concat(Se.SET_NODE_CONTENT),t),n.next=4,S.debouncedUpdate((r={},Object(s["a"])(r,"node_content/".concat(t.nodeID,"/nodeID"),t.nodeID),Object(s["a"])(r,"node_content/".concat(t.nodeID,"/content"),t.content),r));case 4:if(i=n.sent,!i){n.next=7;break}return n.abrupt("return",i);case 7:return n.abrupt("return",null);case 8:case"end":return n.stop()}}),n)})))()})),ae),mutations:(ce={},Object(s["a"])(ce,Se.SET_CONTENTS,(function(e,t){e.nodeContents=t})),Object(s["a"])(ce,Se.SET_USER_COMMENTS,(function(e,t){e.userNodeComments=t})),Object(s["a"])(ce,Se.SET_NODE_CONTENT,(function(e,t){Me(e.nodeContents,t.nodeID),e.nodeContents[t.nodeID].content=t.content})),Object(s["a"])(ce,Se.SET_NODE_COMMENT,(function(e,t){Le(e.userNodeComments,t.nodeID),e.userNodeComments[t.nodeID].comment=t.comment})),ce)},ze=(n("ac1f"),n("841c"),n("5bd5")),Ge=new ze["Worker"]({language:"en",tokenize:"forward"});function Je(e,t){Ge.add(e,t)}function We(e){return Ge.search(e)}var $e,qe={SET_USER:"SET_USER",SET_SUBSCRIBE_PERIOD:"SET_SUBSCRIBE_PERIOD"},Ye={signIn:"signIn",signOut:"signOut",setSubscribePeriod:"setSubscribePeriod"},Fe={namespaced:!0,state:{user:null,subscribePeriod:""},mutations:(Ve={},Object(s["a"])(Ve,qe.SET_USER,(function(e,t){e.user=t})),Object(s["a"])(Ve,qe.SET_SUBSCRIBE_PERIOD,(function(e,t){e.subscribePeriod=t})),Ve),actions:(Ue={},Object(s["a"])(Ue,Ye.signIn,(function(e){return Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.commit,t.next=3,O["a"].auth().signInWithPopup(new O["a"].auth.GoogleAuthProvider);case 3:case"end":return t.stop()}}),t)})))()})),Object(s["a"])(Ue,Ye.signOut,(function(e){return Object(u["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.commit,t.next=3,O["a"].auth().signOut();case 3:n(qe.SET_USER,null);case 4:case"end":return t.stop()}}),t)})))()})),Object(s["a"])(Ue,Ye.setSubscribePeriod,(function(e,t){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=e.commit,o=e.state,o.user){n.next=3;break}return n.abrupt("return");case 3:return r(qe.SET_SUBSCRIBE_PERIOD,t),n.next=6,S.setUserSubscribePeriod(o.user,t);case 6:case"end":return n.stop()}}),n)})))()})),Ue)};function Xe(e){return Ze.apply(this,arguments)}function Ze(){return Ze=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,r,o,i,a,c,u,s,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,S.getMap(t);case 2:if(n=e.sent,r=Object(d["a"])(n,2),o=r[0],i=r[1],(null===o||i)&&Q("fetchMap: cannot api.getMap(user)",{err:i}),a=w(o),c=Object(d["a"])(a,2),u=c[0],s=c[1],null===s){e.next=10;break}return e.abrupt("return",[null,s]);case 10:for(l in zt.commit("tree/".concat(xt.SET_TREE),u),o)Qe(l);case 12:case"end":return e.stop()}}),e)}))),Ze.apply(this,arguments)}function Ke(e){S.unsubscribeDBChange("map/".concat(e)),S.unsubscribeDBChange("node_content/".concat(e)),S.unsubscribeDBChange("precondition/".concat(e)),S.unsubscribeDBChange("node_image/".concat(e))}function Qe(e){S.subscribeMapNodeChange(e,(function(e){return zt.dispatch("tree/".concat(It.handleMapNodeUpdate),e)})),S.subscribeNodeContentChange(e,(function(e){Je(e.nodeID,e.content),zt.commit("nodeContent/".concat(Se.SET_NODE_CONTENT),e)})),S.subscribePreconditionNodeChange(e),S.subscribeNodeImageChange(e)}function et(e){return tt.apply(this,arguments)}function tt(){return tt=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,r,o,i,a,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,S.getPins(t);case 2:if(n=e.sent,r=Object(d["a"])(n,2),o=r[0],i=r[1],null==o&&(i?console.error("fetchPins",i):console.log("fetchPins: empty pins")),!t||o){e.next=15;break}return e.next=10,S.getPins(null);case 10:a=e.sent,c=Object(d["a"])(a,2),o=c[0],i=c[1],(null==o||i)&&(console.error(i),o={});case 15:zt.commit("pin/".concat(b.SET_PINS),o);case 16:case"end":return e.stop()}}),e)}))),tt.apply(this,arguments)}function nt(e){return rt.apply(this,arguments)}function rt(){return rt=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,S.getUserSubscribePeriod(t);case 4:n=e.sent,zt.commit("user/".concat(qe.SET_SUBSCRIBE_PERIOD),n);case 6:case"end":return e.stop()}}),e)}))),rt.apply(this,arguments)}function ot(e){return it.apply(this,arguments)}function it(){return it=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,r,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,S.getSubscriptions(t);case 2:n=e.sent,r=Object(d["a"])(n,2),o=r[0],i=r[1],null==o&&(i?console.error("fetchSubscriptions",i):console.log("fetchSubscriptions: empty")),zt.commit("subscriptions/".concat(P.SET_SUBSCRIPTIONS),o);case 8:case"end":return e.stop()}}),e)}))),it.apply(this,arguments)}function at(e){return ct.apply(this,arguments)}function ct(){return ct=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,r,o,i,a,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,S.getPreconditions(t);case 2:if(n=e.sent,r=Object(d["a"])(n,2),o=r[0],i=r[1],(null==o||i)&&(console.error(i),o={}),!t||o){e.next=15;break}return e.next=10,S.getPreconditions(null);case 10:a=e.sent,c=Object(d["a"])(a,2),o=c[0],i=c[1],(null==o||i)&&(console.error(i),o={});case 15:zt.commit("precondition/".concat(j.SET_PRECONDITIONS),o);case 16:case"end":return e.stop()}}),e)}))),ct.apply(this,arguments)}function ut(e){return st.apply(this,arguments)}function st(){return st=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,r,o,i,a,c,u,s,l,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,S.getNodeContent();case 2:if(n=e.sent,r=Object(d["a"])(n,2),o=r[0],i=r[1],null!=o&&!i){e.next=9;break}return Q("fetchNodeContents error",{err:i}),e.abrupt("return");case 9:for(c in a={},o)a[c]={nodeID:o[c].nodeID,content:o[c].content};if(zt.commit("nodeContent/".concat(Se.SET_CONTENTS),a),!t){e.next=25;break}return e.next=15,S.getUserComments(t);case 15:if(u=e.sent,s=Object(d["a"])(u,2),l=s[0],p=s[1],!p){e.next=22;break}return Q("fetch userComments error",{err:p,user:t}),e.abrupt("return");case 22:if(null!==l){e.next=24;break}return e.abrupt("return");case 24:zt.commit("nodeContent/".concat(Se.SET_USER_COMMENTS),l);case 25:case"end":return e.stop()}}),e)}))),st.apply(this,arguments)}function dt(e){return lt.apply(this,arguments)}function lt(){return lt=Object(u["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Xe(t);case 2:return e.next=4,et(t);case 4:return e.next=6,nt(t);case 6:return e.next=8,ot(t);case 8:return e.next=10,at(t);case 10:return e.next=12,ut(t);case 12:case"end":return e.stop()}}),e)}))),lt.apply(this,arguments)}var pt=2560,bt=2e3,ft=1/3,mt=[{x:0,y:ft*bt},{x:0,y:2*ft*bt},{x:ft/2.5*pt,y:(1-ft/4)*bt},{x:ft*pt,y:bt},{x:2*ft*pt,y:bt},{x:(1-ft/2.5)*pt,y:(1-ft/4)*bt},{x:pt,y:2*ft*bt},{x:pt,y:ft*bt},{x:(1-ft/2.5)*pt,y:ft/4*bt},{x:2*ft*pt,y:0},{x:ft*pt,y:0},{x:ft/2.5*pt,y:ft/4*bt}],Ot={x:S.ROOT_CENTER_X,y:S.ROOT_CENTER_Y},vt=Math.min(S.ROOT_WIDTH/pt,S.ROOT_HEIGHT/bt);for(var ht in mt)mt[ht].x=vt*mt[ht].x+S.ROOT_CENTER_X-vt*pt/2,mt[ht].y=vt*mt[ht].y+S.ROOT_CENTER_Y-vt*bt/2;var gt,jt,yt,xt={SET_SELECTED_NODE_ID:"SET_SELECTED_NODE_ID",SET_TREE:"SET_TREE",UPDATE_NODE_POSITION:"UPDATE_NODE_POSITION",REMOVE_NODE:"REMOVE_NODE"},It={handleMapNodeUpdate:"handleMapNodeUpdate"},Nt={namespaced:!0,state:function(){return{tree:null,nodeRecord:{},mapNodeLayers:[],selectedNodeId:null}},getters:{selectedNode:function(e){return e.selectedNodeId&&e.nodeRecord[e.selectedNodeId]?e.nodeRecord[e.selectedNodeId].node:null}},actions:Object(s["a"])({},It.handleMapNodeUpdate,(function(e,t){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,i,a,c,u,s,l,b,f,m,O,v,h,g,j,y,x,I,N,w,D,k,T,E;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=e.commit,o=e.state,i=o.nodeRecord[t.id],i){n.next=4;break}return n.abrupt("return");case 4:if(a={id:i.node.id,parentID:i.parent?i.parent.id:null,name:i.node.title,children:i.node.children.map((function(e){return e.id})).sort(),position:i.node.position},c=t.children.filter((function(e){return!a.children.includes(e)})),u=a.children.filter((function(e){return!t.children.includes(e)})),!c.length){n.next=29;break}s=Object(p["a"])(c),n.prev=9,b=regeneratorRuntime.mark((function e(){var n,i,a,c,u,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=l.value,o.nodeRecord[n]&&(console.log("actions.handleDBUpdate: remove node for cut-and-paste",o.nodeRecord[n]),i={nodeID:n,returnError:null},r(xt.REMOVE_NODE,{nodeID:n,returnError:null}),i.returnError&&Q("handleDBUpdate: cannot cut node",{err:i.returnError})),e.next=4,S.getMapNode(n);case 4:if(a=e.sent,console.log("actions.handleDBUpdate: add node for cut-and-paste",a),c=[a],a){e.next=11;break}return t.children=t.children.filter((function(e){return e!=n})),Q("Cannot find node for addition",{nodeID:n}),e.abrupt("return","continue");case 11:u=regeneratorRuntime.mark((function e(){var t,n,r,i,a,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=c.pop(),t){e.next=3;break}return e.abrupt("return","continue");case 3:if(n={id:t.id,title:t.name,position:t.position,children:[]},o.nodeRecord[t.parentID]){e.next=7;break}return Q("Cannot find nodeID in nodeRecord",{nodeID:t.parentID}),e.abrupt("return",{v:{v:void 0}});case 7:o.nodeRecord[t.parentID].node.children=o.nodeRecord[t.parentID].node.children.filter((function(e){return e.id!=n.id})),o.nodeRecord[t.parentID].node.children.push(n),o.nodeRecord[n.id]={parent:o.nodeRecord[t.parentID].node,node:n},Qe(n.id),r=Object(p["a"])(t.children),e.prev=12,a=regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=i.value,e.next=3,S.getMapNode(n);case 3:if(r=e.sent,r){e.next=8;break}return t.children=t.children.filter((function(e){return e!=n})),Q("Cannot find node for addition",{nodeID:n}),e.abrupt("return","continue");case 8:c.push(r);case 9:case"end":return e.stop()}}),e)})),r.s();case 15:if((i=r.n()).done){e.next=22;break}return e.delegateYield(a(),"t0",17);case 17:if(u=e.t0,"continue"!==u){e.next=20;break}return e.abrupt("continue",20);case 20:e.next=15;break;case 22:e.next=27;break;case 24:e.prev=24,e.t1=e["catch"](12),r.e(e.t1);case 27:return e.prev=27,r.f(),e.finish(27);case 30:case"end":return e.stop()}}),e,null,[[12,24,27,30]])}));case 12:if(!c.length){e.next=21;break}return e.delegateYield(u(),"t0",14);case 14:if(s=e.t0,"continue"!==s){e.next=17;break}return e.abrupt("continue",12);case 17:if("object"!==Object(J["a"])(s)){e.next=19;break}return e.abrupt("return",s.v);case 19:e.next=12;break;case 21:case"end":return e.stop()}}),e)})),s.s();case 12:if((l=s.n()).done){n.next=21;break}return n.delegateYield(b(),"t0",14);case 14:if(f=n.t0,"continue"!==f){n.next=17;break}return n.abrupt("continue",19);case 17:if("object"!==Object(J["a"])(f)){n.next=19;break}return n.abrupt("return",f.v);case 19:n.next=12;break;case 21:n.next=26;break;case 23:n.prev=23,n.t1=n["catch"](9),s.e(n.t1);case 26:return n.prev=26,s.f(),n.finish(26);case 29:if(!u.length){n.next=54;break}m=Object(p["a"])(u),n.prev=31,m.s();case 33:if((O=m.n()).done){n.next=46;break}if(v=O.value,o.nodeRecord[v]&&o.nodeRecord[v].parent){n.next=37;break}return n.abrupt("continue",44);case 37:if(!o.nodeRecord[v]||o.nodeRecord[v].parent.id===t.id){n.next=39;break}return n.abrupt("continue",44);case 39:console.log("actions.handleDBUpdate: removing children",o.nodeRecord[v]),h={nodeID:v,returnError:null},r(xt.REMOVE_NODE,h),h.returnError&&Q("actions.handleDBUpdate: cannot remove node",{err:h.returnError,id:v}),Ke(v);case 44:n.next=33;break;case 46:n.next=51;break;case 48:n.prev=48,n.t2=n["catch"](31),m.e(n.t2);case 51:return n.prev=51,m.f(),n.finish(51);case 54:if(!u.length&&!c.length){n.next=60;break}if(g=Ce(o.tree,mt,Ot),j=Object(d["a"])(g,2),y=j[0],x=j[1],!x){n.next=59;break}return Q("Cannot treeToMapNodeLayers",{err:x}),n.abrupt("return");case 59:o.mapNodeLayers=y;case 60:if(Z(t.position.x)===Z(a.position.x)&&Z(t.position.y)===Z(a.position.y)){n.next=68;break}if(I=_e("denormalize",t.position,i.parent?i.parent.id:null,o.mapNodeLayers),N=Object(d["a"])(I,1),w=N[0],a.parentID!=t.parentID){n.next=68;break}if(D={nodeId:t.id,newCenter:w,returnError:null},r(xt.UPDATE_NODE_POSITION,D),null===D.returnError){n.next=68;break}return Q("actions.handleDBUpdate: cannot update node's position",{dbNode:t,err:D.returnError}),n.abrupt("return");case 68:if(a.name===t.name){n.next=74;break}if(i.node.title=t.name,k=te(a.id,o.mapNodeLayers),T=Object(d["a"])(k,1),E=T[0],E){n.next=73;break}return n.abrupt("return");case 73:E.title=t.name;case 74:case"end":return n.stop()}}),n,null,[[9,23,26,29],[31,48,51,54]])})))()})),mutations:($e={},Object(s["a"])($e,xt.REMOVE_NODE,(function(e,t){if(null!==e.tree)if(e.nodeRecord[t.nodeID]){var n=e.nodeRecord[t.nodeID].parent;if(n){var r=[t.nodeID];while(r.length){var o=r.pop();o&&(r.push.apply(r,Object(G["a"])(e.nodeRecord[o].node.children.map((function(e){return e.id})))),delete e.nodeRecord[o])}var i=n.children.findIndex((function(e){return e.id===t.nodeID}));n.children.splice(i,1)}else t.returnError=v("REMOVE_NODE: cannot remove root node",{nodeId:t.nodeID})}else t.returnError=v("REMOVE_NODE: cannot find nodeId in nodeRecord",{nodeID:t.nodeID,nodeRecord:e.nodeRecord});else t.returnError=v("state.tree === null",{})})),Object(s["a"])($e,xt.SET_SELECTED_NODE_ID,(function(e,t){e.selectedNodeId=t})),Object(s["a"])($e,xt.SET_TREE,(function(e,t){if(null==t)return e.tree=null,e.nodeRecord={},void(e.mapNodeLayers=[]);e.tree=t,e.nodeRecord=ye(t);var n=Ce(t,mt,Ot),r=Object(d["a"])(n,2),o=r[0],i=r[1];null!=o&&null==i?e.mapNodeLayers=o:console.error(i)})),Object(s["a"])($e,xt.UPDATE_NODE_POSITION,(function(e,t){var n=e.nodeRecord[t.nodeId].parent;if(null!==n){var r=te(n.id,e.mapNodeLayers),o=Object(d["a"])(r,1),i=o[0];if(!i)return void(t.returnError=v("UPDATE_NODE_POSITION: cannot find parent mapNode",{"parent.id":n.id,"state.mapNodeLayers":e.mapNodeLayers}));if(!le(t.newCenter,i.border))return void(t.returnError=v("!isInside",{newCenter:t.newCenter,"parentMapNode.border":i.border}))}t.returnError=ie(e,{nodeId:t.nodeId,position:t.newCenter})})),$e)},wt={ADD_ZOOM:"ADD_ZOOM",ADD_PAN:"ADD_PAN",ADD_RELATIVE_PAN:"ADD_RELATIVE_PAN",SET_PAN:"SET_PAN",SET_ZOOM_CENTER:"SET_ZOOM_CENTER",RESET_ZOOM_AND_PAN:"RESET_ZOOM_AND_PAN"},Dt=.002,kt=1,Tt=100,Et=Object(T["debounce"])((function(e,t){e.debouncedZoom=t,e.relative.zoom=1}),Tt),_t=Object(T["debounce"])((function(e,t){e.debouncedPan=t,e.relative.pan={x:0,y:0}}),Tt),Ct={namespaced:!0,state:{zoom:1,pan:{x:0,y:0},debouncedZoom:1,debouncedPan:{x:0,y:0},zoomCenter:{x:0,y:0},relative:{zoom:1,pan:{x:0,y:0}}},mutations:(gt={},Object(s["a"])(gt,wt.SET_ZOOM_CENTER,(function(e,t){e.zoomCenter=t})),Object(s["a"])(gt,wt.ADD_ZOOM,(function(e,t){var n=e.zoom*Math.pow(2,t*Dt);n<.5||(e.zoom=n,e.relative.zoom=e.relative.zoom*Math.pow(2,t*Dt),Et(e,e.zoom))})),Object(s["a"])(gt,wt.ADD_PAN,(function(e,t){e.pan=Ie({from:{x:0,y:0},to:e.pan},Ne(t,kt)).to,_t(e,e.pan)})),Object(s["a"])(gt,wt.ADD_RELATIVE_PAN,(function(e,t){e.relative.pan=Ie({from:{x:0,y:0},to:e.relative.pan},Ne(t,kt)).to,_t(e,e.pan)})),Object(s["a"])(gt,wt.SET_PAN,(function(e,t){e.pan=t,_t(e,e.pan)})),Object(s["a"])(gt,wt.RESET_ZOOM_AND_PAN,(function(e,t){e.pan={x:0,y:0},_t(e,e.pan),e.zoom=1,Et(e,e.zoom)})),gt)},Rt={ADD_CUT_PASTE:"ADD_CUT_PASTE",ADD_CREATE:"ADD_CREATE",ADD_REMOVE:"ADD_REMOVE",ADD_POSITION_CHANGE:"ADD_POSITION_CHANGE"};(function(e){e["CUT_PASTE"]="CUT_PASTE",e["CREATE"]="CREATE",e["REMOVE"]="REMOVE",e["POSITION_CHANGE"]="POSITION_CHANGE"})(yt||(yt={}));var St,Pt={CUT_PASTE:"CUT_PASTE",CREATE:"CREATE",REMOVE:"REMOVE",POSITION_CHANGE:"POSITION_CHANGE"},At={namespaced:!0,state:{stableChangeList:{},localChangeList:{}},mutations:(jt={},Object(s["a"])(jt,Rt.ADD_CUT_PASTE,(function(e,t){e.localChangeList[t.nodeID]||(e.localChangeList[t.nodeID]={}),e.localChangeList[t.nodeID][Pt.CREATE]?e.localChangeList[t.nodeID][Pt.CREATE].parentID=t.newParentID:e.localChangeList[t.nodeID][Pt.CUT_PASTE]=t})),Object(s["a"])(jt,Rt.ADD_CREATE,(function(e,t){e.localChangeList[t.nodeID]||(e.localChangeList[t.nodeID]={}),e.localChangeList[t.nodeID][Pt.CREATE]=t})),Object(s["a"])(jt,Rt.ADD_REMOVE,(function(e,t){e.localChangeList[t.nodeID]={},e.localChangeList[t.nodeID][Pt.REMOVE]=t})),Object(s["a"])(jt,Rt.ADD_POSITION_CHANGE,(function(e,t){e.localChangeList[t.nodeID]||(e.localChangeList[t.nodeID]={});var n=t.oldPosition;e.localChangeList[t.nodeID][Pt.POSITION_CHANGE]&&(n=e.localChangeList[t.nodeID][Pt.POSITION_CHANGE].oldPosition),e.localChangeList[t.nodeID][Pt.POSITION_CHANGE]={nodeID:t.nodeID,oldPosition:n,newPosition:t.newPosition}})),jt),actions:{}},Mt=(n("fb6a"),{SET_NODE_IDS:"SET_NODE_IDS"}),Bt={namespaced:!0,state:{nodeIDs:[]},mutations:Object(s["a"])({},Mt.SET_NODE_IDS,(function(e,t){t.length>20?e.nodeIDs=t.slice(0,20):e.nodeIDs=t}))},Lt={init:"init",updateNodePosition:"updateNodePosition",createNode:"createNode",cutPasteNode:"cutPasteNode",removeNode:"removeNode",setEditMode:"setEditMode",confirmSignInPopup:"confirmSignInPopup"},Vt={SET_EDIT_MODE:"SET_EDIT_MODE"},Ut=Object(T["debounce"])((function(e,t,n,r){var o=_e("normalize",t,n,r),i=Object(d["a"])(o,1),a=i[0];S.update(Object(s["a"])({},"map/".concat(e,"/position"),a))}),200),Ht=Symbol(),zt=Object(l["a"])({state:{editModeOn:!1},mutations:Object(s["a"])({},Vt.SET_EDIT_MODE,(function(e,t){e.editModeOn=t})),actions:(St={},Object(s["a"])(St,Lt.confirmSignInPopup,(function(e,t){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=e.dispatch,t.confirm.require({message:t.message,header:"SignIn",acceptLabel:"Ok, Sign In",rejectLabel:"No, thanks, just watching",accept:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r("user/".concat(Ye.signIn));case 2:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),reject:function(){}});case 2:case"end":return n.stop()}}),n)})))()})),Object(s["a"])(St,Lt.setEditMode,(function(e,t){var n=e.commit;n(Vt.SET_EDIT_MODE,t)})),Object(s["a"])(St,Lt.init,(function(e){return Object(u["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=e.commit,S.initFirebase(),O["a"].auth().onAuthStateChanged((function(e){e&&!e.isAnonymous?(S.setPublicUserData(e.uid,e.displayName,null),n("user/".concat(qe.SET_USER),e),dt(e)):(n("user/".concat(qe.SET_USER),null),dt(null))}));case 3:case"end":return t.stop()}}),t)})))()})),Object(s["a"])(St,Lt.createNode,(function(e,t){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,i,a,c,u,l,p,b,f,m,O,v,h,g,j,y,x,I,N,w;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(o=e.commit,i=e.state,a=i.tree.nodeRecord[t.parentID].node,c=oe(a,i.tree.mapNodeLayers,!0),u=Object(d["a"])(c,3),l=u[0],p=u[1],b=u[2],null===b){n.next=6;break}return Q("Cannot create new center",{err:b,parent:a,"state.tree.mapNodeLayers":i.tree.mapNodeLayers}),n.abrupt("return");case 6:if(f=_e("normalize",l,t.parentID,i.tree.mapNodeLayers),m=Object(d["a"])(f,2),O=m[0],v=m[1],!v){n.next=10;break}return Q("createNode: cannot create new center",{err:v,parent:a,"state.tree.mapNodeLayers":i.tree.mapNodeLayers}),n.abrupt("return");case 10:return h=re(t.title,O),g={id:h.id,parentID:t.parentID,name:t.title,children:[],position:O},j=S.generateKey(),r={},Object(s["a"])(r,"map/".concat(g.id),g),Object(s["a"])(r,"map/".concat(g.parentID,"/children/").concat(j),g.id),y=r,p&&(x=_e("normalize",p.position,t.parentID,i.tree.mapNodeLayers),I=Object(d["a"])(x,1),N=I[0],y["map/".concat(p.id,"/position")]=N),n.next=17,S.getMapNode(t.parentID);case 17:if(w=n.sent,w){n.next=21;break}return console.error("Cannot find parent to add node",t.parentID),n.abrupt("return");case 21:return n.next=23,S.update(y);case 23:return o("history/".concat(Rt.ADD_CREATE),{nodeID:h.id,parentID:t.parentID}),n.abrupt("return",h.id);case 25:case"end":return n.stop()}}),n)})))()})),Object(s["a"])(St,Lt.cutPasteNode,(function(e,t){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,i,a,c,u,l,p,b,f,m,O,v,h,g,j,y,x,I,N;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(o=e.commit,i=e.state,a=i.tree.nodeRecord[t.nodeID].parent,c=i.tree.nodeRecord[t.parentID].node,u=oe(c,i.tree.mapNodeLayers,!0),l=Object(d["a"])(u,3),p=l[0],b=l[1],f=l[2],!f){n.next=7;break}return Q("cutPasteNode: cannot getNewNodeCenter",{err:f}),n.abrupt("return");case 7:if(m=_e("normalize",p,t.parentID,i.tree.mapNodeLayers),O=Object(d["a"])(m,2),v=O[0],h=O[1],!h){n.next=11;break}return Q("cutPasteNode: cannot create new center",{err:h,parent:parent,"state.tree.mapNodeLayers":i.tree.mapNodeLayers}),n.abrupt("return");case 11:return g=S.generateKey(),n.next=14,S.findKeyOfChild(a.id,t.nodeID);case 14:return j=n.sent,r={},Object(s["a"])(r,"map/".concat(t.nodeID,"/parentID"),c.id),Object(s["a"])(r,"map/".concat(a.id,"/children/").concat(j),null),Object(s["a"])(r,"map/".concat(c.id,"/children/").concat(g),t.nodeID),Object(s["a"])(r,"map/".concat(t.nodeID,"/position"),v),y=r,b&&(x=_e("normalize",b.position,t.parentID,i.tree.mapNodeLayers),I=Object(d["a"])(x,1),N=I[0],y["map/".concat(b.id,"/position")]=N),n.next=19,S.update(y);case 19:o("history/".concat(Rt.ADD_CUT_PASTE),{nodeID:t.nodeID,parentID:t.parentID});case 20:case"end":return n.stop()}}),n)})))()})),Object(s["a"])(St,Lt.removeNode,(function(e,t){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=e.commit,o=e.state,i=o.tree.nodeRecord[t].parent,i){n.next=4;break}return n.abrupt("return");case 4:return n.next=6,S.update(Object(s["a"])({},"cmd/remove",t));case 6:r("history/".concat(Rt.ADD_REMOVE),{parentNodeID:i.id,nodeID:t});case 7:case"end":return n.stop()}}),n)})))()})),Object(s["a"])(St,Lt.updateNodePosition,(function(e,t){var n=e.commit,r=e.state;if(r.editModeOn){var o=te(t.nodeId,r.tree.mapNodeLayers),i=Object(d["a"])(o,1),a=i[0];if(!a)return v("UPDATE_NODE_POSITION: cannot find mapNode",{"v.nodeId":t.nodeId,"state.mapNodeLayers":r.tree.mapNodeLayers});var c=Ie({from:{x:0,y:0},to:a.center},{from:{x:0,y:0},to:t.delta}).to,u={nodeId:t.nodeId,newCenter:c,returnError:null};n("tree/".concat(xt.UPDATE_NODE_POSITION),u),null===u.returnError&&(n("history/".concat(Rt.ADD_POSITION_CHANGE),{nodeID:t.nodeId,oldPosition:a.center,newPosition:c}),Ut(t.nodeId,c,r.tree.nodeRecord[t.nodeId].parent.id,r.tree.mapNodeLayers))}})),St),modules:{pin:m,subscriptions:M,titleBox:L,image:I,precondition:y,positionChangePermits:z,tree:Nt,user:Fe,zoomPan:Ct,history:At,nodeContent:He,searchResult:Bt}});function Gt(){return Object(l["b"])(Ht)}var Jt=Object(r["n"])({setup:function(){var e=Gt();e.dispatch(Lt.init)}});Jt.render=o;var Wt=Jt,$t=n("9319"),qt=n("b24b"),Yt=n("485c"),Ft=n("6c02"),Xt=Object(r["l"])(" This section is just for test/emulator cases for now "),Zt=Object(r["m"])("input",{id:"email"},null,-1),Kt=Object(r["m"])("input",{id:"password"},null,-1);function Qt(e,t,n,o,i,a){return Object(r["A"])(),Object(r["g"])(r["a"],null,[Xt,Zt,Kt,Object(r["m"])("button",{onClick:t[1]||(t[1]=function(){return e.login&&e.login.apply(e,arguments)})},"login")],64)}var en=Object(r["n"])({name:"PasswordLogin",setup:function(){Gt();return{login:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=document.getElementById("email"),n=document.getElementById("password"),e.next=4,O["a"].auth().signInWithEmailAndPassword(t.value,n.value);case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}}});en.render=Qt;var tn=en,nn={class:"p-toast-message-icon"},rn={class:"p-toast-message-text"},on={class:"p-toast-summary"};function an(e,t,n,o,i,a){var c=Object(r["J"])("ConfirmDialog"),u=Object(r["J"])("Toast"),s=Object(r["J"])("NodeContent"),d=Object(r["J"])("Menu"),l=Object(r["J"])("Map");return Object(r["A"])(),Object(r["g"])(r["a"],null,[Object(r["m"])(c),Object(r["m"])(u,{position:"bottom-left"},{icon:Object(r["V"])((function(e){return[Object(r["m"])("div",nn,[Object(r["m"])("span",{class:e.class},null,2)])]})),message:Object(r["V"])((function(e){return[Object(r["m"])("div",rn,[Object(r["m"])("span",on,Object(r["N"])(e.message.summary),1),Object(r["m"])("div",{class:"p-toast-detail",innerHTML:e.message.detail},null,8,["innerHTML"])])]})),_:1}),Object(r["m"])(s,{clickedTitleId:e.clickedTitleId,onSelectPreconditionIsOn:e.setSelectPreconditionON,onSelectPreconditionIsOff:e.setSelectPreconditionOFF,show:!e.editModeOn,selectedNodeId:e.selectedNodeId},null,8,["clickedTitleId","onSelectPreconditionIsOn","onSelectPreconditionIsOff","show","selectedNodeId"]),Object(r["m"])(d,{onRestoreSelectNewParentIsOn:e.setRestoreSelectNewParentON,onRestoreSelectNewParentIsOff:e.setRestoreSelectNewParentOFF,clickedTitleId:e.clickedTitleId},null,8,["onRestoreSelectNewParentIsOn","onRestoreSelectNewParentIsOff","clickedTitleId"]),Object(r["m"])(l,{layers:e.visibleZoomedPanedLayers,selectedNodeId:e.selectedNodeId,selectedNodePreconditionIds:e.selectedNodePreconditionIds,"pin-nodes":e.pinNodes,searchResultPinNodes:e.searchResultPinNodes,searchResultNodeIDs:e.searchResultNodeIDs,onTitleDragging:e.nodeDragging,onTitleClick:e.titleClick,onTitleOver:e.titleOver,onTitleLeave:e.titleLeave,onDraggingBackground:e.mapDragging,onWheel:e.zoom},null,8,["layers","selectedNodeId","selectedNodePreconditionIds","pin-nodes","searchResultPinNodes","searchResultNodeIDs","onTitleDragging","onTitleClick","onTitleOver","onTitleLeave","onDraggingBackground","onWheel"])],64)}function cn(e,t,n,o,i,a){var c=Object(r["J"])("MapLayer"),u=Object(r["J"])("PreconditionLayer"),s=Object(r["J"])("PinLayer");return Object(r["A"])(),Object(r["g"])("svg",{xmlns:"http://www.w3.org/2000/svg",width:e.svgWidth,height:e.svgHeight,viewBox:"0 0 ".concat(e.svgWidth," ").concat(e.svgHeight),id:e.mapID,style:{"touch-action":"none"}},[(Object(r["A"])(!0),Object(r["g"])(r["a"],null,Object(r["H"])(e.layers,(function(t,n){return Object(r["A"])(),Object(r["g"])(c,{key:n,"layer-id":n,"map-nodes":t,"border-color":e.borderColor(n),"font-color":e.fontColor(n),"font-size":e.fontSize(n),"font-opacity":e.fontOpacity(n),selectedNodeId:e.selectedNodeId,selectedNodePreconditionIds:e.selectedNodePreconditionIds,searchResultNodeIDs:e.searchResultNodeIDs,"map-id":e.mapID,onTitleDragging:e.draggingNode,onTitleClick:e.titleClick,onTitleOver:e.titleOver,onTitleLeave:e.titleLeave},null,8,["layer-id","map-nodes","border-color","font-color","font-size","font-opacity","selectedNodeId","selectedNodePreconditionIds","searchResultNodeIDs","map-id","onTitleDragging","onTitleClick","onTitleOver","onTitleLeave"])})),128)),Object(r["m"])(u,{selectedNodeId:e.selectedNodeId,visibleTitleIds:e.visibleTitleIds,"layer-id":"precondition",onTitleClick:e.titleClick,onTitleOver:e.titleOver,onTitleLeave:e.titleLeave},null,8,["selectedNodeId","visibleTitleIds","onTitleClick","onTitleOver","onTitleLeave"]),Object(r["m"])(s,{pinNodes:e.pinNodes,"layer-id":"pinNodes",color:"pink","font-size":8,"font-weight":"normal","text-decoration":"none",selectedNodeId:e.selectedNodeId,onTitleClick:e.titleClick,onTitleOver:e.titleOver,onTitleLeave:e.titleLeave},null,8,["pinNodes","selectedNodeId","onTitleClick","onTitleOver","onTitleLeave"]),Object(r["m"])(s,{pinNodes:e.searchResultPinNodes,"layer-id":"searchResultPinNodes",color:"red","font-size":10,"font-weight":"bold","text-decoration":"underline",selectedNodeId:e.selectedNodeId,onTitleClick:e.titleClick,onTitleOver:e.titleOver,onTitleLeave:e.titleLeave},null,8,["pinNodes","selectedNodeId","onTitleClick","onTitleOver","onTitleLeave"])],8,["width","height","viewBox","id"])}var un=Object(r["Y"])("data-v-182e8a4c"),sn=un((function(e,t,n,o,i,a){return Object(r["A"])(),Object(r["g"])(r["a"],null,[(Object(r["A"])(!0),Object(r["g"])(r["a"],null,Object(r["H"])(e.mapNodes,(function(t,n){return Object(r["A"])(),Object(r["g"])("polygon",{key:n,stroke:e.borderColor,fill:e.polygonFill(e.selectedNodeId,t.id,e.selectedNodePreconditionIds),"fill-opacity":e.polygonFillOpacity(e.selectedNodeId,t.id,e.selectedNodePreconditionIds),"stroke-width":"2",points:e.polygonToPath(t.border),"pointer-events":"none"},null,8,["stroke","fill","fill-opacity","points"])})),128)),(Object(r["A"])(!0),Object(r["g"])(r["a"],null,Object(r["H"])(e.mapNodes,(function(t){return Object(r["A"])(),Object(r["g"])("text",{id:"".concat(e.TITLE_PREFIX).concat(t.id),key:t.id,"font-family":"Roboto","font-size":"".concat(e.fontSize,"vmax"),"font-weight":e.textWeight(t.id,e.selectedNodeId),fill:e.textColor(t.id,e.selectedNodeId),"fill-opacity":e.fontOpacity,"text-decoration":e.textDecoration(t.id),class:"text"},[(Object(r["A"])(!0),Object(r["g"])(r["a"],null,Object(r["H"])(e.splitLines(t.title,20),(function(n,o){return Object(r["A"])(),Object(r["g"])("tspan",{key:o,x:e.titleBox[t.id]?e.titleBox[t.id].position.x:0,y:e.titleBox[t.id]&&e.innerWidth>0?e.titleBox[t.id].position.y+o*e.fontSize*Math.max(e.innerWidth,e.innerHeight)/100:0,"alignment-baseline":"hanging"},Object(r["N"])(n),9,["x","y"])})),128))],8,["id","font-size","font-weight","fill","fill-opacity","text-decoration"])})),128)),(Object(r["A"])(!0),Object(r["g"])(r["a"],null,Object(r["H"])(e.mapNodes,(function(t){return Object(r["A"])(),Object(r["g"])("rect",{key:t.id,x:e.titleBox[t.id]?e.titleBox[t.id].position.x:0,y:e.titleBox[t.id]?e.titleBox[t.id].position.y:0,width:e.titleBox[t.id]?e.titleBox[t.id].bbox.width:0,height:e.titleBox[t.id]?e.titleBox[t.id].bbox.height:0,fill:"transparent","stroke-width":"0",onMouseover:function(n){return e.titleOver(t.id)},onMouseleave:function(n){return e.titleLeave(t.id)},onClick:function(n){return e.titleClick(t.id)},onMousedown:function(n){return e.titleMouseDown(t.id)},stroke:"pink",cursor:"pointer","pointer-events":"fill"},null,40,["x","y","width","height","onMouseover","onMouseleave","onClick","onMousedown"])})),128))],64)})),dn=function(e,t,n){n.nodeId&&(n.dragStart=!0,e("title-dragging",{nodeId:n.nodeId,delta:{x:t.movementX,y:t.movementY}}))},ln=function(e,t){t.nodeId&&(t.dragStart&&e("title-drop",{id:t.nodeId}),t.dragStart=!1,t.nodeId=null)},pn=function(e){var t={};for(var n in e){var r=e[n];t[r.id]={position:r.center,bbox:{width:0,height:0}}}return t},bn=function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t,n,o){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i={},e.next=3,Object(r["s"])((function(){for(var e in o){var r=o[e],a=document.getElementById("".concat(t).concat(r.id));null!=a&&("center"==n?i[r.id]={position:{x:r.center.x-a.getBoundingClientRect().width/2,y:r.center.y-a.getBoundingClientRect().height/2},bbox:{width:a.getBoundingClientRect().width,height:a.getBoundingClientRect().height}}:"left"==n&&(i[r.id]={position:{x:r.center.x-a.getBoundingClientRect().width,y:r.center.y-a.getBoundingClientRect().height/2},bbox:{width:a.getBoundingClientRect().width,height:a.getBoundingClientRect().height}}))}}));case 3:return e.abrupt("return",i);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),fn=function(e,t,n,o){o(pn(n.value)),Object(r["T"])(n,function(){var n=Object(u["a"])(regeneratorRuntime.mark((function n(r){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.abrupt("return",bn(e,t,r).then((function(e){return o(e)})));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),{immediate:!0,deep:!0})};n("1276");function mn(e,t){if(t<=0)return[];if(""==e)return[];var n=e.split(" "),r=[],o=[];while(n.length)if(o.join(" ").length>t){var i=[];o.length>1&&i.push(o.pop()),r.push(o.join(" ")),o=i}else o.push(n.shift());if(o.join(" ").length>t){var a=[];o.length>1&&a.push(o.pop()),r.push(o.join(" ")),o=a}return o.length&&r.push(o.join(" ")),r}var On="title_",vn=Object(r["n"])({name:"MapLayer",emits:["title-over","title-leave","title-click","title-drop","title-dragging"],props:{layerId:{type:Number},mapId:{type:String,required:!0},mapNodes:{type:Object,required:!0},borderColor:{type:String,required:!0},fontSize:{type:Number,required:!0},fontColor:{type:String,required:!0},fontOpacity:{type:Number,required:!0},selectedNodeId:{type:String,validator:function(e){return"string"===typeof e||null===e},required:!0},selectedNodePreconditionIds:Object,searchResultNodeIDs:Object},setup:function(e,t){var n=Object(r["O"])(e,"mapNodes"),o=Gt(),i="map_"+e.layerId,a=Object(r["e"])((function(){return o.state.titleBox.layerMap[i]}));fn(On,"center",n,(function(e){o.commit("titleBox/".concat(B.SET_MAP),{layerName:i,titleBoxMap:e})}));var c={nodeId:null,dragStart:!1},u=function(e){return dn(t.emit,e,c)},s=function(){return ln(t.emit,c)};Object(r["y"])((function(){var t=document.getElementById(e.mapId);t?(t.addEventListener("mousemove",u),t.addEventListener("mouseup",s)):Q("MapLayer.vue: cannot find map id for event listener",{})})),Object(r["z"])((function(){var t=document.getElementById(e.mapId);t?(t.removeEventListener("mousemove",u),t.removeEventListener("mouseup",s)):Q("MapLayer.vue: cannot find map id for event listener",{})}));var d=Object(r["e"])((function(){var t={};if(!e.searchResultNodeIDs)return t;var n,r=Object(p["a"])(e.searchResultNodeIDs);try{for(r.s();!(n=r.n()).done;){var o=n.value;t[o]=!0}}catch(i){r.e(i)}finally{r.f()}return t}));return{TITLE_PREFIX:On,titleBox:a,innerWidth:window.innerWidth,innerHeight:window.innerHeight,textColor:function(t,n){var r;return n&&n==t||e.selectedNodePreconditionIds&&-1!=(null===(r=e.selectedNodePreconditionIds)||void 0===r?void 0:r.indexOf(t))?"#ffa500":d.value[t]?"red":e.fontColor},textWeight:function(e,t){return t&&t==e||d.value[e]?"bold":"normal"},textDecoration:function(e){return d.value[e]?"underline":"none"},titleClick:function(e){t.emit("title-click",{id:e})},titleOver:function(e){t.emit("title-over",{id:e})},titleLeave:function(e){t.emit("title-leave",{id:e})},titleMouseDown:function(e){c.nodeId=e,c.dragStart=!1}}},methods:{splitLines:mn,polygonToPath:je,polygonFill:he,polygonFillOpacity:ge}});n("62a5");vn.render=sn,vn.__scopeId="data-v-182e8a4c";var hn=vn,gn={on:!1},jn=function(){gn.on=!0},yn=function(){gn.on=!1},xn=function(e,t){gn.on&&e("dragging-background",t)},In={mouseDown:jn,mouseUp:yn,mouseMove:xn};function Nn(e,t,n,o,i,a){var c=Object(r["J"])("PinMarker"),u=Object(r["J"])("SVGTextBox");return Object(r["A"])(),Object(r["g"])(r["a"],null,[(Object(r["A"])(!0),Object(r["g"])(r["a"],null,Object(r["H"])(e.visiblePinNodes,(function(t){return Object(r["A"])(),Object(r["g"])(c,{key:t.id,x:t.center.x,y:t.center.y,color:e.color},null,8,["x","y","color"])})),128)),(Object(r["A"])(!0),Object(r["g"])(r["a"],null,Object(r["H"])(e.visiblePinNodes,(function(t){return Object(r["A"])(),Object(r["g"])(u,{text:t.title,id:"".concat(e.TITLE_PREFIX).concat(t.id),key:t.id,useLineBreak:!0,x:e.titleXY[t.id].x,y:e.titleXY[t.id].y,"line-height":8,"max-char-per-line":10,"font-family":"Roboto","font-size":e.fontSize,"font-weight":e.fontWeight,color:e.color,"text-decoration":e.textDecoration},null,8,["text","id","x","y","font-size","font-weight","color","text-decoration"])})),128)),(Object(r["A"])(!0),Object(r["g"])(r["a"],null,Object(r["H"])(e.pinNodes,(function(t){return Object(r["A"])(),Object(r["g"])("rect",{key:t.id,x:e.titleXY[t.id].x,y:e.titleXY[t.id].y,width:e.titleBox[t.id]?e.titleBox[t.id].bbox.width:0,height:e.titleBox[t.id]?e.titleBox[t.id].bbox.height:0,cursor:"pointer",fill:"transparent",onClick:function(n){return e.titleBoxClick(t.id)},onMouseover:function(n){return e.titleOver(t.id)},onMouseleave:function(n){return e.titleLeave(t.id)},"stroke-width":"0",stroke:"pink"},null,40,["x","y","width","height","onClick","onMouseover","onMouseleave"])})),128))],64)}function wn(e,t,n,o,i,a){return Object(r["A"])(),Object(r["g"])("g",{transform:"translate(".concat(e.x-e.WIDTH/2," ").concat(e.y-e.HEIGHT,") scale(0.05 0.05)")},[Object(r["m"])("path",{fill:"".concat(e.color),d:"M182.9,551.7c0,0.1,0.2,0.3,0.2,0.3S358.3,283,358.3,194.6c0-130.1-88.8-186.7-175.4-186.9\n        C96.3,7.9,7.5,64.5,7.5,194.6c0,88.4,175.3,357.4,175.3,357.4S182.9,551.7,182.9,551.7z M122.2,187.2c0-33.6,27.2-60.8,60.8-60.8\n        c33.6,0,60.8,27.2,60.8,60.8S216.5,248,182.9,248C149.4,248,122.2,220.8,122.2,187.2z"},null,8,["fill"])],8,["transform"])}var Dn=18,kn=26,Tn=Object(r["n"])({name:"PinMarker",props:{x:{type:Number,required:!0},y:{type:Number,required:!0},color:{type:String,required:!0}},setup:function(){return{WIDTH:Dn,HEIGHT:kn}}});Tn.render=wn;var En=Tn,_n=Object(r["Y"])("data-v-3400d8a7"),Cn=_n((function(e,t,n,o,i,a){return Object(r["A"])(),Object(r["g"])("text",{id:e.id,"font-family":e.fontFamily,"font-size":e.fontSize,"font-weight":e.fontWeight,fill:e.color,class:"text"},[(Object(r["A"])(!0),Object(r["g"])(r["a"],null,Object(r["H"])(e.lines,(function(t,n){return Object(r["A"])(),Object(r["g"])("tspan",{key:n,x:e.x,y:e.y>0?e.y+n*e.lineHeight:0,"alignment-baseline":"hanging"},Object(r["N"])(t),9,["x","y"])})),128))],8,["id","font-family","font-size","font-weight","fill"])})),Rn=Object(r["n"])({name:"SVGTextBox",props:{id:{type:String,required:!0},useLineBreak:{type:Boolean,required:!0},text:{type:String,required:!0},x:{type:Number,required:!0},y:{type:Number,required:!0},lineHeight:{type:Number,required:!0},maxCharPerLine:{type:Number,required:!0},fontFamily:{type:String,required:!0},fontSize:{type:Number,required:!0},fontWeight:{type:String,required:!0},color:{type:String,required:!0}},setup:function(e){var t=[];return t=e.useLineBreak?mn(e.text,e.maxCharPerLine):[e.text],{lines:t}}});n("1d0f");Rn.render=Cn,Rn.__scopeId="data-v-3400d8a7";var Sn=Rn,Pn="pin_title_",An=Object(r["n"])({name:"PinLayer",components:{SVGTextBox:Sn,PinMarker:En},emits:["title-click","title-over","title-leave"],props:{layerId:String,pinNodes:{type:Object,required:!0},selectedNodeId:{type:String,validator:function(e){return"string"===typeof e||null===e},required:!0},color:{type:String},fontWeight:{type:String},fontSize:{type:Number},textDecoration:{type:String}},setup:function(e,t){var n=Object(r["e"])((function(){var t,n={},r=Object(p["a"])(e.pinNodes);try{for(r.s();!(t=r.n()).done;){var o=t.value;n[o.id]=o}}catch(i){r.e(i)}finally{r.f()}return n})),o=Object(r["e"])((function(){var t,n={},r=Object(p["a"])(e.pinNodes);try{for(r.s();!(t=r.n()).done;){var o=t.value;o.id!=e.selectedNodeId&&(n[o.id]=o)}}catch(i){r.e(i)}finally{r.f()}return n})),i=Gt(),a="pin_"+e.layerId,c=Object(r["e"])((function(){return i.state.titleBox.layerMap[a]}));return fn(Pn,"left",n,(function(e){i.commit("titleBox/".concat(B.SET_MAP),{layerName:a,titleBoxMap:e})})),{TITLE_PREFIX:Pn,PIN_MARKER_HEIGHT:kn,PIN_MARKER_WIDTH:Dn,visiblePinNodes:o,titleBox:c,titleXY:Object(r["e"])((function(){var e={};for(var t in n.value){var r=n.value[t];e[r.id]={x:c.value[r.id]?c.value[r.id].position.x:0,y:c.value[r.id]?c.value[r.id].position.y:0}}return e})),titleBoxClick:function(e){t.emit("title-click",{id:e})},titleOver:function(e){t.emit("title-over",{id:e})},titleLeave:function(e){t.emit("title-leave",{id:e})}}}});An.render=Nn;var Mn=An,Bn=Object(r["m"])("defs",null,[Object(r["m"])("marker",{id:"preconditionArrowHead",markerWidth:"6",markerHeight:"7",refX:"3",refY:"3.5",orient:"auto"},[Object(r["m"])("polygon",{fill:"#aae3b9",stroke:"#aae3b9",points:"0 0, 6 3.5, 0 7"})])],-1);function Ln(e,t,n,o,i,a){var c=Object(r["J"])("PreconditionArrow"),u=Object(r["J"])("SVGTextBox");return Object(r["A"])(),Object(r["g"])(r["a"],null,[Bn,(Object(r["A"])(!0),Object(r["g"])(r["a"],null,Object(r["H"])(e.preconditions,(function(t){return Object(r["A"])(),Object(r["g"])(c,{key:t.id,markerId:"preconditionArrow",from:t.center,to:e.selectedNode?e.selectedNode.center:null,color:"#aae3b9"},null,8,["from","to"])})),128)),(Object(r["A"])(!0),Object(r["g"])(r["a"],null,Object(r["H"])(e.visibleTitleNodes,(function(t){return Object(r["A"])(),Object(r["g"])(u,{text:t.title,id:"".concat(e.TITLE_PREFIX).concat(t.id),key:t.id,useLineBreak:!0,x:e.visibleTitleNodeBoxes[t.id]?e.visibleTitleNodeBoxes[t.id].position.x:0,y:e.visibleTitleNodeBoxes[t.id]?e.visibleTitleNodeBoxes[t.id].position.y:0,"line-height":8,"max-char-per-line":10,"font-family":"Roboto","font-size":8,"font-weight":"normal",color:"#ffa500"},null,8,["text","id","x","y"])})),128)),(Object(r["A"])(!0),Object(r["g"])(r["a"],null,Object(r["H"])(e.visibleTitleNodes,(function(t){return Object(r["A"])(),Object(r["g"])("rect",{key:t.id,x:e.visibleTitleNodeBoxes[t.id]?e.visibleTitleNodeBoxes[t.id].position.x:0,y:e.visibleTitleNodeBoxes[t.id]?e.visibleTitleNodeBoxes[t.id].position.y:0,width:e.visibleTitleNodeBoxes[t.id]?e.visibleTitleNodeBoxes[t.id].bbox.width:0,height:e.visibleTitleNodeBoxes[t.id]?e.visibleTitleNodeBoxes[t.id].bbox.height:0,cursor:"pointer",fill:"transparent",onClick:function(n){return e.titleBoxClick(t.id)},onMouseover:function(n){return e.titleBoxOver(t.id)},onMouseleave:function(n){return e.titleBoxLeave(t.id)},"stroke-width":"0",stroke:"pink"},null,40,["x","y","width","height","onClick","onMouseover","onMouseleave"])})),128))],64)}function Vn(e,t,n,o,i,a){return e.from&&e.to?(Object(r["A"])(),Object(r["g"])("line",{key:0,x1:e.from.x,y1:e.from.y,x2:e.to.x,y2:e.to.y,stroke:e.color,"stroke-width":"1","marker-end":"url(#preconditionArrowHead)"},null,8,["x1","y1","x2","y2","stroke"])):Object(r["h"])("",!0)}var Un=Object(r["n"])({name:"PreconditionArrow",props:{markerId:String,color:String,from:Object,to:Object||null}});Un.render=Vn;var Hn=Un;function zn(e,t){return"<a href='/".concat(e,"'>").concat(t[e]?t[e].node.title:"undefined","</a>")}function Gn(e,t){var n={};for(var r in e)n[e[r]]=!0;var o={};for(var i in t)o[t[i]]=!0;var a=[];for(var c in o)n[c]||a.push(c);var u=[];for(var s in n)o[s]||u.push(s);return[a,u]}function Jn(e,t){if(!t[e]||null==t[e].parent)return[];var n=[],r=t[t[e].parent.id];while(null!==r){if(n.push(r.node),null==r.parent)break;r=t[r.parent.id]}return n}function Wn(e,t){return Jn(e,t).filter((function(e){return"0"!==e.id})).map((function(e){return e.title})).reverse().join("/")}function $n(){return window.innerWidth>window.innerHeight}var qn=$n()?3:1;function Yn(e,t,n){return{x:e.x*t+n.x,y:e.y*t+n.y}}function Fn(e,t,n){return e.map((function(e){return Yn(e,t,n)}))}function Xn(e,t,n,r,o){e.x=(e.x-o.x)/n*t+r.x,e.y=(e.y-o.y)/n*t+r.y}function Zn(e,t,n,r,o){e.forEach((function(e){return Xn(e,t,n,r,o)}))}function Kn(e,t,n,r,o,i){if(!e||0==e.length)return["",null];var a=null,c=n.width*n.height,u=e[0];while(Object.keys(u).length){for(var s in a="",u){var l=Fn(u[s].border,r,o);if(le(i,l)){a=s;break}}if(""===a){var b=1/0;for(var f in u){var m=Yn(u[f].center,r,o),O=se({from:m,to:i});O<b&&(b=O,a=f)}}var h=be(Fn(u[a].border,r,o));if(Math.floor(h)*qn<=Math.floor(c))return null==t[a].parent?[a,null]:[t[a].parent.id,null];if(u={},!t[a])return["",v("findCurrentNode: cannot find underFocusPointNodeId in nodeRecord",{maxIntersectNodeId:a,nodeRecord:t})];var g,j=Object(p["a"])(t[a].node.children);try{for(j.s();!(g=j.n()).done;){var y=g.value,x=te(y.id,e),I=Object(d["a"])(x,1),N=I[0];if(null==N)return["",v("filterNodesAndLayers: Cannot find node in layers",{"child.id":y.id,layers:e})];u[y.id]=N}}catch(w){j.e(w)}finally{j.f()}if(0===Object.keys(u).length)return[a,null]}return["",v("filterNodesAndLayers: unknown error",{})]}function Qn(e,t,n){if(!e||!e.length)return[[],null];var r=[],o=te(n,e),i=Object(d["a"])(o,2),a=i[0],c=i[1];if(null==a||null==c)return[[],v("filterNodesAndLayers-currentNode: error in findMapNode",{currentNodeId:n,layers:e})];var u={};if(null==t[a.id].parent)u[a.id]=K(a);else{var s,l=Object(p["a"])(t[a.id].parent.children);try{for(l.s();!(s=l.n()).done;){var b=s.value,f=te(b.id,[e[c]]),m=Object(d["a"])(f,2),O=m[0],h=m[1];if(null==O||null===h)return[[],v("filterNodesAndLayers-upperLayer: error in findMapNode",{"child.id":b.id,level:c,layers:[e[c]]})];u[b.id]=K(O),u[b.id].title=""}}catch(Y){l.e(Y)}finally{l.f()}}r.push(u);var g={};for(var j in u){var y,x=Object(p["a"])(t[j].node.children);try{for(x.s();!(y=x.n()).done;){var I=y.value,N=te(I.id,[e[c+1]]),w=Object(d["a"])(N,2),D=w[0],k=w[1];if(null==D||null===k)return[[],v("filterNodesAndLayers-firstLayer: error in findMapNode",{"child.id":I.id,layers:[e[c+1]]})];j!=n?(g[I.id]=K(D),g[I.id].title=""):g[I.id]=K(D)}}catch(Y){x.e(Y)}finally{x.f()}}Object.keys(g).length>0&&r.push(g);var T,E={},_=Object(p["a"])(t[n].node.children);try{for(_.s();!(T=_.n()).done;){var C,R=T.value,S=Object(p["a"])(t[R.id].node.children);try{for(S.s();!(C=S.n()).done;){var P=C.value,A=te(P.id,[e[c+2]]),M=Object(d["a"])(A,2),B=M[0],L=M[1];if(null==B||null===L)return[[],v("filterNodesAndLayers-secondLayer: error in findMapNode",{"child.id":R.id,layers:[e[c+2]]})];E[P.id]=K(B)}}catch(Y){S.e(Y)}finally{S.f()}}}catch(Y){_.e(Y)}finally{_.f()}Object.keys(E).length>0&&r.push(E);var V={};for(var U in E){var H,z=Object(p["a"])(t[U].node.children);try{for(z.s();!(H=z.n()).done;){var G=H.value,J=te(G.id,[e[c+3]]),W=Object(d["a"])(J,2),$=W[0],q=W[1];if(null==$||null===q)return[[],v("filterNodesAndLayers-thirdLayer:cannot findMapNode",{"child.id":G.id,level:c+3,layers:[e[c+3]]})];V[G.id]=K($),V[G.id].title=""}}catch(Y){z.e(Y)}finally{z.f()}}return Object.keys(V).length>0&&r.push(V),[r,null]}function er(e,t,n,r,o){if(!e||0==e.length)return[];for(var i in e){for(var a in e[i])Xn(e[i][a].center,t,r,n,o),Zn(e[i][a].border,t,r,n,o)}}function tr(e,t,n){if(!e||0==e.length)return[];var r=[];for(var o in e){var i={};for(var a in e[o]){var c=e[o][a];i[a]={id:c.id,title:c.title,center:Yn(c.center,t,n),border:Fn(c.border,t,n)}}r.push(i)}return r}var nr=n("0347"),rr="precondition_title_",or=Object(r["n"])({name:"PreconditionLayer",emits:["title-over","title-leave","title-click"],components:{SVGTextBox:Sn,PreconditionArrow:Hn},props:{layerId:String,selectedNodeId:String,visibleTitleIds:Object},setup:function(e,t){var n=Gt(),o=n.state.zoomPan,i=Object(r["e"])((function(){if(e.selectedNodeId&&n.state.tree.mapNodeLayers){var t=te(e.selectedNodeId,n.state.tree.mapNodeLayers),r=Object(d["a"])(t,1),i=r[0];if(!i)return null;var a=K(i);return Object(nr["a"])().phone?a.center=Yn(a.center,o.debouncedZoom,o.debouncedPan):a.center=Yn(a.center,o.zoom,o.pan),a}return null})),a=Object(r["G"])({}),c=Object(r["G"])({}),u="precondition",s=Object(r["e"])((function(){return n.state.titleBox.layerMap[u]}));return fn(rr,"left",c,(function(e){n.commit("titleBox/".concat(B.SET_MAP),{layerName:u,titleBoxMap:e})})),Object(r["T"])((function(){return Object(nr["a"])().phone?[o.debouncedZoom,o.debouncedPan,e.selectedNodeId,n.state.precondition.preconditions,e.visibleTitleIds]:[o.zoom,o.pan,e.selectedNodeId,n.state.precondition.preconditions,e.visibleTitleIds]}),(function(){var t;if(a.value={},c.value={},e.selectedNodeId&&n.state.precondition.preconditions[e.selectedNodeId]&&n.state.tree.mapNodeLayers){var r,u=K(ne(n.state.precondition.preconditions[e.selectedNodeId],n.state.tree.mapNodeLayers)),s=Object(p["a"])(u);try{for(s.s();!(r=s.n()).done;){var d=r.value;Object(nr["a"])().phone?d.center=Yn(d.center,o.debouncedZoom,o.debouncedPan):d.center=Yn(d.center,o.zoom,o.pan),a.value[d.id]=d}}catch(f){s.e(f)}finally{s.f()}}for(var l in a.value){var b;-1==(null===(b=e.visibleTitleIds)||void 0===b?void 0:b.indexOf(l))&&(c.value[l]=a.value[l])}e.selectedNodeId&&i.value&&n.state.tree.mapNodeLayers&&-1==(null===(t=e.visibleTitleIds)||void 0===t?void 0:t.indexOf(e.selectedNodeId))&&(c.value[e.selectedNodeId]=i.value)}),{immediate:!0,deep:!0}),{TITLE_PREFIX:rr,selectedNode:i,preconditions:a,visibleTitleNodes:c,visibleTitleNodeBoxes:s,titleBoxClick:function(e){t.emit("title-click",{id:e})},titleBoxOver:function(e){t.emit("title-over",{id:e})},titleBoxLeave:function(e){t.emit("title-leave",{id:e})}}}});or.render=Ln;var ir=or,ar="mapID",cr=Object(r["n"])({name:"Map",emits:["title-dragging","title-click","title-over","title-leave","dragging-background","wheel"],components:{PreconditionLayer:ir,PinLayer:Mn,MapLayer:hn},props:{layers:Object,selectedNodeId:{type:String||null,validator:function(e){return"string"===typeof e||null===e},required:!0},selectedNodePreconditionIds:Object,pinNodes:Object,searchResultPinNodes:Object,searchResultNodeIDs:Object},setup:function(e,t){return Object(r["y"])((function(){var e=document.getElementById(ar);if(e){e.addEventListener("mousedown",(function(e){In.mouseDown()})),e.addEventListener("mouseup",(function(e){In.mouseUp()})),e.addEventListener("mousemove",(function(e){In.mouseMove(t.emit,{from:{x:e.clientX-e.movementX,y:e.clientY-e.movementY},to:{x:e.clientX,y:e.clientY}})})),e.addEventListener("wheel",(function(e){t.emit("wheel",{delta:-e.deltaY,center:{x:e.clientX,y:e.clientY}})}),{passive:!0});var n=1/0,r={x:0,y:0},o={x:1/0,y:1/0};e.addEventListener("touchstart",(function(e){1===e.touches.length&&(o.x=e.touches[0].clientX,o.y=e.touches[0].clientY),2===e.touches.length&&(n=1/0),In.mouseDown()}),{passive:!0}),e.addEventListener("touchend",(function(e){r={x:0,y:0},n=1/0,o.x=1/0,o.y=1/0,In.mouseUp()})),e.addEventListener("touchmove",(function(e){if(1===e.touches.length)o.x!=1/0&&o.y!=1/0&&In.mouseMove(t.emit,{from:o,to:{x:e.touches[0].clientX,y:e.touches[0].clientY}}),o.x=e.touches[0].clientX,o.y=e.touches[0].clientY;else if(2===e.touches.length){var i=0;n===1/0&&(r={x:e.touches[0].pageX+(e.touches[0].pageX-e.touches[1].pageX)/2,y:e.touches[0].pageY+(e.touches[0].pageY-e.touches[1].pageY)/2});var a=Math.max(Math.abs(r.x-e.touches[0].pageX),Math.abs(r.x-e.touches[1].pageX),Math.abs(r.y-e.touches[0].pageY),Math.abs(r.y-e.touches[1].pageY));n!==1/0&&(i=a-n),n=a,t.emit("wheel",{delta:4*i,center:r})}}),{passive:!0})}else Q("Map.vue: cannot find map id for event listener",{})})),{svgWidth:window.innerWidth,svgHeight:window.innerHeight,visibleTitleIds:Object(r["e"])((function(){if(!e.layers)return[];var t,n=[],r=Object(p["a"])(e.layers);try{for(r.s();!(t=r.n()).done;){var o=t.value;for(var i in o)""!=o[i].title&&n.push(i)}}catch(a){r.e(a)}finally{r.f()}return n})),draggingNode:function(e){t.emit("title-dragging",{id:e.nodeId,delta:e.delta})},titleClick:function(e){t.emit("title-click",{id:e.id})},titleOver:function(e){t.emit("title-over",{id:e.id})},titleLeave:function(e){t.emit("title-leave",{id:e.id})},mapID:ar,fontSize:function(t){var n,r=0;return n=$n()?{0:.4,1:.73,2:1.4,3:1.86}:{0:1.8*.4,1:1.314,2:2.52,3:1.8*1.86},e.layers.length>=4&&(r=n[t]),3==e.layers.length&&(r=n[t+1]),r},fontOpacity:function(t){var n=0,r={0:1,1:1,2:.2,3:1};return e.layers.length>=4&&(n=r[t]),3==e.layers.length&&(n=r[t+1]),n},fontColor:function(t){return e.layers.length>=4?"rgb(".concat(200-100*t,",").concat(200-100*t,",").concat(200-100*t,")"):3==e.layers.length?"rgb(".concat(200-100*(t+1),",").concat(200-100*(t+1),",").concat(200-100*(t+1),")"):""},borderColor:function(t){var n=0,r={0:240,1:200,2:100,3:90};return e.layers.length>=4&&(n=r[t]),3==e.layers.length&&(n=r[t+1]),"rgb(".concat(n,",").concat(n,",").concat(n,")")}}}});cr.render=cn;var ur=cr,sr=n("fdc1"),dr=n.n(sr),lr=n("4623"),pr=n.n(lr),br=n("9233"),fr=n.n(br),mr=n("31f3"),Or=n.n(mr),vr=n("0622"),hr=n.n(vr),gr=n("99ba"),jr=n.n(gr),yr=n("fe82"),xr=n.n(yr),Ir=n("1fec"),Nr=n.n(Ir),wr=n("bc82"),Dr=n.n(wr),kr=n("334d"),Tr=n.n(kr),Er=n("10b7"),_r=n.n(Er),Cr={class:"p-fluid"},Rr={class:"p-field p-grid"},Sr={key:0,class:"p-col-12"},Pr=Object(r["m"])("div",{style:{height:"240px"}},null,-1),Ar={class:"p-col-9"},Mr={class:"p-col-1"},Br={class:"p-col-2"},Lr={class:"p-col-12"},Vr={class:"p-field p-grid"},Ur={class:"p-col-12 p-md-12"},Hr={class:"p-field p-grid"},zr={class:"p-col-2"},Gr={key:2},Jr={class:"p-field p-grid"},Wr={class:"p-fluid"},$r={class:"p-field p-grid"},qr=Object(r["m"])("div",{class:"p-col-12"},[Object(r["m"])("div",{style:{height:"60px"}})],-1),Yr={class:"p-col-12"},Fr=Object(r["m"])("img",{alt:"logo",src:dr.a,style:{width:"30px"}},null,-1),Xr=Object(r["m"])("img",{alt:"logo",src:pr.a,style:{width:"30px"}},null,-1),Zr=Object(r["m"])("img",{alt:"logo",src:fr.a,style:{width:"30px"}},null,-1),Kr=Object(r["m"])("img",{alt:"logo",src:Or.a,style:{width:"30px"}},null,-1),Qr={class:"p-fluid"},eo={class:"p-field p-grid"},to={key:0,class:"p-col-12"},no=Object(r["m"])("div",{style:{height:"60px"}},null,-1),ro=Object(r["m"])("div",{class:"p-col-12",style:{"margin-bottom":"2em"}},[Object(r["m"])("iframe",{width:"100%",src:"https://www.youtube.com/embed/DuiTlnrK6G4?si=HuVA4cs5U86H9E3l",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerpolicy:"strict-origin-when-cross-origin",allowfullscreen:""})],-1),oo=Object(r["m"])("img",{alt:"logo",src:hr.a,style:{width:"25px"}},null,-1),io=Object(r["m"])("img",{alt:"logo",src:jr.a,style:{width:"30px"}},null,-1),ao=Object(r["l"])(" Keep node content "),co=Object(r["m"])("b",null,"focused and simple but profound",-1),uo=Object(r["l"])(" (you can use "),so=Object(r["m"])("a",{target:"_blank",href:"https://markdown-it.github.io/"},"markdown",-1),lo=Object(r["l"])(" and "),po=Object(r["m"])("a",{target:"_blank",href:"https://katex.org/docs/supported.html"},"katex",-1),bo=Object(r["l"])(" "),fo=Object(r["m"])("img",{alt:"logo",src:xr.a,style:{width:"20px","margin-bottom":"-5px"}},null,-1),mo=Object(r["l"])(") "),Oo=Object(r["m"])("img",{alt:"logo",src:Nr.a,style:{width:"30px"}},null,-1),vo=Object(r["l"])(" Use "),ho=Object(r["m"])("b",null,'"based on"',-1),go=Object(r["l"])(" to link nodes that are necessary for solid understanding of your description "),jo=Object(r["m"])("img",{alt:"logo",src:Dr.a,style:{width:"30px"}},null,-1),yo=Object(r["m"])("img",{alt:"logo",src:Tr.a,style:{width:"30px"}},null,-1),xo=Object(r["m"])("img",{alt:"logo",src:_r.a,style:{width:"20px"}},null,-1),Io=Object(r["l"])(" Talk to your coauthors in "),No=Object(r["m"])("a",{target:"_blank",href:"https://discord.com/channels/1171118046543347782/1171118047587745953"},"chat",-1),wo=Object(r["l"])(" to adapt community rules and create a great content "),Do=Object(r["m"])("i",null,"One of the greatest impact one can do is to help millions of others to discover the truth!",-1);function ko(e,t,n,o,i,a){var c=Object(r["J"])("TitleImage"),u=Object(r["J"])("Title"),s=Object(r["J"])("SubscribeButton"),d=Object(r["J"])("PinButton"),l=Object(r["J"])("Markdown"),p=Object(r["J"])("TextArea"),b=Object(r["J"])("AddBasedOnButton"),f=Object(r["J"])("SectionPreconditions"),m=Object(r["J"])("SectionUsedBy"),O=Object(r["J"])("ChangeLog"),v=Object(r["K"])("tooltip");return e.show&&e.selectedNode?(Object(r["A"])(),Object(r["g"])("div",{key:0,class:"".concat(e.wrapperClass())},[Object(r["m"])("div",Cr,[e.isWideScreen()?(Object(r["A"])(),Object(r["g"])(c,{key:0,nodeID:e.selectedNodeContent?e.selectedNodeContent.nodeID:"",nodeContent:e.selectedNodeContent?e.selectedNodeContent.content:""},null,8,["nodeID","nodeContent"])):Object(r["h"])("",!0),Object(r["m"])("div",Rr,[e.isWideScreen()?(Object(r["A"])(),Object(r["g"])("div",Sr,[Pr])):Object(r["h"])("",!0),Object(r["m"])("div",Ar,[Object(r["m"])(u,{content:e.selectedNodeContent?e.selectedNode.title:"",onContentChanged:t[1]||(t[1]=function(t){return e.changeNodeTitle(t)})},null,8,["content"])]),Object(r["m"])("div",Mr,[Object(r["m"])(s,{nodeID:e.selectedNodeContent?e.selectedNodeContent.nodeID:""},null,8,["nodeID"])]),Object(r["m"])("div",Br,[Object(r["m"])(d)]),Object(r["m"])("div",Lr,[Object(r["m"])(l,{content:e.selectedNodeContent?e.selectedNodeContent.content:"",rows:20,onContentChanged:t[2]||(t[2]=function(t){return e.changeContent(t)})},null,8,["content"])])]),Object(r["m"])("div",Vr,[Object(r["m"])("div",Ur,[Object(r["m"])(p,{id:"comment",placeholder:"Your notes (visible only to you)",autoResize:!0,rows:"2",value:e.selectedNodeComment,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.changeComment(t)}),onKeydown:e.checkAuthorized},null,8,["value","onKeydown"])])]),Object(r["m"])("div",Hr,[Object(r["m"])("div",{class:"p-col-10 ".concat(e.$style.section," p-pt-2")}," based on ",2),Object(r["m"])("div",zr,[Object(r["m"])(b,{clickedTitleId:e.clickedTitleId,onSelectPreconditionIsOn:t[4]||(t[4]=function(t){return e.$emit("select-precondition-is-on")}),onSelectPreconditionIsOff:t[5]||(t[5]=function(t){return e.$emit("select-precondition-is-off")})},null,8,["clickedTitleId"])])]),e.selectedNodeContent?(Object(r["A"])(),Object(r["g"])(f,{key:1,"node-id":e.selectedNode.id},null,8,["node-id"])):Object(r["h"])("",!0),e.selectedNodeContent&&e.usedBy&&e.usedBy.length>0?(Object(r["A"])(),Object(r["g"])("div",Gr,[Object(r["m"])("div",Jr,[Object(r["m"])("div",{class:"p-col-12 ".concat(e.$style.section," p-pt-5")}," basis for ",2)]),Object(r["m"])(m,{nodeIDs:e.usedBy},null,8,["nodeIDs"])])):Object(r["h"])("",!0),Object(r["m"])(O,{"node-id":e.selectedNode.id},null,8,["node-id"])])],2)):e.editModeOn?(Object(r["A"])(),Object(r["g"])("div",{key:1,class:"".concat(e.wrapperClass())},[Object(r["m"])("div",Wr,[Object(r["m"])("div",$r,[qr,Object(r["m"])("div",Yr,[Object(r["m"])("div",{class:e.$style.title}," Map edit mode is on ",2)]),Object(r["m"])("div",{class:"p-col-12 ".concat(e.$style.list)},' In this mode you can change map structure but cannot edit contents of individual nodes. To return back to content editing push "edit map" button again. ',2),Object(r["m"])("div",{class:"p-col-1 ".concat(e.$style.icon)},[Fr],2),Object(r["m"])("div",{class:"p-col-11 ".concat(e.$style.list)},' To add new node 1) select parent node on map and then 2) click "add" button in upper menu. ',2),Object(r["m"])("div",{class:"p-col-1 ".concat(e.$style.icon)},[Xr],2),Object(r["m"])("div",{class:"p-col-11 ".concat(e.$style.list)},' To remove node 1) select it on map and 2) click "delete" button in upper menu. ',2),Object(r["m"])("div",{class:"p-col-1 ".concat(e.$style.icon)},[Zr],2),Object(r["m"])("div",{class:"p-col-11 ".concat(e.$style.list)},' To move node 1) select it on map, then 2) press "cut" button, then 3) select its new parent and 4) press "paste" button. ',2),Object(r["m"])("div",{class:"p-col-1 ".concat(e.$style.icon)},[Kr],2),Object(r["m"])("div",{class:"p-col-11 ".concat(e.$style.list)},' You can use "log" to see log of map edits and revert or complain any unfortunate edit. ',2),Object(r["m"])("div",{class:"p-col-12 ".concat(e.$style.list)}," After add, paste or remove you can drag node title and its neighbours to adjust node centers position. ",2)])])],2)):(Object(r["A"])(),Object(r["g"])("div",{key:2,class:"".concat(e.wrapperClass())},[Object(r["m"])("div",Qr,[Object(r["m"])("div",eo,[e.isWideScreen()?(Object(r["A"])(),Object(r["g"])("div",to,[no])):Object(r["h"])("",!0),ro,Object(r["m"])("div",{class:"p-col-2 ".concat(e.$style.icon)},[oo],2),Object(r["m"])("div",{class:"p-col-10 ".concat(e.$style.list)}," Sign in to edit map ",2),Object(r["m"])("div",{class:"p-col-2 ".concat(e.$style.list)},[io],2),Object(r["W"])(Object(r["m"])("div",{class:"p-col-10 ".concat(e.$style.list)},[ao,co,uo,so,lo,po,bo,fo,mo],2),[[v,{escape:!1,autoHide:!1,pt:{root:{style:{"max-width":"fit-content"}},arrow:{style:{borderRightColor:"#dcdcde",borderBottomColor:"rgb(255 255 255 / 0)",borderTopColor:"rgb(255 255 255 / 0)"}},text:{style:{"background-color":"#dcdcde",color:"black"}}},value:"\n<div style='padding-left: 20px; width:370px;height:550px;'>\n  Use <a target='_blank' href='https://markdown-it.github.io/'>markdown</a> to format text\n  and <a target='_blank' href='https://katex.org/docs/supported.html'>katex</a> notation to write formulas.\n For example write\n <textarea rows='3' cols='40'>$$\n\\sum_{\\mathclap{1\\le i\\le j\\le n}} x_{ij}\n$$</textarea>\n  to render formula:\n  ".concat(e.md.render("$$\n\\sum_{\\mathclap{1\\le i\\le j\\le n}} x_{ij}\n$$"),"\n  <div style='margin-top: -4em;'>\n  Or write\n   <textarea rows='3' cols='40'>![](https://cdn.scimap.org/images/default.jpg =340x)</textarea>\n   to insert image:\n   ").concat(e.md.render("![](https://cdn.scimap.org/images/default.jpg =340x)"),"\n   </div>\n</div>")}]]),Object(r["m"])("div",{class:"p-col-2 ".concat(e.$style.icon)},[Oo],2),Object(r["m"])("div",{class:"p-col-10 ".concat(e.$style.list)},[vo,ho,go],2),Object(r["m"])("div",{class:"p-col-2 ".concat(e.$style.icon),style:{color:"#3B6BF9","padding-left":"10px","font-weight":"bold","font-size":"1.5em"}}," W ",2),Object(r["m"])("div",{class:"p-col-10 ".concat(e.$style.list)}," Use Wikipedia core content policies: neutral point of view, verifiability, and no original research ",2),Object(r["m"])("div",{class:"p-col-2 ".concat(e.$style.icon)},[jo],2),Object(r["m"])("div",{class:"p-col-10 ".concat(e.$style.list)}," Pin nodes that you are currently interested in ",2),Object(r["m"])("div",{class:"p-col-2 ".concat(e.$style.icon)},[yo],2),Object(r["m"])("div",{class:"p-col-10 ".concat(e.$style.list)}," Subscribe to node changes to receive updates on email ",2),Object(r["m"])("div",{class:"p-col-2 ".concat(e.$style.icon),style:{color:"#3B6BF9"}}," [ORG] ",2),Object(r["m"])("div",{class:"p-col-10 ".concat(e.$style.list)}," If you know actions one can take to push knowledge further (jobs, crowdsourcing, etc.) - you can also add it! ",2),Object(r["m"])("div",{class:"p-col-2 ".concat(e.$style.icon)},[xo],2),Object(r["m"])("div",{class:"p-col-10 ".concat(e.$style.list)},[Io,No,wo],2),Object(r["m"])("div",{class:"p-col-12 ".concat(e.$style.list)},[Do],2)])])],2))}var To=n("4c62"),Eo={class:"p-col-10 p-pl-md-2"},_o={class:"p-col-2 p-p-md-0"};function Co(e,t,n,o,i,a){var c=Object(r["J"])("Link"),u=Object(r["J"])("RemoveIcon");return Object(r["A"])(!0),Object(r["g"])(r["a"],null,Object(r["H"])(e.preconditions,(function(t){return Object(r["A"])(),Object(r["g"])("div",{class:"p-grid ".concat(e.$style.precondition," p-p-md-0"),key:t.id},[Object(r["m"])("div",Eo,[Object(r["m"])("p",{class:"".concat(e.$style.preconditionPath)},Object(r["N"])(e.preconditionPaths[t.id]),3),Object(r["m"])("p",{class:"".concat(e.$style.title)},[Object(r["m"])(c,{nodeID:t.id,nodeTitle:t.title},null,8,["nodeID","nodeTitle"])],2)]),Object(r["m"])("div",_o,[Object(r["m"])(u,{onClick:function(n){return e.remove(t.id)}},null,8,["onClick"])])],2)})),128)}var Ro=n("67c1"),So=n.n(Ro),Po=Object(r["Y"])("data-v-154fe046");Object(r["D"])("data-v-154fe046");var Ao={key:0,class:"custom"},Mo=Object(r["m"])("img",{style:{height:"35px"},alt:"pin-off",src:So.a},null,-1),Bo={key:1,class:"custom"},Lo=Object(r["m"])("img",{style:{height:"35px"},alt:"pin-on",src:pr.a},null,-1);Object(r["B"])();var Vo=Po((function(e,t,n,o,i,a){return Object(r["A"])(),Object(r["g"])("div",{style:{cursor:"pointer"},onMouseenter:t[1]||(t[1]=function(e){return o.mouseOver=!0}),onMouseleave:t[2]||(t[2]=function(e){return o.mouseOver=!1})},[o.mouseOver?(Object(r["A"])(),Object(r["g"])("div",Ao,[Mo])):(Object(r["A"])(),Object(r["g"])("div",Bo,[Lo]))],32)})),Uo={name:"RemoveIcon",setup:function(){var e=Object(r["G"])(!1);return{mouseOver:e}}};n("46b4");Uo.render=Vo,Uo.__scopeId="data-v-154fe046";var Ho=Uo,zo=n("d725");function Go(e,t,n,o,i,a){return Object(r["A"])(),Object(r["g"])("a",{href:"#",onClick:t[1]||(t[1]=function(t){return e.goto(t,e.nodeID)})},Object(r["N"])(e.nodeTitle),1)}var Jo=Object(r["n"])({name:"Link",props:{nodeID:{type:String,required:!0},nodeTitle:{type:String,required:!0}},setup:function(){var e=Gt(),t=Object(Ft["e"])(),n=e.state.tree;return{goto:function(r,o){r.preventDefault();var i=te(o,n.mapNodeLayers),a=Object(d["a"])(i,1),c=a[0];null!=c&&(t.push({name:"node",params:{id:o}}),e.commit("zoomPan/".concat(wt.RESET_ZOOM_AND_PAN)),e.commit("zoomPan/".concat(wt.SET_PAN),{x:-c.center.x+n.mapNodeLayers[0]["0"].center.x,y:-c.center.y+n.mapNodeLayers[0]["0"].center.y}))}}}});Jo.render=Go;var Wo=Jo,$o=Object(r["n"])({name:"Preconditions",props:{nodeId:{type:String,required:!0}},components:{Link:Wo,RemoveIcon:Ho},setup:function(e){var t=Gt(),n=Object(zo["b"])(),o=Object(r["G"])([]),i=Object(r["G"])({});return Object(r["U"])((function(){if(o.value=[],i.value={},e.nodeId&&t.state.precondition.preconditions[e.nodeId]){var n,r=Object(p["a"])(t.state.precondition.preconditions[e.nodeId]);try{for(r.s();!(n=r.n()).done;){var a=n.value;o.value.push(t.state.tree.nodeRecord[a].node),i.value[a]=Wn(a,t.state.tree.nodeRecord)}}catch(c){r.e(c)}finally{r.f()}}})),{preconditions:o,preconditionPaths:i,remove:function(){var r=Object(u["a"])(regeneratorRuntime.mark((function r(o){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.state.user&&t.state.user.user&&!t.state.user.user.isAnonymous){r.next=4;break}return r.next=3,t.dispatch("".concat(Lt.confirmSignInPopup),{confirm:n,message:"Please authorize to added node prerequisites"});case 3:return r.abrupt("return");case 4:t.commit("precondition/".concat(j.REMOVE_PRECONDITION),{nodeID:e.nodeId,preconditionID:o}),S.savePreconditions(t.state.user.user,{nodeId:e.nodeId,preconditionIds:t.state.precondition.preconditions[e.nodeId]});case 6:case"end":return r.stop()}}),r)})));function o(e){return r.apply(this,arguments)}return o}()}}}),qo=n("533a");const Yo=$o.__cssModules={};Yo["$style"]=qo["default"],$o.render=Co;var Fo=$o,Xo={class:"p-col-12"};function Zo(e,t,n,o,i,a){var c=Object(r["J"])("Link");return Object(r["A"])(!0),Object(r["g"])(r["a"],null,Object(r["H"])(e.usedBy,(function(t){return Object(r["A"])(),Object(r["g"])("div",{class:"p-grid ".concat(e.$style.precondition," p-p-md-0"),key:t.id},[Object(r["m"])("div",Xo,[Object(r["m"])("p",{class:"".concat(e.$style.preconditionPath)},Object(r["N"])(e.usedByPaths[t.id]),3),Object(r["m"])("p",{class:"".concat(e.$style.title)},[Object(r["m"])(c,{nodeID:t.id,nodeTitle:t.title},null,8,["nodeID","nodeTitle"])],2)])],2)})),128)}var Ko=Object(r["n"])({name:"UsedBy",components:{Link:Wo},props:{nodeIDs:Object},setup:function(e){var t=Gt(),n=Object(r["G"])([]),o=Object(r["G"])({});return Object(r["U"])((function(){if(n.value=[],o.value={},e.nodeIDs){var r,i=Object(p["a"])(e.nodeIDs);try{for(i.s();!(r=i.n()).done;){var a=r.value;t.state.tree.nodeRecord[a]?(n.value.push(t.state.tree.nodeRecord[a].node),o.value[a]=Wn(a,t.state.tree.nodeRecord)):console.log("UsedBy: cannot find id in nodeRecord",a)}}catch(c){i.e(c)}finally{i.f()}}})),{usedBy:n,usedByPaths:o}}}),Qo=n("187b");const ei=Ko.__cssModules={};ei["$style"]=Qo["default"],Ko.render=Zo;var ti=Ko,ni=Object(r["Y"])("data-v-22c74c27"),ri=ni((function(e,t,n,o,i,a){return Object(r["A"])(),Object(r["g"])(r["a"],null,[o.isAuthorized?Object(r["W"])((Object(r["A"])(),Object(r["g"])("p",{key:0,innerHTML:o.renderedContent,onClick:t[1]||(t[1]=function(e){return o.setEditOn(!0)}),class:"renderedContent"},null,8,["innerHTML"])),[[r["S"],!o.editOn]]):(Object(r["A"])(),Object(r["g"])("p",{key:1,innerHTML:o.renderedContent,class:"renderedContent"},null,8,["innerHTML"])),Object(r["m"])("textarea",{class:"rawContent p-inputtextarea p-inputtext p-component p-inputtextarea-resizable",style:{display:"none"},ref:"txtarea",rows:n.rows,value:n.content,onInput:t[2]||(t[2]=function(e){return o.changeContent(e.target.value)}),onFocusout:t[3]||(t[3]=function(e){return o.setEditOn(!1)})},null,40,["rows","value"])],64)})),oi=(n("466d"),n("498a"),n("d4cd")),ii=n.n(oi),ai=n("a68e"),ci=n("8102"),ui=n("746a"),si=new ii.a;si.use(ai,{output:"html"}).use(ci).use(ui,"warning",{validate:function(e){return console.log("validate",e.trim(),"warning"==e.trim()),e.trim().match(/^warning$/)},render:function(e,t){var n=e[t].info.trim().match(/^warning(.*)$/);return 1===e[t].nesting?'<div style="background-color: #c6f68d; padding: 8px;">'+si.utils.escapeHtml(n[1])+"\n":"</div>\n"}});var di={name:"Markdown",emits:["content-changed"],props:{content:{type:String,required:!0},rows:{type:Number,required:!0}},setup:function(e,t){var n=Gt(),o=Object(r["e"])((function(){return si.render(e.content)})),i=Object(r["G"])(!1),a=Object(r["G"])(null);return{isAuthorized:Object(r["e"])((function(){return n.state.user&&n.state.user.user&&!n.state.user.user.isAnonymous})),editOn:i,txtarea:a,setEditOn:function(e){i.value=e,e&&a.value&&(a.value.style.display="block",a.value.focus()),!e&&a.value&&(a.value.style.display="none")},renderedContent:o,changeContent:function(e){t.emit("content-changed",e)}}}};n("175a");di.render=ri,di.__scopeId="data-v-22c74c27";var li=di,pi={key:0},bi={key:1,class:"m-0"};function fi(e,t,n,o,i,a){var c=Object(r["J"])("ChangeLogComplain"),u=Object(r["J"])("Markdown"),s=Object(r["J"])("Card"),d=Object(r["J"])("Fieldset");return Object(r["A"])(),Object(r["g"])(r["a"],null,[Object(r["m"])(c,{show:e.complainModalVisible,complainChangeLink:e.complainChangeLink,onHide:t[1]||(t[1]=function(t){return e.complainModalVisible=!1})},null,8,["show","complainChangeLink"]),Object(r["m"])(d,{legend:"change log",toggleable:!0,collapsed:e.collapsed,"onUpdate:collapsed":t[2]||(t[2]=function(t){return e.toggle(t)}),pt:{legend:{class:"bg-primary"}}},{default:Object(r["V"])((function(){return[e.isAuthorized?(Object(r["A"])(),Object(r["g"])("div",bi,[(Object(r["A"])(!0),Object(r["g"])(r["a"],null,Object(r["H"])(e.changes,(function(t,n){return Object(r["A"])(),Object(r["g"])(s,{key:n,class:"mt-3"},Object(r["k"])({title:Object(r["V"])((function(){return[Object(r["l"])(Object(r["N"])(new Date(t.timestamp).toLocaleDateString())+" "+Object(r["N"])(new Date(t.timestamp).toLocaleTimeString())+" / "+Object(r["N"])(t.action)+" change ",1)]})),subtitle:Object(r["V"])((function(){return[Object(r["l"])(Object(r["N"])(t.userDisplayName?t.userDisplayName:"user id ".concat(t.userID))+" / ",1),Object(r["m"])("a",{href:"#",onClick:function(n){return e.showComplain(t.changeLogID)}},"Complain",8,["onClick"])]})),_:2},[t.action==e.ActionType.Name?{name:"content",fn:Object(r["V"])((function(){return[Object(r["l"])(Object(r["N"])(t.newName),1)]}))}:t.action==e.ActionType.Content?{name:"content",fn:Object(r["V"])((function(){return[Object(r["m"])(u,{content:t.newContent,rows:10},null,8,["content"])]}))}:t.action==e.ActionType.Precondition?{name:"content",fn:Object(r["V"])((function(){return[Object(r["m"])("div",{innerHTML:e.getContent(t)},null,8,["innerHTML"])]}))}:void 0]),1024)})),128))])):(Object(r["A"])(),Object(r["g"])("div",pi," Sign in to see node change log "))]})),_:1},8,["collapsed"])],64)}var mi,Oi=n("743f"),vi=n("9899");n("2ca0");function hi(e,t,n){return gi.apply(this,arguments)}function gi(){return gi=Object(u["a"])(regeneratorRuntime.mark((function e(t,n,r){var o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=[],n.length&&o.push(Object(E["i"])("node_id","in",n)),t.length&&o.push(Object(E["i"])("action","in",t)),o.push(Object(E["i"])("user_id","!=","function")),i=Object(E["h"])(Object(E["b"])(Object(E["e"])(),"changes"),E["a"].apply(void 0,o),Object(E["g"])("timestamp","desc")),e.abrupt("return",Object(E["f"])(i,(function(e){var t=[];e.forEach((function(e){t.push({changeLogID:e.id,nodeID:e.get("node_id"),userID:e.get("user_id"),timestamp:e.get("timestamp"),action:e.get("action"),attributes:{value:e.get("attributes.value"),valueBefore:e.get("attributes.valueBefore"),valueAfter:e.get("attributes.valueAfter"),added:e.get("attributes.added"),removed:e.get("attributes.removed"),parentNodeID:e.get("attributes.parentNodeID")}})})),r(t)})));case 6:case"end":return e.stop()}}),e)}))),gi.apply(this,arguments)}function ji(e){return yi.apply(this,arguments)}function yi(){return yi=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={},e.next=3,O["a"].database().ref("map/".concat(t,"/name")).get();case 3:if(r=e.sent,!r.exists()){e.next=8;break}n["map/".concat(t)]=r.val(),e.next=12;break;case 8:return e.next=10,O["a"].database().ref("trash/".concat(t,"/map/name")).get();case 10:o=e.sent,o.exists()&&(n["trash/".concat(t)]=o.val());case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e)}))),yi.apply(this,arguments)}function xi(e){return Ii.apply(this,arguments)}function Ii(){return Ii=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={},e.next=3,O["a"].database().ref("public_user_data/".concat(t,"/displayName")).get();case 3:return r=e.sent,r.exists()&&(n["".concat(t)]=r.val()),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)}))),Ii.apply(this,arguments)}function Ni(e){return wi.apply(this,arguments)}function wi(){return wi=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,r,o,i,a,c,u,s,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=[],r=Object(p["a"])(t);try{for(r.s();!(o=r.n()).done;)i=o.value,n.push(xi(i))}catch(l){r.e(l)}finally{r.f()}return e.next=5,Promise.all(n);case 5:a=e.sent,c={},u=Object(p["a"])(a);try{for(u.s();!(s=u.n()).done;)d=s.value,c[Object.keys(d)[0]]=Object.values(d)[0]}catch(l){u.e(l)}finally{u.f()}return e.abrupt("return",c);case 10:case"end":return e.stop()}}),e)}))),wi.apply(this,arguments)}function Di(e){return ki.apply(this,arguments)}function ki(){return ki=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,r,o,i,a,c,u,s,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=[],r=Object(p["a"])(t);try{for(r.s();!(o=r.n()).done;)i=o.value,n.push(ji(i))}catch(l){r.e(l)}finally{r.f()}return e.next=5,Promise.all(n);case 5:a=e.sent,c={},u=Object(p["a"])(a);try{for(u.s();!(s=u.n()).done;)d=s.value,c[Object.keys(d)[0]]=Object.values(d)[0]}catch(l){u.e(l)}finally{u.f()}return e.abrupt("return",c);case 10:case"end":return e.stop()}}),e)}))),ki.apply(this,arguments)}function Ti(e,t){if(null==e)return"";var n="";return null!=t["map/".concat(e)]?n="map/".concat(e):null!=t["trash/".concat(e)]&&(n="trash/".concat(e)),n}function Ei(e,t,n){return _i.apply(this,arguments)}function _i(){return _i=Object(u["a"])(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",hi(t,n,(function(e){var t,n={},o={},i=Object(p["a"])(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(n[a.userID]="",o[a.nodeID]="",a.action==mi.ParentID&&(null!=a.attributes.valueBefore&&(o[a.attributes.valueBefore]=""),null!=a.attributes.valueAfter&&(o[a.attributes.valueAfter]="")),a.action==mi.Restore&&null!=a.attributes.parentNodeID&&(o[a.attributes.parentNodeID]=""),a.action==mi.Precondition){if(null!=a.attributes.removed){var c,u=Object(p["a"])(a.attributes.removed);try{for(u.s();!(c=u.n()).done;){var s=c.value;o[s]=""}}catch(h){u.e(h)}finally{u.f()}}if(null!=a.attributes.added){var d,l=Object(p["a"])(a.attributes.added);try{for(l.s();!(d=l.n()).done;){var b=d.value;o[b]=""}}catch(h){l.e(h)}finally{l.f()}}}}}catch(h){i.e(h)}finally{i.f()}var f=[];for(var m in o)f.push(m);var O=[];for(var v in n)O.push(v);Promise.all([Di(f),Ni(O)]).then((function(t){var n=t[0],o=t[1],i=[];e.forEach((function(e){var t=Ti(e.nodeID,n);if(e.action==mi.Name)i.push({changeLogID:e.changeLogID,timestamp:e.timestamp,action:e.action,userID:e.userID,userDisplayName:o[e.userID],node:{id:e.nodeID,idPath:t,name:n[t]},newName:e.attributes.value});else if(e.action==mi.Content)i.push({changeLogID:e.changeLogID,timestamp:e.timestamp,action:e.action,userID:e.userID,userDisplayName:o[e.userID],node:{id:e.nodeID,idPath:t,name:n[t]},newContent:e.attributes.value});else if(e.action==mi.Precondition){var r=[];if(e.attributes.removed){var a,c=Object(p["a"])(e.attributes.removed);try{for(c.s();!(a=c.n()).done;){var u=a.value;r.push({id:u,idPath:Ti(u,n),name:n[Ti(u,n)]})}}catch(h){c.e(h)}finally{c.f()}}var s=[];if(e.attributes.added){var d,l=Object(p["a"])(e.attributes.added);try{for(l.s();!(d=l.n()).done;){var b=d.value;s.push({id:b,idPath:Ti(b,n),name:n[Ti(b,n)]})}}catch(h){l.e(h)}finally{l.f()}}i.push({changeLogID:e.changeLogID,timestamp:e.timestamp,action:e.action,userID:e.userID,userDisplayName:o[e.userID],node:{id:e.nodeID,idPath:t,name:n[t]},removed:r,added:s})}else if(e.action==mi.ParentID&&null!==e.attributes.valueAfter){var f=Ti(e.attributes.valueBefore,n),m=Ti(e.attributes.valueAfter,n);i.push({changeLogID:e.changeLogID,timestamp:e.timestamp,action:e.action,userID:e.userID,userDisplayName:o[e.userID],node:{id:e.nodeID,idPath:t,name:n[t]},parentNodeBefore:{id:e.attributes.valueBefore,idPath:f,name:n[f]},parentNodeAfter:{id:e.attributes.valueAfter,idPath:m,name:n[m]},isRemoved:!1,isAdded:null==e.attributes.valueBefore})}else if(e.action==mi.Remove){var O=Ti(e.attributes.parentNodeID,n);i.push({changeLogID:e.changeLogID,timestamp:e.timestamp,action:e.action,userID:e.userID,userDisplayName:o[e.userID],node:{id:e.nodeID,idPath:t,name:n[t]},parentNodeBefore:{id:e.attributes.parentNodeID,idPath:O,name:n[O]},parentNodeAfter:null,isRemoved:!0,isAdded:!1})}else if(e.action==mi.Restore){var v=Ti(e.attributes.parentNodeID,n);i.push({changeLogID:e.changeLogID,timestamp:e.timestamp,action:e.action,userID:e.userID,userDisplayName:o[e.userID],node:{id:e.nodeID,idPath:t,name:n[t]},parentNodeBefore:null,parentNodeAfter:{id:e.attributes.parentNodeID,idPath:v,name:n[v]},isRemoved:!1,isAdded:!0})}})),r(i)}))})));case 1:case"end":return e.stop()}}),e)}))),_i.apply(this,arguments)}function Ci(e){return e.startsWith("trash")}function Ri(e,t,n){return Ci(e)?'<a target="_blank" href="/node_description/'.concat(t,'">').concat(n,"</a>"):'<a target="_blank" href="/'.concat(t,'">').concat(n,"</a>")}(function(e){e["Name"]="name",e["ParentID"]="parentID",e["Content"]="content",e["Precondition"]="precondition",e["Remove"]="remove",e["Restore"]="restore"})(mi||(mi={}));var Si=Object(r["m"])("h3",null,Object(r["N"])("Please use our discord channel to complain about inappropriate changes"),-1),Pi=Object(r["m"])("h3",null,[Object(r["m"])("a",{target:"_blank",href:"https://discord.com/channels/1171118046543347782/1196694554791915600"},"Discord edit-complains channel")],-1),Ai=Object(r["m"])("p",null," You can use the following text: ",-1),Mi=Object(r["l"])(" Hi, I think I found changes that was inappropriate because ... "),Bi=Object(r["m"])("br",null,null,-1),Li=Object(r["m"])("br",null,null,-1),Vi=Object(r["l"])(" This is the ...st time I found inappropriate changes from this user. "),Ui=Object(r["m"])("br",null,null,-1);function Hi(e,t,n,o,i,a){var c=Object(r["J"])("Dialog");return Object(r["A"])(),Object(r["g"])(c,{visible:e.complainModalVisible,"onUpdate:visible":t[1]||(t[1]=function(t){return e.complainModalVisible=t}),onHide:t[2]||(t[2]=function(t){return e.$emit("hide")}),dismissableMask:!0,closable:!0,modal:!0,closeOnEscape:!0},{header:Object(r["V"])((function(){return[Si]})),footer:Object(r["V"])((function(){return[]})),default:Object(r["V"])((function(){return[Pi,Ai,Object(r["m"])("code",null,[Mi,Bi,Object(r["l"])(" Here is the changes I am talking about "+Object(r["N"])(e.complainChangeLink)+" ",1),Li,Vi,Ui])]})),_:1},8,["visible"])}var zi=n("5bd2"),Gi=Object(r["n"])({name:"ChangeLogComplain",props:{show:Boolean,complainChangeLink:String},components:{Dialog:zi["a"]},emits:["hide"],setup:function(e){var t=Object(r["G"])(!1);return Object(r["T"])((function(){return[e.show]}),function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(n,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.value=n[0];case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),{complainModalVisible:t}}});Gi.render=Hi;var Ji=Gi,Wi=Object(r["n"])({name:"ChangeLog",computed:{ActionType:function(){return mi}},props:{nodeId:{type:String,required:!0}},components:{Markdown:li,ChangeLogComplain:Ji,Fieldset:Oi["a"],Card:vi["a"]},setup:function(e){var t=Gt(),n=Object(r["e"])((function(){return t.state.user.user&&!t.state.user.user.isAnonymous})),o=Object(r["G"])(""),i=Object(r["G"])(!1),a=Object(r["G"])(!0),c=Object(r["E"])([]),s=function(){};return Object(r["T"])((function(){return[e.nodeId,a.value]}),function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(n,r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n[0]!=r[0]&&(a.value=!0),s(),s=function(){},0!=a.value){t.next=7;break}return t.next=6,Ei([mi.Name,mi.Content,mi.Precondition],[e.nodeId],(function(e){c.splice.apply(c,[0,c.length].concat(Object(G["a"])(e)))}));case 6:s=t.sent;case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),{changes:c,collapsed:a,toggle:function(e){a.value=e},showComplain:function(e){i.value=!0,o.value="https://scimap.org/change/"+e},getContent:function(e){e=e;var t,n=[],r=Object(p["a"])(e.removed);try{for(r.s();!(t=r.n()).done;){var o=t.value;n.push(Ri(o.idPath,o.id,o.name))}}catch(d){r.e(d)}finally{r.f()}var i,a=[],c=Object(p["a"])(e.added);try{for(c.s();!(i=c.n()).done;){var u=i.value;a.push(Ri(u.idPath,u.id,u.name))}}catch(d){c.e(d)}finally{c.f()}var s="";return n.length>0&&(s+="removed: ".concat(n.join(", "))),a.length>0&&(s+="<br> added: ".concat(a.join(", "))),s},complainModalVisible:i,complainChangeLink:o,isAuthorized:n}}});Wi.render=fi;var $i=Wi,qi=Object(r["m"])("h3",null,Object(r["N"])("Choose parent from which pin will be visible"),-1);function Yi(e,t,n,o,i,a){var c=Object(r["J"])("PinIcon"),u=Object(r["J"])("Listbox"),s=Object(r["J"])("Button"),d=Object(r["J"])("Dialog");return Object(r["A"])(),Object(r["g"])(r["a"],null,[Object(r["m"])(c,{onClick:o.clickPin},null,8,["onClick"]),Object(r["m"])(d,{visible:o.addDialogVisible,"onUpdate:visible":t[2]||(t[2]=function(e){return o.addDialogVisible=e}),dismissableMask:!0,closable:!0,modal:!0,closeOnEscape:!0},{header:Object(r["V"])((function(){return[qi]})),footer:Object(r["V"])((function(){return[Object(r["m"])(s,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:o.cancelAdd},null,8,["onClick"]),Object(r["m"])(s,{label:"Yes",icon:"pi pi-check",onClick:o.add},null,8,["onClick"])]})),default:Object(r["V"])((function(){return[Object(r["m"])(u,{modelValue:o.selectedParent,"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.selectedParent=e}),options:o.parents,optionLabel:"title"},null,8,["modelValue","options"])]})),_:1},8,["visible"])],64)}var Fi=n("bb57"),Xi=n("dc4a"),Zi=n("b969"),Ki=n.n(Zi),Qi=Object(r["Y"])("data-v-4ed46db5");Object(r["D"])("data-v-4ed46db5");var ea={key:0,class:"pin"},ta=Object(r["m"])("img",{style:{height:"35px"},alt:"pin-off",src:Dr.a},null,-1),na={key:1,class:"pin"},ra=Object(r["m"])("img",{style:{height:"35px"},alt:"pin-on",src:Ki.a},null,-1);Object(r["B"])();var oa=Qi((function(e,t,n,o,i,a){return Object(r["A"])(),Object(r["g"])("div",{style:{cursor:"pointer"},onMouseenter:t[1]||(t[1]=function(e){return o.mouseOver=!0}),onMouseleave:t[2]||(t[2]=function(e){return o.mouseOver=!1})},[o.isPinned||o.mouseOver?(Object(r["A"])(),Object(r["g"])("div",ea,[ta])):(Object(r["A"])(),Object(r["g"])("div",na,[ra]))],32)})),ia={name:"PinIcon",setup:function(){var e=Gt(),t=Object(r["G"])(!1);return Object(r["T"])((function(){return e.state.tree.selectedNodeId}),Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.value=!1;case 1:case"end":return e.stop()}}),e)})))),{isPinned:Object(r["e"])((function(){return void 0!==e.state.pin.pins[e.state.tree.selectedNodeId]})),mouseOver:t}}};n("229a");ia.render=oa,ia.__scopeId="data-v-4ed46db5";var aa=ia,ca={name:"PinButton",components:{PinIcon:aa,Dialog:zi["a"],Button:Fi["a"],Listbox:Xi["a"]},setup:function(){var e=Gt(),t=Object(zo["b"])(),n=e.state.tree,o=Object(r["G"])(!1),i=Object(r["G"])(!1),a=Object(r["e"])((function(){return e.getters["tree/selectedNode"]})),c=Object(r["G"])(""),s=Object(r["e"])((function(){var e=[],t=n.nodeRecord[n.selectedNodeId].parent;while(n.nodeRecord[t.id].parent)e.push({title:t.title,id:t.id}),t=n.nodeRecord[t.id].parent;return e.push({title:"root",id:0}),e}));return{clickPin:function(){var n=Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.state.user&&e.state.user.user&&!e.state.user.user.isAnonymous){n.next=4;break}return n.next=3,e.dispatch("".concat(Lt.confirmSignInPopup),{confirm:t,message:"Please authorize to pin nodes"});case 3:return n.abrupt("return");case 4:void 0!==e.state.pin.pins[e.state.tree.selectedNodeId]?(e.dispatch("pin/".concat(f.RemovePin),e.state.tree.selectedNodeId),S.savePins(e.state.user.user,e.state.pin.pins)):o.value=!o.value;case 5:case"end":return n.stop()}}),n)})));function r(){return n.apply(this,arguments)}return r}(),selectedParent:i,parents:s,add:function(){o.value=!1,e.dispatch("pin/".concat(f.AddPin),{parentId:i.value.id,nodeId:a.value.id}),S.savePins(e.state.user.user,e.state.pin.pins),i.value=null},cancelAdd:function(){o.value=!1},addDialogVisible:o,newNodeTitle:c}}};ca.render=Yi;var ua=ca;function sa(e,t,n,o,i,a){var c=Object(r["J"])("SubscribeIcon");return Object(r["A"])(),Object(r["g"])(c,{onClick:e.toggleSubscribe,"is-on":e.isOn},null,8,["onClick","is-on"])}var da=n("ce14"),la=n.n(da),pa=Object(r["Y"])("data-v-5d02b387");Object(r["D"])("data-v-5d02b387");var ba={key:0,class:"subscribe"},fa=Object(r["m"])("img",{style:{height:"35px"},alt:"img",src:Tr.a},null,-1),ma={key:1,class:"subscribe"},Oa=Object(r["m"])("img",{style:{height:"35px"},alt:"img",src:la.a},null,-1);Object(r["B"])();var va=pa((function(e,t,n,o,i,a){return Object(r["A"])(),Object(r["g"])("div",{style:{cursor:"pointer"},onMouseenter:t[1]||(t[1]=function(e){return o.mouseOver=!0}),onMouseleave:t[2]||(t[2]=function(e){return o.mouseOver=!1})},[n.isOn||o.mouseOver?(Object(r["A"])(),Object(r["g"])("div",ba,[fa])):(Object(r["A"])(),Object(r["g"])("div",ma,[Oa]))],32)})),ha={name:"SubscribeIcon",props:{isOn:Boolean},setup:function(){var e=Object(r["G"])(!1);return{mouseOver:e}}};n("6951");ha.render=va,ha.__scopeId="data-v-5d02b387";var ga=ha,ja=Object(r["n"])({name:"SubscribeButton",components:{SubscribeIcon:ga},props:{nodeID:{type:String,required:!0}},setup:function(e){var t=Gt();return{isOn:Object(r["e"])((function(){return!!t.state.subscriptions.subscriptions[e.nodeID]&&1==t.state.subscriptions.subscriptions[e.nodeID]})),toggleSubscribe:function(){t.dispatch("subscriptions/".concat(A.ToggleSubscription),e.nodeID)}}}});ja.render=sa;var ya=ja,xa=Object(r["Y"])("data-v-00857be5"),Ia=xa((function(e,t,n,o,i,a){return Object(r["A"])(),Object(r["g"])(r["a"],null,[Object(r["W"])(Object(r["m"])("p",{innerHTML:o.renderedContent,onClick:t[1]||(t[1]=function(e){return o.setEditOn(!0)}),class:"title"},null,8,["innerHTML"]),[[r["S"],!o.editOn]]),Object(r["m"])("textarea",{class:"title rawTitle p-inputtextarea p-inputtext p-component p-inputtextarea-resizable",style:{display:"none"},ref:"txtarea",rows:"1",value:n.content,onInput:t[2]||(t[2]=function(e){return o.changeContent(e.target.value)}),onFocusout:t[3]||(t[3]=function(e){return o.setEditOn(!1)})},null,40,["value"])],64)})),Na={name:"Title",emits:["content-changed"],props:{content:{type:String,required:!0}},setup:function(e,t){var n=Object(r["e"])((function(){return e.content})),o=Object(r["G"])(!1),i=Gt(),a=Object(r["G"])(null);return{editOn:o,txtarea:a,setEditOn:function(e){i.state.user&&i.state.user.user&&!i.state.user.user.isAnonymous&&(o.value=e,e&&a.value&&(a.value.style.display="block",a.value.focus()),!e&&a.value&&(a.value.style.display="none"))},renderedContent:n,changeContent:function(e){t.emit("content-changed",e)}}}};n("0c69");Na.render=Ia,Na.__scopeId="data-v-00857be5";var wa=Na;function Da(e,t,n,o,i,a){var c=Object(r["J"])("AddBasedOnIcon"),u=Object(r["J"])("Button"),s=Object(r["J"])("Dialog");return Object(r["A"])(),Object(r["g"])(r["a"],null,[Object(r["m"])(c,{onClick:o.showAddBanner},null,8,["onClick"]),Object(r["m"])(s,{visible:o.addBannerVisible,"onUpdate:visible":t[1]||(t[1]=function(e){return o.addBannerVisible=e}),dismissableMask:!1,closable:!0,modal:!1,closeOnEscape:!0,onMousedown:t[2]||(t[2]=Object(r["X"])((function(){}),["stop"]))},{header:Object(r["V"])((function(){return[Object(r["m"])("h3",null,' Set "'+Object(r["N"])(o.preconditionNode.title?o.preconditionNode.title:o.selectedNode?o.selectedNode.title:"")+'" as precondition for "'+Object(r["N"])(o.targetNode?o.targetNode.title:"")+'" ',1)]})),footer:Object(r["V"])((function(){return[Object(r["m"])(u,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:o.cancelAdd},null,8,["onClick"]),Object(r["m"])(u,{label:"Done",icon:"pi pi-check",onClick:o.add},null,8,["onClick"])]})),_:1},8,["visible"])],64)}var ka=n("7835"),Ta=n.n(ka),Ea=Object(r["Y"])("data-v-2494d1ac");Object(r["D"])("data-v-2494d1ac");var _a={key:0,class:"custom"},Ca=Object(r["m"])("img",{style:{height:"35px"},alt:"pin-off",src:Ta.a},null,-1),Ra={key:1,class:"custom"},Sa=Object(r["m"])("img",{style:{height:"35px"},alt:"pin-on",src:dr.a},null,-1);Object(r["B"])();var Pa=Ea((function(e,t,n,o,i,a){return Object(r["A"])(),Object(r["g"])("div",{style:{cursor:"pointer"},onMouseenter:t[1]||(t[1]=function(e){return o.mouseOver=!0}),onMouseleave:t[2]||(t[2]=function(e){return o.mouseOver=!1})},[o.mouseOver?(Object(r["A"])(),Object(r["g"])("div",_a,[Ca])):(Object(r["A"])(),Object(r["g"])("div",Ra,[Sa]))],32)})),Aa={name:"AddBasedOnIcon",setup:function(){var e=Object(r["G"])(!1);return{mouseOver:e}}};n("7ccc");Aa.render=Pa,Aa.__scopeId="data-v-2494d1ac";var Ma=Aa,Ba={name:"AddBasedOnButton",components:{Dialog:zi["a"],Button:Fi["a"],AddBasedOnIcon:Ma},emits:["select-precondition-is-on","select-precondition-is-off"],props:{clickedTitleId:{type:String,required:!0}},setup:function(e,t){var n=Gt(),o=Object(zo["b"])(),i=Object(r["G"])(!1),a=Object(r["G"])({}),c=Object(r["G"])({}),s=Object(r["e"])((function(){return n.getters["tree/selectedNode"]}));return Object(r["T"])((function(){return e.clickedTitleId}),(function(){i.value&&"-1"!==e.clickedTitleId&&n.state.tree.nodeRecord[e.clickedTitleId]&&(c.value=n.state.tree.nodeRecord[e.clickedTitleId].node)}),{immediate:!0}),{showAddBanner:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n.state.user&&n.state.user.user&&!n.state.user.user.isAnonymous){e.next=4;break}return e.next=3,n.dispatch("".concat(Lt.confirmSignInPopup),{confirm:o,message:"Please authorize to added node prerequisites"});case 3:return e.abrupt("return");case 4:t.emit("select-precondition-is-on"),a.value=n.getters["tree/selectedNode"],i.value=!i.value;case 7:case"end":return e.stop()}}),e)})));function r(){return e.apply(this,arguments)}return r}(),add:function(){var e=[];n.state.precondition.preconditions[a.value.id]&&(e=n.state.precondition.preconditions[a.value.id]),e.push(c.value.id),S.savePreconditions(n.state.user.user,{nodeId:a.value.id,preconditionIds:e}),t.emit("select-precondition-is-off"),i.value=!1,c.value={}},cancelAdd:function(){i.value=!1,c.value={},t.emit("select-precondition-is-off")},addBannerVisible:i,targetNode:a,preconditionNode:c,selectedNode:s}}};Ba.render=Da;var La=Ba,Va=Object(r["m"])("div",{style:{width:"431px","padding-right":"10px"}},' Press "copy markdown link" button to add image into this node description ',-1),Ua=Object(r["l"])("upload"),Ha=Object(r["m"])("div",{style:{height:"10px"}},null,-1),za=Object(r["m"])("div",{style:{height:"10px"}},null,-1),Ga={style:{display:"flex","flex-direction":"row","justify-content":"space-between"}},Ja=Object(r["l"])("set as default"),Wa=Object(r["l"])("copy markdown link"),$a=Object(r["m"])("span",{class:"material-symbols-outlined"},"delete",-1);function qa(e,t,n,o,i,a){var c=Object(r["J"])("Button"),u=Object(r["J"])("ProgressBar"),s=Object(r["J"])("Card"),d=Object(r["J"])("Dialog");return Object(r["A"])(),Object(r["g"])(r["a"],null,[e.isAuthorized?(Object(r["A"])(),Object(r["g"])("img",{key:0,style:{position:"absolute",left:"0",top:"0",width:"100%",height:"240px",cursor:"pointer"},alt:"welcome",src:e.defaultImageURL,onClick:t[1]||(t[1]=function(){return e.toggleAddDialog&&e.toggleAddDialog.apply(e,arguments)})},null,8,["src"])):(Object(r["A"])(),Object(r["g"])("img",{key:1,style:{position:"absolute",left:"0",top:"0",width:"100%",height:"240px"},alt:"welcome",src:e.defaultImageURL},null,8,["src"])),Object(r["m"])("input",{type:"file",ref:"input",style:{display:"none"},onChange:t[2]||(t[2]=function(){return e.onInputChange&&e.onInputChange.apply(e,arguments)}),accept:"image/*"},null,544),Object(r["m"])(d,{visible:e.addDialogVisible,"onUpdate:visible":t[3]||(t[3]=function(t){return e.addDialogVisible=t}),dismissableMask:!0,closable:!0,modal:!0,closeOnEscape:!0,onMousedown:t[4]||(t[4]=Object(r["X"])((function(){}),["stop"]))},{header:Object(r["V"])((function(){return[Va]})),default:Object(r["V"])((function(){return[Object(r["m"])(c,{rounded:"",onClick:e.triggerUpload},{default:Object(r["V"])((function(){return[Ua]})),_:1},8,["onClick"]),Ha,e.showProgressBar?(Object(r["A"])(),Object(r["g"])(u,{key:0,mode:"indeterminate",style:{height:"6px"}})):Object(r["h"])("",!0),za,(Object(r["A"])(!0),Object(r["g"])(r["a"],null,Object(r["H"])(e.items,(function(t,n){return Object(r["A"])(),Object(r["g"])(s,{key:n,class:"p-mt-1"},{content:Object(r["V"])((function(){return[Object(r["m"])("img",{alt:"image",src:t.url,style:{width:"431px"}},null,8,["src"])]})),footer:Object(r["V"])((function(){return[Object(r["m"])("div",Ga,[Object(r["m"])(c,{rounded:"",onClick:function(n){return e.setAsDefault(t.url)}},{default:Object(r["V"])((function(){return[Ja]})),_:2},1032,["onClick"]),Object(r["m"])(c,{rounded:"",onClick:function(n){return e.copyMDLink(t.url)}},{default:Object(r["V"])((function(){return[Wa]})),_:2},1032,["onClick"]),e.showRemoveButton(t.id)?(Object(r["A"])(),Object(r["g"])(c,{key:0,onClick:function(n){return e.toTrash(t.id)},severity:"danger",text:"",raised:"",rounded:"","aria-label":"Delete"},{icon:Object(r["V"])((function(){return[$a]})),_:2},1032,["onClick"])):Object(r["h"])("",!0)])]})),_:2},1024)})),128))]})),_:1},8,["visible"])],64)}n("2b3d");var Ya=n("18cb"),Fa=n("c045"),Xa=n("d374"),Za="webp",Ka=Object(r["n"])({name:"TitleImage",components:{Button:Fi["a"],Card:vi["a"],Dialog:zi["a"],ProgressBar:Fa["a"]},props:{nodeID:{type:String,required:!0},nodeContent:{type:String,required:!0}},setup:function(e){var t=Object(Ya["b"])(),n=Gt(),o=Object(zo["b"])(),i=Object(r["G"])(!1),a=Object(r["G"])(),c="https://cdn.scimap.org/images/default.jpg",s=Object(r["G"])([]),d=Object(r["G"])(!1),l=Object(r["G"])(c),p=Object(r["e"])((function(){return"/node_image/".concat(e.nodeID)}));return Object(r["U"])((function(){var t=n.state.image.images[e.nodeID];for(var r in s.value=[],s.value.push({id:"",timestamp:1/0,name:"default",url:c,removed:0}),l.value=c,t)"default"!=r?s.value.push({id:r,timestamp:Number(r),name:t[r].name,url:"https://cdn.scimap.org"+t[r].path,removed:t[r].removed}):l.value=t[r].url;s.value=s.value.filter((function(e){return!e.removed})).sort((function(e,t){return t.timestamp-e.timestamp}))})),{items:s,isAuthorized:Object(r["e"])((function(){return n.state.user&&n.state.user.user&&!n.state.user.user.isAnonymous})),defaultImageURL:l,setAsDefault:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,O["a"].database().ref("".concat(p.value)).update({default:{url:t,name:""}});case 2:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),copyMDLink:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,navigator.clipboard.writeText("![](".concat(n," =350x)"));case 2:t.add({severity:"info",summary:"Copied",detail:"You can now paste it into node description. Please, do not use this link in other node description as someone can remove it from this node images as not used!",life:1e3});case 3:case"end":return e.stop()}}),e)})));function n(t){return e.apply(this,arguments)}return n}(),showRemoveButton:function(t){return!!t&&(!e.nodeContent.length||!e.nodeContent.includes(t))},toTrash:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:o.require({message:"Are you sure you want to delete this image?",header:"Confirmation",icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined",rejectLabel:"Cancel",acceptLabel:"Delete",accept:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,O["a"].database().ref("".concat(p.value,"/").concat(n)).update({removed:(new Date).getTime()});case 2:t.add({severity:"info",summary:"Image was deleted",detail:"",life:3e3});case 3:case"end":return e.stop()}}),e)})));function r(){return e.apply(this,arguments)}return r}()});case 1:case"end":return e.stop()}}),e)})));function n(t){return e.apply(this,arguments)}return n}(),toggleAddDialog:function(){i.value=!i.value},addDialogVisible:i,input:a,triggerUpload:function(){a.value.click()},showProgressBar:d,onInputChange:function(){var r=Object(u["a"])(regeneratorRuntime.mark((function r(o){var i,a,c,u,s,l;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n.state.user&&n.state.user.user&&!n.state.user.user.isAnonymous&&0!=e.nodeID.length){r.next=2;break}return r.abrupt("return");case 2:return d.value=!0,i=o.target.files[0],r.next=6,Object(Xa["a"])(i,90,0,0,Za);case 6:if(a=r.sent,!(a.size>5e5)){r.next=14;break}return r.next=10,Object(Xa["a"])(i,90,1200,"auto",Za);case 10:if(a=r.sent,!(a.size>5e5)){r.next=14;break}return t.add({severity:"info",summary:"Sorry",detail:"Cannot compress file, please try to resize/compress it to less than 500Kb",life:3e3}),r.abrupt("return");case 14:c=i.name,u=(new Date).getTime(),s="/user/".concat(n.state.user.user.uid,"/image/").concat(u,".").concat(Za),l=O["a"].storage().ref(s).put(a),l.on("state_changed",(function(e){}),(function(e){console.log(e.message)}),(function(){d.value=!1,l.snapshot.ref.getDownloadURL().then((function(e){var t={};try{t=new URL(e)}catch(r){return void console.log(r)}var n=t.protocol+"//"+t.hostname+(""==t.port?"":":"+t.port)+t.pathname+"?alt=media";O["a"].database().ref("".concat(p.value,"/").concat(u)).update({name:c,path:s,url:n})}))}));case 19:case"end":return r.stop()}}),r)})));function o(e){return r.apply(this,arguments)}return o}()}}});Ka.render=qa;var Qa=Ka,ec=n("a68e"),tc=n("8102"),nc=new ii.a;nc.use(ec,{output:"html"}).use(tc);var rc=Object(r["n"])({name:"NodeContent",components:{TitleImage:Qa,AddBasedOnButton:La,Title:wa,SectionUsedBy:ti,Markdown:li,TextArea:To["a"],SectionPreconditions:Fo,ChangeLog:$i,PinButton:ua,SubscribeButton:ya},emits:["select-precondition-is-on","select-precondition-is-off"],props:{show:{type:Boolean,required:!0},selectedNodeId:{type:String||null,validator:function(e){return"string"===typeof e||null===e},required:!0},clickedTitleId:{type:String,required:!0}},setup:function(e){var t=Object(r["Q"])(),n=Gt(),o=Object(zo["b"])(),i=n.state.tree,a=Object(r["e"])((function(){return e.selectedNodeId&&i.nodeRecord[e.selectedNodeId]?i.nodeRecord[e.selectedNodeId].node:null})),c=Object(r["e"])((function(){if(e.selectedNodeId&&n.state.nodeContent.nodeContents[e.selectedNodeId])return n.state.nodeContent.nodeContents[e.selectedNodeId];var t=K(Ae);return t.nodeID=e.selectedNodeId,t})),d=Object(r["e"])((function(){return e.selectedNodeId&&n.state.nodeContent.userNodeComments[e.selectedNodeId]?n.state.nodeContent.userNodeComments[e.selectedNodeId].comment:""}));return{md:nc,usedBy:Object(r["e"])((function(){return n.state.precondition.reverseIndex[e.selectedNodeId]})),editModeOn:Object(r["e"])((function(){return n.state.editModeOn})),selectedNode:a,selectedNodeContent:c,checkAuthorized:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n.state.user.user&&!n.state.user.user.isAnonymous){e.next=4;break}return e.next=3,n.dispatch("".concat(Lt.confirmSignInPopup),{confirm:o,message:"Please authorize to add comments and edit content"});case 3:t.preventDefault();case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),selectedNodeComment:d,changeNodeTitle:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a.value&&a.value.id){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,S.debouncedUpdate(Object(s["a"])({},"map/".concat(a.value.id,"/name"),t));case 4:n=e.sent,n&&Q(n.error.message,n.kv);case 6:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),changeContent:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n.dispatch("nodeContent/".concat(Pe.setNodeContent),{nodeID:a.value.id,content:t});case 2:r=e.sent,r&&Q(r,{});case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),changeComment:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n.dispatch("nodeContent/".concat(Pe.setNodeComment),{nodeID:a.value.id,comment:t});case 2:r=e.sent,r&&Q(r,{});case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),isWideScreen:$n,wrapperClass:function(){return $n()?t.wrapperContent:t.wrapperContentMobile}}}}),oc=n("5bca");const ic=rc.__cssModules={};ic["$style"]=oc["default"],rc.render=ko;var ac=rc,cc=n("9383"),uc=n("b3b6"),sc=n("c8fa"),dc=n.n(sc),lc={key:0,style:{width:"100%"}},pc={style:{position:"absolute",right:"1.5rem",top:"1.2rem"}},bc=Object(r["m"])("img",{alt:"user",src:dc.a,style:{width:"1.2rem"}},null,-1),fc={key:0,style:{position:"absolute",right:"6.1rem",top:"1.2rem"}},mc={key:2,style:{position:"absolute",right:"20.6rem",top:"1.2rem"}},Oc={key:3,style:{position:"absolute",right:"26.6rem",top:"1.2rem"}},vc={key:4,style:{position:"absolute",right:"32.6rem",top:"1.2rem"}},hc={key:5,style:{position:"absolute",right:"39.6rem",top:"1.2rem"}},gc={key:1};function jc(e,t,n,o,i,a){var c=Object(r["J"])("TextSearch"),u=Object(r["J"])("MenuButton"),s=Object(r["J"])("PrimeMenu"),d=Object(r["J"])("Feedback"),l=Object(r["J"])("EditMode"),p=Object(r["J"])("MapChangeLog"),b=Object(r["J"])("AddNode"),f=Object(r["J"])("RemoveNode"),m=Object(r["J"])("CutPaste"),O=Object(r["J"])("Button");return Object(r["A"])(),Object(r["g"])(r["a"],null,[Object(r["m"])("div",{class:o.isWideScreen()?e.$style.textWrapperSearch:e.$style.textWrapperSearchMobile},[Object(r["m"])(c,{style:o.isWideScreen()?"":"width: 80%;"},null,8,["style"])],2),Object(r["m"])("div",{class:e.$style.wrapper},[o.email?(Object(r["A"])(),Object(r["g"])("div",lc,[Object(r["m"])("div",pc,[Object(r["m"])(u,{onClick:o.toggleUserMenu},{default:Object(r["V"])((function(){return[bc]})),_:1},8,["onClick"]),Object(r["m"])(s,{ref:"menu",id:"overlay_menu",model:o.items,popup:!0},null,8,["model"])]),o.isWideScreen()?(Object(r["A"])(),Object(r["g"])("div",fc,[Object(r["m"])(d)])):Object(r["h"])("",!0),o.isWideScreen()?(Object(r["A"])(),Object(r["g"])(l,{key:1,style:{position:"absolute",right:"12.5rem",top:"1.2rem"}})):Object(r["h"])("",!0),o.editModeOn&&o.isWideScreen()?(Object(r["A"])(),Object(r["g"])("div",mc,[Object(r["m"])(p,{onRestoreSelectNewParentIsOn:t[1]||(t[1]=function(t){return e.$emit("restore-select-new-parent-is-on")}),onRestoreSelectNewParentIsOff:t[2]||(t[2]=function(t){return e.$emit("restore-select-new-parent-is-off")}),clickedTitleId:n.clickedTitleId},null,8,["clickedTitleId"])])):Object(r["h"])("",!0),o.editModeOn?(Object(r["A"])(),Object(r["g"])("div",Oc,[Object(r["m"])(b)])):Object(r["h"])("",!0),o.editModeOn?(Object(r["A"])(),Object(r["g"])("div",vc,[Object(r["m"])(f)])):Object(r["h"])("",!0),o.editModeOn?(Object(r["A"])(),Object(r["g"])("div",hc,[Object(r["m"])(m)])):Object(r["h"])("",!0)])):(Object(r["A"])(),Object(r["g"])("div",gc,[Object(r["m"])(O,{onClick:o.signIn,style:{position:"absolute",right:"2rem",top:"1.2rem"},rounded:"",size:"small",icon:"pi pi-sign-in",label:o.isWideScreen()?"sign in":""},null,8,["onClick","label"])]))],2)],64)}var yc=Object(r["m"])("img",{alt:"icon",src:dr.a,style:{width:"20px"}},null,-1),xc=Object(r["m"])("span",{class:"p-ml-2"},"add",-1);function Ic(e,t,n,o,i,a){var c=Object(r["J"])("MenuButton"),u=Object(r["J"])("Input"),s=Object(r["J"])("Button"),d=Object(r["J"])("Dialog");return Object(r["A"])(),Object(r["g"])(r["a"],null,[Object(r["m"])(c,{onClick:o.toggleAddDialog},{default:Object(r["V"])((function(){return[yc,xc]})),_:1},8,["onClick"]),Object(r["m"])(d,{visible:o.addDialogVisible,"onUpdate:visible":t[2]||(t[2]=function(e){return o.addDialogVisible=e}),dismissableMask:!0,closable:!0,modal:!0,closeOnEscape:!0,onMousedown:t[3]||(t[3]=Object(r["X"])((function(){}),["stop"]))},{header:Object(r["V"])((function(){return[Object(r["m"])("h3",null,Object(r["N"])(o.selectedNodeTitle?"Add subsection to ".concat(o.selectedNodeTitle):"Add section"),1)]})),footer:Object(r["V"])((function(){return[Object(r["m"])(s,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:o.cancelAdd},null,8,["onClick"]),Object(r["m"])(s,{label:"Yes",icon:"pi pi-check",onClick:o.add},null,8,["onClick"])]})),default:Object(r["V"])((function(){return[Object(r["m"])(u,{type:"text",modelValue:o.newNodeTitle,"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.newNodeTitle=e})},null,8,["modelValue"])]})),_:1},8,["visible"])],64)}var Nc=n("8398");function wc(e,t,n,o,i,a){var c=Object(r["J"])("Button");return Object(r["A"])(),Object(r["g"])(c,{size:"small",rounded:"",onMouseenter:t[1]||(t[1]=function(t){return e.mouseover=!0}),onMouseleave:t[2]||(t[2]=function(t){return e.mouseover=!1}),style:(e.mouseover?"background-color: #03dbfc; ":e.bgColor?"background-color: ".concat(e.bgColor,";"):"background-color: white;")+"color: black; border-color:#3B6BF9;"},{default:Object(r["V"])((function(){return[Object(r["I"])(e.$slots,"default")]})),_:3},8,["style"])}var Dc=Object(r["n"])({name:"MenuButton",components:{Button:Fi["a"]},props:{bgColor:String},setup:function(){var e=Object(r["G"])(!1);return{mouseover:e}}});Dc.render=wc;var kc=Dc,Tc={name:"AddNode",components:{MenuButton:kc,Dialog:zi["a"],Button:Fi["a"],Input:Nc["a"]},setup:function(){var e=Gt(),t=Object(r["G"])(!1),n=Object(r["e"])((function(){return e.getters["tree/selectedNode"]})),o=Object(r["G"])("");return{selectedNodeTitle:Object(r["e"])((function(){return n.value?n.value.title:""})),toggleAddDialog:function(){return t.value=!t.value},add:function(){var r=Object(u["a"])(regeneratorRuntime.mark((function r(){var i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,e.dispatch("".concat(Lt.createNode),{parentID:n.value?n.value.id:0,title:o.value});case 2:i=r.sent,e.commit("positionChangePermits/".concat(U.ADD_NODES),[i].concat(Object(G["a"])(e.state.tree.nodeRecord[n.value.id].node.children.map((function(e){return e.id}))))),o.value="",t.value=!1;case 6:case"end":return r.stop()}}),r)})));function i(){return r.apply(this,arguments)}return i}(),cancelAdd:function(){o.value="",t.value=!1},addDialogVisible:t,newNodeTitle:o}}};Tc.render=Ic;var Ec=Tc,_c=Object(r["m"])("img",{alt:"icon",src:pr.a,style:{width:"20px"}},null,-1),Cc=Object(r["m"])("span",{class:"p-ml-2"},"delete",-1);function Rc(e,t,n,o,i,a){var c=Object(r["J"])("MenuButton"),u=Object(r["J"])("Button"),s=Object(r["J"])("Dialog");return Object(r["A"])(),Object(r["g"])(r["a"],null,[Object(r["m"])(c,{onClick:o.toggleDialog,disabled:!o.selectedNodeTitle},{default:Object(r["V"])((function(){return[_c,Cc]})),_:1},8,["onClick","disabled"]),Object(r["m"])(s,{visible:o.addDialogVisible,"onUpdate:visible":t[1]||(t[1]=function(e){return o.addDialogVisible=e}),dismissableMask:!0,closable:!0,modal:!0,closeOnEscape:!0},{header:Object(r["V"])((function(){return[Object(r["m"])("h3",null,Object(r["N"])('Remove "'.concat(o.selectedNodeTitle,'" and all its descendants?')),1)]})),footer:Object(r["V"])((function(){return[Object(r["m"])(u,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:o.cancel},null,8,["onClick"]),Object(r["m"])(u,{label:"Yes",icon:"pi pi-check",onClick:o.remove},null,8,["onClick"])]})),_:1},8,["visible"])],64)}var Sc={name:"RemoveNode",components:{MenuButton:kc,Dialog:zi["a"],Button:Fi["a"]},setup:function(){var e=Gt(),t=Object(Ya["b"])(),n=Object(r["G"])(!1),o=Object(r["e"])((function(){return e.getters["tree/selectedNode"]}));return{selectedNodeTitle:Object(r["e"])((function(){return o.value?o.value.title:""})),toggleDialog:function(){var r=o.value.id,i=[r],a=[];while(i.length>0){var c,u=i.pop();a.push(u),(c=i).push.apply(c,Object(G["a"])(e.state.tree.nodeRecord[u].node.children.map((function(e){return e.id}))))}i=[r];var s={};while(i.length>0){var l,p=i.pop(),b=Gn(a,e.state.precondition.reverseIndex[p]),f=Object(d["a"])(b,2),m=f[0];f[1];e.state.precondition.reverseIndex[p]&&m.length>0&&(s[p]=m),(l=i).push.apply(l,Object(G["a"])(e.state.tree.nodeRecord[p].node.children.map((function(e){return e.id}))))}if(Object.keys(s).length>0){var O=function(){var n=e.state.tree.nodeRecord,r="";for(var o in s)r+="<div>- remove ".concat(zn(o,n)," from 'based on' of ").concat(s[o].map((function(e){return zn(e,n)})).join(", "),"</div>");return t.add({severity:"info",summary:"Cannot remove node until some other nodes use it or its children in their 'based on'",detail:"If you are sure you want to remove it, please: "+r,life:3e4}),{v:void 0}}();if("object"===Object(J["a"])(O))return O.v}n.value=!n.value},remove:function(){n.value=!1,e.dispatch("".concat(Lt.removeNode),o.value.id),e.commit("positionChangePermits/".concat(U.ADD_NODES),e.state.tree.nodeRecord[o.value.id].parent.children.map((function(e){return e.id}))),e.commit("tree/".concat(xt.SET_SELECTED_NODE_ID),e.state.tree.nodeRecord[o.value.id].parent.id)},cancel:function(){n.value=!1},addDialogVisible:n}}};Sc.render=Rc;var Pc=Sc,Ac=n("8423"),Mc=n.n(Ac),Bc=n("4612"),Lc=n.n(Bc),Vc=Object(r["m"])("img",{alt:"icon",src:Mc.a,style:{width:"20px"}},null,-1),Uc=Object(r["m"])("span",{class:"p-ml-2"},"edit map",-1),Hc=Object(r["m"])("img",{alt:"icon",src:Lc.a,style:{width:"20px"}},null,-1),zc=Object(r["m"])("span",{class:"p-ml-2"},"edit map",-1);function Gc(e,t,n,o,i,a){var c=Object(r["J"])("MenuButton");return Object(r["A"])(),Object(r["g"])("div",null,[o.editModeOn?Object(r["h"])("",!0):(Object(r["A"])(),Object(r["g"])(c,{key:0,onClick:o.on,style:{height:"35px"}},{default:Object(r["V"])((function(){return[Vc,Uc]})),_:1},8,["onClick"])),o.editModeOn?(Object(r["A"])(),Object(r["g"])(c,{key:1,onClick:o.off,style:{height:"35px"},"bg-color":"#03dbfc;"},{default:Object(r["V"])((function(){return[Hc,zc]})),_:1},8,["onClick"])):Object(r["h"])("",!0)])}var Jc={name:"EditMode",components:{MenuButton:kc},setup:function(){var e=Gt();return{editModeOn:Object(r["e"])((function(){return e.state.editModeOn})),on:function(){e.dispatch("".concat(Lt.setEditMode),!0)},off:function(){e.dispatch("".concat(Lt.setEditMode),!1)}}}};Jc.render=Gc;var Wc=Jc,$c=n("70bb"),qc=n.n($c),Yc=Object(r["m"])("img",{alt:"icon",src:fr.a,style:{width:"20px"}},null,-1),Fc=Object(r["m"])("span",{class:"p-ml-2"},"cut",-1),Xc=Object(r["m"])("img",{alt:"icon",src:qc.a,style:{width:"20px"}},null,-1),Zc=Object(r["m"])("span",{class:"p-ml-2"},"paste",-1);function Kc(e,t,n,o,i,a){var c=Object(r["J"])("MenuButton");return Object(r["A"])(),Object(r["g"])(r["a"],null,[null==o.cutNodeID?(Object(r["A"])(),Object(r["g"])(c,{key:0,onClick:o.cut,disabled:!o.selectedNode},{default:Object(r["V"])((function(){return[Yc,Fc]})),_:1},8,["onClick","disabled"])):Object(r["h"])("",!0),null!=o.cutNodeID?(Object(r["A"])(),Object(r["g"])(c,{key:1,onClick:o.paste},{default:Object(r["V"])((function(){return[Xc,Zc]})),_:1},8,["onClick"])):Object(r["h"])("",!0)],64)}var Qc={name:"CutPaste",components:{MenuButton:kc},setup:function(){var e=Gt(),t=Object(r["e"])((function(){return e.getters["tree/selectedNode"]})),n=Object(r["G"])(null);return{selectedNode:t,cutNodeID:n,cut:function(){n.value=t.value.id},paste:function(){var r=e.state.tree.nodeRecord[n.value].parent.children.map((function(e){return e.id})),o=e.state.tree.nodeRecord[t.value.id].node.children.map((function(e){return e.id}));e.commit("positionChangePermits/".concat(U.ADD_NODES),[].concat(Object(G["a"])(r),Object(G["a"])(o))),e.dispatch("".concat(Lt.cutPasteNode),{nodeID:n.value,parentID:t.value.id}),n.value=null}}}};Qc.render=Kc;var eu=Qc,tu=Object(r["m"])("img",{alt:"icon",src:_r.a,style:{width:"20px"}},null,-1),nu=Object(r["m"])("span",{class:"p-ml-2"},"chat",-1);function ru(e,t,n,o,i,a){var c=Object(r["J"])("MenuButton");return Object(r["A"])(),Object(r["g"])(c,{onClick:o.send},{default:Object(r["V"])((function(){return[tu,nu]})),_:1},8,["onClick"])}var ou={name:"Feedback",components:{MenuButton:kc},setup:function(){return{send:function(){window.open("https://discord.com/channels/1171118046543347782/1171118047105396749","_blank")}}}};ou.render=ru;var iu=ou,au={class:"p-input-icon-right",style:{width:"100%"}};function cu(e,t,n,o,i,a){var c=Object(r["J"])("InputText");return Object(r["A"])(),Object(r["g"])("span",au,[Object(r["m"])("i",{class:"pi pi-times",style:{right:"1.2rem",cursor:"pointer"},onClick:t[1]||(t[1]=function(){return o.clearBox&&o.clearBox.apply(o,arguments)})}),Object(r["m"])(c,{class:e.$style["searchBox"],placeholder:"Search SciMap",modelValue:o.value,"onUpdate:modelValue":[t[2]||(t[2]=function(e){return o.value=e}),t[3]||(t[3]=function(e){return o.doSearch(e)})]},null,8,["class","modelValue"])])}var uu={name:"TextSearch",components:{InputText:Nc["a"]},setup:function(){var e=Object(r["G"])(""),t=Gt(),n=Object(T["debounce"])(S.setUserLastSearch,2e3),o=function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(r){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,We(r);case 2:return o=e.sent,t.commit("searchResult/".concat(Mt.SET_NODE_IDS),o),r.length>0&&n(t.state.user.user.uid,r),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{doSearch:o,value:e,clearBox:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.value="",t.next=3,o("");case 3:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}()}}},su=n("dc79");const du=uu.__cssModules={};du["$style"]=su["default"],uu.render=cu;var lu=uu,pu=n("fc68"),bu=n.n(pu),fu=Object(r["m"])("img",{alt:"icon",src:Or.a,style:{width:"20px"}},null,-1),mu=Object(r["m"])("span",{class:"p-ml-2"},"log",-1),Ou=Object(r["m"])("h3",null," Map change log ",-1),vu={class:"p-grid"},hu={class:"p-col-1"},gu={key:0,alt:"add_icon",src:dr.a,style:{width:"20px"}},ju={key:1,alt:"add_icon",src:pr.a,style:{width:"20px"}},yu={key:2,alt:"add_icon",src:bu.a,style:{width:"20px"}},xu={class:"p-col-6"},Iu={class:"p-col-5"};function Nu(e,t,n,o,i,a){var c=Object(r["J"])("ChangeLogComplain"),u=Object(r["J"])("MenuButton"),s=Object(r["J"])("RestoreNode"),d=Object(r["J"])("Card"),l=Object(r["J"])("Dialog");return Object(r["A"])(),Object(r["g"])(r["a"],null,[Object(r["m"])(c,{show:e.complainModalVisible,complainChangeLink:e.complainChangeLink,onHide:t[1]||(t[1]=function(t){return e.complainModalVisible=!1})},null,8,["show","complainChangeLink"]),Object(r["m"])(u,{onClick:e.toggleAddDialog},{default:Object(r["V"])((function(){return[fu,mu]})),_:1},8,["onClick"]),Object(r["m"])(l,{visible:e.addDialogVisible,"onUpdate:visible":t[4]||(t[4]=function(t){return e.addDialogVisible=t}),dismissableMask:!1,closable:!0,modal:!1,closeOnEscape:!0,onMousedown:t[5]||(t[5]=Object(r["X"])((function(){}),["stop"]))},{header:Object(r["V"])((function(){return[Ou]})),default:Object(r["V"])((function(){return[(Object(r["A"])(!0),Object(r["g"])(r["a"],null,Object(r["H"])(e.changes,(function(n,o){return Object(r["A"])(),Object(r["g"])(d,{key:o,class:"p-mt-3"},{title:Object(r["V"])((function(){return[Object(r["m"])("div",vu,[Object(r["m"])("div",hu,[n.isAdded?(Object(r["A"])(),Object(r["g"])("img",gu)):n.isRemoved?(Object(r["A"])(),Object(r["g"])("img",ju)):(Object(r["A"])(),Object(r["g"])("img",yu))]),Object(r["m"])("div",xu,Object(r["N"])(new Date(n.timestamp).toLocaleDateString())+" "+Object(r["N"])(new Date(n.timestamp).toLocaleTimeString()),1),Object(r["m"])("div",Iu,[Object(r["m"])(s,{onRestoreSelectNewParentIsOn:t[2]||(t[2]=function(t){return e.$emit("restore-select-new-parent-is-on")}),onRestoreSelectNewParentIsOff:t[3]||(t[3]=function(t){return e.$emit("restore-select-new-parent-is-off")}),clickedTitleId:e.clickedTitleId,event:n},null,8,["clickedTitleId","event"])])])]})),subtitle:Object(r["V"])((function(){return[Object(r["l"])(Object(r["N"])(n.userDisplayName)+" / ",1),Object(r["m"])("a",{href:"#",onClick:function(t){return e.showComplain(n.changeLogID)}},"Complain",8,["onClick"])]})),content:Object(r["V"])((function(){return[Object(r["m"])("div",{style:{width:"20rem"},innerHTML:e.getActionDescription(n)},null,8,["innerHTML"])]})),_:2},1024)})),128))]})),_:1},8,["visible"])],64)}var wu=n("4fbc"),Du=n.n(wu),ku=Object(r["m"])("h3",null," Parent node of this node was deleted, please select new parent. ",-1);function Tu(e,t,n,o,i,a){var c=Object(r["J"])("Button"),u=Object(r["J"])("Dialog");return Object(r["A"])(),Object(r["g"])(r["a"],null,[e.event.isRemoved&&e.IsNodeInTrash(e.event.node.idPath)?(Object(r["A"])(),Object(r["g"])("img",{key:0,alt:"add_icon",src:Du.a,style:{width:"30px",cursor:"pointer"},onClick:t[1]||(t[1]=function(t){return e.revertRemove(e.event)})})):Object(r["h"])("",!0),Object(r["m"])(u,{visible:e.newParentDialogVisible,"onUpdate:visible":t[2]||(t[2]=function(t){return e.newParentDialogVisible=t}),dismissableMask:!1,closable:!0,modal:!1,closeOnEscape:!0,onMousedown:t[3]||(t[3]=Object(r["X"])((function(){}),["stop"]))},{header:Object(r["V"])((function(){return[ku]})),footer:Object(r["V"])((function(){return[Object(r["m"])(c,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:e.cancelAdd},null,8,["onClick"]),Object(r["m"])(c,{label:"Done",icon:"pi pi-check",onClick:e.add},null,8,["onClick"])]})),default:Object(r["V"])((function(){return[Object(r["l"])(' Set "'+Object(r["N"])(e.newParentNode&&e.newParentNode.title?e.newParentNode.title:"")+'" as new parent node. ',1)]})),_:1},8,["visible"])],64)}var Eu=Object(r["n"])({name:"RestoreNode",components:{Dialog:zi["a"],Button:Fi["a"]},emits:["restore-select-new-parent-is-on","restore-select-new-parent-is-off"],props:{event:{type:Object,required:!0},clickedTitleId:{type:String,required:!0}},setup:function(e,t){var n=Gt(),o=Object(r["G"])(!1),i=Object(r["G"])(null),a=Object(r["G"])("");Object(r["T"])((function(){return e.clickedTitleId}),(function(){o.value&&a.value&&"-1"!==e.clickedTitleId&&n.state.tree.nodeRecord[e.clickedTitleId]&&(i.value=n.state.tree.nodeRecord[e.clickedTitleId].node)}),{immediate:!0});var c=function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,S.update(Object(s["a"])({},"cmd/restore",{nodeID:t,parentID:n}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return{newParentDialogVisible:o,newParentNode:i,cancelAdd:function(){o.value=!1,a.value="",i.value=null,t.emit("restore-select-new-parent-is-off")},add:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c(a.value,i.value.id);case 2:t.emit("restore-select-new-parent-is-off"),o.value=!1,a.value="",i.value=null;case 6:case"end":return e.stop()}}),e)})));function n(){return e.apply(this,arguments)}return n}(),IsNodeInTrash:Ci,revertRemove:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n.isRemoved){e.next=2;break}return e.abrupt("return");case 2:if(!n.parentNodeBefore||Ci(n.parentNodeBefore.idPath)){e.next=8;break}if(!Ci(n.node.idPath)){e.next=6;break}return e.next=6,c(n.node.id,n.parentNodeBefore.id);case 6:e.next=11;break;case 8:t.emit("restore-select-new-parent-is-on"),o.value=!0,a.value=n.node.id;case 11:case"end":return e.stop()}}),e)})));function n(t){return e.apply(this,arguments)}return n}()}}});Eu.render=Tu;var _u=Eu,Cu=Object(r["n"])({name:"MapChangeLog",components:{RestoreNode:_u,MenuButton:kc,ChangeLogComplain:Ji,Card:vi["a"],Dialog:zi["a"]},emits:["restore-select-new-parent-is-on","restore-select-new-parent-is-off"],props:{clickedTitleId:{type:String,required:!0}},setup:function(){var e=Object(r["G"])(""),t=Object(r["G"])(!1),n=Object(r["G"])(!1),o=Object(r["E"])([]);return Ei([mi.ParentID,mi.Remove,mi.Restore],[],(function(e){o.splice.apply(o,[0,o.length].concat(Object(G["a"])(e)))})),{complainChangeLink:e,complainModalVisible:t,showComplain:function(n){t.value=!0,e.value="https://scimap.org/change/"+n},toggleAddDialog:function(){return n.value=!n.value},addDialogVisible:n,changes:o,getActionDescription:function(e){return e.action===mi.Restore?"node ".concat(Ri(e.node.idPath,e.node.id,e.node.name)," was restored to ").concat(Ri(e.parentNodeAfter.idPath,e.parentNodeAfter.id,e.parentNodeAfter.name)):e.isAdded?"node ".concat(Ri(e.node.idPath,e.node.id,e.node.name)," was added to ").concat(Ri(e.parentNodeAfter.idPath,e.parentNodeAfter.id,e.parentNodeAfter.name)):e.isRemoved?"node ".concat(Ri(e.node.idPath,e.node.id,e.node.name)," was removed from ").concat(Ri(e.parentNodeBefore.idPath,e.parentNodeBefore.id,e.parentNodeBefore.name)):"node ".concat(Ri(e.node.idPath,e.node.id,e.node.name)," was moved from ").concat(Ri(e.parentNodeBefore.idPath,e.parentNodeBefore.id,e.parentNodeBefore.name)," to ").concat(Ri(e.parentNodeAfter.idPath,e.parentNodeAfter.id,e.parentNodeAfter.name))}}}});Cu.render=Nu;var Ru=Cu,Su=n("7b17"),Pu={name:"Menu",components:{Button:Fi["a"],PrimeMenu:Su["a"],MenuButton:kc,Feedback:iu,CutPaste:eu,AddNode:Ec,RemoveNode:Pc,EditMode:Wc,TextSearch:lu,MapChangeLog:Ru},emits:["restore-select-new-parent-is-on","restore-select-new-parent-is-off"],props:{clickedTitleId:{type:String,required:!0}},setup:function(){Object(r["Q"])();var e=Gt(),t=e.state.user,n=Object(r["G"])(),o=Object(r["e"])((function(){return t.user&&t.user.photoURL?t.user.photoURL:"../../assets/images/user.svg"})),i=Object(r["e"])((function(){return t.user?t.user.email:null})),a=Object(r["e"])((function(){return e.state.editModeOn})),c=Object(r["e"])((function(){var n=[{label:i.value},{separator:!0}];return n.push.apply(n,[{label:"email changes - "+(t.subscribePeriod?t.subscribePeriod:"weekly"),icon:"pi pi-eye",items:[{label:"weekly",icon:"pi pi-calendar",command:function(){e.dispatch("user/".concat(Ye.setSubscribePeriod),"weekly")}},{label:"daily",icon:"pi pi-tablet",command:function(){e.dispatch("user/".concat(Ye.setSubscribePeriod),"daily")}},{label:"on pause",icon:"pi pi-pause",command:function(){e.dispatch("user/".concat(Ye.setSubscribePeriod),"on pause")}}]},{label:"sign out",icon:"pi pi-sign-out",command:function(){e.dispatch("user/".concat(Ye.signOut))}}]),n}));return{isWideScreen:$n,email:i,userPhotoURL:o,editModeOn:a,isNodeSelected:Object(r["e"])((function(){return e.state.tree.selectedNodeId})),isPinned:Object(r["e"])((function(){return void 0!==e.state.pin.pins[e.state.tree.selectedNodeId]})),signIn:function(){return e.dispatch("user/".concat(Ye.signIn))},menu:n,toggleUserMenu:function(e){n.value.toggle(e)},items:c}}},Au=n("8b59");const Mu=Pu.__cssModules={};Mu["$style"]=Au["default"],Pu.render=jc;var Bu=Pu,Lu=Object(r["n"])({name:"Home",components:{Map:ur,Menu:Bu,NodeContent:ac,ConfirmDialog:cc["a"],Toast:uc["a"]},setup:function(){var e=Gt(),t=Object(Ft["e"])(),n=Object(Ft["d"])(),o=e.state.tree,i=e.state.zoomPan,a=e.state.pin,c=e.state.searchResult,s=Object(r["G"])("-1"),l=!1,b=!1,f=!1;Object(r["T"])((function(){return n.params.id}),(function(){e.commit("tree/".concat(xt.SET_SELECTED_NODE_ID),n.params.id)}),{immediate:!0});var m=function(e,t,n){var r=Qn(t,n,e),o=Object(d["a"])(r,2),i=o[0],a=o[1];return a?(Q("Home.vue: error in filterNodesAndLayers:",{err:a}),[]):i.reverse()},O=Object(r["G"])(null),v=Object(r["G"])([]),h=!0;Object(Ft["c"])(function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:h=!1;case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),Object(r["T"])((function(){return[o.mapNodeLayers]}),(function(){if(h&&n.params.id.length>0&&o.mapNodeLayers.length>0){var t=te(n.params.id,o.mapNodeLayers),r=Object(d["a"])(t,1),i=r[0];null!=i&&e.commit("zoomPan/".concat(wt.SET_PAN),{x:-i.center.x+o.mapNodeLayers[0]["0"].center.x,y:-i.center.y+o.mapNodeLayers[0]["0"].center.y})}})),Object(r["T"])((function(){return[o.mapNodeLayers,i.debouncedZoom,i.debouncedPan]}),(function(){var e=Kn(o.mapNodeLayers,o.nodeRecord,{width:window.innerWidth,height:window.innerHeight},i.debouncedZoom,i.pan,{x:S.ROOT_CENTER_X,y:S.ROOT_CENTER_Y}),t=Object(d["a"])(e,2),n=t[0],r=t[1];null!=r&&Q("filterNodesAndLayers: error in findCurrentNode",{err:r}),O.value=n,v.value=m(n,o.mapNodeLayers,o.nodeRecord)}),{immediate:!0,deep:!0});var g=Object(r["G"])([]),j=[];return Object(r["T"])(v,(function(){var e=document.getElementById("mapID");if(e&&Object(nr["a"])().phone){e.setAttribute("transform"," scale(1 1)");var t=e.viewBox.baseVal;t.x=0,t.y=0}j=K(v.value),g.value=tr(j,i.zoom,i.pan)}),{immediate:!0,deep:!0}),Object(r["T"])((function(){return[i.zoom,i.pan]}),(function(e,t){if(t){var n=document.getElementById("mapID");if(n&&Object(nr["a"])().phone){n.setAttribute("transform-origin"," ".concat(i.zoomCenter.x,"px ").concat(i.zoomCenter.y,"px")),n.setAttribute("transform"," scale(".concat(i.relative.zoom,")"));var r=n.viewBox.baseVal;r.x=-i.relative.pan.x,r.y=-i.relative.pan.y}else er(g.value,e[0],e[1],t[0],t[1])}else g.value=tr(j,i.zoom,i.pan)}),{immediate:!0,deep:!0}),{pinNodes:Object(r["e"])((function(){if(null==O.value)return[];var e=a.pinsReverse[O.value];if(!e)return[];var t,n=Object(p["a"])(v.value);try{for(n.s();!(t=n.n()).done;){var r=t.value;for(var c in r){var u=r[c];if(""!=u.title){var s=e.indexOf(u.id);-1!=s&&e.splice(s,1)}}}}catch(g){n.e(g)}finally{n.f()}var d,l=ne(e,o.mapNodeLayers),b=[],f=Object(p["a"])(l);try{for(f.s();!(d=f.n()).done;){var m=d.value,h=K(m);Object(nr["a"])().phone?h.center=Yn(m.center,i.debouncedZoom,i.debouncedPan):h.center=Yn(m.center,i.zoom,i.pan),b.push(h)}}catch(g){f.e(g)}finally{f.f()}return b})),searchResultNodeIDs:Object(r["e"])((function(){return c.nodeIDs})),searchResultPinNodes:Object(r["e"])((function(){if(null==O.value)return[];var e=K(c.nodeIDs);if(!e)return[];var t,n=Object(p["a"])(v.value);try{for(n.s();!(t=n.n()).done;){var r=t.value;for(var a in r){var u=r[a];if(""!=u.title){var s=e.indexOf(u.id);-1!=s&&e.splice(s,1)}}}}catch(g){n.e(g)}finally{n.f()}var d,l=ne(e,o.mapNodeLayers),b=[],f=Object(p["a"])(l);try{for(f.s();!(d=f.n()).done;){var m=d.value,h=K(m);Object(nr["a"])().phone?h.center=Yn(m.center,i.debouncedZoom,i.debouncedPan):h.center=Yn(m.center,i.zoom,i.pan),b.push(h)}}catch(g){f.e(g)}finally{f.f()}return b})),editModeOn:Object(r["e"])((function(){return e.state.editModeOn})),selectedNodeId:Object(r["e"])((function(){return o.selectedNodeId})),selectedNodePreconditionIds:Object(r["e"])((function(){return o.selectedNodeId?e.state.precondition.preconditions[o.selectedNodeId]:[]})),visibleZoomedPanedLayers:g,nodeDragging:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.dispatch("positionChangePermits/".concat(H.CheckNodeID),n.id);case 2:if(r=t.sent,r){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,e.dispatch("".concat(Lt.updateNodePosition),{nodeId:n.id,delta:{x:n.delta.x/i.zoom,y:n.delta.y/i.zoom}});case 7:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}(),setSelectPreconditionON:function(){l=!0},setSelectPreconditionOFF:function(){l=!1,s.value="-1"},setRestoreSelectNewParentON:function(){b=!0},setRestoreSelectNewParentOFF:function(){b=!1},clickedTitleId:s,titleClick:function(e){b||l?s.value=e.id:t.push({name:"node",params:{id:e.id}})},titleOver:function(t){f=!0,e.commit("tree/".concat(xt.SET_SELECTED_NODE_ID),t.id)},titleLeave:function(t){f=!1,e.commit("tree/".concat(xt.SET_SELECTED_NODE_ID),n.params.id)},mapDragging:function(t){e.state.editModeOn&&f||(e.commit("zoomPan/".concat(wt.ADD_PAN),t),e.commit("zoomPan/".concat(wt.ADD_RELATIVE_PAN),t))},zoom:function(t){var n={x:(t.center.x-i.pan.x)/i.zoom,y:(t.center.y-i.pan.y)/i.zoom};e.commit("zoomPan/".concat(wt.SET_ZOOM_CENTER),t.center),e.commit("zoomPan/".concat(wt.ADD_ZOOM),t.delta);var r={x:n.x*i.zoom+i.pan.x,y:n.y*i.zoom+i.pan.y};e.commit("zoomPan/".concat(wt.ADD_PAN),{from:r,to:t.center})}}}});Lu.render=an;var Vu=Lu,Uu={key:0},Hu={key:1},zu=Object(r["m"])("b",null,"id:",-1),Gu=Object(r["m"])("b",null,"timestamp:",-1),Ju=Object(r["m"])("b",null,"action:",-1),Wu=Object(r["m"])("b",null,"node_id:",-1),$u=Object(r["m"])("b",null,"user_id:",-1),qu=Object(r["m"])("b",null,"value:",-1),Yu={key:1};function Fu(e,t,n,o,i,a){var c=Object(r["J"])("Markdown");return o.isAuthorized?(Object(r["A"])(),Object(r["g"])("div",Hu,[Object(r["m"])("div",null,[zu,Object(r["l"])(" "+Object(r["N"])(o.route.params.id),1)]),Object(r["m"])("div",null,[Gu,Object(r["l"])(" "+Object(r["N"])(new Date(o.change["timestamp"]).toLocaleDateString())+" "+Object(r["N"])(new Date(o.change["timestamp"]).toLocaleTimeString()),1)]),Object(r["m"])("div",null,[Ju,Object(r["l"])(" "+Object(r["N"])(o.change["action"]),1)]),Object(r["m"])("div",null,[Wu,Object(r["l"])(" "+Object(r["N"])(o.change["node_id"]),1)]),Object(r["m"])("div",null,[$u,Object(r["l"])(" "+Object(r["N"])(o.change["user_id"]),1)]),qu,-1!=["content","name"].indexOf(o.change["action"])?(Object(r["A"])(),Object(r["g"])(c,{key:0,content:o.change["attributes"]["value"],rows:20},null,8,["content"])):(Object(r["A"])(),Object(r["g"])("div",Yu,Object(r["N"])(JSON.stringify(o.change["attributes"])),1))])):(Object(r["A"])(),Object(r["g"])("h1",Uu,"Only authorized users can view changes"))}var Xu={name:"Change",components:{Markdown:li},setup:function(){var e=Gt(),t=Object(r["e"])((function(){return e.state.user.user&&!e.state.user.user.isAnonymous})),n=Object(Ft["d"])(),o=Object(r["G"])({});return Object(r["T"])((function(){return t.value}),Object(u["a"])(regeneratorRuntime.mark((function e(){var r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.value){e.next=6;break}return r=Object(E["c"])(Object(E["e"])(),"changes",n.params.id),e.next=4,Object(E["d"])(r);case 4:i=e.sent,i.exists()&&(o.value=i.data());case 6:case"end":return e.stop()}}),e)}))),{immediate:!0}),{isAuthorized:t,route:n,change:o}}};Xu.render=Fu;var Zu=Xu,Ku={key:0},Qu=Object(r["l"])("Please, "),es=Object(r["l"])(" to unsubscribe"),ts={key:1};function ns(e,t,n,o,i,a){return o.isAuthorized?(Object(r["A"])(),Object(r["g"])("div",ts," You successfully unsubscribed from scimap.org digest! ")):(Object(r["A"])(),Object(r["g"])("h1",Ku,[Qu,Object(r["m"])("a",{href:"#",onClick:t[1]||(t[1]=function(e){return a.store.dispatch("user/".concat(a.userActions.signIn))})},"Sign in"),es]))}var rs={name:"UnsubscribeDigest",computed:{store:function(){return zt},userActions:function(){return Ye}},setup:function(){var e=Gt(),t=Object(r["e"])((function(){return e.state.user.user&&!e.state.user.user.isAnonymous}));return Object(r["T"])((function(){return e.state.user.user&&!e.state.user.user.isAnonymous}),(function(){t.value&&e.dispatch("user/".concat(Ye.setSubscribePeriod),"on pause")}),{immediate:!0}),{isAuthorized:t}}};rs.render=ns;var os=rs,is={key:0},as={key:1},cs=Object(r["m"])("b",null,"id:",-1),us=Object(r["m"])("b",null,"is removed from map:",-1),ss=Object(r["m"])("b",null,"parent_id:",-1),ds=Object(r["m"])("b",null,"name:",-1),ls=Object(r["m"])("b",null,"content:",-1),ps=Object(r["m"])("b",null,"precondition:",-1),bs=Object(r["m"])("b",null,"children:",-1);function fs(e,t,n,o,i,a){var c=Object(r["J"])("Markdown");return o.isAuthorized?(Object(r["A"])(),Object(r["g"])("div",as,[Object(r["m"])("div",null,[cs,Object(r["l"])(" "+Object(r["N"])(o.route.params.id),1)]),Object(r["m"])("div",null,[us,Object(r["l"])(" "+Object(r["N"])(o.node["is_in_trash"]),1)]),Object(r["m"])("div",null,[ss,Object(r["m"])("a",{target:"_blank",href:o.node["map"]["parentID"]},Object(r["N"])(o.node["map"]["parentID"]),9,["href"])]),Object(r["m"])("div",null,[ds,Object(r["l"])(" "+Object(r["N"])(o.node["map"]["name"]),1)]),ls,Object(r["m"])(c,{content:o.node["node_content"]?o.node["node_content"]["content"]:"",rows:20},null,8,["content"]),Object(r["m"])("div",null,[ps,(Object(r["A"])(!0),Object(r["g"])(r["a"],null,Object(r["H"])(o.node["precondition"],(function(e){return Object(r["A"])(),Object(r["g"])("div",{key:e},[Object(r["m"])("a",{target:"_blank",href:e},Object(r["N"])(e),9,["href"])])})),128))]),Object(r["m"])("div",null,[bs,(Object(r["A"])(!0),Object(r["g"])(r["a"],null,Object(r["H"])(o.node["map"]["children"],(function(e){return Object(r["A"])(),Object(r["g"])("div",{key:e},[Object(r["m"])("a",{target:"_blank",href:e},Object(r["N"])(e),9,["href"])])})),128))])])):(Object(r["A"])(),Object(r["g"])("h1",is,"Only authorized users can view node profile"))}var ms={name:"NodeDescription",components:{Markdown:li},setup:function(){var e=Gt(),t=Object(r["e"])((function(){return e.state.user.user&&!e.state.user.user.isAnonymous})),n=Object(Ft["d"])(),o=Object(r["G"])({});return Object(r["T"])((function(){return t.value}),Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.value&&O["a"].database().ref("/map/".concat(n.params.id)).once("value",(function(e){e.exists()?(o.value["is_in_trash"]=!1,o.value["map"]=e.val(),O["a"].database().ref("/node_content/".concat(n.params.id)).once("value",(function(e){e.exists()&&(o.value["node_content"]=e.val())})),O["a"].database().ref("/precondition/".concat(n.params.id)).once("value",(function(e){e.exists()&&(o.value["precondition"]=e.val())}))):O["a"].database().ref("/trash/".concat(n.params.id)).once("value",(function(e){e.exists()&&(o.value=e.val(),o.value["is_in_trash"]=!0)}))}));case 1:case"end":return e.stop()}}),e)}))),{immediate:!0}),{isAuthorized:t,route:n,node:o}}};ms.render=fs;var Os=ms;function vs(e,t){return Object(r["A"])(),Object(r["g"])("h1",null,"Oops, it looks like the page you're looking for doesn't exist.")}const hs={};hs.render=vs;var gs=hs,js={style:{padding:"2em 2em 2em 2em"}},ys=Object(r["m"])("h1",null,"Sorry, SciMap do not ready for mobile yet, please reopen it on you laptop/desktop",-1),xs=Object(r["l"])(" You can "),Is=Object(r["l"])("still "),Ns=Object(r["l"])(" without any warranties"),ws=Object(r["m"])("li",null,"or watch video about SciMap",-1),Ds=Object(r["m"])("div",{style:{"text-align":"center"}},[Object(r["m"])("iframe",{src:"https://www.youtube.com/embed/DuiTlnrK6G4?si=HuVA4cs5U86H9E3l",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerpolicy:"strict-origin-when-cross-origin",allowfullscreen:""})],-1);function ks(e,t,n,o,i,a){return Object(r["A"])(),Object(r["g"])("div",js,[ys,xs,Object(r["m"])("ul",null,[Object(r["m"])("li",null,[Is,Object(r["m"])("a",{href:o.url},"try desktop version on mobile",8,["href"]),Ns]),ws]),Ds])}var Ts={setup:function(){var e=new URLSearchParams(window.location.search),t=new URL(decodeURI(e.get("from")));return t.searchParams.append("forceDesktopOnMobile","true"),{url:t.href}}};Ts.render=ks;var Es=Ts,_s=[{path:"/passwordLogin",component:tn},{path:"/mobile_warning",component:Es},{path:"/node_description/:id?",name:"node_description",component:Os},{path:"/change/:id?",name:"change",component:Zu},{path:"/unsubscribe_digest",name:"unsubscribe_digest",component:os},{path:"/:id?",name:"node",component:Vu},{path:"/:catchAll(.*)",component:gs}],Cs=Object(Ft["a"])({history:Object(Ft["b"])("/"),routes:_s}),Rs=Cs,Ss=(n("7165"),n("e1ae"),n("4121"),n("bddf"),n("6b8c"));Object(r["f"])(Wt).use(zt,Ht).use(Rs).use($t["a"]).use(qt["a"]).use(Yt["a"]).directive("tooltip",Ss["a"]).mount("#app")},cd50:function(e,t,n){var r={"./bmp":"0dcc","./bmp.js":"0dcc","./gif":"c416","./gif.js":"c416","./jpg":"135b","./jpg.js":"135b","./png":"e9ef","./png.js":"e9ef","./psd":"520c","./psd.js":"520c","./svg":"b0bf","./svg.js":"b0bf","./tiff":"f270","./tiff.js":"f270","./webp":"cf1e","./webp.js":"cf1e"};function o(e){var t=i(e);return n(t)}function i(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=i,e.exports=o,o.id="cd50"},ce14:function(e,t,n){e.exports=n.p+"img/eye-off.d2cfd862.svg"},d470:function(e,t,n){},d6b6:function(e){e.exports=JSON.parse("{}")},dc79:function(e,t,n){"use strict";var r=n("0be9"),o=n.n(r);n.d(t,"default",(function(){return o.a}))},fc68:function(e,t,n){e.exports=n.p+"img/move.bbe00c47.svg"},fdc1:function(e,t,n){e.exports=n.p+"img/add-off.32a0c20b.svg"},fe82:function(e,t,n){e.exports=n.p+"img/question.df174033.svg"}});
//# sourceMappingURL=app.4ff6bf3c.js.map