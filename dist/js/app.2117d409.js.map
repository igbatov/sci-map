{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/assets/images/sign-in.svg","webpack:///./src/components/menu/Textsearch.vue?cdad","webpack:///./src/components/node_content/Title.vue?1654","webpack:///./src/assets/images/chat.svg","webpack:///./src/components/node_content/UsedBy.vue?2a53","webpack:///./src/components/SVGTextBox.vue?6701","webpack:///./src/assets/images/plugin.svg","webpack:///./src/components/node_content/PinIcon.vue?4950","webpack:///./src/views/Home.vue?cadf","webpack:///./src/assets/images/log.svg","webpack:///./src/assets/images/eye-on.svg","webpack:///./src/assets/images/edit-map-off.png","webpack:///./src/components/node_content/Markdown.vue?520d","webpack:///./src/assets/images/switch-off.svg","webpack:///./src/assets/images/remove-off.svg","webpack:///./src/components/node_content/RemoveIcon.vue?aab8","webpack:///./src/assets/images/edit-map-on.png","webpack:///./src/assets/images/revert.svg","webpack:///./src/components/node_content/Preconditions.vue?971a","webpack:///./src/components/map_layer/MapLayer.vue?1492","webpack:///./src/assets/images/remove-on.svg","webpack:///./src/components/node_content/SubscribeIcon.vue?8445","webpack:///./src/views/Home.vue?95ef","webpack:///./src/assets/images/paste.svg","webpack:///./src/assets/images/add-on.svg","webpack:///./src/assets/images/help-question.svg","webpack:///./src/components/node_content/AddBasedOnIcon.vue?e31f","webpack:///./src/assets/images/switch-on.svg","webpack:///./src/assets/images/cut.svg","webpack:///./src/assets/images/goal.svg","webpack:///./src/components/node_content/UsedBy.vue?47f0","webpack:///./src/components/node_content/Preconditions.vue?630e","webpack:///./src/components/menu/Index.vue?a24b","webpack:///./src/components/node_content/Index.vue?c0b9","webpack:///./src/assets/images/pin-off.svg","webpack:///./src/assets/images/pin-on.svg","webpack:///./src/assets/images/menu.svg","webpack:///./src/components/menu/Index.vue?b99f","webpack:///./src/App.vue","webpack:///./src/store/pin/index.ts","webpack:///./src/tools/errorkv.ts","webpack:///./src/store/precondition/index.ts","webpack:///./src/store/image/index.ts","webpack:///./src/api/helpers.ts","webpack:///./src/api/api.ts","webpack:///./src/store/subscriptions/index.ts","webpack:///./src/store/title_box/index.ts","webpack:///./src/store/position_change_permits/index.ts","webpack:///./src/tools/utils.ts","webpack:///./src/store/tree/helpers.ts","webpack:///./src/tools/graphics.ts","webpack:///./src/store/node_content/index.ts","webpack:///./src/tools/textsearch.ts","webpack:///./src/store/user/index.ts","webpack:///./src/store/helpers.ts","webpack:///./src/store/tree/index.ts","webpack:///./src/store/history/index.ts","webpack:///./src/store/zoom_pan/index.ts","webpack:///./src/store/search_result/index.ts","webpack:///./src/store/index.ts","webpack:///./src/App.vue?3acc","webpack:///./src/App.vue?dfb6","webpack:///./src/views/PasswordLogin.vue","webpack:///./src/views/PasswordLogin.vue?76a3","webpack:///./src/views/PasswordLogin.vue?e3c1","webpack:///./src/views/Home.vue","webpack:///./src/components/map/Map.vue","webpack:///./src/components/map_layer/MapLayer.vue","webpack:///./src/components/map_layer/MapLayer.ts","webpack:///./src/components/SVGTextBox.ts","webpack:///./src/components/map_layer/MapLayer.vue?1431","webpack:///./src/components/map_layer/MapLayer.vue?0796","webpack:///./src/components/map/MapPan.ts","webpack:///./src/components/pin_layer/PinLayer.vue","webpack:///./src/components/pin_layer/PinMarker.vue","webpack:///./src/components/pin_layer/PinMarker.vue?bbb0","webpack:///./src/components/pin_layer/PinMarker.vue?9aa1","webpack:///./src/components/SVGTextBox.vue","webpack:///./src/components/SVGTextBox.vue?ae08","webpack:///./src/components/SVGTextBox.vue?ec46","webpack:///./src/components/pin_layer/PinLayer.vue?738a","webpack:///./src/components/pin_layer/PinLayer.vue?8bd0","webpack:///./src/components/precondition_layer/PreconditionLayer.vue","webpack:///./src/components/precondition_layer/PreconditionArrow.vue","webpack:///./src/components/precondition_layer/PreconditionArrow.vue?e51e","webpack:///./src/components/precondition_layer/PreconditionArrow.vue?74c6","webpack:///./src/components/helpers.ts","webpack:///./src/views/Home.ts","webpack:///./src/components/precondition_layer/PreconditionLayer.vue?6cdc","webpack:///./src/components/precondition_layer/PreconditionLayer.vue?73c2","webpack:///./src/components/map/Map.vue?b432","webpack:///./src/components/map/Map.vue?8505","webpack:///./src/components/node_content/Index.vue","webpack:///./src/components/node_content/Preconditions.vue","webpack:///./src/components/node_content/RemoveIcon.vue","webpack:///./src/components/node_content/RemoveIcon.vue?f4ef","webpack:///./src/components/Link.vue","webpack:///./src/components/Link.vue?14eb","webpack:///./src/components/Link.vue?da62","webpack:///./src/components/node_content/Preconditions.vue?b5b4","webpack:///./src/components/node_content/Preconditions.vue?c4ee","webpack:///./src/components/node_content/UsedBy.vue","webpack:///./src/components/node_content/UsedBy.vue?fc09","webpack:///./src/components/node_content/UsedBy.vue?0024","webpack:///./src/components/node_content/Markdown.vue","webpack:///./src/components/node_content/Markdown.vue?6e5c","webpack:///./src/components/node_content/Markdown.vue?9efd","webpack:///./src/components/node_content/ChangeLog.vue","webpack:///./src/store/change_log/index.ts","webpack:///./src/api/change_log.ts","webpack:///./src/components/node_content/ChangeLogComplain.vue","webpack:///./src/components/node_content/ChangeLogComplain.vue?d4d1","webpack:///./src/components/node_content/ChangeLogComplain.vue?5b6f","webpack:///./src/components/node_content/ChangeLog.vue?ff01","webpack:///./src/components/node_content/ChangeLog.vue?5753","webpack:///./src/components/node_content/PinButton.vue","webpack:///./src/components/node_content/PinIcon.vue","webpack:///./src/components/node_content/PinIcon.vue?7cf5","webpack:///./src/components/node_content/PinButton.vue?f1ab","webpack:///./src/components/node_content/SubscribeButton.vue","webpack:///./src/components/node_content/SubscribeIcon.vue","webpack:///./src/components/node_content/SubscribeIcon.vue?a7ab","webpack:///./src/components/node_content/SubscribeButton.vue?f9b6","webpack:///./src/components/node_content/SubscribeButton.vue?04a0","webpack:///./src/components/node_content/Title.vue","webpack:///./src/components/node_content/Title.vue?1578","webpack:///./src/components/node_content/Title.vue?f8bb","webpack:///./src/components/node_content/AddBasedOnButton.vue","webpack:///./src/components/node_content/AddBasedOnIcon.vue","webpack:///./src/components/node_content/AddBasedOnIcon.vue?6da1","webpack:///./src/components/node_content/AddBasedOnButton.vue?6d44","webpack:///./src/components/node_content/TitleImage.vue","webpack:///./src/components/node_content/TitleImage.vue?36f1","webpack:///./src/components/node_content/TitleImage.vue?6fb7","webpack:///./src/components/node_content/Index.vue?70b7","webpack:///./src/components/node_content/Index.vue?1dc7","webpack:///./src/components/menu/Index.vue","webpack:///./src/components/menu/AddNode.vue","webpack:///./src/components/menu/MenuButton.vue","webpack:///./src/components/menu/MenuButton.vue?30bd","webpack:///./src/components/menu/AddNode.vue?9c98","webpack:///./src/components/menu/RemoveNode.vue","webpack:///./src/components/menu/RemoveNode.vue?4610","webpack:///./src/components/menu/RemoveNode.vue?2cae","webpack:///./src/components/menu/EditMode.vue","webpack:///./src/components/menu/EditMode.vue?1f8e","webpack:///./src/components/menu/CutPaste.vue","webpack:///./src/components/menu/CutPaste.vue?91c8","webpack:///./src/components/menu/Feedback.vue","webpack:///./src/components/menu/Feedback.vue?098b","webpack:///./src/components/menu/MapChangeLog.vue","webpack:///./src/components/menu/RestoreNode.vue","webpack:///./src/components/menu/RestoreNode.vue?51ab","webpack:///./src/components/menu/RestoreNode.vue?1d4e","webpack:///./src/components/menu/MapChangeLog.vue?c7fd","webpack:///./src/components/menu/MapChangeLog.vue?978e","webpack:///./src/components/menu/Help.vue","webpack:///./src/components/menu/Help.vue?9451","webpack:///./src/components/menu/Help.vue?4105","webpack:///./src/components/menu/Index.vue?075d","webpack:///./src/components/menu/Textsearch.vue","webpack:///./src/components/menu/Textsearch.vue?1edb","webpack:///./src/components/menu/Textsearch.vue?31d6","webpack:///./src/views/LogoDummy.vue","webpack:///./src/views/LogoDummy.vue?c915","webpack:///./src/views/LogoDummy.vue?16ec","webpack:///./src/views/Home.vue?d5e7","webpack:///./src/views/Home.vue?ab8c","webpack:///./src/views/Change.vue","webpack:///./src/views/Change.vue?708d","webpack:///./src/views/Change.vue?8302","webpack:///./src/views/UnsubscribeDigest.vue","webpack:///./src/views/UnsubscribeDigest.vue?eca5","webpack:///./src/views/UnsubscribeDigest.vue?3058","webpack:///./src/views/NodeDescription.vue","webpack:///./src/views/NodeDescription.vue?fd3e","webpack:///./src/views/NodeDescription.vue?8bca","webpack:///./src/views/NotFound.vue","webpack:///./src/views/NotFound.vue?8fd3","webpack:///./src/views/MobileWarning.vue","webpack:///./src/views/MobileWarning.vue?bce7","webpack:///./src/views/MobileWarning.vue?e041","webpack:///./src/router/index.ts","webpack:///./src/main.ts","webpack:///./node_modules/markdown-it-imsize/lib/imsize/types sync ^\\.\\/.*$","webpack:///./src/assets/images/eye-off.svg","webpack:///./src/components/node_content/Index.vue?7af1","webpack:///./src/components/menu/Textsearch.vue?0596","webpack:///./src/assets/images/move.svg","webpack:///./src/assets/images/add-off.svg","webpack:///./src/assets/images/question.svg"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","mutations","SET_PINS","ADD_TO_PINS","REMOVE_PIN","ADD_TO_PINS_REVERSE","AddPin","RemovePin","namespaced","state","pins","pinsReverse","actions","v","commit","rootState","currentParent","tree","nodeRecord","nodeId","parent","parentIds","id","parentId","pinId","index","indexOf","message","kv","code","err","Error","error","SET_PRECONDITIONS","UPDATE_PRECONDITIONS","REMOVE_PRECONDITION","preconditions","reverseIndex","precondID","nodeID","preconditionIDs","preconditionID","UPDATE_IMAGES","images","convertChildren","children","Array","isArray","filter","childID","sort","forEach","arr","toString","values","convertDBMapToTree","dbNodes","root","title","position","stack","node","pop","parentID","database","ref","update","debouncedUpdate","ROOT_WIDTH","innerWidth","innerHeight","ROOT_HEIGHT","ROOT_CENTER_X","ROOT_CENTER_Y","ST_WIDTH","ST_HEIGHT","initFirebase","initializeApp","prodConfig","analytics","getMapFromDB","snapshot","exists","map","val","getMapFromStorage","user","storage","child","uid","getDownloadURL","url","a","response","x","y","getMap","e","getPins","savePins","set","getSubscriptions","setSubscription","getPreconditions","savePreconditions","preconditionIds","subscribeMapNodeChange","cb","this","subscribeDBChange","snap","subscribeNodeContentChange","subscribePreconditionNodeChange","subscribeNodeImageChange","path","on","unsubscribeDBChange","off","transaction","setPublicUserData","userID","displayName","discordName","console","getMapNode","pr","getTrashNode","type","generateKey","findKeyInList","orderByValue","equalTo","limitToFirst","findKeyOfChild","getUserSubscribePeriod","setUserSubscribePeriod","period","setUserLastSearch","searchPhrase","getUserComments","nodeComment","getNodeContent","SET_SUBSCRIPTIONS","SET_SUBSCRIPTION","ToggleSubscription","subscriptions","api","SET_MAP","layerMap","layerName","titleBoxMap","PERMISSION_TIMEOUT","ADD_NODES","REMOVE_NODES","CheckNodeID","permittedNodeIDs","nodeIDs","Date","getTime","ROUND_EPSILON","mod","round","num","Math","pow","clone","printError","msg","kvArr","findMapNode","mapNodeLayers","level","layer","Number","findMapNodes","ids","createNewNode","center","getNewNodeCenter","addRandom","parentMapNode","fromCenterVectors","border","from","to","maxFromCenterVector","getVectorLength","coeff","random","maxDiagChild","maxDiagChildMapNode","maxDiagChildId","childMapNode","childId","getMaxDiagonal","childDiag","err1","maxDiag","err2","finalMaxDiag","newNodeCenter","vectorOnNumber","modifiedNode","updatePosition","item","convertPosition","normalizedPosition","layerLevel","treeToMapNodeLayers","ls","mergeMapNodeLayers","NORMALIZED_BORDER","sqrt","polygonToTurf","pp","point","isInside","polygon","polygonToPCPolygon","abs","intersect","p1","p2","np1","np2","cf","tp1","tp2","polygonIntersect","intersection","resultPolys","poly","resultPoly","getBoundingBorders","minX","reduce","previousValue","currentValue","minY","maxX","maxY","leftBottom","rightTop","getVoronoiCellsInSquare","centers","turfPoints","collection","cells","bbox","cellMap","features","cell","cellBorder","geometry","coordinates","getVoronoiCells","outerBorder","bb","res","BoundingBorders","intersections","polygonFill","selectedNodeId","currentNodeId","selectedNodePreconditionIds","polygonFillOpacity","polygonToPath","join","treeToNodeRecord","transferToPoint","vector","addVector","b","bTransferred","aTr","transferPointOnVector","getVectorIntersection","v1","v2","x1","y1","x2","y2","x3","y3","x4","y4","denom","numeA","numeB","uA","uB","morphChildrenPoints","oldBorder","newBorder","oldPoints","oldCenterTf","newCenterTf","oldCenter","newCenter","maxDiameter","max","newPoints","oldPoint","centerToPoint","oldBorderIntersection","segment","newBorderIntersection","NewEmptyVector","diagonals","middle","maxDiagonal","diag","convertedPosition","morphedPositions","normalizedBorder","tmp","rootBorder","rootPosition","keys","treeLayers","lastTreeLayer","lastMapNodeLayer","newTreeLayer","newMapNodeLayer","treeNode","tmpMap","strPos","JSON","stringify","firstId","secondId","treeNodeChildren","denormalizedPosition","ch","recipientLayers","insertedLayers","startFromLevel","SET_CONTENTS","SET_USER_COMMENTS","SET_NODE_CONTENT","SET_NODE_COMMENT","setNodeContent","setNodeComment","EmptyNodeContent","content","createContentIfNotExist","nodeContents","EmptyNodeComment","comment","createCommentIfNotExist","userNodeComments","SearchFieldName","isAnonymous","indexTitle","tokenize","encode","str","split","rtl","stemmer","matcher","indexContent","indexUserComment","idMapCnt","nodeIDMap","searchIdMap","field","text","Title","add","toLowerCase","Content","UserComment","search","ids1","ids2","ids3","SET_USER","SET_SUBSCRIBE_PERIOD","signIn","signOut","setSubscribePeriod","subscribePeriod","auth","signInWithPopup","GoogleAuthProvider","initMap","convErr","SET_TREE","subscribeNodeChanges","unSubscribeNodeChanges","dbNode","dispatch","handleMapNodeUpdate","fetchPins","log","fetchSubscribePeriod","fetchSubscriptions","initPreconditions","initNodeContents","nodeContent","userComments","idx","initData","ROOT_BORDER","ROOT_CENTER","userFitCoefficient","min","changeTypeEnum","SET_SELECTED_NODE_ID","UPDATE_NODE_POSITION","REMOVE_NODE","getters","selectedNode","dbNodeRecord","oldDBNode","newChildren","includes","removedChildren","returnError","addedDBNode","toProcess","inProcessNode","childNode","ind","findIndex","ADD_ZOOM","ADD_PAN","ADD_RELATIVE_PAN","SET_PAN","SET_ZOOM_CENTER","RESET_ZOOM_AND_PAN","ZOOM_SENSITIVITY","PAN_SENSITIVITY","DEBOUNCE_WAIT","zoomDebounce","debouncedZoom","relative","zoom","panDebounce","debouncedPan","pan","zoomCenter","delta","newZoom","ADD_CUT_PASTE","ADD_CREATE","ADD_REMOVE","ADD_POSITION_CHANGE","changeTypes","CUT_PASTE","CREATE","REMOVE","POSITION_CHANGE","stableChangeList","localChangeList","change","newParentID","firstOldPosition","oldPosition","newPosition","SET_NODE_IDS","init","updateNodePosition","createNode","cutPasteNode","removeNode","setEditMode","confirmSignInPopup","SET_EDIT_MODE","debouncedPositionSet","normalizedNewNodeCenter","editModeOn","confirm","require","header","acceptLabel","rejectLabel","accept","reject","onAuthStateChanged","changedNode","newDBNode","newKey","updateMap","normalizedChangedCenter","pn","oldParent","newParent","oldKey","parentNodeID","mapNode","args","pin","titleBox","image","precondition","positionChangePermits","zoomPan","history","searchResult","useStore","setup","store","render","login","emailEl","document","getElementById","passwordEl","signInWithEmailAndPassword","class","icon","slotProps","summary","detail","visibleZoomedPanedLayers","isWideScreen","$style","textWrapperSearch","textWrapperSearchMobile","style","setRestoreSelectNewParentON","setRestoreSelectNewParentOFF","clickedTitleId","setSelectPreconditionON","setSelectPreconditionOFF","show","layers","pin-nodes","pinNodes","searchResultPinNodes","searchResultNodeIDs","nodeDragging","titleClick","titleOver","titleLeave","mapDragging","gutterSize","layout","splitterResize","$event","size","wrapperHeight","contentSplitHeight","wrapHeight","wrapWidth","xmlns","width","svgWidth","height","svgHeight","viewBox","mapID","layer-id","map-nodes","border-color","borderColor","font-color","fontColor","font-size","fontSize","font-opacity","fontOpacity","map-id","draggingNode","visibleTitleIds","color","font-weight","text-decoration","mapNodes","stroke","fill","fill-opacity","stroke-width","points","pointer-events","TITLE_PREFIX","font-family","textWeight","textColor","textDecoration","splitLines","line","alignment-baseline","titleMouseDown","cursor","mouseMoveListener","emit","event","mouseDownInfo","dragStart","movementX","movementY","mouseUpListener","nodeToTitleBox","nodes","updateTitleBox","titleIdPrefix","dom","getBoundingClientRect","mps","then","immediate","deep","maxCharNum","words","lines","currLine","nextLine","emits","props","layerId","mapId","String","required","validator","prop","ctx","layerID","titleMouseDownInfo","mouseMove","mouseUp","addEventListener","removeEventListener","searchResultNodeIDsMap","methods","__scopeId","mouseDownBg","mouseDown","visiblePinNodes","useLineBreak","titleXY","line-height","max-char-per-line","fontWeight","titleBoxClick","transform","WIDTH","HEIGHT","fontFamily","lineHeight","Boolean","maxCharPerLine","components","SVGTextBox","PinMarker","allPinNodes","PIN_MARKER_HEIGHT","PIN_MARKER_WIDTH","alignedXY","markerWidth","markerHeight","refX","refY","orient","markerId","visibleTitleNodes","titleBoxOver","titleBoxLeave","marker-end","idToLink","getArrayDiff","beforeArr","afterArr","beforeMap","afterMap","added","removed","getTreePathNodes","records","getTreePathString","reverse","MIN_VISIBLE_NODES_NUM","zoomAndPanPoint","zoomAndPanPolygon","zoomAndPanPointInPlace","oldZoom","newPan","oldPan","zoomAndPanPolygonInPlace","findCentralNode","viewport","zoomFactor","focusPoint","underFocusPointNodeId","viewportArea","nodesToCheck","borderToCheck","minDist","Infinity","nodeCenter","dist","underCursorNodeArea","floor","maxIntersectNodeId","filterNodesAndLayers","resultLayers","currentNode","upperLayer","firstLayer","secondLayer","childOfChild","thirdLayer","zoomAnPanLayersInPlace","zoomAnPanLayers","PreconditionArrow","zoomPanState","zoomedPannedSelectedNode","phone","extraPreconditionTitles","visibleTitleNodeBoxes","PreconditionLayer","PinLayer","MapLayer","clientX","clientY","deltaY","passive","prevDist","prevPoint","touches","pageX","pageY","levelSizes","0","1","2","3","levelColors","alt","src","frameborder","allow","referrerpolicy","allowfullscreen","target","href","wrapperClass","selectedNodeContent","changeNodeTitle","rows","changeContent","placeholder","autoResize","selectedNodeComment","changeComment","checkAuthorized","section","$emit","node-id","usedBy","list","preconditionPath","preconditionPaths","nodeTitle","remove","mouseOver","goto","router","treeState","preventDefault","firstNode","params","Link","RemoveIcon","cssModules","__cssModules","usedByNode","usedByPaths","isAuthorized","renderedContent","setEditOn","editOn","mdKatex","mdImsize","mdContainer","mdVideo","md","use","output","containerClassName","youtube","validate","trim","match","tokens","info","nesting","utils","escapeHtml","txtarea","display","focus","complainModalVisible","complainChangeLink","legend","toggleable","collapsed","toggle","pt","changes","timestamp","toLocaleDateString","toLocaleTimeString","action","subtitle","userDisplayName","showComplain","changeLogID","ActionType","Name","newName","newContent","Precondition","getContent","subscribeChangeLog","andConditions","q","changeLogs","doc","attributes","valueBefore","valueAfter","getNodeName","nodeName","prTrash","getUserDisplayName","userName","getUserDisplayNames","userIDs","fetches","Promise","all","responses","getNodeNames","getPathFromNodeName","nodeNames","nodePath","subscribeChangeLogEnriched","userNames","changeLog","ParentID","Restore","resp","changeLogsEnriched","idPath","beforePath","afterPath","parentNodeBefore","parentNodeAfter","isRemoved","isAdded","Remove","IsNodeInTrash","nodeIDPath","startsWith","GetNodeUrl","visible","dismissableMask","closable","modal","closeOnEscape","footer","Dialog","newArgs","oldArgs","computed","Markdown","ChangeLogComplain","Fieldset","Card","unsubscribe","cd","clickPin","addDialogVisible","label","cancelAdd","selectedParent","options","parents","optionLabel","isPinned","undefined","PinIcon","Button","Listbox","newNodeTitle","selectedNodeParents","toggleSubscribe","is-on","isOn","SubscribeIcon","showAddBanner","addBannerVisible","preconditionNode","targetNode","AddBasedOnIcon","preconditionsIDs","defaultImageURL","toggleAddDialog","onInputChange","rounded","triggerUpload","showProgressBar","items","setAsDefault","copyMDLink","showRemoveButton","toTrash","severity","raised","aria-label","fileFormat","ProgressBar","toast","input","defaultURL","dbNodeImgPath","getImageURL","default","navigator","clipboard","writeText","life","rejectClass","click","imgFile","files","compressedBlob","fileName","filePath","storageRef","put","parsedURL","URL","preparedURL","protocol","hostname","port","pathname","TitleImage","AddBasedOnButton","SectionUsedBy","TextArea","SectionPreconditions","ChangeLog","PinButton","SubscribeButton","wrapperContent","wrapperContentMobile","wrapper","email","toggleUserMenu","model","popup","isNodeSelected","disabled","selectedNodeTitle","mouseover","bgColor","MenuButton","Input","newNodeID","toggleDialog","cancel","allChildrenIDs","usedByNodes","nr","detailText","bg-color","cutNodeID","cut","paste","oldParentChildrenID","newParentChildrenID","send","open","getActionDescription","revertRemove","newParentDialogVisible","newParentNode","nodeIdToRestore","restoreNodeWithChildren","RestoreNode","toggleHelp","isHelpVisible","PrimeMenu","Feedback","Help","CutPaste","AddNode","RemoveNode","EditMode","MapChangeLog","menu","userPhotoURL","photoURL","separator","command","clearBox","doSearch","InputText","debouncedLog","stroke-miterlimit","xmlns:dc","xmlns:cc","xmlns:rdf","xmlns:svg","xml:space","version","rdf:about","rdf:resource","LogoDummy","Splitter","SplitterPanel","TextSearch","Map","Menu","NodeContent","ConfirmDialog","Toast","route","pinState","searchResultState","selectPreconditionIsOn","restoreSelectNewParentIsOn","updateLayers","centralNodeId","filteredLayers","visibleLayers","isFirstPageLoad","newCentralNodeId","layersToZoomAndPan","svg","setAttribute","baseVal","pinNodeIDs","pinMapNodes","pinMapNode","cl","searchResultMapNodes","searchResultMapNode","hasDragPermit","initial","after","sizes","docRef","docSnap","userActions","once","script","urlParams","URLSearchParams","location","decodeURI","searchParams","append","routes","component","PasswordLogin","MobileWarning","NodeDescription","Change","UnsubscribeDigest","Home","NotFound","App","directive","mount","webpackContext","req","webpackContextResolve","resolve"],"mappings":"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","file":"js/app.2117d409.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","module.exports = __webpack_public_path__ + \"img/sign-in.857c8105.svg\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"searchBox\":\"Textsearch_searchBox_1SbLb\"};","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Title.vue?vue&type=style&index=0&id=00857be5&scoped=true&lang=css\"","module.exports = __webpack_public_path__ + \"img/chat.b54d0730.svg\";","export { default } from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-0-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-0-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./UsedBy.vue?vue&type=style&index=0&id=b8b30aac&module=true&lang=css\"; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-0-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-0-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./UsedBy.vue?vue&type=style&index=0&id=b8b30aac&module=true&lang=css\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./SVGTextBox.vue?vue&type=style&index=0&id=3400d8a7&scoped=true&lang=css\"","module.exports = __webpack_public_path__ + \"img/plugin.71b16b67.svg\";","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./PinIcon.vue?vue&type=style&index=0&id=4ed46db5&scoped=true&lang=css\"","// extracted by mini-css-extract-plugin\nmodule.exports = {\"textWrapperSearch\":\"Home_textWrapperSearch_1uPYg\",\"textWrapperSearchMobile\":\"Home_textWrapperSearchMobile_2KNYE\"};","module.exports = __webpack_public_path__ + \"img/log.2b2ea6d0.svg\";","module.exports = __webpack_public_path__ + \"img/eye-on.e881e189.svg\";","module.exports = __webpack_public_path__ + \"img/edit-map-off.d3da093a.png\";","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Markdown.vue?vue&type=style&index=0&id=a238a804&scoped=true&lang=css\"","module.exports = __webpack_public_path__ + \"img/switch-off.17f7401d.svg\";","module.exports = __webpack_public_path__ + \"img/remove-off.9d54941e.svg\";","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./RemoveIcon.vue?vue&type=style&index=0&id=154fe046&scoped=true&lang=css\"","module.exports = __webpack_public_path__ + \"img/edit-map-on.aab258df.png\";","module.exports = __webpack_public_path__ + \"img/revert.3fe2bc78.svg\";","export { default } from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-0-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-0-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Preconditions.vue?vue&type=style&index=0&id=c5b277c6&module=true&lang=css\"; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-0-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-0-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Preconditions.vue?vue&type=style&index=0&id=c5b277c6&module=true&lang=css\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./MapLayer.vue?vue&type=style&index=0&id=182e8a4c&scoped=true&lang=css\"","module.exports = __webpack_public_path__ + \"img/remove-on.9d54941e.svg\";","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./SubscribeIcon.vue?vue&type=style&index=0&id=5d02b387&scoped=true&lang=css\"","export { default } from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-0-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-0-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-0-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Home.vue?vue&type=style&index=0&id=354a2316&module=true&lang=css\"; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-0-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-0-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-0-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Home.vue?vue&type=style&index=0&id=354a2316&module=true&lang=css\"","module.exports = __webpack_public_path__ + \"img/paste.c9ceeece.svg\";","module.exports = __webpack_public_path__ + \"img/add-on.5a83fc0e.svg\";","module.exports = __webpack_public_path__ + \"img/help-question.4958b291.svg\";","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./AddBasedOnIcon.vue?vue&type=style&index=0&id=2494d1ac&scoped=true&lang=css\"","module.exports = __webpack_public_path__ + \"img/switch-on.70cdd4b4.svg\";","module.exports = __webpack_public_path__ + \"img/cut.5b0b166e.svg\";","module.exports = __webpack_public_path__ + \"img/goal.dfe3dc4c.svg\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"title\":\"UsedBy_title_3F9En\",\"precondition\":\"UsedBy_precondition_1vpBY\",\"preconditionPath\":\"UsedBy_preconditionPath_3XvY1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"title\":\"Preconditions_title_1ANO_\",\"precondition\":\"Preconditions_precondition_XjUJT\",\"preconditionPath\":\"Preconditions_preconditionPath_1K70l\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"Index_wrapper_1nXRC\",\"customSvgIcon\":\"Index_customSvgIcon_3R9kx\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapperContentMobile\":\"Index_wrapperContentMobile_3O52m\",\"wrapperContent\":\"Index_wrapperContent_1bUq4\",\"title\":\"Index_title_1kpia\",\"list\":\"Index_list_3qW8z\",\"icon\":\"Index_icon_2jnZk\",\"section\":\"Index_section_bVQDf\"};","module.exports = __webpack_public_path__ + \"img/pin-off.addc500f.svg\";","module.exports = __webpack_public_path__ + \"img/pin-on.ae33cffa.svg\";","module.exports = __webpack_public_path__ + \"img/menu.4256f039.svg\";","export { default } from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-0-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-0-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Index.vue?vue&type=style&index=0&id=b5d62c42&module=true&lang=css\"; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-0-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-0-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Index.vue?vue&type=style&index=0&id=b5d62c42&module=true&lang=css\"","<template>\n  <router-view />\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nimport { useStore, actions } from \"@/store\";\nexport default defineComponent({\n  setup() {\n    const store = useStore();\n    store.dispatch(actions.init);\n  }\n});\n</script>\n","import { Commit } from \"vuex\";\nimport { NodeRecordItem } from \"@/store/tree\";\n\nexport type Pins = Record<\n  string /* node_id of pinned node */,\n  string[] /* list of parents where this node_id is visible */\n>;\n\nexport interface State {\n  pins: Pins;\n  pinsReverse: Record<\n    string /* node_id of parent whose children contain pinned nodes (that must be visible) */,\n    string[] /* array of pins (= node ids) that is visible in this node_id */\n  >;\n}\n\nexport const mutations = {\n  SET_PINS: \"SET_PINS\",\n  ADD_TO_PINS: \"ADD_TO_PINS\",\n  REMOVE_PIN: \"REMOVE_PIN\",\n  ADD_TO_PINS_REVERSE: \"ADD_TO_PINS_REVERSE\"\n};\n\nexport const actions = {\n  AddPin: \"AddPin\",\n  RemovePin: \"RemovePin\"\n};\n\nexport const store = {\n  namespaced: true,\n  state: {\n    pins: {},\n    pinsReverse: {}\n  },\n  actions: {\n    // had to use action instead of mutation to get access to rootState https://github.com/vuejs/vuex/issues/344\n    [actions.AddPin](\n      {\n        commit,\n        rootState\n      }: {\n        commit: Commit;\n        rootState: { tree: { nodeRecord: Record<string, NodeRecordItem> } };\n      },\n      v: { nodeId: string; parentId: string }\n    ) {\n      // get all parents of nodeId until parentID\n      let currentParent = rootState.tree.nodeRecord[v.nodeId].parent;\n      if (!currentParent) {\n        return;\n      }\n      const parentIds = [];\n      while (currentParent && currentParent.id != v.parentId) {\n        parentIds.push(currentParent.id);\n        currentParent = rootState.tree.nodeRecord[currentParent.id].parent;\n      }\n      parentIds.push(v.parentId);\n      // Set them to pins\n      commit(mutations.ADD_TO_PINS, { nodeId: v.nodeId, parentIds });\n\n      // And for each parent add pined node id to it\n      for (const parentId of parentIds) {\n        commit(mutations.ADD_TO_PINS_REVERSE, {\n          nodeId: parentId,\n          pinId: v.nodeId\n        });\n      }\n    },\n    [actions.RemovePin]({ commit }: { commit: Commit }, nodeId: string) {\n      commit(mutations.REMOVE_PIN, nodeId);\n    }\n  },\n  mutations: {\n    [mutations.SET_PINS](state: State, pins: Pins) {\n      state.pins = pins;\n      state.pinsReverse = {};\n      for (const pinId in pins) {\n        for (const parentId of pins[pinId]) {\n          if (!state.pinsReverse[parentId]) {\n            state.pinsReverse[parentId] = [];\n          }\n          state.pinsReverse[parentId].push(pinId);\n        }\n      }\n    },\n    [mutations.ADD_TO_PINS](\n      state: State,\n      v: { nodeId: string; parentIds: string[] }\n    ) {\n      state.pins[v.nodeId] = v.parentIds;\n    },\n    [mutations.ADD_TO_PINS_REVERSE](\n      state: State,\n      v: { nodeId: string; pinId: string }\n    ) {\n      if (!state.pinsReverse[v.nodeId]) {\n        state.pinsReverse[v.nodeId] = [];\n      }\n      state.pinsReverse[v.nodeId].push(v.pinId);\n    },\n    [mutations.REMOVE_PIN](state: State, nodeId: string) {\n      for (const parentId of state.pins[nodeId]) {\n        const index = state.pinsReverse[parentId].indexOf(nodeId);\n        state.pinsReverse[parentId].splice(index, 1);\n      }\n      delete state.pins[nodeId];\n    }\n  }\n};\n","/* eslint-disable  @typescript-eslint/no-explicit-any */\nimport { ErrorKV } from \"@/types/errorkv\";\n\nexport const UNAUTHORIZED = 401;\n\nexport default (\n  message: string,\n  kv: Record<string, any>,\n  code?: number\n): ErrorKV => {\n  const err = new Error(message);\n\n  return {\n    error: err,\n    kv: kv,\n    code\n  };\n};\n","export type Preconditions = Record<\n  string /* id of node with premises */,\n  string[] /* ids of premise nodes */\n>;\n\nexport type ReverseIndex = Record<\n  string /* id of node (A) */,\n  string[] /* ids nodes nodes that has node A as a premise */\n>;\n\nexport interface State {\n  preconditions: Preconditions;\n  reverseIndex: ReverseIndex; // reverse index for preconditions - i e reverseIndex[id1] as nodeID1 means that nodeID1 has id1 as its precondition\n}\n\nexport const mutations = {\n  SET_PRECONDITIONS: \"SET_PRECONDITIONS\",\n  UPDATE_PRECONDITIONS: \"UPDATE_PRECONDITIONS\",\n  REMOVE_PRECONDITION: \"REMOVE_PRECONDITION\"\n};\n\nexport const store = {\n  namespaced: true,\n  state: {\n    preconditions: {} as Record<string, string[]>,\n    reverseIndex: {} as Record<string, string[]>\n  },\n  mutations: {\n    /**\n     * Set preconditions for all nodes\n     * @param state\n     * @param preconditions\n     */\n    [mutations.SET_PRECONDITIONS](state: State, preconditions: Preconditions) {\n      state.preconditions = preconditions;\n      state.reverseIndex = {};\n\n      // create reverseIndex\n      for (const id in preconditions) {\n        for (const precondID of preconditions[id]) {\n          if (typeof state.reverseIndex[precondID] === \"undefined\") {\n            state.reverseIndex[precondID] = [];\n          }\n          state.reverseIndex[precondID].push(id);\n        }\n      }\n    },\n\n    /**\n     * Set preconditions for one node\n     * @param state\n     * @param v\n     */\n    [mutations.UPDATE_PRECONDITIONS](\n      state: State,\n      v: { nodeID: string; preconditionIDs: Array<string> }\n    ) {\n      if (!state.preconditions[v.nodeID]) {\n        state.preconditions[v.nodeID] = [];\n      }\n      // remove from reverseIndex old preconditions\n      for (const id of state.preconditions[v.nodeID]) {\n        if (\n          state.reverseIndex[id] &&\n          state.reverseIndex[id].indexOf(v.nodeID) != -1\n        ) {\n          state.reverseIndex[id].splice(\n            state.reverseIndex[id].indexOf(v.nodeID),\n            1\n          );\n        }\n      }\n\n      state.preconditions[v.nodeID] = v.preconditionIDs;\n\n      // add to reverseIndex new preconditions\n      for (const precondID of state.preconditions[v.nodeID]) {\n        if (!state.reverseIndex[precondID]) {\n          state.reverseIndex[precondID] = [];\n        }\n        state.reverseIndex[precondID].push(v.nodeID);\n      }\n    },\n\n    /**\n     * Remove one precondition from one node\n     * @param state\n     * @param v\n     */\n    [mutations.REMOVE_PRECONDITION](\n      state: State,\n      v: { nodeID: string; preconditionID: string }\n    ) {\n      if (!state.preconditions[v.nodeID]) {\n        return;\n      }\n\n      const p = state.preconditions[v.nodeID];\n      if (!p) {\n        return;\n      }\n      if (p.indexOf(v.preconditionID) == -1) {\n        return;\n      }\n      p.splice(p.indexOf(v.preconditionID), 1);\n\n      // remove from reverseIndex\n      if (!state.reverseIndex[v.preconditionID]) {\n        return\n      }\n      if (state.reverseIndex[v.preconditionID].indexOf(v.nodeID) == -1) {\n        return;\n      }\n      state.reverseIndex[v.preconditionID].splice(state.reverseIndex[v.preconditionID].indexOf(v.nodeID), 1);\n    }\n  },\n\n};\n","import {DBImage} from \"@/api/types\";\n\nexport type Images =  Record<string, Record<string, DBImage>>;\n\nexport interface State {\n  images: Images;\n}\n\nexport const mutations = {\n  UPDATE_IMAGES: \"UPDATE_IMAGES\",\n};\n\nexport const store = {\n  namespaced: true,\n  state: {\n    images: {} as Images,\n  },\n  mutations: {\n    [mutations.UPDATE_IMAGES](state: State, v: {nodeID: string, images: Record<string, DBImage>}) {\n        state.images[v.nodeID] = v.images\n    },\n  }\n};\n","import { DBMapNode } from \"@/api/types\";\nimport { Tree } from \"@/types/graphics\";\nimport { ErrorKV } from \"@/types/errorkv\";\nimport NewErrorKV from \"../tools/errorkv\";\n\n// convert children an object to array\nexport function convertChildren(children: any): string[] {\n  let result: string[];\n\n  if (!children) {\n    result = [];\n  } else if (Array.isArray(children)) {\n    result = children.filter(childID => !!childID).sort();\n    result.forEach((childID, i, arr) => (arr[i] = childID.toString()));\n  } else {\n    result = Object.values(children)\n      .filter(childID => !!childID)\n      .sort() as string[];\n    result.forEach((childID, i, arr) => (arr[i] = childID.toString()));\n  }\n  return result;\n}\n\nexport function convertDBMapToTree(\n  dbNodes: Record<string, DBMapNode>\n): [Tree | null, ErrorKV] {\n  const root: Tree = {\n    id: dbNodes[\"0\"].id.toString(),\n    title: dbNodes[\"0\"].name,\n    position: dbNodes[\"0\"].position,\n    children: []\n  };\n  const stack = [root];\n\n  while (stack.length > 0) {\n    const node = stack.pop();\n    if (!node) {\n      continue;\n    }\n    if (!dbNodes[node.id]) {\n      return [\n        null,\n        NewErrorKV(\"Cannot find id in dbNodes\", { \"node.id\": node.id, dbNodes })\n      ];\n    }\n    dbNodes[node.id].children = convertChildren(dbNodes[node.id].children);\n    if (!dbNodes[node.id].children.length) {\n      continue;\n    }\n    const children: Tree[] = [];\n    for (const childID of dbNodes[node.id].children) {\n      if (!dbNodes[childID]) {\n        return [\n          null,\n          NewErrorKV(\"Cannot find child id in dbNodes\", {\n            childID,\n            parentID: node.id\n          })\n        ];\n      }\n      children.push({\n        id: childID.toString(),\n        title: dbNodes[childID].name,\n        position: dbNodes[childID].position,\n        children: []\n      });\n    }\n\n    node.children = children;\n    stack.push(...children);\n  }\n\n  return [root, null];\n}\n","import firebase from \"firebase/compat\";\nimport { Tree } from \"@/types/graphics\";\nimport { ErrorKV } from \"@/types/errorkv\";\nimport NewErrorKV from \"../tools/errorkv\";\nimport axios from \"axios\";\nimport { Pins } from \"@/store/pin\";\nimport {mutations as preconditionMutations, Preconditions} from \"@/store/precondition\";\nimport {mutations as imageMutations} from \"@/store/image\";\nimport { DBMapNode, DBImage} from \"@/api/types\";\nimport { convertChildren } from \"./helpers\";\nimport { NodeComment, NodeContent } from \"@/store/node_content\";\nimport emulatorConfig from \"../../firebase.json\";\nimport prodConfig from \"./prodConfig.json\";\nimport stgConfig from \"./stgConfig.json\";\nimport { debounce } from \"lodash\";\n\nimport { connectFirestoreEmulator, getFirestore } from \"firebase/firestore\";\nimport {store} from \"@/store\";\n\nconst MAP_FROM_STORAGE = false; // use storage as a source for the map (or database)\n\nconst update = async (data: Record<string, any>): Promise<ErrorKV> => {\n  try {\n    await firebase\n      .database()\n      .ref()\n      .update(data);\n    return null;\n  } catch (e) {\n    return NewErrorKV(\"api: error in update\", { err: e });\n  }\n};\n\nconst debouncedUpdate = debounce(update, 2000);\n\n// These ROOT_WIDTH and ROOT_HEIGHT is used only to scale to a device window proportionally,\n// An actual proportion and border of map is hardcoded in store/tree ROOT_WIDTH/ROOT_HEIGHT/ROOT_BORDER\nexport default {\n  ROOT_WIDTH: window.innerWidth > window.innerHeight ? window.innerWidth : 1.5*0.95*window.innerWidth,\n  ROOT_HEIGHT: window.innerWidth > window.innerHeight ? 0.95*window.innerHeight : 1.5*window.innerHeight,\n  ROOT_CENTER_X: window.innerWidth > window.innerHeight ? 0.3 * window.innerWidth + (0.7 * window.innerWidth) / 2 : window.innerWidth/2,\n  ROOT_CENTER_Y: window.innerWidth > window.innerHeight ? window.innerHeight / 2 : (0.75 * window.innerHeight) / 2,\n  ST_WIDTH: 1000,\n  ST_HEIGHT: 1000,\n  initFirebase() {\n    // Initialize Firebase\n    if (process.env.VUE_APP_PROJECT === \"prod\") {\n      firebase.initializeApp(prodConfig);\n      firebase.analytics();\n    } else if (process.env.VUE_APP_PROJECT === \"stage\") {\n      firebase.initializeApp(stgConfig);\n      firebase.analytics();\n    }\n    if (process.env.VUE_APP_PROJECT === \"emulator\") {\n      console.log(\"Starting in emulator mode\");\n      firebase.initializeApp(prodConfig);\n      firebase\n        .auth()\n        .useEmulator(`http://localhost:${emulatorConfig.emulators.auth.port}`);\n      firebase\n        .database()\n        .useEmulator(\"localhost\", emulatorConfig.emulators.database.port);\n      firebase\n        .storage()\n        .useEmulator(\"localhost\", emulatorConfig.emulators.storage.port);\n      connectFirestoreEmulator(\n        getFirestore(),\n        \"localhost\",\n        emulatorConfig.emulators.firestore.port\n      );\n    }\n  },\n\n  async getMapFromDB(): Promise<[Record<string, DBMapNode> | null, ErrorKV]> {\n    const snapshot = await firebase\n      .database()\n      .ref(\"map\")\n      .get();\n    if (!snapshot.exists()) {\n      return [null, NewErrorKV(\"!snapshot.exists\", {})];\n    }\n    const map = snapshot.val();\n\n    return [map, null];\n  },\n\n  /**\n   * TODO: use it to cut costs on DB reads from read-only users\n   * @param user\n   */\n  async getMapFromStorage(\n    user: firebase.User | null\n  ): Promise<[Tree | null, ErrorKV]> {\n    const storage = firebase.storage().ref();\n    let ref = storage.child(`/map.json`);\n    if (user) {\n      ref = storage.child(`/user/${user.uid}/map.json`);\n    }\n    const url = await ref.getDownloadURL();\n\n    const response = await axios.get(url);\n    return [\n      {\n        id: \"0\",\n        title: \"\",\n        position: { x: this.ROOT_WIDTH / 2, y: this.ROOT_HEIGHT / 2 },\n        // children: apiTree.children\n        children: response.data\n      },\n      null\n    ];\n  },\n\n  async getMap(\n    user: firebase.User | null\n  ): Promise<[Record<string, DBMapNode> | null, ErrorKV]> {\n    try {\n      return await this.getMapFromDB();\n    } catch (e) {\n      return [null, NewErrorKV(e.message, { e: e })];\n    }\n  },\n\n  async getPins(user: firebase.User | null): Promise<[Pins | null, ErrorKV]> {\n    try {\n      if (user == null) {\n        // for anonymous use general pins\n        const storage = firebase.storage().ref();\n        const ref = storage.child(`/pins.json`);\n        const url = await ref.getDownloadURL();\n\n        const response = await axios.get(url);\n        return [response.data, null];\n      } else {\n        // for authenticated user use realtime database\n        const snapshot = await firebase\n          .database()\n          .ref(`user_data/${user.uid}/pins`)\n          .get();\n        if (!snapshot.exists()) {\n          return [null, NewErrorKV(\"!snapshot.exists\", {})];\n        }\n        return [snapshot.val(), null];\n      }\n\n    } catch (e) {\n      return [null, NewErrorKV(e.message, { e: e })];\n    }\n  },\n\n  async savePins(user: firebase.User, pins: Pins) {\n    if (!user) {\n      return;\n    }\n    await firebase\n      .database()\n      .ref(`user_data/${user.uid}/pins`).set(pins);\n  },\n\n  /**\n   * getSubscriptions\n   * @param user\n   */\n  async getSubscriptions(user: firebase.User | null): Promise<[Pins | null, ErrorKV]> {\n    if (!user) {\n      return [null, null]\n    }\n    try {\n      // for authenticated user use realtime database\n      const snapshot = await firebase\n        .database()\n        .ref(`user_subscription/${user.uid}`)\n        .get();\n      if (!snapshot.exists()) {\n        return [null, NewErrorKV(\"!snapshot.exists\", {})];\n      }\n      return [snapshot.val(), null];\n    } catch (e) {\n      return [null, NewErrorKV(e.message, { e: e })];\n    }\n  },\n\n  /**\n   * setSubscription\n   * @param user\n   * @param v\n   */\n  async setSubscription(user: firebase.User | null, v:{nodeID: string, mode: number | null}) {\n    if (!user) {\n      return;\n    }\n    await firebase\n      .database()\n      .ref(`user_subscription/${user.uid}/${v.nodeID}`).set(v.mode);\n  },\n\n  async getPreconditions(\n    user: firebase.User | null\n  ): Promise<[Preconditions | null, ErrorKV]> {\n    try {\n      const snapshot = await firebase\n        .database()\n        .ref(\"precondition\")\n        .get();\n      if (!snapshot.exists()) {\n        return [null, NewErrorKV(\"!snapshot.exists\", {})];\n      }\n      const preconditions = snapshot.val();\n\n      return [preconditions, null];\n    } catch (e) {\n      return [null, NewErrorKV(e.message, { e: e })];\n    }\n  },\n\n  async savePreconditions(\n    user: firebase.User | null,\n    preconditions: { nodeId: string; preconditionIds: string[] }\n  ) {\n    if (!user) {\n      return;\n    }\n    await firebase\n      .database()\n      .ref(\"precondition/\" + preconditions.nodeId)\n      .set(preconditions.preconditionIds);\n  },\n\n  subscribeMapNodeChange(nodeID: string, cb: (a: DBMapNode) => any) {\n    this.subscribeDBChange(\n      `map/${nodeID}`,\n      (snap: firebase.database.DataSnapshot) => {\n        if (!snap.exists()) {\n          return;\n        }\n        const node = snap.val() as DBMapNode;\n        // console.log('got update for map node', node)\n        node.id = node.id.toString();\n        node.children = convertChildren(node.children);\n        cb(node);\n      }\n    );\n  },\n\n  subscribeNodeContentChange(\n    nodeID: string,\n    cb: (a: { nodeID: string; content: string }) => any\n  ) {\n    this.subscribeDBChange(\n      `node_content/${nodeID}`,\n      (snap: firebase.database.DataSnapshot) => {\n        if (!snap.exists()) {\n          return;\n        }\n        const node = snap.val() as { nodeID: string; content: string };\n        // console.log('got update for node content', node)\n        cb(node);\n      }\n    );\n  },\n\n  subscribePreconditionNodeChange(\n    nodeID: string,\n  ) {\n    this.subscribeDBChange(\n      `precondition/${nodeID}`,\n      (snap: firebase.database.DataSnapshot) => {\n        if (!snap.exists()) {\n          return;\n        }\n        const preconditionIDs = snap.val() as Array<string>;\n        store.commit(\n          `precondition/${preconditionMutations.UPDATE_PRECONDITIONS}`,\n          { nodeID: nodeID, preconditionIDs: preconditionIDs }\n        );\n      }\n    );\n  },\n\n  subscribeNodeImageChange(\n    nodeID: string,\n  ) {\n    this.subscribeDBChange(\n      `node_image/${nodeID}`,\n      (snap: firebase.database.DataSnapshot) => {\n        if (!snap.exists()) {\n          return;\n        }\n        const images = snap.val() as Record<string, DBImage>;\n        store.commit(\n          `image/${imageMutations.UPDATE_IMAGES}`,\n          {nodeID, images}\n        );\n      }\n    );\n  },\n\n  subscribeDBChange(\n    path: string,\n    cb: (a: firebase.database.DataSnapshot) => any\n  ) {\n    firebase\n      .database()\n      .ref(path)\n      .on(\"value\", cb);\n  },\n\n  unsubscribeDBChange(\n    path: string,\n    cb?: (a: firebase.database.DataSnapshot) => any\n  ) {\n    firebase\n      .database()\n      .ref(path)\n      .off(\"value\", cb);\n  },\n\n  async transaction(nodeID: string, update: (val: any) => any) {\n    await firebase\n      .database()\n      .ref(\"map/\" + nodeID)\n      .transaction(\n        update,\n        () => {\n          return;\n        },\n        false\n      );\n  },\n\n  async setPublicUserData(\n    userID: string,\n    displayName: string | null,\n    discordName: string | null\n  ) {\n    try {\n      await firebase\n        .database()\n        .ref(\"public_user_data/\" + userID)\n        .set({\n          displayName,\n          discordName\n        });\n    } catch (e) {\n      console.error(e);\n    }\n  },\n\n  async getMapNode(nodeID: string): Promise<DBMapNode | null> {\n    const pr = await firebase\n      .database()\n      .ref(\"map/\" + nodeID)\n      .get();\n    const node = pr.val();\n    if (!node) {\n      console.error(\"got null fetching from map/nodeID\", nodeID)\n      return null\n    }\n    node.id = node.id.toString();\n    node.children = convertChildren(node.children);\n    return node;\n  },\n\n  async getTrashNode(nodeID: string, type: string): Promise<DBMapNode | null> {\n    const pr = await firebase\n      .database()\n      .ref(`trash/${nodeID}/${type}`)\n      .get();\n    return pr.val();\n  },\n\n  generateKey(): string | null {\n    return firebase\n      .database()\n      .ref()\n      .push().key;\n  },\n\n  async findKeyInList(path: string, value: string): Promise<string | null> {\n    const snap = await firebase\n      .database()\n      .ref(path)\n      .orderByValue()\n      .equalTo(value)\n      .limitToFirst(1)\n      .get();\n    return snap.key;\n  },\n\n  async findKeyOfChild(\n    nodeID: string,\n    childID: string\n  ): Promise<string | null> {\n    const pr = await firebase\n      .database()\n      .ref(\"map/\" + nodeID)\n      .get();\n    const node = pr.val();\n    if (!node.children) {\n      return null;\n    }\n\n    for (const key in node.children) {\n      if (node.children[key].toString() === childID) {\n        return key;\n      }\n    }\n    return null;\n  },\n\n  update,\n  debouncedUpdate,\n\n  /**\n   * getUserSubscribePeriod\n   * @param user\n   */\n  async getUserSubscribePeriod(\n    user: firebase.User | null\n  ): Promise<string> {\n    if (!user) {\n      return ''\n    }\n    const userID = user.uid;\n    const snapshot = await firebase\n      .database()\n      .ref(`user_data/${userID}/subscribe_period`)\n      .get();\n    if (!snapshot.exists()) {\n      return '';\n    }\n    return snapshot.val();\n  },\n\n  /**\n   * setUserSubscribePeriod\n   * @param user\n   * @param period\n   */\n  async setUserSubscribePeriod(\n    user: firebase.User,\n    period: string,\n  ){\n    const userID = user.uid;\n    return await firebase\n      .database()\n      .ref(`user_data/${userID}/subscribe_period`)\n      .set(period);\n  },\n\n  /**\n   * setUserSearchPhrase\n   * @param userID\n   * @param searchPhrase\n   */\n  async setUserLastSearch(\n    userID: string,\n    searchPhrase: string,\n  ){\n    return await firebase\n      .database()\n      .ref(`user_data/${userID}/last_search`)\n      .set(searchPhrase);\n  },\n\n  async getUserComments(\n    user: firebase.User\n  ): Promise<[Record<string, NodeComment> | null, ErrorKV]> {\n    const userID = user.uid;\n    const snapshot = await firebase\n      .database()\n      .ref(`user_data/${userID}/comment`)\n      .get();\n    if (!snapshot.exists()) {\n      return [null, NewErrorKV(\"!snapshot.exists\", {})];\n    }\n    const nodeComment = snapshot.val();\n\n    return [nodeComment, null];\n  },\n\n  async getNodeContent(): Promise<\n    [Record<string, NodeContent> | null, ErrorKV]\n  > {\n    const snapshot = await firebase\n      .database()\n      .ref(`node_content`)\n      .get();\n\n    if (!snapshot.exists()) {\n      return [{}, null];\n    }\n\n    return [snapshot.val(), null];\n  }\n};\n","import { Commit } from \"vuex\";\nimport firebase from \"firebase/compat\";\nimport api from \"@/api/api\";\n\nexport type Subscriptions = Record<\n  string /* node_id user is subscribed on */,\n  number\n>;\n\nexport interface State {\n  subscriptions: Subscriptions;\n}\n\nexport const mutations = {\n  SET_SUBSCRIPTIONS: \"SET_SUBSCRIPTIONS\",\n  SET_SUBSCRIPTION: \"SET_SUBSCRIPTION\",\n};\n\nexport const actions = {\n  ToggleSubscription: \"ToggleSubscription\",\n};\n\nexport const store = {\n  namespaced: true,\n  state: {\n    subscriptions: {},\n  },\n  actions: {\n    /**\n     * ToggleSubscription\n     * @param commit\n     * @param state\n     * @param rootState\n     * @param nodeID\n     */\n    [actions.ToggleSubscription](\n      {\n        commit, state, rootState\n      }: {\n        commit: Commit;\n        state: State;\n        rootState: { user: { user: firebase.User | null } };\n      },\n      nodeID: string\n    ) {\n      const v = {nodeID: nodeID, mode: 0} as {nodeID: string, mode: number | null}\n      if (!state.subscriptions[nodeID] || state.subscriptions[nodeID] == 0) {\n        v.mode = 1\n      } else if (state.subscriptions[nodeID] == 1) {\n        v.mode = null\n      }\n      commit(mutations.SET_SUBSCRIPTION, v);\n      api.setSubscription(rootState.user.user, v);\n    },\n  },\n  mutations: {\n    /**\n     * SET_SUBSCRIPTIONS\n     * @param state\n     * @param subscriptions\n     */\n    [mutations.SET_SUBSCRIPTIONS](state: State, subscriptions: Subscriptions) {\n      if (!subscriptions) {\n        state.subscriptions = {};\n      } else {\n        state.subscriptions = subscriptions\n      }\n    },\n\n    /**\n     * SET_SUBSCRIPTION\n     * @param state\n     * @param v\n     */\n    [mutations.SET_SUBSCRIPTION](\n      state: State,\n      v: {nodeID: string, mode: number}\n    ) {\n      if (v.mode>0) {\n        state.subscriptions[v.nodeID] = v.mode;\n      } else {\n        delete state.subscriptions[v.nodeID];\n      }\n    },\n  }\n};\n","export type TitleBox = {\n  position: {\n    x: number;\n    y: number;\n  };\n  bbox: {\n    width: number;\n    height: number;\n  };\n};\n\nexport type TitleBoxMap = Record<\n  string /* node_id */,\n  TitleBox /* title box attributes */\n>;\n\nexport interface State {\n  layerMap: Record<string, TitleBoxMap>;\n}\n\nexport const mutations = {\n  SET_MAP: \"SET_MAP\"\n};\n\nexport const store = {\n  namespaced: true,\n  state: {\n    layerMap: {}\n  },\n  mutations: {\n    [mutations.SET_MAP](\n      state: State,\n      v: { layerName: string; titleBoxMap: TitleBoxMap }\n    ) {\n      state.layerMap[v.layerName] = v.titleBoxMap;\n    }\n  }\n};\n","/**\n * This store contains nodeIDs that is permitted to move (change positions)\n * The idea is to restrict position change only for just added nodes and its neighbours\n * Otherwise there is risk that everybody will to do little tweaks in node coordinates that will\n * sum up in constant map visual mess\n */\nimport { Commit, Dispatch } from \"vuex\";\nconst PERMISSION_TIMEOUT = 60 * 60 * 1000; // time after which permit is revoked (in milliseconds)\n\nexport const mutations = {\n  ADD_NODES: \"ADD_NODES\",\n  REMOVE_NODES: \"REMOVE_NODES\"\n};\n\nexport const actions = {\n  CheckNodeID: \"CheckNodeID\"\n};\n\nexport interface State {\n  permittedNodeIDs: Record<string, number>; // key is nodeID, value is created_at\n}\n\nexport const store = {\n  namespaced: true,\n  state: {\n    permittedNodeIDs: {}\n  },\n  mutations: {\n    [mutations.ADD_NODES](state: State, nodeIDs: string) {\n      for (const nodeID of nodeIDs) {\n        state.permittedNodeIDs[nodeID] = new Date().getTime();\n      }\n    },\n    [mutations.REMOVE_NODES](state: State, nodeIDs: string) {\n      for (const nodeID of nodeIDs) {\n        delete state.permittedNodeIDs[nodeID];\n      }\n    }\n  },\n  actions: {\n    [actions.CheckNodeID](\n      { commit, state }: { commit: Commit; state: State },\n      nodeID: string\n    ) {\n      if (\n        !!state.permittedNodeIDs[nodeID] &&\n        new Date().getTime() <\n          state.permittedNodeIDs[nodeID] + PERMISSION_TIMEOUT\n      ) {\n        return true;\n      }\n      if (state.permittedNodeIDs[nodeID]) {\n        commit(mutations.REMOVE_NODES, [nodeID]);\n      }\n      return false;\n    }\n  }\n};\n","import { cloneDeep } from \"lodash\";\nimport { Point, Tree, TreeSkeleton, Viewport } from \"@/types/graphics\";\nimport { ErrorKV } from \"@/types/errorkv\";\nimport NewErrorKV from \"../tools/errorkv\";\nimport { getBoundingBorders, getVoronoiCells } from \"../tools/graphics\";\n\nexport const ROUND_EPSILON = 0;\n\n/**\n * Correct modulo on negative numbers\n * @param n\n * @param m\n */\nexport function mod(n: number, m: number): number {\n  return ((n % m) + m) % m;\n}\n\nexport function round(num: number): number {\n  const t = Math.pow(10, ROUND_EPSILON);\n  return Math.round(num * t) / t;\n}\n\nexport function sleep(ms: number) {\n  return new Promise(resolve => setTimeout(resolve, ms));\n}\n\n/* eslint-disable  @typescript-eslint/no-explicit-any */\nexport function clone(v: any): any {\n  return cloneDeep(v);\n}\n\nexport function generateTreeSkeleton(\n  levelsNum: number,\n  numOnLevel: number\n): TreeSkeleton {\n  let globalID = 0;\n  const root = { id: String(globalID), children: [] };\n  let toProcess: TreeSkeleton[] = [root];\n  for (let i = 1; i < levelsNum; i++) {\n    const nextToProcess = [];\n    while (toProcess.length) {\n      const node = toProcess.shift();\n      node!.children = [];\n      for (let j = 0; j < numOnLevel; j++) {\n        globalID++;\n        const child = { id: String(globalID) };\n        node!.children.push(child);\n        nextToProcess.push(child);\n      }\n    }\n    toProcess = nextToProcess;\n  }\n\n  return root;\n}\n\n/**\n * Fill TreeSkeleton with default values to make real Tree\n * @param sk\n */\nexport function skeletonToTree(sk: TreeSkeleton, idAsTitle: boolean): Tree {\n  const res = clone(sk);\n  const stack: TreeSkeleton[] = [res];\n  while (stack.length) {\n    const node = stack.pop();\n    if (!node) {\n      continue;\n    }\n    node.id = String(node.id);\n    if (!node.title) {\n      node.title = idAsTitle ? String(node.id) : \"\";\n    }\n    if (!node.position) {\n      node.position = { x: 0, y: 0 };\n    }\n    if (!node.children) {\n      node.children = [];\n    }\n    stack.push(...node.children);\n  }\n  return res;\n}\n\n/**\n * Traverse tree and fill position\n */\nexport function fillTreePositions(\n  tree: Tree,\n  rootWH: Viewport\n): ErrorKV | null {\n  if (tree.id !== \"0\") {\n    return NewErrorKV(\"fillTreePositions: root node id must be '0'\", { tree });\n  }\n  tree.position = { x: rootWH.width / 2, y: rootWH.height / 2 };\n  const nodeBorders: Record<string, { topLeft: Point; bottomRight: Point }> = {\n    0: {\n      topLeft: { x: 0, y: 0 },\n      bottomRight: { x: rootWH.width, y: rootWH.height }\n    }\n  };\n  const stack: Tree[] = [tree];\n  while (stack.length) {\n    const node = stack.pop();\n    if (!node || !node.children || !node.children.length) {\n      continue;\n    }\n    const borderBox = nodeBorders[node.id];\n    const height = borderBox.bottomRight.y - borderBox.topLeft.y;\n    const width = borderBox.bottomRight.x - borderBox.topLeft.x;\n    if (height > width) {\n      for (const i in node.children) {\n        node.children[i].position = {\n          x: node.position!.x,\n          y:\n            borderBox.topLeft.y +\n            (Number(i) + 1 / 2) * (height / node.children.length)\n        };\n      }\n    } else {\n      for (const i in node.children) {\n        node.children[i].position = {\n          x:\n            borderBox.topLeft.x +\n            ((Number(i) + 1 / 2) * width) / node.children.length,\n          y: node.position!.y\n        };\n      }\n    }\n\n    // compute children borders as voronoi cells bounding boxes\n    const [cells, err] = getVoronoiCells(\n      [\n        { x: borderBox.topLeft.x, y: borderBox.topLeft.y },\n        { x: borderBox.bottomRight.x, y: borderBox.topLeft.y },\n        { x: borderBox.bottomRight.x, y: borderBox.bottomRight.y },\n        { x: borderBox.topLeft.x, y: borderBox.bottomRight.y }\n      ],\n      node.children.map(ch => ch.position)\n    );\n    if (err) {\n      return NewErrorKV(\"fillTreePositions: error in getVoronoiCells\", { err });\n    }\n    for (const i in cells) {\n      const cellBBox = getBoundingBorders(cells[i].border);\n      nodeBorders[node.children[i].id] = {\n        topLeft: cellBBox.leftBottom,\n        bottomRight: cellBBox.rightTop\n      };\n    }\n\n    stack.push(...node.children);\n  }\n\n  return null;\n}\n\nexport function printError(msg: string, kv: any) {\n  if (!kv) {\n    console.error(msg);\n  }\n\n  // const callback = function(stackframes: StackFrame[]) {\n  //   const stringifiedStack = stackframes.map(function(sf) {\n  //     return sf.toString();\n  //   }).join('\\n');\n  //   console.error(msg, stringifiedStack);\n  // };\n  //\n  // const errBack = function(e: Error) { console.log(e.message); };\n  //\n  const kvArr = [];\n  for (const i in kv) {\n    kvArr.push(i, kv[i]);\n    // if (kv[i] instanceof Error) {\n    //   StackTrace.get({offline: true}).then(callback).catch(errBack);\n    // }\n  }\n\n  console.error(msg, ...kvArr);\n}\n","import { MapNode, Point, Tree } from \"@/types/graphics\";\nimport {\n  convertPosition,\n  getMaxDiagonal,\n  getVectorLength,\n  mergeMapNodeLayers,\n  treeToMapNodeLayers,\n  vectorOnNumber\n} from \"../../tools/graphics\";\nimport { ErrorKV } from \"@/types/errorkv\";\nimport NewErrorKV from \"../../tools/errorkv\";\nimport { clone } from \"../../tools/utils\";\nimport { NodeRecordItem } from \"@/store/tree/index\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nexport function findMapNode(\n  id: string,\n  mapNodeLayers: Array<Record<string, MapNode>>\n): [MapNode | null, number | null] {\n  for (const level in mapNodeLayers) {\n    const layer = mapNodeLayers[Number(level)];\n    if (layer && layer[id]) {\n      return [layer[id], Number(level)];\n    }\n  }\n\n  return [null, null];\n}\n\nexport function findMapNodes(\n  ids: string[],\n  mapNodeLayers: Array<Record<string, MapNode>>\n): MapNode[] {\n  const result: MapNode[] = [];\n  for (const layer of mapNodeLayers) {\n    if (!layer) {\n      continue;\n    }\n    for (const id of ids) {\n      if (layer[id]) {\n        result.push(layer[id]);\n      }\n    }\n  }\n\n  return result;\n}\n\nexport function createNewNode(title: string, center: Point): Tree {\n  return {\n    id: uuidv4(),\n    position: center,\n    title: title,\n    children: []\n  } as Tree;\n}\n\n/**\n * Вычисляет где можно поставить центр для нового подузла узла parent\n *\n * Логика добавления следующая.\n * Обозначим координаты центра узла parent как (Xc, Yc)\n * Если в узле нет ни одного подузла, то находим наибольшее расстояние между (Xc, Yc)\n * и вершинами границы, делим вектор соединяющий (Xc, Yc) и эту вершину пополам\n * и ставим там центр нового подузла\n *\n * Если в узле есть подузлы, берем подузел с наибольшей диагональю,\n * находим в нем наибольшую диагональ соединяющую 2 вершины границы,\n * делим ее пополам, старый центр ставим в центре одной половины, новый в центре другой.\n *\n * Добавляем рандом (см баг https://sci-map.atlassian.net/browse/SM-118)\n * @param parent\n * @param mapNodeLayers\n * @param addRandom\n */\nexport function getNewNodeCenter(\n  parent: Tree,\n  mapNodeLayers: Array<Record<number, MapNode>>,\n  addRandom: boolean\n): [\n  Point | null, // new node center\n  Tree | null, // existing node with corrected center (if any)\n  ErrorKV // error (if any)\n] {\n  const [parentMapNode] = findMapNode(parent.id, mapNodeLayers);\n  if (parentMapNode === null) {\n    return [\n      null,\n      null,\n      NewErrorKV(\"getNewNodeCenter: cannot find mapNode for parent\", {\n        parentId: parent.id,\n        mapNodeLayers: mapNodeLayers\n      })\n    ];\n  }\n\n  if (parent.children.length === 0) {\n    const fromCenterVectors = parentMapNode.border.map(p => ({\n      from: parentMapNode.center,\n      to: p\n    }));\n    let maxFromCenterVector = fromCenterVectors[0];\n    for (const v of fromCenterVectors) {\n      if (getVectorLength(v) > getVectorLength(maxFromCenterVector)) {\n        maxFromCenterVector = v;\n      }\n    }\n\n    let coeff = 1 / 2;\n    if (addRandom) {\n      coeff = Math.random() * (1 / 2) + 1 / 4;\n    }\n\n    return [\n      {\n        x:\n          maxFromCenterVector.from.x +\n          coeff * (maxFromCenterVector.to.x - maxFromCenterVector.from.x),\n        y:\n          maxFromCenterVector.from.y +\n          coeff * (maxFromCenterVector.to.y - maxFromCenterVector.from.y)\n      },\n      null,\n      null\n    ];\n  } else {\n    const maxDiagChild = parent.children[0];\n    let [maxDiagChildMapNode] = findMapNode(maxDiagChild.id, mapNodeLayers);\n    if (maxDiagChildMapNode === null) {\n      return [\n        null,\n        null,\n        NewErrorKV(\"getNewNodeCenter: cannot find maxDiagChild in layers\", {\n          maxDiagChildId: maxDiagChild.id,\n          mapNodeLayers: mapNodeLayers\n        })\n      ];\n    }\n    for (const child of parent.children) {\n      const [childMapNode] = findMapNode(child.id, mapNodeLayers);\n      if (childMapNode === null) {\n        return [\n          null,\n          null,\n          NewErrorKV(\"getNewNodeCenter: cannot find child in layers\", {\n            childId: child.id,\n            mapNodeLayers: mapNodeLayers\n          })\n        ];\n      }\n\n      const [childDiag, err1] = getMaxDiagonal(childMapNode.border);\n      if (err1) {\n        return [\n          null,\n          null,\n          NewErrorKV(\"getNewNodeCenter: error getMaxDiagonal\", {\n            childMapNode,\n            err1\n          })\n        ];\n      }\n      const [maxDiag, err2] = getMaxDiagonal(maxDiagChildMapNode.border);\n      if (err2) {\n        return [\n          null,\n          null,\n          NewErrorKV(\"getNewNodeCenter: error getMaxDiagonal\", {\n            maxDiagChildMapNode,\n            err2\n          })\n        ];\n      }\n      if (getVectorLength(childDiag) > getVectorLength(maxDiag)) {\n        maxDiagChildMapNode = childMapNode;\n      }\n    }\n\n    let coeff = 3 / 4;\n    if (addRandom) {\n      coeff = Math.random() * (1 / 4) + 2.5 / 4;\n    }\n\n    const [finalMaxDiag] = getMaxDiagonal(maxDiagChildMapNode.border);\n    const newNodeCenter = vectorOnNumber(finalMaxDiag!, coeff).to;\n    const modifiedNode = clone(maxDiagChild);\n    modifiedNode.position = vectorOnNumber(finalMaxDiag!, 1 / 4).to;\n    return [newNodeCenter, modifiedNode, null];\n  }\n}\n\nexport function updatePosition(\n  state: {\n    tree: Tree | null;\n    nodeRecord: Record<string, NodeRecordItem>;\n    mapNodeLayers: Array<Record<string, MapNode>>;\n  },\n  v: { nodeId: string; position: Point }\n): ErrorKV {\n  if (state.tree == null) {\n    return NewErrorKV(\"state.tree == null\", {});\n  }\n\n  const item = state.nodeRecord[v.nodeId];\n  if (!item) {\n    return NewErrorKV(\"updateNodePosition: cannot find node in nodeRecord\", {\n      \"v.nodeId\": v.nodeId,\n      \"state.nodeRecord\": state.nodeRecord\n    });\n  }\n\n  if (!item.parent) {\n    return NewErrorKV(\"updateNodePosition: cannot move root of tree\", {\n      \"v.nodeId\": v.nodeId\n    });\n  }\n\n  const [normalizedPosition] = convertPosition(\n    \"normalize\",\n    v.position,\n    item.parent.id,\n    state.mapNodeLayers\n  );\n  item.node.position = normalizedPosition!;\n\n  // Если мы меняем один узел, то могут поменяться границы всех соседей\n  // так что надо действовать так как будто поменялись границы всех подузлов родителя узла\n  const [parentMapNode, layerLevel] = findMapNode(\n    item.parent.id,\n    state.mapNodeLayers\n  );\n  if (!parentMapNode || layerLevel === null) {\n    return NewErrorKV(\"updateNodePosition: cannot find mapNode for parent\", {\n      id: item.parent.id,\n      \"state.mapNodeLayers\": state.mapNodeLayers\n    });\n  }\n  const [ls, err] = treeToMapNodeLayers(\n    item.parent,\n    parentMapNode.border,\n    parentMapNode.center\n  );\n  if (ls == null || err != null) {\n    return NewErrorKV(\"updateNodePosition: create layers for parent\", {\n      id: item.parent.id,\n      parentMapNode: parentMapNode\n    });\n  }\n  return mergeMapNodeLayers(state.mapNodeLayers, ls, layerLevel);\n}\n","import {\n  Tree,\n  Point,\n  Polygon,\n  VoronoiCell,\n  MapNode,\n  Vector,\n  Rectangle\n} from \"@/types/graphics\";\nimport * as turf from \"@turf/turf\";\nimport { ErrorKV } from \"@/types/errorkv\";\nimport { default as NewErrorKV } from \"../tools/errorkv\";\nimport { NodeRecordItem } from \"@/store/tree\";\nimport { polygonArea } from \"d3-polygon\";\nimport polygonClipping from \"polygon-clipping\";\nimport { clone, mod, round } from \"../tools/utils\";\nimport { findMapNode } from \"../store/tree/helpers\";\nimport api from \"../api/api\";\n\nconst NORMALIZED_BORDER = [\n  { x: 0, y: 0 },\n  { x: 0, y: api.ST_HEIGHT },\n  { x: api.ST_WIDTH, y: api.ST_HEIGHT },\n  { x: api.ST_WIDTH, y: 0 }\n];\n\nexport function getVectorLength(v: Vector): number {\n  return Math.sqrt(\n    Math.pow(v.from.x - v.to.x, 2) + Math.pow(v.from.y - v.to.y, 2)\n  );\n}\n\nexport function polygonToTurf(\n  p: Polygon\n): turf.Feature<turf.Polygon, turf.Properties> {\n  if (!p) {\n    throw new Error(\"polygonToTurf: p is empty\");\n  }\n  const pp = p.map(point => [point.x, point.y]);\n  pp.push([p[0].x, p[0].y]);\n  return turf.polygon([pp]);\n}\n\nexport function isInside(point: Point, polygon: Polygon): boolean {\n  return turf.booleanPointInPolygon(\n    turf.point([point.x, point.y]),\n    polygonToTurf(polygon)\n  );\n}\n\nexport function polygonToPCPolygon(p: Polygon): polygonClipping.Polygon {\n  const pp = p.map(point => [point.x, point.y] as polygonClipping.Pair);\n  pp.push([p[0].x, p[0].y]);\n  return [pp];\n}\n\nexport function area(p: Polygon): number {\n  return Math.abs(polygonArea(p.map(point => [point.x, point.y])));\n}\n\nexport function intersect(\n  p1: Polygon,\n  p2: Polygon\n): [Polygon[] | null, ErrorKV] {\n  // polygonClipping.intersection does not like digits after point\n  // so we find the least multiplier that gives area > 1000 for polygon\n  // and then round coordinates\n  let np1: Polygon = clone(p1);\n  let np2: Polygon = clone(p2);\n  let cf = 1;\n  while (area(np1) < 1000 && area(np2) < 1000) {\n    cf = cf * 10;\n    np1 = p1.map(p => ({ x: p.x * cf, y: p.y * cf }));\n    np2 = p2.map(p => ({ x: p.x * cf, y: p.y * cf }));\n  }\n  np1 = np1.map(p => ({ x: round(p.x), y: round(p.y) }));\n  np2 = np2.map(p => ({ x: round(p.x), y: round(p.y) }));\n\n  const tp1 = polygonToPCPolygon(np1);\n  const tp2 = polygonToPCPolygon(np2);\n  if (tp1 == null || tp2 == null) {\n    return [\n      null,\n      NewErrorKV(\"intersect: error in polygonToPCPolygon\", { p1: p1, p2: p2 })\n    ];\n  }\n\n  // polygonClipping.intersection\n  const polygonIntersect = polygonClipping.intersection(tp1, tp2);\n  if (polygonIntersect == null || !polygonIntersect.length) {\n    return [[], null];\n  }\n\n  const resultPolys = [];\n\n  for (const poly of polygonIntersect[0]) {\n    const resultPoly = [];\n    for (const p of poly) {\n      resultPoly.push({ x: p[0] / cf, y: p[1] / cf });\n    }\n    // удаляем последнюю точку полигона потому что она всегда совпадает с первой\n    resultPoly.pop();\n    resultPolys.push(resultPoly);\n  }\n\n  return [resultPolys, null];\n}\n\n// Возвращает левый нижний и правый верхний углы описанного вокруг Polygon квадрата\nexport function getBoundingBorders(border: Polygon): Rectangle {\n  if (!border) {\n    console.error(\"bad border\", border);\n  }\n  const minX = border.reduce((previousValue, currentValue) =>\n    previousValue.x > currentValue.x ? currentValue : previousValue\n  ).x;\n  const minY = border.reduce((previousValue, currentValue) =>\n    previousValue.y > currentValue.y ? currentValue : previousValue\n  ).y;\n  const maxX = border.reduce((previousValue, currentValue) =>\n    previousValue.x < currentValue.x ? currentValue : previousValue\n  ).x;\n  const maxY = border.reduce((previousValue, currentValue) =>\n    previousValue.y < currentValue.y ? currentValue : previousValue\n  ).y;\n  return {\n    leftBottom: { x: minX, y: minY },\n    rightTop: { x: maxX, y: maxY }\n  };\n}\n\nexport function getVoronoiCellsInSquare(\n  centers: Point[],\n  leftBottom: Point,\n  rightTop: Point\n): [Record<number, Polygon>, ErrorKV] {\n  const turfPoints = centers.map(p => turf.point([p.x, p.y]));\n  const collection = turf.featureCollection(turfPoints);\n  const cells = turf.voronoi(collection, {\n    bbox: [leftBottom.x, leftBottom.y, rightTop.x, rightTop.y]\n  });\n  const cellMap: Record<number, Polygon> = {};\n  let index = 0;\n  for (const cell of cells.features) {\n    if (!cell) {\n      return [\n        {},\n        NewErrorKV(\"getVoronoiCellsInSquare: undefined cell\", {\n          centers,\n          leftBottom,\n          rightTop,\n          cells\n        })\n      ];\n    }\n    const cellBorder = cell.geometry!.coordinates[0].map(p => ({\n      x: p[0],\n      y: p[1]\n    }));\n    cellBorder.pop(); // удаляем последнюю точку полигона потому что она всегда совпадает с первой\n    cellMap[index] = cellBorder;\n    index++;\n  }\n\n  return [cellMap, null];\n}\n\nexport function getVoronoiCells(\n  outerBorder: Polygon, //(граница массива точек)\n  centers: Point[] //(точки внутри этой границы)\n): [VoronoiCell[], ErrorKV] {\n  if (!outerBorder) {\n    return [\n      [],\n      NewErrorKV(\"getVoronoiCells: bad outerBorder\", { outerBorder, centers })\n    ];\n  }\n  const bb = getBoundingBorders(outerBorder);\n  const [cellMap, err] = getVoronoiCellsInSquare(\n    centers,\n    bb.leftBottom,\n    bb.rightTop\n  );\n  if (err) {\n    return [\n      [],\n      NewErrorKV(\"getVoronoiCells: error in getVoronoiCellsInSquare\", {\n        err,\n        bb,\n        centers\n      })\n    ];\n  }\n\n  const res = [];\n  for (const index in centers) {\n    if (!cellMap[index]) {\n      return [\n        [],\n        NewErrorKV(\"Cannot find index in cellMap\", {\n          index: index,\n          centers: centers,\n          cellMap: cellMap,\n          BoundingBorders: bb,\n          outerBorder\n        })\n      ];\n    }\n\n    const [intersections, err] = intersect(cellMap[index], outerBorder); // мы хотим чтобы граница всех cell совпадала с outerBorder\n    if (intersections == null || err != null) {\n      return [\n        [],\n        NewErrorKV(\"getVoronoiCells error\", {\n          err,\n          cellBorder: cellMap[index],\n          outerBorder\n        })\n      ];\n    }\n\n    if (intersections == []) {\n      return [\n        [],\n        NewErrorKV(\"Voronoi cell has no intersection with outerBorder\", {\n          point: centers[index]\n        })\n      ];\n    }\n    if (intersections.length > 1) {\n      return [\n        [],\n        NewErrorKV(\n          \"Voronoi cell has more than one intersection with outerBorder\",\n          { point: centers[index] }\n        )\n      ];\n    }\n    res.push({\n      border: intersections[0],\n      center: centers[index]\n    });\n  }\n\n  return [res, null];\n}\n\nexport function getVoronoiCellRecords(\n  outerBorder: Polygon, //(граница массива точек)\n  centers: Record<string, Point> //(точки внутри этой границы)\n): [Record<string, Polygon>, ErrorKV] {\n  const result: Record<string, Polygon> = {};\n  const ids: string[] = [];\n  const centersArray: Point[] = [];\n  for (const id in centers) {\n    ids.push(id);\n    centersArray.push(centers[id]);\n  }\n\n  const [cells, err] = getVoronoiCells(outerBorder, centersArray);\n  if (err !== null) {\n    return [{}, err];\n  }\n  for (const i in ids) {\n    result[ids[i]] = cells[i].border;\n  }\n\n  return [result, null];\n}\n\nexport function polygonFill(\n  selectedNodeId: string,\n  currentNodeId: string,\n  selectedNodePreconditionIds: string[]\n): string {\n  if (selectedNodeId && selectedNodeId == currentNodeId) {\n    return \"#f3afaf\";\n  }\n  if (\n    selectedNodePreconditionIds &&\n    selectedNodePreconditionIds.indexOf(currentNodeId) != -1\n  ) {\n    return \"#62f363\";\n  }\n  return \"transparent\";\n}\n\nexport function polygonFillOpacity(\n  selectedNodeId: string,\n  currentNodeId: string,\n  selectedNodePreconditionIds: string[]\n): string {\n  if (selectedNodeId && selectedNodeId == currentNodeId) {\n    return \"0.2\";\n  }\n  if (\n    selectedNodePreconditionIds &&\n    selectedNodePreconditionIds.indexOf(currentNodeId) != -1\n  ) {\n    return \"0.2\";\n  }\n  return \"0\";\n}\n\nexport function polygonToPath(polygon: Polygon): string {\n  return polygon.map((point: Point) => `${point.x} ${point.y}`).join(\",\");\n}\n\nexport function treeToNodeRecord(tree: Tree): Record<number, NodeRecordItem> {\n  const nodeRecord: Record<string, NodeRecordItem> = {};\n  const stack: NodeRecordItem[] = [{ node: tree, parent: null }];\n  while (stack.length) {\n    const item = stack.pop();\n    if (!item) {\n      break;\n    }\n    nodeRecord[item.node.id] = item;\n    stack.push(\n      ...item.node.children.map(child => ({\n        node: child,\n        parent: item.node\n      }))\n    );\n  }\n\n  return nodeRecord;\n}\n\nexport function transferToPoint(vector: Vector, point: Point): Vector {\n  return {\n    from: {\n      x: point.x,\n      y: point.y\n    },\n    to: {\n      x: point.x + (vector.to.x - vector.from.x),\n      y: point.y + (vector.to.y - vector.from.y)\n    }\n  };\n}\n\nexport function pointToVector(p: Point): Vector {\n  return { from: { x: 0, y: 0 }, to: p };\n}\n\nexport function addVector(a: Vector, b: Vector): Vector {\n  const bTransferred = transferToPoint(b, a.to);\n  return {\n    from: { x: a.from.x, y: a.from.y },\n    to: { x: bTransferred.to.x, y: bTransferred.to.y }\n  };\n}\n\nexport function subtractVector(a: Vector, b: Vector): Vector {\n  return transferToPoint(\n    addVector(\n      { from: { x: b.from.x, y: b.from.y }, to: { x: -b.to.x, y: -b.to.y } },\n      a\n    ),\n    transferToPoint(b, a.from).to\n  );\n}\n\nexport function vectorOnNumber(a: Vector, c: number): Vector {\n  const aTr = transferToPoint(a, { x: 0, y: 0 });\n  return transferToPoint(\n    { from: { x: 0, y: 0 }, to: { x: aTr.to.x * c, y: aTr.to.y * c } },\n    a.from\n  );\n}\n\nexport function getRectangleCenter(s: Rectangle): Point {\n  const diagonal = subtractVector(\n    pointToVector(s.rightTop),\n    pointToVector(s.leftBottom)\n  );\n  return vectorOnNumber(diagonal, 1 / 2).to;\n}\n\nexport function transferPointOnVector(p: Point, v: Vector): Point {\n  return transferToPoint(v, p).to;\n}\n\n// math: https://web.archive.org/web/20060911055655/http://local.wasp.uwa.edu.au/~pbourke/geometry/lineline2d/\nexport function getVectorIntersection(v1: Vector, v2: Vector): Point | null {\n  const x1 = v1.from.x;\n  const y1 = v1.from.y;\n  const x2 = v1.to.x;\n  const y2 = v1.to.y;\n  const x3 = v2.from.x;\n  const y3 = v2.from.y;\n  const x4 = v2.to.x;\n  const y4 = v2.to.y;\n  const denom = (y4 - y3) * (x2 - x1) - (x4 - x3) * (y2 - y1);\n  const numeA = (x4 - x3) * (y1 - y3) - (y4 - y3) * (x1 - x3);\n  const numeB = (x2 - x1) * (y1 - y3) - (y2 - y1) * (x1 - x3);\n\n  if (denom == 0) {\n    return null;\n  }\n\n  const uA = numeA / denom;\n  const uB = numeB / denom;\n\n  if (uA >= 0 && uA <= 1 && uB >= 0 && uB <= 1) {\n    return {\n      x: x1 + uA * (x2 - x1),\n      y: y1 + uA * (y2 - y1)\n    };\n  }\n\n  return null;\n}\n\nexport function morphChildrenPoints(\n  oldBorder: Polygon,\n  newBorder: Polygon,\n  oldPoints: Record<string, Point>\n): [Record<string, Point> | null, ErrorKV] {\n  const oldCenterTf = turf.centerOfMass(polygonToTurf(oldBorder)).geometry;\n  if (oldCenterTf == null) {\n    return [\n      null,\n      NewErrorKV(\"morphChildrenPoints oldBorder centerOfMass error\", {\n        oldBorder: oldBorder,\n        oldPoints: oldPoints\n      })\n    ];\n  }\n  const newCenterTf = turf.centerOfMass(polygonToTurf(newBorder)).geometry;\n  if (newCenterTf == null) {\n    return [\n      null,\n      NewErrorKV(\"morphChildrenPoints newBorder centerOfMass error\", {\n        newBorder: newBorder,\n        oldPoints: oldPoints\n      })\n    ];\n  }\n  const oldCenter = {\n    x: oldCenterTf.coordinates[0],\n    y: oldCenterTf.coordinates[1]\n  };\n  const newCenter = {\n    x: newCenterTf.coordinates[0],\n    y: newCenterTf.coordinates[1]\n  };\n\n  // Move old node and its children to new node center\n  oldBorder = oldBorder.map(\n    (p): Point => {\n      return transferPointOnVector(p, { from: oldCenter, to: newCenter });\n    }\n  );\n  for (const id in oldPoints) {\n    oldPoints[id] = transferPointOnVector(oldPoints[id], {\n      from: oldCenter,\n      to: newCenter\n    });\n  }\n\n  // morph children\n  const maxDiameter = Math.max(\n    getVectorLength({\n      from: getBoundingBorders(oldBorder).leftBottom,\n      to: getBoundingBorders(oldBorder).rightTop\n    }),\n    getVectorLength({\n      from: getBoundingBorders(newBorder).leftBottom,\n      to: getBoundingBorders(newBorder).rightTop\n    })\n  );\n\n  const newPoints: Record<string, Point> = {};\n  for (const id in oldPoints) {\n    const oldPoint = oldPoints[id];\n    if (newCenter.x == oldPoint.x && newCenter.y == oldPoint.y) {\n      newPoints[id] = oldPoint;\n      continue;\n    }\n    let centerToPoint = { from: newCenter, to: oldPoints[id] };\n    // enlarge it to guarantee intersect with both newBorder and oldBorder (transferred to newBorder center)\n    centerToPoint = vectorOnNumber(\n      centerToPoint,\n      maxDiameter / getVectorLength(centerToPoint)\n    );\n    let oldBorderIntersection = null;\n    for (const i in oldBorder) {\n      const segment = {\n        from: oldBorder[i],\n        to: oldBorder[(Number(i) + 1) % oldBorder.length]\n      };\n      const p = getVectorIntersection(centerToPoint, segment);\n      if (p != null) {\n        oldBorderIntersection = p;\n        break;\n      }\n    }\n    if (oldBorderIntersection == null) {\n      return [\n        null,\n        NewErrorKV(\n          \"morphChildrenPoints cannot find intersection with oldBorder\",\n          {\n            centerToPoint: centerToPoint,\n            oldBorder: oldBorder\n          }\n        )\n      ];\n    }\n\n    let newBorderIntersection = null;\n    for (const i in newBorder) {\n      const segment = {\n        from: newBorder[i],\n        to: newBorder[(Number(i) + 1) % newBorder.length]\n      };\n      const p = getVectorIntersection(centerToPoint, segment);\n      if (p != null) {\n        newBorderIntersection = p;\n        break;\n      }\n    }\n    if (newBorderIntersection == null) {\n      return [\n        null,\n        NewErrorKV(\n          \"morphChildrenPoints cannot find intersection with newBorder\",\n          {\n            centerToPoint: centerToPoint,\n            newBorder: newBorder\n          }\n        )\n      ];\n    }\n\n    if (\n      oldBorderIntersection.x == newBorderIntersection.x &&\n      oldBorderIntersection.y == newBorderIntersection.y\n    ) {\n      newPoints[id] = oldPoint;\n      continue;\n    }\n\n    const coeff =\n      getVectorLength({ from: newCenter, to: newBorderIntersection }) /\n      getVectorLength({ from: newCenter, to: oldBorderIntersection });\n    newPoints[id] = vectorOnNumber({ from: newCenter, to: oldPoint }, coeff).to;\n  }\n\n  return [newPoints, null];\n}\n\nexport function NewEmptyVector(): Vector {\n  return { from: { x: 0, y: 0 }, to: { x: 0, y: 0 } };\n}\n\nexport function getMaxDiagonal(polygon: Polygon): [Vector, ErrorKV] {\n  if (!polygon || polygon.length < 3) {\n    return [\n      NewEmptyVector(),\n      NewErrorKV(\"getMaxDiagonal: bad polygon\", { polygon })\n    ];\n  }\n\n  const diagonals: Vector[] = [];\n  if (polygon.length == 3) {\n    // triangle does not has diagonals, so me emulate them\n    for (const i in polygon) {\n      const middle = vectorOnNumber(\n        {\n          from: polygon[mod(Number(i) - 1, polygon.length)],\n          to: polygon[mod(Number(i) + 1, polygon.length)]\n        },\n        1 / 2\n      );\n      diagonals.push({ from: polygon[i], to: middle.to });\n    }\n  } else {\n    for (const i in polygon) {\n      for (const j in polygon) {\n        if (\n          Number(j) != mod(Number(i) - 1, polygon.length) &&\n          Number(j) != Number(i) &&\n          Number(j) != mod(Number(i) + 1, polygon.length)\n        ) {\n          diagonals.push({ from: polygon[i], to: polygon[j] });\n        }\n      }\n    }\n  }\n\n  let maxDiagonal = diagonals[0];\n  for (const diag of diagonals) {\n    if (getVectorLength(diag) > getVectorLength(maxDiagonal)) {\n      maxDiagonal = diag;\n    }\n  }\n\n  return [maxDiagonal, null];\n}\n\nexport function convertPosition(\n  type: \"normalize\" | \"denormalize\",\n  position: Point,\n  parentID: string | null,\n  mapNodeLayers: Array<Record<string, MapNode>>\n): [Point | null, ErrorKV] {\n  let convertedPosition: Point;\n  if (parentID) {\n    const [parentMapNode] = findMapNode(parentID, mapNodeLayers);\n    if (!parentMapNode) {\n      return [\n        null,\n        NewErrorKV(\"UPDATE_NODE: Cannot findMapNode\", { id: parentID })\n      ];\n    }\n\n    let morphedPositions: Record<string, Point> | null, err: ErrorKV;\n    if (type === \"denormalize\") {\n      if (!isInside(position, NORMALIZED_BORDER)) {\n        return [\n          null,\n          NewErrorKV(\"convertPosition: position outside NORMALIZED_BORDER\", {\n            normalizedBorder: NORMALIZED_BORDER,\n            position,\n            parentID\n          })\n        ];\n      }\n      [morphedPositions, err] = morphChildrenPoints(\n        NORMALIZED_BORDER,\n        parentMapNode.border,\n        { tmp: position }\n      );\n    } else {\n      if (!isInside(position, parentMapNode.border)) {\n        return [\n          null,\n          NewErrorKV(\"convertPosition: position outside parentMapNode.border\", {\n            \"parentMapNode.border\": parentMapNode.border,\n            \"parentMapNode.center\": parentMapNode.center,\n            position,\n            parentID\n          })\n        ];\n      }\n      [morphedPositions, err] = morphChildrenPoints(\n        parentMapNode.border,\n        NORMALIZED_BORDER,\n        { tmp: position }\n      );\n      if (err !== null) {\n        return [\n          null,\n          NewErrorKV(\"UPDATE_NODE: Cannot morphChildrenPoints\", {\n            type: type,\n            normalizedBorder: NORMALIZED_BORDER,\n            \"parentMapNode.border\": parentMapNode.border,\n            \"dbNode.position\": position\n          })\n        ];\n      }\n      // make sure that after normalization position is strictly inside border\n      if (morphedPositions![\"tmp\"].x < 0) {\n        morphedPositions![\"tmp\"].x = 1;\n      }\n      if (morphedPositions![\"tmp\"].x > api.ST_WIDTH) {\n        morphedPositions![\"tmp\"].x = api.ST_WIDTH - 1;\n      }\n      if (morphedPositions![\"tmp\"].y < 0) {\n        morphedPositions![\"tmp\"].y = 1;\n      }\n      if (morphedPositions![\"tmp\"].y > api.ST_HEIGHT) {\n        morphedPositions![\"tmp\"].y = api.ST_HEIGHT - 1;\n      }\n    }\n    if (err !== null) {\n      return [\n        null,\n        NewErrorKV(\"UPDATE_NODE: Cannot morphChildrenPoints\", {\n          type: type,\n          normalizedBorder: NORMALIZED_BORDER,\n          \"parentMapNode.border\": parentMapNode.border,\n          \"dbNode.position\": position\n        })\n      ];\n    }\n    convertedPosition = morphedPositions![\"tmp\"];\n  } else {\n    if (type === \"denormalize\") {\n      convertedPosition = { x: api.ROOT_CENTER_X, y: api.ROOT_CENTER_Y };\n    } else {\n      convertedPosition = { x: api.ST_WIDTH / 2, y: api.ST_HEIGHT / 2 };\n    }\n  }\n\n  return [convertedPosition, null];\n}\n\n/**\n *\n * @param tree\n * @param rootBorder\n * @param rootPosition\n */\nexport function treeToMapNodeLayers(\n  tree: Tree,\n  rootBorder: Polygon,\n  rootPosition: Point\n): [Array<Record<string, MapNode>> | null, ErrorKV] {\n  if (Object.keys(tree).length == 0) {\n    return [[], null];\n  }\n  const treeLayers: Array<Array<Tree>> = [[tree]];\n  const mapNodeLayers: Array<Record<string, MapNode>> = [\n    {\n      [tree.id]: {\n        id: tree.id,\n        border: rootBorder,\n        title: tree.title,\n        center: rootPosition\n      }\n    }\n  ];\n  /*eslint no-constant-condition: [\"error\", { \"checkLoops\": false }]*/\n  while (true) {\n    const lastTreeLayer = treeLayers[treeLayers.length - 1];\n    const lastMapNodeLayer = mapNodeLayers[treeLayers.length - 1];\n    const newTreeLayer = [];\n    const newMapNodeLayer: Record<string, MapNode> = {};\n    for (const treeNode of lastTreeLayer) {\n      if (!treeNode.children) {\n        return [\n          null,\n          NewErrorKV(\"treeToMapNodeLayers: treeNode with children undefined\", {\n            treeNode\n          })\n        ];\n      }\n      if (!treeNode.children.length) {\n        continue;\n      }\n\n      // check that no two children have the same center\n      const tmpMap = {} as Record<string, string>;\n      let strPos = \"\";\n      for (const i in treeNode.children) {\n        strPos = JSON.stringify(treeNode.children[i].position);\n        if (tmpMap[strPos] && tmpMap[strPos].length > 0) {\n          return [\n            null,\n            NewErrorKV(\"two children has the same center\", {\n              firstId: tmpMap[strPos],\n              secondId: treeNode.children[i].id\n            })\n          ];\n        } else {\n          tmpMap[strPos] = treeNode.children[i].id;\n        }\n      }\n\n      newTreeLayer.push(...treeNode.children);\n      if (!lastMapNodeLayer[treeNode.id]) {\n        return [\n          null,\n          NewErrorKV(\"Cannot find node in mapNodeLayers\", {\n            layer: mapNodeLayers[mapNodeLayers.length - 1],\n            treeNode: treeNode\n          })\n        ];\n      }\n\n      // denormalize positions\n      const treeNodeChildren = clone(treeNode.children) as Array<Tree>;\n      for (const child of treeNodeChildren) {\n        const [denormalizedPosition, err] = convertPosition(\n          \"denormalize\",\n          child.position,\n          treeNode.id,\n          [lastMapNodeLayer]\n        );\n        if (err) {\n          return [null, err];\n        }\n        child.position = denormalizedPosition!;\n      }\n      const [cells, error] = getVoronoiCells(\n        lastMapNodeLayer[treeNode.id].border,\n        treeNodeChildren.map(ch => ({ x: ch.position.x, y: ch.position.y }))\n      );\n      if (error != null) {\n        return [null, error];\n      }\n\n      for (const cell of cells) {\n        for (const child of treeNodeChildren) {\n          if (\n            child.position.x == cell.center.x &&\n            child.position.y == cell.center.y\n          ) {\n            newMapNodeLayer[child.id] = {\n              id: child.id,\n              title: child.title,\n              center: child.position,\n              border: cell.border\n            };\n          }\n        }\n      }\n    }\n\n    if (newTreeLayer.length) {\n      treeLayers.push(newTreeLayer);\n      mapNodeLayers.push(newMapNodeLayer);\n    } else {\n      return [mapNodeLayers, null];\n    }\n  }\n}\n\nexport function mergeMapNodeLayers(\n  recipientLayers: Record<string, MapNode>[],\n  insertedLayers: Record<string, MapNode>[],\n  startFromLevel: number\n): ErrorKV {\n  if (startFromLevel >= recipientLayers.length || startFromLevel < 0) {\n    return NewErrorKV(\n      \"startFromLevel >= recipientLayers.length or startFromLevel < 0\",\n      {\n        startFromLevel,\n        \"recipientLayers.length\": recipientLayers.length\n      }\n    );\n  }\n  let i = startFromLevel;\n  while (i < startFromLevel + insertedLayers.length) {\n    for (const id in insertedLayers[i - startFromLevel]) {\n      recipientLayers[i][id] = insertedLayers[i - startFromLevel][id];\n    }\n    i++;\n  }\n\n  return null;\n}\n","import { clone } from \"@/tools/utils\";\nimport { Commit } from \"vuex\";\nimport api from \"@/api/api\";\nimport { ErrorKV } from \"@/types/errorkv\";\nimport { State as UserState } from \"@/store/user\";\n\nexport type NodeContent = {\n  nodeID: string;\n  content: string;\n};\n\n// user private comment\nexport type NodeComment = {\n  nodeID: string;\n  comment: string;\n};\n\nexport interface State {\n  nodeContents: Record<string, NodeContent>;\n  userNodeComments: Record<string, NodeComment>;\n}\n\nexport const mutations = {\n  SET_CONTENTS: \"SET_CONTENTS\",\n  SET_USER_COMMENTS: \"SET_USER_COMMENTS\",\n  SET_NODE_CONTENT: \"SET_NODE_CONTENT\",\n  SET_NODE_COMMENT: \"SET_NODE_COMMENT\"\n};\n\nexport const actions = {\n  getNodeContent: \"getNodeContent\",\n  setNodeContent: \"setNodeContent\",\n  setNodeComment: \"setNodeComment\"\n};\n\nexport const EmptyNodeContent = {\n  nodeID: \"\",\n  content: \"\"\n} as NodeContent;\n\nfunction createContentIfNotExist(\n  nodeContents: Record<string, NodeContent>,\n  nodeID: string\n) {\n  if (!nodeContents[nodeID]) {\n    nodeContents[nodeID] = clone(EmptyNodeContent);\n    nodeContents[nodeID].nodeID = nodeID;\n  }\n}\n\nexport const EmptyNodeComment = {\n  nodeID: \"\",\n  comment: \"\"\n} as NodeComment;\n\nfunction createCommentIfNotExist(\n  userNodeComments: Record<string, NodeComment>,\n  nodeID: string\n) {\n  if (!userNodeComments[nodeID]) {\n    userNodeComments[nodeID] = clone(EmptyNodeComment);\n    userNodeComments[nodeID].nodeID = nodeID;\n  }\n}\n\nexport const store = {\n  namespaced: true,\n  state: {\n    nodeContents: {} as Record<string, NodeContent>,\n    userNodeComments: {} as Record<string, NodeComment>\n  } as State,\n  actions: {\n    [actions.getNodeContent](\n      { state }: { state: State },\n      nodeID: string\n    ): NodeContent {\n      return state.nodeContents[nodeID];\n    },\n\n    /**\n     * setNodeComment\n     * @param commit\n     * @param state\n     * @param v\n     */\n    async [actions.setNodeComment](\n      { commit, rootState }: { commit: Commit; rootState: { user: UserState } },\n      v: { nodeID: string; comment: string }\n    ): Promise<ErrorKV> {\n      // cannot save for unauthorized user\n      if (!rootState.user.user || rootState.user.user.isAnonymous) {\n        return null;\n      }\n\n      // add to DB\n      const err = await api.debouncedUpdate({\n        [`user_data/${rootState.user.user.uid}/comment/${v.nodeID}/nodeID`]: v.nodeID,\n        [`user_data/${rootState.user.user.uid}/comment/${v.nodeID}/comment`]: v.comment\n      });\n      if (err) {\n        return err;\n      }\n\n      // change in local store\n      commit(`${mutations.SET_NODE_COMMENT}`, v);\n\n      return null;\n    },\n\n    /**\n     * setNodeContent\n     * @param commit\n     * @param state\n     * @param v\n     */\n    async [actions.setNodeContent](\n      { commit, state }: { commit: Commit; state: State },\n      v: { nodeID: string; content: string }\n    ): Promise<ErrorKV> {\n      // change in local store before adding to DB for comfortable textbox editing experience\n      commit(`${mutations.SET_NODE_CONTENT}`, v);\n\n      // add to DB\n      const err = await api.debouncedUpdate({\n        [`node_content/${v.nodeID}/nodeID`]: v.nodeID,\n        [`node_content/${v.nodeID}/content`]: v.content\n      });\n      if (err) {\n        return err;\n      }\n\n      return null;\n    }\n  },\n  mutations: {\n    /**\n     * SET_CONTENTS\n     * @param state\n     * @param nodeContents\n     */\n    [mutations.SET_CONTENTS](\n      state: State,\n      nodeContents: Record<string, NodeContent>\n    ) {\n      state.nodeContents = nodeContents;\n    },\n\n    /**\n     * SET_USER_CONTENTS\n     * @param state\n     * @param userNodeComments\n     */\n    [mutations.SET_USER_COMMENTS](\n      state: State,\n      userNodeComments: Record<string, NodeComment>\n    ) {\n      state.userNodeComments = userNodeComments;\n    },\n\n    /**\n     * SET_NODE_CONTENT\n     * @param state\n     * @param v\n     */\n    [mutations.SET_NODE_CONTENT](\n      state: State,\n      v: { nodeID: string; content: string }\n    ) {\n      createContentIfNotExist(state.nodeContents, v.nodeID);\n      state.nodeContents[v.nodeID].content = v.content;\n    },\n\n    /**\n     * SET_NODE_COMMENT\n     * @param state\n     * @param v\n     */\n    [mutations.SET_NODE_COMMENT](\n      state: State,\n      v: { nodeID: string; comment: string }\n    ) {\n      createCommentIfNotExist(state.userNodeComments, v.nodeID);\n      state.userNodeComments[v.nodeID].comment = v.comment;\n    }\n  }\n};\n","// FlexSearch for full-text search\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\nimport FlexSearch from \"flexsearch/dist/module/index.js\";\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\nimport { stemmer, filter, matcher } from \"flexsearch/dist/module/lang/en.js\";\nconst indexTitle = new FlexSearch({\n  tokenize: \"forward\",\n  encode: (str: string) => {\n    return str.split(/\\s+/);\n  },\n  rtl: false,\n  stemmer: stemmer,\n  matcher: matcher,\n  filter: filter\n});\n\nconst indexContent = new FlexSearch({\n  tokenize: \"forward\",\n  encode: (str: string) => {\n    return str.split(/\\s+/);\n  },\n  rtl: false,\n  stemmer: stemmer,\n  matcher: matcher,\n  filter: filter\n});\n\nconst indexUserComment = new FlexSearch({\n  tokenize: \"forward\",\n  encode: (str: string) => {\n    return str.split(/\\s+/);\n  },\n  rtl: false,\n  stemmer: stemmer,\n  matcher: matcher,\n  filter: filter\n});\n\nexport enum SearchFieldName {\n  Title = \"Title\",\n  Content = \"Content\",\n  UserComment = \"UserComment\",\n}\n\n// best practice is to use numbers as ids for FlexSearch\nlet idMapCnt = 0;\nconst nodeIDMap = {} as Record<string, number>\nconst searchIdMap = {} as Record<number, string>\n\nexport function add(nodeID: string, field: SearchFieldName, text: string) {\n  if (!nodeIDMap[nodeID]) {\n    idMapCnt++\n    nodeIDMap[nodeID] = idMapCnt\n    searchIdMap[idMapCnt] = nodeID\n  }\n  if (field === SearchFieldName.Title) {\n    indexTitle.add(nodeIDMap[nodeID], text.toLowerCase());\n  }\n  if (field === SearchFieldName.Content) {\n    indexContent.add(nodeIDMap[nodeID], text.toLowerCase());\n  }\n  if (field === SearchFieldName.UserComment) {\n    indexUserComment.add(nodeIDMap[nodeID], text.toLowerCase());\n  }\n}\n\nexport async function search(text: string): Promise<Array<string>> {\n  const ids1 = await indexTitle.search(text.toLowerCase());\n  const ids2 = await indexContent.search(text.toLowerCase());\n  const ids3 = await indexUserComment.search(text.toLowerCase());\n  const result = [] as string[]\n  result.push(...ids1.map((id: number) => searchIdMap[id]))\n  result.push(...ids2.map((id: number) => searchIdMap[id]))\n  result.push(...ids3.map((id: number) => searchIdMap[id]))\n  return result\n}\n","import firebase from \"firebase/compat\";\nimport { Commit } from \"vuex\";\nimport api from \"@/api/api\";\n\nexport interface State {\n  user: firebase.User | null;\n  subscribePeriod: string;\n}\n\nexport const mutations = {\n  SET_USER: \"SET_USER\",\n  SET_SUBSCRIBE_PERIOD: \"SET_SUBSCRIBE_PERIOD\"\n};\nexport const actions = {\n  signIn: \"signIn\",\n  signOut: \"signOut\",\n  setSubscribePeriod: \"setSubscribePeriod\",\n};\n\nexport const store = {\n  namespaced: true,\n  state: {\n    user: null,\n    subscribePeriod: '',\n  },\n  mutations: {\n    [mutations.SET_USER](state: State, user: firebase.User) {\n      state.user = user;\n    },\n    [mutations.SET_SUBSCRIBE_PERIOD](state: State, subscribePeriod: string) {\n      state.subscribePeriod = subscribePeriod;\n    },\n  },\n  actions: {\n    async [actions.signIn]({ commit }: { commit: Commit }) {\n      await firebase\n        .auth()\n        .signInWithPopup(new firebase.auth.GoogleAuthProvider());\n    },\n\n    async [actions.signOut]({ commit }: { commit: Commit }) {\n      await firebase.auth().signOut();\n      commit(mutations.SET_USER, null);\n    },\n\n    async [actions.setSubscribePeriod]({ commit, state }: { commit: Commit; state: State }, period: string) {\n      if (!state.user) {\n        return\n      }\n      commit(mutations.SET_SUBSCRIBE_PERIOD, period);\n      await api.setUserSubscribePeriod(state.user, period);\n    }\n  }\n};\n","import firebase from \"firebase/compat\";\nimport api from \"@/api/api\";\nimport {actions as treeActions, mutations as treeMutations} from \"@/store/tree\";\nimport {mutations as pinMutations} from \"@/store/pin\";\nimport {mutations as subscriptionsMutations} from \"@/store/subscriptions\";\nimport {mutations as preconditionMutations} from \"@/store/precondition\";\nimport {mutations as nodeContentMutations, NodeContent} from \"@/store/node_content\";\nimport {store} from \"@/store/index\";\nimport {printError} from \"@/tools/utils\";\nimport {convertDBMapToTree} from \"@/api/helpers\";\nimport {DBMapNode} from \"@/api/types\";\nimport {add as textSearchAdd, SearchFieldName} from \"@/tools/textsearch\";\nimport {mutations as userMutations} from \"@/store/user\";\n\n/**\n * 1) fetch map\n * 2) subscribe to changes\n * 3) convert to tree and set to internal store\n * @param user\n */\nexport async function initMap(user: firebase.User | null) {\n  const [map, err] = await api.getMap(user);\n  if (map === null || err) {\n    printError(\"fetchMap: cannot api.getMap(user)\", { err });\n  }\n  // create Tree with denormalized positions\n  const [tree, convErr] = convertDBMapToTree(map!);\n  if (convErr !== null) {\n    return [null, convErr];\n  }\n  store.commit(`tree/${treeMutations.SET_TREE}`, tree);\n\n  // subscribe on changes for every node in map\n  // General advice is to listen to specific paths (not root) and dynamically change subscribe/unsubscribe\n  // https://firebase.google.com/docs/database/usage/optimize#efficient-listeners\n  for (const id in map) {\n    subscribeNodeChanges(id)\n  }\n}\n\nexport function unSubscribeNodeChanges(id: string) {\n  api.unsubscribeDBChange(`map/${id}`)\n  api.unsubscribeDBChange(`node_content/${id}`)\n  api.unsubscribeDBChange(`precondition/${id}`)\n  api.unsubscribeDBChange(`node_image/${id}`)\n}\n\nexport function subscribeNodeChanges(id: string) {\n  // subscribe children, name or position change\n  api.subscribeMapNodeChange(id, async (dbNode: DBMapNode) => {\n      textSearchAdd(dbNode.id, SearchFieldName.Title, dbNode.name);\n      await store.dispatch(`tree/${treeActions.handleMapNodeUpdate}`, dbNode)\n  });\n\n  // subscribe node content change\n  api.subscribeNodeContentChange(\n    id,\n    (v: { nodeID: string; content: string }) => {\n      textSearchAdd(v.nodeID, SearchFieldName.Content, v.content);\n      store.commit(`nodeContent/${nodeContentMutations.SET_NODE_CONTENT}`, v);\n    }\n  );\n\n  // subscribe on precondition changes for every node\n  api.subscribePreconditionNodeChange(id);\n\n  // subscribe image change\n  api.subscribeNodeImageChange(id)\n}\n\nexport async function fetchPins(user: firebase.User | null) {\n  let [pins, err] = await api.getPins(user);\n  if (pins == null) {\n    if (err) {\n      console.error(\"fetchPins\", err);\n    } else {\n      console.log(\"fetchPins: empty pins\");\n    }\n  }\n\n  if (user && !pins) {\n    [pins, err] = await api.getPins(null);\n    if (pins == null || err) {\n      console.error(err);\n      pins = {};\n    }\n  }\n\n  store.commit(`pin/${pinMutations.SET_PINS}`, pins);\n}\n\nexport async function fetchSubscribePeriod(user: firebase.User | null) {\n  if (!user) {\n    return\n  }\n  const period = await api.getUserSubscribePeriod(user);\n  store.commit(`user/${userMutations.SET_SUBSCRIBE_PERIOD}`, period);\n}\n\nexport async function fetchSubscriptions(user: firebase.User | null) {\n  const [subscriptions, err] = await api.getSubscriptions(user);\n  if (subscriptions == null) {\n    if (err) {\n      console.error(\"fetchSubscriptions\", err);\n    } else {\n      console.log(\"fetchSubscriptions: empty\");\n    }\n  }\n\n  store.commit(`subscriptions/${subscriptionsMutations.SET_SUBSCRIPTIONS}`, subscriptions);\n}\n\nexport async function initPreconditions(user: firebase.User | null) {\n  let [preconditions, err] = await api.getPreconditions(user);\n  if (preconditions == null || err) {\n    console.error(err);\n    preconditions = {};\n  }\n\n  if (user && !preconditions) {\n    [preconditions, err] = await api.getPreconditions(null);\n    if (preconditions == null || err) {\n      console.error(err);\n      preconditions = {};\n    }\n  }\n\n  store.commit(\n    `precondition/${preconditionMutations.SET_PRECONDITIONS}`,\n    preconditions\n  );\n}\n\n/**\n * Fetch all node content and subscribe for content change for each node\n * @param user\n */\nexport async function initNodeContents(user: firebase.User | null) {\n  // fetch node_content from general map\n  const [nodeContent, err] = await api.getNodeContent();\n  if (nodeContent == null || err) {\n    printError(\"fetchNodeContents error\", { err });\n    return;\n  }\n\n  const nodeContents: Record<string, NodeContent> = {};\n  for (const i in nodeContent) {\n    nodeContents[i] = {\n      nodeID: nodeContent[i].nodeID,\n      content: nodeContent[i].content\n    } as NodeContent;\n  }\n\n  store.commit(\n    `nodeContent/${nodeContentMutations.SET_CONTENTS}`,\n    nodeContents\n  );\n\n  if (user) {\n    const [userComments, err] = await api.getUserComments(user);\n    if (err) {\n      printError(\"fetch userComments error\", { err, user });\n      return;\n    }\n    if (userComments === null) {\n      return;\n    }\n\n    // add to search\n    for (const idx in userComments) {\n      textSearchAdd(userComments[idx].nodeID, SearchFieldName.UserComment, userComments[idx].comment)\n    }\n\n    // fix in store\n    store.commit(\n      `nodeContent/${nodeContentMutations.SET_USER_COMMENTS}`,\n      userComments\n    );\n  }\n}\n\nexport async function initData(user: firebase.User | null) {\n  await initMap(user);\n  await fetchPins(user);\n  await fetchSubscribePeriod(user);\n  await fetchSubscriptions(user);\n  await initPreconditions(user);\n  await initNodeContents(user);\n}\n","import { MapNode, Point, Tree } from \"@/types/graphics\";\nimport {\n  convertPosition,\n  isInside,\n  treeToMapNodeLayers,\n  treeToNodeRecord\n} from \"@/tools/graphics\";\nimport { findMapNode, updatePosition } from \"@/store/tree/helpers\";\nimport { ErrorKV } from \"@/types/errorkv\";\nimport NewErrorKV from \"@/tools/errorkv\";\nimport { DBMapNode } from \"@/api/types\";\nimport { printError, round } from \"@/tools/utils\";\nimport api from \"@/api/api\";\nimport { Commit, Dispatch } from \"vuex\";\nimport {subscribeNodeChanges, unSubscribeNodeChanges} from \"@/store/helpers\";\n\n// Every node in map in database is stored for quadratic border 1000x1000.\n// But on a client it is recalculated to the proportion hardcoded in these ROOT_WIDTH/ROOT_HEIGHT\n// and fit into border given by ROOT_BORDER\n// Important!: these proportion and border should be the same for every user regardless of device screen!\n// Thus, it should be fixed in these constants and never be changed!\n// This is because all users should see the same borders and relative title positions\n// and fit titles in \"one for everyone's\" setting.\n// If we give every user its own scene, they will try to fit node positions for their device screen\n// and breaking other users fitting, and this will lead to constant changing mess.\n//\n// ROOT_WIDTH,\n// ROOT_HEIGHT and ROOT_BORDER below were chosen\n// to fit laptop screens (where width>height) as well as mobile screens in vertical orientation (height>width).\nconst ROOT_WIDTH = 2560;\nconst ROOT_HEIGHT = 2000;\nconst cf = 1 / 3;\nconst ROOT_BORDER = [\n  { x: 0, y: cf * ROOT_HEIGHT },\n  { x: 0, y: 2 * cf * ROOT_HEIGHT },\n  { x: (cf / 2.5) * ROOT_WIDTH, y: (1 - cf / 4) * ROOT_HEIGHT },\n  { x: cf * ROOT_WIDTH, y: ROOT_HEIGHT },\n  { x: 2 * cf * ROOT_WIDTH, y: ROOT_HEIGHT },\n  { x: (1 - cf / 2.5) * ROOT_WIDTH, y: (1 - cf / 4) * ROOT_HEIGHT },\n  { x: ROOT_WIDTH, y: 2 * cf * ROOT_HEIGHT },\n  { x: ROOT_WIDTH, y: cf * ROOT_HEIGHT },\n  { x: (1 - cf / 2.5) * ROOT_WIDTH, y: (cf / 4) * ROOT_HEIGHT },\n  { x: 2 * cf * ROOT_WIDTH, y: 0 },\n  { x: cf * ROOT_WIDTH, y: 0 },\n  { x: (cf / 2.5) * ROOT_WIDTH, y: (cf / 4) * ROOT_HEIGHT }\n];\nconst ROOT_CENTER = { x: api.ROOT_CENTER_X, y: api.ROOT_CENTER_Y };\n\n// Scale a root border proportionally to fit user browser viewport and move the left\nconst userFitCoefficient = Math.min(\n  api.ROOT_WIDTH / ROOT_WIDTH,\n  api.ROOT_HEIGHT / ROOT_HEIGHT\n);\nfor (const idx in ROOT_BORDER) {\n  ROOT_BORDER[idx].x =\n    userFitCoefficient * ROOT_BORDER[idx].x +\n    api.ROOT_CENTER_X -\n    (userFitCoefficient * ROOT_WIDTH) / 2;\n  ROOT_BORDER[idx].y =\n    userFitCoefficient * ROOT_BORDER[idx].y +\n    api.ROOT_CENTER_Y -\n    (userFitCoefficient * ROOT_HEIGHT) / 2;\n}\n\nexport interface NodeRecordItem {\n  node: Tree;\n  parent: Tree | null;\n}\n\nexport interface State {\n  tree: Tree | null;\n  nodeRecord: Record<string, NodeRecordItem>;\n  mapNodeLayers: Array<Record<string, MapNode>>;\n  selectedNodeId: string | null;\n}\n\nexport const mutations = {\n  SET_SELECTED_NODE_ID: \"SET_SELECTED_NODE_ID\",\n  SET_TREE: \"SET_TREE\",\n  UPDATE_NODE_POSITION: \"UPDATE_NODE_POSITION\",\n  REMOVE_NODE: \"REMOVE_NODE\"\n};\n\nexport const actions = {\n  handleMapNodeUpdate: \"handleMapNodeUpdate\"\n};\n\nexport const store = {\n  namespaced: true,\n  state() {\n    return {\n      tree: null,\n      nodeRecord: {} as Record<string, NodeRecordItem>, // id => NodeRecordItem\n      mapNodeLayers: [] as Array<Record<string, DBMapNode>>,\n      selectedNodeId: null\n    };\n  },\n\n  getters: {\n    selectedNode: (state: State) => {\n      if (!state.selectedNodeId) {\n        return null;\n      }\n      if (!state.nodeRecord[state.selectedNodeId]) {\n        return null;\n      }\n      return state.nodeRecord[state.selectedNodeId].node;\n    }\n  },\n\n  actions: {\n    /**\n     * Update tree and dependant structures on DBNode change\n     *\n     * После добавления нового узла мы не вносим изменения локально, а сохраняем в базу и ждем пока оттуда придет обновление\n     *\n     * Маппинг изменений в виде снэпшотов на изменения в формате store/history выглядит следующим образом.\n     * Мы сравниваем наш узел и пришедший новый снэпшот этого узла\n     *\n     * Если видим удаление child, то это либо перенос, либо удаление узла.\n     * В любом случае мы можем у себя удалить этот узел (мы не удаляем всю информацию, только из дерева - 'fake removal').\n     * Если это перенос, то мы либо получили событие добавления в другой узел\n     * до этого события, либо получим его после. Если получили до, то из этого узла уже должны были его удалить,\n     * так что остается вариант когда мы еще получим событие о добавлении. В этом случаем для нас это будет добавление нового узла.\n     * То есть мы запросим из базы этот узел и вставим его\n     *\n     * Если видим добавление child, то это либо перенос, либо добавление нового узла. Если мы не находим у себя child с таким id,\n     * то это добавление - нам нужно запросить из базы node с таким id и добавить его к себе.\n     * Если в nodeRecord есть такой узел, то это перенос - мы удаляем его из старого родителя и вставляем в новый\n     *\n     * Этими двумя кейсами покрываются события добавления, удаления и переноса.\n     * Событие изменения имени и позиции мапятся тривиально\n     *\n     * @param commit\n     * @param state\n     * @param dispatch\n     * @param dbNode\n     */\n    async [actions.handleMapNodeUpdate](\n      {\n        commit,\n        state,\n      }: { commit: Commit; state: State; dispatch: Dispatch },\n      dbNode: DBMapNode\n    ) {\n      const dbNodeRecord = state.nodeRecord[dbNode.id];\n      if (!dbNodeRecord) {\n        // if it is a new node, we will fetch it from its parent children update event\n        return;\n      }\n\n      const oldDBNode = {\n        id: dbNodeRecord.node.id,\n        parentID: dbNodeRecord.parent ? dbNodeRecord.parent.id : null,\n        name: dbNodeRecord.node.title,\n        children: dbNodeRecord.node.children.map(n => n.id).sort(),\n        position: dbNodeRecord.node.position\n      };\n\n      const newChildren = dbNode.children.filter(\n        x => !oldDBNode.children.includes(x)\n      );\n      const removedChildren = oldDBNode.children.filter(\n        x => !dbNode.children.includes(x)\n      );\n\n      // Add/move of new child\n      if (newChildren.length) {\n        for (const childID of newChildren) {\n          if (state.nodeRecord[childID]) {\n            console.log(\n              \"actions.handleDBUpdate: remove node for cut-and-paste\",\n              state.nodeRecord[childID]\n            );\n            // if we already have this node, then it is cut-and-paste new parent\n            // so we should remove node from old parent\n            const v = {\n              nodeID: childID,\n              returnError: null\n            };\n            commit(mutations.REMOVE_NODE, {\n              nodeID: childID,\n              returnError: null\n            });\n            if (v.returnError) {\n              printError(\"handleDBUpdate: cannot cut node\", {\n                err: v.returnError\n              });\n            }\n          }\n\n          // request node and its children from the server, fill in tree\n          const addedDBNode = await api.getMapNode(childID);\n          console.log(\n            \"actions.handleDBUpdate: add node for cut-and-paste\",\n            addedDBNode\n          );\n\n          const toProcess = [addedDBNode];\n          if (!addedDBNode) {\n            // we cannot find node for addition, remove it from parent\n            dbNode.children = dbNode.children.filter(id => id != childID);\n            printError(\"Cannot find node for addition\", { nodeID: childID });\n            continue;\n          }\n          while (toProcess.length) {\n            const inProcessNode = toProcess.pop();\n            if (!inProcessNode) {\n              continue;\n            }\n            // create new MapNode\n            const treeNode = {\n              id: inProcessNode.id,\n              title: inProcessNode.name,\n              position: inProcessNode.position,\n              children: []\n            } as Tree;\n            if (!state.nodeRecord[inProcessNode.parentID]) {\n              printError(\"Cannot find nodeID in nodeRecord\", {\n                nodeID: inProcessNode.parentID\n              });\n              return;\n            }\n            // make sure we have no duplicates\n            state.nodeRecord[\n              inProcessNode.parentID\n            ].node.children = state.nodeRecord[\n              inProcessNode.parentID\n            ].node.children.filter(n => n.id != treeNode.id);\n            // add child to parent\n            state.nodeRecord[inProcessNode.parentID].node.children.push(\n              treeNode\n            );\n            // add child to nodeRecord\n            state.nodeRecord[treeNode.id] = {\n              parent: state.nodeRecord[inProcessNode.parentID].node,\n              node: treeNode\n            };\n            // subscribe to new node changes\n            subscribeNodeChanges(treeNode.id);\n            for (const childID of inProcessNode.children) {\n              const childNode = await api.getMapNode(childID);\n              if (!childNode) {\n                // we cannot find node for addition, remove it from parent\n                inProcessNode.children = inProcessNode.children.filter(\n                  id => id != childID\n                );\n                printError(\"Cannot find node for addition\", {\n                  nodeID: childID\n                });\n                continue;\n              }\n              toProcess.push(childNode);\n            }\n          }\n        }\n      }\n\n      // Remove of child\n      if (removedChildren.length) {\n        for (const childID of removedChildren) {\n          if (!state.nodeRecord[childID] || !state.nodeRecord[childID].parent) {\n            // node was already removed somewhere\n            continue;\n          }\n          if (\n            state.nodeRecord[childID] &&\n            state.nodeRecord[childID].parent!.id !== dbNode.id\n          ) {\n            // node was already removed from this parent (this is cut-and-paste operation)\n            continue;\n          }\n          console.log(\n            \"actions.handleDBUpdate: removing children\",\n            state.nodeRecord[childID]\n          );\n          const v = { nodeID: childID, returnError: null };\n          commit(mutations.REMOVE_NODE, v);\n          if (v.returnError) {\n            printError(\"actions.handleDBUpdate: cannot remove node\", {\n              err: v.returnError,\n              id: childID\n            });\n          }\n          // unsubscribe from removed node changes\n          unSubscribeNodeChanges(childID);\n        }\n      }\n\n      if (removedChildren.length || newChildren.length) {\n        const [ls, err2] = treeToMapNodeLayers(\n          state.tree!,\n          ROOT_BORDER,\n          ROOT_CENTER\n        );\n        if (err2) {\n          printError(\"Cannot treeToMapNodeLayers\", { err: err2 });\n          return;\n        }\n        state.mapNodeLayers = ls!;\n      }\n\n      // Change of position\n      if (\n        round(dbNode.position.x) !== round(oldDBNode.position.x) ||\n        round(dbNode.position.y) !== round(oldDBNode.position.y)\n      ) {\n        // calculate denormalized position of dbNode\n        const [denormalizedPosition] = convertPosition(\n          \"denormalize\",\n          dbNode.position,\n          dbNodeRecord.parent ? dbNodeRecord.parent.id : null,\n          state.mapNodeLayers\n        );\n        if (oldDBNode.parentID == dbNode.parentID) {\n          // we do not want to process position change due to parent change - it is already processed by ADD_NODE\n          const v = {\n            nodeId: dbNode.id,\n            newCenter: denormalizedPosition,\n            returnError: null\n          };\n          commit(mutations.UPDATE_NODE_POSITION, v);\n          if (v.returnError !== null) {\n            printError(\n              \"actions.handleDBUpdate: cannot update node's position\",\n              { dbNode: dbNode, err: v.returnError }\n            );\n            return;\n          }\n        }\n      }\n\n      // Change of name\n      if (oldDBNode.name !== dbNode.name) {\n        dbNodeRecord.node.title = dbNode.name;\n        const [node] = findMapNode(oldDBNode.id, state.mapNodeLayers);\n        if (!node) {\n          return;\n        }\n        node.title = dbNode.name;\n      }\n    }\n  },\n  mutations: {\n    /**\n     * REMOVE_NODE\n     * @param state\n     * @param v\n     */\n    [mutations.REMOVE_NODE](\n      state: State,\n      v: { nodeID: string; returnError: ErrorKV }\n    ) {\n      if (state.tree === null) {\n        v.returnError = NewErrorKV(\"state.tree === null\", {});\n        return;\n      }\n\n      if (!state.nodeRecord[v.nodeID]) {\n        v.returnError = NewErrorKV(\n          \"REMOVE_NODE: cannot find nodeId in nodeRecord\",\n          { nodeID: v.nodeID, nodeRecord: state.nodeRecord }\n        );\n        return;\n      }\n      const parent = state.nodeRecord[v.nodeID].parent;\n      if (!parent) {\n        v.returnError = NewErrorKV(\"REMOVE_NODE: cannot remove root node\", {\n          nodeId: v.nodeID\n        });\n        return;\n      }\n\n      // remove node and its descendants from nodeRecord\n      const stack = [v.nodeID];\n      while (stack.length) {\n        const id = stack.pop();\n        if (!id) {\n          continue;\n        }\n        stack.push(...state.nodeRecord[id].node.children.map(node => node.id));\n        delete state.nodeRecord[id];\n      }\n\n      // remove from parent's children\n      const ind = parent.children.findIndex(node => node.id === v.nodeID);\n      parent.children.splice(ind, 1);\n    },\n\n    /**\n     * SET_SELECTED_NODE_ID\n     * @param state\n     * @param id\n     */\n    [mutations.SET_SELECTED_NODE_ID](state: State, id: string | null) {\n      state.selectedNodeId = id;\n    },\n\n    /**\n     * SET_TREE\n     * @param state\n     * @param tree\n     */\n    [mutations.SET_TREE](state: State, tree: Tree | null) {\n      if (tree == null) {\n        state.tree = null;\n        state.nodeRecord = {};\n        state.mapNodeLayers = [];\n        return;\n      }\n      state.tree = tree;\n\n      // traverse tree and fill in nodeRecord\n      state.nodeRecord = treeToNodeRecord(tree);\n\n      // fill state.mapNodeLayers\n      const [ls, err] = treeToMapNodeLayers(tree, ROOT_BORDER, ROOT_CENTER);\n      if (ls == null || err != null) {\n        console.error(err);\n        return;\n      }\n      state.mapNodeLayers = ls;\n    },\n\n    /**\n     * UPDATE_NODE_POSITION\n     * @param state\n     * @param v\n     */\n    [mutations.UPDATE_NODE_POSITION](\n      state: State,\n      v: {\n        nodeId: string;\n        newCenter: Point;\n        returnError: ErrorKV; // still waiting for vuex to implement mutation return values https://github.com/vuejs/vuex/issues/1437\n      }\n    ) {\n      // check that new position is inside parent borders\n      const parent = state.nodeRecord[v.nodeId].parent;\n      if (parent !== null) {\n        const [parentMapNode] = findMapNode(parent.id, state.mapNodeLayers);\n        if (!parentMapNode) {\n          v.returnError = NewErrorKV(\n            \"UPDATE_NODE_POSITION: cannot find parent mapNode\",\n            {\n              \"parent.id\": parent.id,\n              \"state.mapNodeLayers\": state.mapNodeLayers\n            }\n          );\n          return;\n        }\n\n        if (!isInside(v.newCenter, parentMapNode.border)) {\n          v.returnError = NewErrorKV(\"!isInside\", {\n            newCenter: v.newCenter,\n            \"parentMapNode.border\": parentMapNode.border\n          });\n          return;\n        }\n      }\n\n      v.returnError = updatePosition(state, {\n        nodeId: v.nodeId,\n        position: v.newCenter\n      });\n    }\n  }\n};\n","import { Point } from \"@/types/graphics\";\n\nexport const mutations = {\n  ADD_CUT_PASTE: \"ADD_CUT_PASTE\",\n  ADD_CREATE: \"ADD_CREATE\",\n  ADD_REMOVE: \"ADD_REMOVE\",\n  ADD_POSITION_CHANGE: \"ADD_POSITION_CHANGE\"\n};\n\nenum changeTypeEnum {\n  CUT_PASTE = \"CUT_PASTE\",\n  CREATE = \"CREATE\",\n  REMOVE = \"REMOVE\",\n  POSITION_CHANGE = \"POSITION_CHANGE\"\n}\n\nconst changeTypes = {\n  CUT_PASTE: \"CUT_PASTE\" as changeTypeEnum.CUT_PASTE,\n  CREATE: \"CREATE\" as changeTypeEnum.CREATE,\n  REMOVE: \"REMOVE\" as changeTypeEnum.REMOVE,\n  POSITION_CHANGE: \"POSITION_CHANGE\" as changeTypeEnum.POSITION_CHANGE\n};\n\nexport interface CHCutPaste {\n  nodeID: string; // object of change\n  oldParentID: string; // old parent\n  newParentID: string; // new parent\n}\n\nexport interface CHCreate {\n  nodeID: string; // object of change\n  parentID: string; // new parent\n}\n\nexport interface CHRemove {\n  nodeID: string; // object of change\n  parentID: string; // parent where object sits (we need it to revert this event)\n}\n\nexport interface CHPositionChange {\n  nodeID: string; // object of change\n  oldPosition: Point; // old position (we need it to revert this event)\n  newPosition: Point; // new position\n}\n\nexport type TreeChangeList = Record<\n  string,\n  {\n    [changeTypeEnum.CUT_PASTE]?: CHCutPaste;\n    [changeTypeEnum.CREATE]?: CHCreate;\n    [changeTypeEnum.REMOVE]?: CHRemove;\n    [changeTypeEnum.POSITION_CHANGE]?: CHPositionChange;\n  }\n>;\n\nexport interface State {\n  // список изменений который отличает текущую мастер ветку\n  // от того мастера с которого мы начали локальные изменения\n  stableChangeList: TreeChangeList;\n  // список локальных изменений\n  localChangeList: TreeChangeList;\n}\n\nexport const store = {\n  namespaced: true,\n  state: {\n    stableChangeList: {},\n    localChangeList: {}\n  },\n  mutations: {\n    [mutations.ADD_CUT_PASTE](state: State, change: CHCutPaste) {\n      if (!state.localChangeList[change.nodeID]) {\n        state.localChangeList[change.nodeID] = {};\n      }\n      if (state.localChangeList[change.nodeID][changeTypes.CREATE]) {\n        // if user ADDed then MOVEd node then it is simply addition to CUT_PASTE newParentID\n        state.localChangeList[change.nodeID][changeTypes.CREATE]!.parentID =\n          change.newParentID;\n      } else {\n        state.localChangeList[change.nodeID][changeTypes.CUT_PASTE] = change;\n      }\n    },\n    [mutations.ADD_CREATE](state: State, change: CHCreate) {\n      if (!state.localChangeList[change.nodeID]) {\n        state.localChangeList[change.nodeID] = {};\n      }\n      state.localChangeList[change.nodeID][changeTypes.CREATE] = change;\n    },\n    [mutations.ADD_REMOVE](state: State, change: CHRemove) {\n      // clear changelist for this node because REMOVE vanishes them anyway\n      state.localChangeList[change.nodeID] = {};\n      state.localChangeList[change.nodeID][changeTypes.REMOVE] = change;\n    },\n    [mutations.ADD_POSITION_CHANGE](state: State, change: CHPositionChange) {\n      if (!state.localChangeList[change.nodeID]) {\n        state.localChangeList[change.nodeID] = {};\n      }\n      let firstOldPosition = change.oldPosition;\n      if (state.localChangeList[change.nodeID][changeTypes.POSITION_CHANGE]) {\n        firstOldPosition = state.localChangeList[change.nodeID][\n          changeTypes.POSITION_CHANGE\n        ]!.oldPosition;\n      }\n      state.localChangeList[change.nodeID][changeTypes.POSITION_CHANGE] = {\n        nodeID: change.nodeID,\n        oldPosition: firstOldPosition,\n        newPosition: change.newPosition\n      };\n    }\n  },\n  actions: {}\n};\n","import { Point, Vector } from \"@/types/graphics\";\nimport { addVector, vectorOnNumber } from \"@/tools/graphics\";\nimport { debounce } from \"lodash\";\n\nexport interface State {\n  zoom: number;\n  zoomCenter: Point;\n  pan: Point;\n  debouncedZoom: number;\n  debouncedPan: Point;\n  relative: {\n    zoom: number;\n    pan: Point;\n  }\n}\n\nexport const mutations = {\n  ADD_ZOOM: \"ADD_ZOOM\",\n  ADD_PAN: \"ADD_PAN\",\n  ADD_RELATIVE_PAN: \"ADD_RELATIVE_PAN\",\n  SET_PAN: \"SET_PAN\",\n  SET_ZOOM_CENTER: \"SET_ZOOM_CENTER\",\n  RESET_ZOOM_AND_PAN: \"RESET_ZOOM_AND_PAN\"\n};\n\nconst ZOOM_SENSITIVITY = 1 / 500;\nconst PAN_SENSITIVITY = 1;\nconst DEBOUNCE_WAIT = 100;\n\nconst zoomDebounce = debounce((state, value: number) => {\n  state.debouncedZoom = value;\n  state.relative.zoom = 1;\n}, DEBOUNCE_WAIT);\n\nconst panDebounce = debounce((state, value: Point) => {\n  state.debouncedPan = value;\n  state.relative.pan = {x:0, y:0};\n}, DEBOUNCE_WAIT);\n\nexport const store = {\n  namespaced: true,\n  state: {\n    zoom: 1, // absolute zoom\n    pan: { x: 0, y: 0 }, // absolute pan\n    debouncedZoom: 1,\n    debouncedPan: { x: 0, y: 0 },\n    zoomCenter: { x: 0, y: 0 },\n    relative: {\n      zoom: 1,\n      pan: { x: 0, y: 0 },\n    },\n  },\n  mutations: {\n    [mutations.SET_ZOOM_CENTER](state: State, center: Point) {\n      state.zoomCenter = center;\n    },\n    [mutations.ADD_ZOOM](state: State, delta: number) {\n      const newZoom = state.zoom * Math.pow(2, delta * ZOOM_SENSITIVITY);\n      if (newZoom < 0.5) {\n        // foolproof from too much zoom\n        return;\n      }\n      state.zoom = newZoom;\n      state.relative.zoom =  state.relative.zoom * Math.pow(2, delta * ZOOM_SENSITIVITY);\n      zoomDebounce(state, state.zoom);\n    },\n    [mutations.ADD_PAN](state: State, delta: Vector) {\n      state.pan = addVector(\n        { from: { x: 0, y: 0 }, to: state.pan },\n        vectorOnNumber(delta, PAN_SENSITIVITY)\n      ).to;\n      panDebounce(state, state.pan);\n    },\n    [mutations.ADD_RELATIVE_PAN](state: State, delta: Vector) {\n      state.relative.pan = addVector(\n        { from: { x: 0, y: 0 }, to: state.relative.pan },\n        vectorOnNumber(delta, PAN_SENSITIVITY)\n      ).to;\n      panDebounce(state, state.pan);\n    },\n    [mutations.SET_PAN](state: State, point: Point) {\n      state.pan = point;\n      panDebounce(state, state.pan);\n    },\n    [mutations.RESET_ZOOM_AND_PAN](state: State, point: Point) {\n      state.pan = {x:0, y:0};\n      panDebounce(state, state.pan);\n      state.zoom = 1;\n      zoomDebounce(state, state.zoom);\n    }\n  }\n};\n","export interface State {\n  nodeIDs: string[];\n}\n\nexport const mutations = {\n  SET_NODE_IDS: \"SET_NODE_IDS\"\n};\n\nexport const store = {\n  namespaced: true,\n  state: {\n    nodeIDs: []\n  },\n  mutations: {\n    [mutations.SET_NODE_IDS](state: State, nodeIDs: Array<string>) {\n      // show only first 20 results\n      if (nodeIDs.length > 20) {\n        // TODO: show notification that only first 20 results are shown\n        state.nodeIDs = nodeIDs.slice(0, 20);\n      } else {\n        state.nodeIDs = nodeIDs;\n      }\n    }\n  }\n};\n","import {\n  Commit,\n  createStore,\n  Dispatch,\n  Store,\n  useStore as baseUseStore\n} from \"vuex\";\nimport { InjectionKey } from \"vue\";\n\nimport { store as pinStore, State as PinState } from \"./pin\";\nimport { store as subscriptionsStore, State as SubscriptionsState } from \"./subscriptions\";\n\nimport { store as titleBoxStore, State as TitleBoxState } from \"./title_box\";\n\nimport {\n  store as preconditionStore,\n  State as PreconditionState\n} from \"./precondition\";\n\nimport {\n  store as imageStore,\n  State as ImageState\n} from \"./image\";\n\nimport {\n  store as positionChangePermitsStore,\n  State as positionChangePermitsState\n} from \"./position_change_permits\";\n\nimport {\n  store as treeStore,\n  State as TreeState,\n  mutations as treeMutations\n} from \"./tree\";\n\nimport { store as zoomPanStore, State as ZoomPanState } from \"./zoom_pan\";\n\nimport {\n  store as userStore,\n  State as UserState,\n  mutations as userMutations,\n  actions as userActions\n} from \"./user\";\n\nimport {\n  store as historyStore,\n  State as HistoryState,\n  mutations as historyMutations\n} from \"./history\";\n\nimport {\n  store as nodeContentStore,\n  State as NodeContentState\n} from \"./node_content\";\n\nimport {\n  store as searchResultStore,\n  State as SearchResultState\n} from \"./search_result\";\n\nimport api from \"@/api/api\";\nimport { initData } from \"./helpers\";\nimport { MapNode, Point } from \"@/types/graphics\";\nimport {\n  createNewNode,\n  findMapNode,\n  getNewNodeCenter\n} from \"@/store/tree/helpers\";\nimport NewErrorKV from \"@/tools/errorkv\";\nimport { addVector, convertPosition } from \"@/tools/graphics\";\nimport { debounce } from \"lodash\";\nimport { printError } from \"@/tools/utils\";\nimport firebase from \"firebase/compat\";\n\nexport type State = {\n  // root states\n  editModeOn: boolean;\n\n  // module states\n  titleBox: TitleBoxState;\n  pin: PinState;\n  subscriptions: SubscriptionsState;\n  image: ImageState;\n  precondition: PreconditionState;\n  positionChangePermits: positionChangePermitsState;\n  tree: TreeState;\n  user: UserState;\n  zoomPan: ZoomPanState;\n  history: HistoryState;\n  nodeContent: NodeContentState;\n  searchResult: SearchResultState;\n};\n\nexport const actions = {\n  init: \"init\",\n  updateNodePosition: \"updateNodePosition\",\n  createNode: \"createNode\",\n  cutPasteNode: \"cutPasteNode\",\n  removeNode: \"removeNode\",\n  setEditMode: \"setEditMode\",\n\n  // confirmSignInPopup\n  confirmSignInPopup: \"confirmSignInPopup\"\n};\n\nexport const mutations = {\n  SET_EDIT_MODE: \"SET_EDIT_MODE\",\n};\n\nconst debouncedPositionSet = debounce(\n  (\n    nodeID: string,\n    newCenter: Point,\n    parentID: string,\n    mapNodeLayers: Record<string, MapNode>[]\n  ) => {\n    const [normalizedNewNodeCenter] = convertPosition(\n      \"normalize\",\n      newCenter,\n      parentID,\n      mapNodeLayers\n    );\n\n    api.update({ [`map/${nodeID}/position`]: normalizedNewNodeCenter });\n  },\n  200\n);\n\nexport const key: InjectionKey<Store<State>> = Symbol();\n\nexport const store = createStore<State>({\n  state: {\n    editModeOn: false,\n  } as State,\n  mutations: {\n    [mutations.SET_EDIT_MODE](state: State, val: boolean) {\n      state.editModeOn = val;\n    },\n  },\n  actions: {\n    /**\n     * confirmSignInPopup\n     * @param commit\n     * @param val\n     */\n    async [actions.confirmSignInPopup](\n      { dispatch }: { dispatch: Dispatch; state: State },\n      val: {confirm:  {\n        require(args: {\n          message?: string;\n          target?: EventTarget;\n          group?: string;\n          icon?: string;\n          header?: string;\n          accept?: () => void;\n          reject?: () => void;\n          acceptLabel?: string;\n          rejectLabel?: string;\n          acceptIcon?: string;\n          rejectIcon?: string;\n          blockScroll?: boolean;\n          acceptClass?: string;\n          rejectClass?: string;\n        }): void;\n\n        close(): void;\n      },\n      message: string,\n      }\n    ) {\n      val.confirm.require({\n        message: val.message,\n        header: \"SignIn\",\n        acceptLabel: \"Ok, Sign In\",\n        rejectLabel: \"No, thanks, just watching\",\n        accept: async () => {\n          await dispatch(`user/${userActions.signIn}`);\n        },\n        reject: () => {\n          return;\n        }\n      });\n    },\n\n    /**\n     *\n     * @param commit\n     * @param val\n     */\n    [actions.setEditMode](\n      { commit }: { commit: Commit; state: State },\n      val: boolean\n    ) {\n      commit(mutations.SET_EDIT_MODE, val);\n    },\n\n    /**\n     *\n     * @param commit\n     */\n    async [actions.init]({ commit }: { commit: Commit }) {\n      api.initFirebase();\n      firebase.auth().onAuthStateChanged(user => {\n        if (user && !user.isAnonymous) {\n          api.setPublicUserData(user.uid, user.displayName, null);\n          commit(`user/${userMutations.SET_USER}`, user);\n          initData(user);\n        } else {\n          commit(`user/${userMutations.SET_USER}`, null);\n          initData(null);\n        }\n      });\n    },\n\n    /**\n     *\n     * @param commit\n     * @param state\n     * @param v\n     */\n    async [actions.createNode](\n      { commit, state }: { commit: Commit; state: State },\n      v: {\n        parentID: string;\n        title: string;\n      }\n    ) {\n      const parent = state.tree.nodeRecord[v.parentID].node;\n      const [newCenter, changedNode, err1] = getNewNodeCenter(\n        parent,\n        state.tree.mapNodeLayers,\n        true\n      );\n      if (err1 !== null) {\n        printError(\"Cannot create new center\", {\n          err: err1,\n          parent,\n          \"state.tree.mapNodeLayers\": state.tree.mapNodeLayers\n        });\n        return;\n      }\n\n      const [normalizedPosition, err2] = convertPosition(\n        \"normalize\",\n        newCenter!,\n        v.parentID,\n        state.tree.mapNodeLayers\n      );\n      if (err2) {\n        printError(\"createNode: cannot create new center\", {\n          err: err2,\n          parent,\n          \"state.tree.mapNodeLayers\": state.tree.mapNodeLayers\n        });\n        return;\n      }\n      const node = createNewNode(v.title, normalizedPosition!);\n      const newDBNode = {\n        id: node.id,\n        parentID: v.parentID,\n        name: v.title,\n        children: [],\n        position: normalizedPosition\n      };\n      const newKey = api.generateKey();\n      const updateMap: Record<string, any> = {\n        [`map/${newDBNode.id}`]: newDBNode,\n        [`map/${newDBNode.parentID}/children/${newKey}`]: newDBNode.id\n      };\n\n      if (changedNode) {\n        const [normalizedChangedCenter] = convertPosition(\n          \"normalize\",\n          changedNode.position,\n          v.parentID,\n          state.tree.mapNodeLayers\n        );\n        updateMap[`map/${changedNode.id}/position`] = normalizedChangedCenter;\n      }\n\n      // check that parent node still exists\n      // maybe it's better to check this as a security rule?\n      const pn = await api.getMapNode(v.parentID)\n      if (!pn) {\n        console.error(\"Cannot find parent to add node\", v.parentID)\n        return\n      }\n      await api.update(updateMap);\n\n      commit(`history/${historyMutations.ADD_CREATE}`, {\n        nodeID: node.id,\n        parentID: v.parentID\n      });\n\n      return node.id;\n    },\n\n    /**\n     *\n     * @param commit\n     * @param state\n     * @param v\n     */\n    async [actions.cutPasteNode](\n      { commit, state }: { commit: Commit; state: State },\n      v: {\n        nodeID: string;\n        parentID: string;\n      }\n    ) {\n      // remove nodeID from oldParent children,\n      // add to newParent children,\n      // recalculate position of node, normalize it and\n      // update DB with these three modifications in one transaction\n      const oldParent = state.tree.nodeRecord[v.nodeID].parent;\n      const newParent = state.tree.nodeRecord[v.parentID].node;\n      const [newCenter, changedNode, err1] = getNewNodeCenter(\n        newParent,\n        state.tree.mapNodeLayers,\n        true\n      );\n      if (err1) {\n        printError(\"cutPasteNode: cannot getNewNodeCenter\", { err: err1 });\n        return;\n      }\n      const [normalizedNewNodeCenter, err2] = convertPosition(\n        \"normalize\",\n        newCenter!,\n        v.parentID,\n        state.tree.mapNodeLayers\n      );\n      if (err2) {\n        printError(\"cutPasteNode: cannot create new center\", {\n          err: err2,\n          parent,\n          \"state.tree.mapNodeLayers\": state.tree.mapNodeLayers\n        });\n        return;\n      }\n      // generate key for new child in list of newParent\n      const newKey = api.generateKey();\n      // search for key of childID in children of oldParent\n      const oldKey = await api.findKeyOfChild(oldParent!.id, v.nodeID);\n      const updateMap = {\n        [`map/${v.nodeID}/parentID`]: newParent!.id,\n        [`map/${oldParent!.id}/children/${oldKey}`]: null, // remove from old parent children\n        [`map/${newParent!.id}/children/${newKey}`]: v.nodeID, // add to children of new parents\n        [`map/${v.nodeID}/position`]: normalizedNewNodeCenter\n      };\n      if (changedNode) {\n        const [normalizedChangedCenter] = convertPosition(\n          \"normalize\",\n          changedNode.position,\n          v.parentID,\n          state.tree.mapNodeLayers\n        );\n        updateMap[`map/${changedNode.id}/position`] = normalizedChangedCenter;\n      }\n      await api.update(updateMap);\n\n      commit(`history/${historyMutations.ADD_CUT_PASTE}`, {\n        nodeID: v.nodeID,\n        parentID: v.parentID\n      });\n    },\n\n    /**\n     *\n     * @param commit\n     * @param state\n     * @param nodeID\n     */\n    async [actions.removeNode](\n      { commit, state }: { commit: Commit; state: State },\n      nodeID: string\n    ) {\n      const parent = state.tree.nodeRecord[nodeID].parent;\n      if (!parent) {\n        return;\n      }\n\n      // do main actions on backend (see functions/cmd_remove.js)\n      await api.update({ [`cmd/remove`]: nodeID });\n\n      commit(`history/${historyMutations.ADD_REMOVE}`, {\n        parentNodeID: parent.id,\n        nodeID: nodeID\n      });\n    },\n\n    /**\n     *\n     * @param commit\n     * @param state\n     * @param v\n     */\n    [actions.updateNodePosition](\n      { commit, state }: { commit: Commit; state: State },\n      v: { nodeId: string; delta: Point }\n    ) {\n      if (!state.editModeOn) {\n        return;\n      }\n      const [mapNode] = findMapNode(v.nodeId, state.tree.mapNodeLayers);\n      if (!mapNode) {\n        return NewErrorKV(\"UPDATE_NODE_POSITION: cannot find mapNode\", {\n          \"v.nodeId\": v.nodeId,\n          \"state.mapNodeLayers\": state.tree.mapNodeLayers\n        });\n      }\n      const newCenter = addVector(\n        { from: { x: 0, y: 0 }, to: mapNode.center },\n        { from: { x: 0, y: 0 }, to: v.delta }\n      ).to;\n\n      const args = { nodeId: v.nodeId, newCenter, returnError: null };\n      commit(`tree/${treeMutations.UPDATE_NODE_POSITION}`, args);\n      if (args.returnError === null) {\n        commit(`history/${historyMutations.ADD_POSITION_CHANGE}`, {\n          nodeID: v.nodeId,\n          oldPosition: mapNode.center,\n          newPosition: newCenter\n        });\n\n        // save to DB with debounce\n        debouncedPositionSet(\n          v.nodeId,\n          newCenter,\n          state.tree.nodeRecord[v.nodeId].parent!.id,\n          state.tree.mapNodeLayers\n        );\n      }\n    }\n  },\n  modules: {\n    pin: pinStore,\n    subscriptions: subscriptionsStore,\n    titleBox: titleBoxStore,\n    image: imageStore,\n    precondition: preconditionStore,\n    positionChangePermits: positionChangePermitsStore,\n    tree: treeStore,\n    user: userStore,\n    zoomPan: zoomPanStore,\n    history: historyStore,\n    nodeContent: nodeContentStore,\n    searchResult: searchResultStore\n  }\n});\n\n// define your own `useStore` composition function\nexport function useStore() {\n  return baseUseStore(key);\n}\n","\nimport { defineComponent } from \"vue\";\nimport { useStore, actions } from \"@/store\";\nexport default defineComponent({\n  setup() {\n    const store = useStore();\n    store.dispatch(actions.init);\n  }\n});\n","import { render } from \"./App.vue?vue&type=template&id=8c892ede\"\nimport script from \"./App.vue?vue&type=script&lang=ts\"\nexport * from \"./App.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<template>\n  This section is just for test/emulator cases for now\n  <input id=\"email\" />\n  <input id=\"password\" />\n  <button @click=\"login\">login</button>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nimport api from \"@/api/api\";\nimport { mutations } from \"@/store/user\";\nimport firebase from \"firebase/compat\";\nimport { useStore } from \"@/store\";\n\nexport default defineComponent({\n  name: \"PasswordLogin\",\n\n  setup() {\n    const store = useStore();\n\n    return {\n      login: async () => {\n        const emailEl = document.getElementById(\"email\") as HTMLInputElement;\n        const passwordEl = document.getElementById(\n          \"password\"\n        ) as HTMLInputElement;\n        await firebase\n          .auth()\n          .signInWithEmailAndPassword(emailEl.value, passwordEl.value);\n      }\n    };\n  }\n});\n</script>\n","\nimport { defineComponent } from \"vue\";\nimport api from \"@/api/api\";\nimport { mutations } from \"@/store/user\";\nimport firebase from \"firebase/compat\";\nimport { useStore } from \"@/store\";\n\nexport default defineComponent({\n  name: \"PasswordLogin\",\n\n  setup() {\n    const store = useStore();\n\n    return {\n      login: async () => {\n        const emailEl = document.getElementById(\"email\") as HTMLInputElement;\n        const passwordEl = document.getElementById(\n          \"password\"\n        ) as HTMLInputElement;\n        await firebase\n          .auth()\n          .signInWithEmailAndPassword(emailEl.value, passwordEl.value);\n      }\n    };\n  }\n});\n","import { render } from \"./PasswordLogin.vue?vue&type=template&id=63c7a1a8\"\nimport script from \"./PasswordLogin.vue?vue&type=script&lang=ts\"\nexport * from \"./PasswordLogin.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<template>\n  <ConfirmDialog></ConfirmDialog>\n  <Toast position=\"bottom-left\">\n    <template #icon=\"slotProps\">\n      <div class=\"p-toast-message-icon\">\n        <span :class=\"slotProps.class\"></span>\n      </div>\n    </template>\n    <template #message=\"slotProps\">\n      <div class=\"p-toast-message-text\">\n        <span class=\"p-toast-summary\">{{slotProps.message.summary}}</span>\n        <div class=\"p-toast-detail\" v-html=\"slotProps.message.detail\" />\n      </div>\n    </template>\n  </Toast>\n  <div v-if=\"!(visibleZoomedPanedLayers && visibleZoomedPanedLayers.length)\">\n    <LogoDummy\n        :wrapHeight=\"innerHeight\"\n        :wrapWidth=\"innerWidth\"\n    />\n  </div>\n  <div v-else>\n    <div :class=\"isWideScreen() ? $style.textWrapperSearch : $style.textWrapperSearchMobile\">\n      <TextSearch :style=\"isWideScreen() ? '' : 'width: 80%;'\" />\n    </div>\n    <Menu\n        @restore-select-new-parent-is-on=\"setRestoreSelectNewParentON\"\n        @restore-select-new-parent-is-off=\"setRestoreSelectNewParentOFF\"\n        :clickedTitleId=\"clickedTitleId\"\n    />\n    <div v-if=\"isWideScreen()\">\n      <NodeContent\n          :clickedTitleId=\"clickedTitleId\"\n          @select-precondition-is-on=\"setSelectPreconditionON\"\n          @select-precondition-is-off=\"setSelectPreconditionOFF\"\n          :show=\"!editModeOn\"\n          :selectedNodeId=\"selectedNodeId\"\n      />\n      <Map\n          :layers=\"visibleZoomedPanedLayers\"\n          :selectedNodeId=\"selectedNodeId\"\n          :selectedNodePreconditionIds=\"selectedNodePreconditionIds\"\n          :pin-nodes=\"pinNodes\"\n          :searchResultPinNodes=\"searchResultPinNodes\"\n          :searchResultNodeIDs=\"searchResultNodeIDs\"\n          @title-dragging=\"nodeDragging\"\n          @title-click=\"titleClick\"\n          @title-over=\"titleOver\"\n          @title-leave=\"titleLeave\"\n          @dragging-background=\"mapDragging\"\n          @wheel=\"zoom\"\n      />\n    </div>\n    <div v-else>\n      <Splitter :style=\"`height:${innerHeight}px`\" :gutterSize=\"15\" layout=\"vertical\" @resize=\"splitterResize($event)\">\n        <SplitterPanel class=\"flex align-items-center justify-content-center\" :size=\"60\">\n          <Map\n              :layers=\"visibleZoomedPanedLayers\"\n              :selectedNodeId=\"selectedNodeId\"\n              :selectedNodePreconditionIds=\"selectedNodePreconditionIds\"\n              :pin-nodes=\"pinNodes\"\n              :searchResultPinNodes=\"searchResultPinNodes\"\n              :searchResultNodeIDs=\"searchResultNodeIDs\"\n              @title-dragging=\"nodeDragging\"\n              @title-click=\"titleClick\"\n              @title-over=\"titleOver\"\n              @title-leave=\"titleLeave\"\n              @dragging-background=\"mapDragging\"\n              @wheel=\"zoom\"\n          />\n        </SplitterPanel>\n        <SplitterPanel class=\"flex align-items-center justify-content-center\" :size=\"40\">\n          <NodeContent\n              :wrapperHeight=\"contentSplitHeight\"\n              :clickedTitleId=\"clickedTitleId\"\n              @select-precondition-is-on=\"setSelectPreconditionON\"\n              @select-precondition-is-off=\"setSelectPreconditionOFF\"\n              :show=\"!editModeOn\"\n              :selectedNodeId=\"selectedNodeId\"\n          />\n        </SplitterPanel>\n      </Splitter>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, ref, watch } from \"vue\";\nimport Map from \"@/components/map/Map.vue\";\nimport NodeContent from \"@/components/node_content/Index.vue\";\nimport ConfirmDialog from \"primevue/confirmdialog\";\nimport Toast from \"primevue/toast\";\nimport {\n  EventClickNode,\n  EventDraggingBackground,\n  EventDraggingNode,\n  EventWheel\n} from \"@/components/map/Map\";\nimport Menu from \"@/components/menu/Index.vue\";\nimport { useStore } from \"@/store\";\nimport { useRouter, useRoute, onBeforeRouteUpdate } from \"vue-router\";\nimport { mutations as treeMutations, NodeRecordItem } from \"@/store/tree\";\nimport { mutations as zoomPanMutations } from \"@/store/zoom_pan\";\nimport { actions } from \"@/store/\";\nimport {\n  filterNodesAndLayers,\n  findCentralNode,\n  zoomAndPanPoint,\n  zoomAnPanLayers,\n  zoomAnPanLayersInPlace\n} from \"@/views/Home\";\nimport { clone, printError } from \"@/tools/utils\";\nimport { MapNode, Point } from \"@/types/graphics\";\nimport { findMapNode, findMapNodes } from \"@/store/tree/helpers\";\nimport { actions as positionChangePermitsActions } from \"@/store/position_change_permits\";\nimport api from \"@/api/api\";\nimport isMobile from 'ismobilejs';\nimport TextSearch from \"@/components/menu/Textsearch.vue\";\nimport {isWideScreen} from \"@/components/helpers\";\nimport Splitter, { SplitterResizeEvent } from 'primevue/splitter';\nimport SplitterPanel from 'primevue/splitterpanel';\nimport LogoDummy from \"@/views/LogoDummy.vue\";\n\nexport default defineComponent({\n  name: \"Home\",\n\n  components: {\n    LogoDummy,\n    Splitter,\n    SplitterPanel,\n    TextSearch,\n    Map,\n    Menu,\n    NodeContent,\n    ConfirmDialog,\n    Toast\n  },\n\n  setup() {\n    const store = useStore();\n    const router = useRouter();\n    const route = useRoute();\n    const treeState = store.state.tree;\n    const zoomPanState = store.state.zoomPan;\n    const pinState = store.state.pin;\n    const searchResultState = store.state.searchResult;\n    const clickedTitleId = ref(\"-1\");\n    let selectPreconditionIsOn = false;\n    let restoreSelectNewParentIsOn = false;\n    let titleOver = false;\n\n    // Set node from URL as selected\n    watch(\n      () => route.params.id,\n      () => {\n        store.commit(\n          `tree/${treeMutations.SET_SELECTED_NODE_ID}`,\n          route.params.id\n        );\n      },\n      { immediate: true }\n    );\n\n    /**\n     * Method updateLayers extracts visibleLayers and nodes from mapNodeLayers.\n     * These are the nodes that will be visible to the user\n     * (and are always just a small part of all nodes of the map).\n     * @param centralNodeId\n     * @param mapNodeLayers\n     * @param nodeRecord\n     */\n    const updateLayers = (\n      centralNodeId: string,\n      mapNodeLayers: Array<Record<string, MapNode>>,\n      nodeRecord: Record<string, NodeRecordItem>\n    ): Array<Record<number, MapNode>> => {\n      // Вычленяем слои и узлы которые мы хотим показывать учитывая что текущий видимый узел это centralNodeId\n      const [filteredLayers, err] = filterNodesAndLayers(\n        mapNodeLayers,\n        nodeRecord,\n        centralNodeId\n      );\n      if (err) {\n        printError(\"Home.vue: error in filterNodesAndLayers:\", { err });\n        return [];\n      }\n      return filteredLayers.reverse();\n    };\n\n    const centralNodeId = ref<string | null>(null);\n    // visibleLayers consists only from user visible nodes and visibleLayers of all (which is treeState.mapNodeLayers)\n    const visibleLayers = ref<Array<Record<string, MapNode>>>([]);\n\n    // Ugly hack to determine a first load of page\n    let isFirstPageLoad = true;\n    onBeforeRouteUpdate(async (to, from) => {\n      isFirstPageLoad = false;\n    });\n    // If this is isFirstPageLoad then pan map to node in URL\n    watch(\n      () => [treeState.mapNodeLayers],\n      () => {\n        if (\n          isFirstPageLoad &&\n          route.params.id.length > 0 &&\n          treeState.mapNodeLayers.length > 0\n        ) {\n          const [firstNode] = findMapNode(\n            route.params.id as string,\n            treeState.mapNodeLayers\n          );\n          if (firstNode != null) {\n            store.commit(`zoomPan/${zoomPanMutations.SET_PAN}`, {\n              x: -firstNode.center.x + treeState.mapNodeLayers[0][\"0\"].center.x,\n              y: -firstNode.center.y + treeState.mapNodeLayers[0][\"0\"].center.y\n            });\n          }\n        }\n      }\n    );\n\n    // Determine which nodes to show based on current pan and zoom\n    watch(\n      () => [\n        treeState.mapNodeLayers,\n        zoomPanState.debouncedZoom,\n        zoomPanState.debouncedPan\n      ],\n      () => {\n        const [newCentralNodeId, err] = findCentralNode(\n          treeState.mapNodeLayers,\n          treeState.nodeRecord,\n          { width: window.innerWidth, height: window.innerHeight },\n          zoomPanState.debouncedZoom,\n          zoomPanState.pan,\n            {x:api.ROOT_CENTER_X, y:api.ROOT_CENTER_Y}\n          // zoomPanState.zoomCenter\n        );\n        if (err != null) {\n          printError(\"filterNodesAndLayers: error in findCurrentNode\", { err });\n        }\n\n        centralNodeId.value = newCentralNodeId;\n        visibleLayers.value = updateLayers(\n          newCentralNodeId,\n          treeState.mapNodeLayers,\n          treeState.nodeRecord\n        );\n      },\n      { immediate: true, deep: true }\n    );\n\n    const visibleZoomedPanedLayers = ref<Array<Record<string, MapNode>>>([]);\n    let layersToZoomAndPan = [] as Array<Record<string, MapNode>>;\n    watch(visibleLayers, ()=>{\n      // visibleLayers это всегда слои с zoom=1 и pan={0, 0} состоящие только из видимых прямо сейчас элементов.\n      // Мы применяем к этому объекту текущий zoomPanState, но сам эталон не трогаем, поэтому здесь clone\n      const svg = document.getElementById(\"mapID\") as any\n      if (svg && isMobile().phone) {\n        // сбрасываем svg трансформацию\n        svg.setAttribute('transform', ` scale(1 1)`);\n        const viewBox = svg.viewBox.baseVal;\n        // сбрасываем pan viewBox\n        viewBox.x = 0;\n        viewBox.y = 0;\n      }\n      layersToZoomAndPan = clone(visibleLayers.value);\n      visibleZoomedPanedLayers.value = zoomAnPanLayers(\n          layersToZoomAndPan,\n          zoomPanState.zoom,\n          zoomPanState.pan\n      );\n    },{ immediate: true, deep: true })\n    watch(\n      () => [\n        zoomPanState.zoom,\n        zoomPanState.pan,\n      ],\n        (newArgs, oldArgs) => {\n        if (!oldArgs) {\n          visibleZoomedPanedLayers.value = zoomAnPanLayers(\n              layersToZoomAndPan,\n              zoomPanState.zoom,\n              zoomPanState.pan\n          )\n        } else {\n          const svg = document.getElementById(\"mapID\") as any\n          if (svg && isMobile().phone) {\n            // для мобильного в реальном времени pan и zoom делаем через svg transform\n            // т к на мобильном пересчет через zoomAnPanLayersInPlace притормаживает\n            svg.setAttribute('transform-origin', ` ${zoomPanState.zoomCenter.x}px ${zoomPanState.zoomCenter.y}px`);\n            svg.setAttribute('transform', ` scale(${zoomPanState.relative.zoom})`);\n            // TODO: для pan вместо viewBox лучше использовать svg transform translate для единообразия\n            // svg.setAttribute('transform', ` scale(${zoomPanState.relative.zoom}) translate(${zoomPanState.relative.pan.x} ${zoomPanState.relative.pan.y})`);\n            // Но при таком подходе после pan обрезается все что вне экрана (так же как сейчас при zoom)\n            // Если же использовать viewBox для zoom начинается какой-то неадекват с определением bbox для title:\n            // viewBox.width =  viewBox.width/zoomPanState.relative.zoom\n            // viewBox.height =  viewBox.height/zoomPanState.relative.zoom\n            // Разбираться не стал, в результате пока что такой вот костыль из смеси viewBox и transform\n            const viewBox = svg.viewBox.baseVal;\n            viewBox.x = -zoomPanState.relative.pan.x;\n            viewBox.y = -zoomPanState.relative.pan.y;\n          } else {\n            zoomAnPanLayersInPlace(\n                visibleZoomedPanedLayers.value,\n                newArgs[0] as number,\n                newArgs[1] as Point,\n                oldArgs[0] as number,\n                oldArgs[1] as Point,\n            );\n          }\n        }\n      },\n      { immediate: true, deep: true }\n    );\n\n    const contentSplitHeight = ref(window.innerHeight*0.4);\n\n    return {\n      innerHeight: window.innerHeight,\n      innerWidth: window.innerWidth,\n      isWideScreen,\n      /**\n       * pinNodes\n       */\n      pinNodes: computed(() => {\n        if (centralNodeId.value == null) {\n          return [];\n        }\n        const pinNodeIDs = pinState.pinsReverse[centralNodeId.value];\n        if (!pinNodeIDs) {\n          return [];\n        }\n\n        // remove pins that already exists on visibleLayers\n        for (const layer of visibleLayers.value) {\n          for (const nodeID in layer) {\n            const node = layer[nodeID];\n            if (node.title != \"\") {\n              const ind = pinNodeIDs.indexOf(node.id);\n              if (ind != -1) {\n                pinNodeIDs.splice(ind, 1);\n              }\n            }\n          }\n        }\n\n        const pinMapNodes = findMapNodes(pinNodeIDs, treeState.mapNodeLayers);\n        const result = [];\n        for (const pinMapNode of pinMapNodes) {\n          const cl = clone(pinMapNode);\n          if (isMobile().phone) {\n            cl.center = zoomAndPanPoint(\n                pinMapNode.center,\n                zoomPanState.debouncedZoom,\n                zoomPanState.debouncedPan\n            );\n          } else {\n            cl.center = zoomAndPanPoint(\n                pinMapNode.center,\n                zoomPanState.zoom,\n                zoomPanState.pan\n            );\n          }\n\n          result.push(cl);\n        }\n\n        return result;\n      }),\n\n      /**\n       * searchResultNodeIDs\n       */\n      searchResultNodeIDs: computed(() => {\n        return searchResultState.nodeIDs;\n      }),\n\n      /**\n       * searchResultPinNodes\n       */\n      searchResultPinNodes: computed(() => {\n        if (centralNodeId.value == null) {\n          return [];\n        }\n        const searchResultNodeIDs = clone(searchResultState.nodeIDs);\n        if (!searchResultNodeIDs) {\n          return [];\n        }\n\n        // remove pins that already exists on visibleLayers\n        for (const layer of visibleLayers.value) {\n          for (const nodeID in layer) {\n            const node = layer[nodeID];\n            if (node.title != \"\") {\n              const ind = searchResultNodeIDs.indexOf(node.id);\n              if (ind != -1) {\n                searchResultNodeIDs.splice(ind, 1);\n              }\n            }\n          }\n        }\n\n        const searchResultMapNodes = findMapNodes(\n          searchResultNodeIDs,\n          treeState.mapNodeLayers\n        );\n        const result = [];\n        for (const searchResultMapNode of searchResultMapNodes) {\n          const cl = clone(searchResultMapNode);\n          if (isMobile().phone) {\n            cl.center = zoomAndPanPoint(\n                searchResultMapNode.center,\n                zoomPanState.debouncedZoom,\n                zoomPanState.debouncedPan\n            );\n          } else {\n            cl.center = zoomAndPanPoint(\n                searchResultMapNode.center,\n                zoomPanState.zoom,\n                zoomPanState.pan\n            );\n          }\n\n          result.push(cl);\n        }\n\n        return result;\n      }),\n\n      editModeOn: computed(() => store.state.editModeOn),\n      selectedNodeId: computed(() => treeState.selectedNodeId),\n      selectedNodePreconditionIds: computed(() =>\n        treeState.selectedNodeId\n          ? store.state.precondition.preconditions[treeState.selectedNodeId]\n          : []\n      ),\n      visibleZoomedPanedLayers: visibleZoomedPanedLayers,\n      nodeDragging: async (e: EventDraggingNode) => {\n        const hasDragPermit = await store.dispatch(\n          `positionChangePermits/${positionChangePermitsActions.CheckNodeID}`,\n          e.id\n        );\n        if (!hasDragPermit) {\n          return;\n        }\n        await store.dispatch(`${actions.updateNodePosition}`, {\n          nodeId: e.id,\n          delta: {\n            x: e.delta.x / zoomPanState.zoom,\n            y: e.delta.y / zoomPanState.zoom\n          }\n        });\n      },\n      setSelectPreconditionON: () => {\n        selectPreconditionIsOn = true;\n      },\n      setSelectPreconditionOFF: () => {\n        selectPreconditionIsOn = false;\n        clickedTitleId.value = \"-1\"\n      },\n      setRestoreSelectNewParentON: () => {\n        restoreSelectNewParentIsOn = true;\n      },\n      setRestoreSelectNewParentOFF: () => {\n        restoreSelectNewParentIsOn = false;\n      },\n      clickedTitleId,\n      titleClick: (e: EventClickNode) => {\n        if (restoreSelectNewParentIsOn || selectPreconditionIsOn) {\n          clickedTitleId.value = e.id;\n        } else {\n          router.push({ name: \"node\", params: { id: e.id } });\n        }\n      },\n      titleOver: (e: EventClickNode) => {\n        titleOver = true;\n        store.commit(`tree/${treeMutations.SET_SELECTED_NODE_ID}`, e.id);\n      },\n      titleLeave: (e: EventClickNode) => {\n        titleOver = false;\n        store.commit(\n          `tree/${treeMutations.SET_SELECTED_NODE_ID}`,\n          route.params.id\n        );\n      },\n      mapDragging: (event: EventDraggingBackground) => {\n        if (store.state.editModeOn && titleOver) {\n          // to prevent pan while node position editing ( = title dragging in edit mode)\n          return;\n        }\n        store.commit(`zoomPan/${zoomPanMutations.ADD_PAN}`, event);\n        store.commit(`zoomPan/${zoomPanMutations.ADD_RELATIVE_PAN}`, event);\n      },\n      zoom: (event: EventWheel) => {\n        // initial value of a center (when root.border == viewport)\n        const initial = {\n          x: (event.center.x - zoomPanState.pan.x) / zoomPanState.zoom,\n          y: (event.center.y - zoomPanState.pan.y) / zoomPanState.zoom\n        };\n        store.commit(\n            `zoomPan/${zoomPanMutations.SET_ZOOM_CENTER}`,\n            event.center\n        );\n        store.commit(`zoomPan/${zoomPanMutations.ADD_ZOOM}`, event.delta);\n        const after = {\n          x: initial.x * zoomPanState.zoom + zoomPanState.pan.x,\n          y: initial.y * zoomPanState.zoom + zoomPanState.pan.y\n        };\n        store.commit(`zoomPan/${zoomPanMutations.ADD_PAN}`, {\n          from: after,\n          to: event.center\n        });\n      },\n      splitterResize: (event: SplitterResizeEvent) => {\n        contentSplitHeight.value = window.innerHeight*event.sizes[1]/100\n      },\n      contentSplitHeight,\n    };\n  }\n});\n</script>\n\n<style module>\n.textWrapperSearch {\n  z-index:20;\n  position: fixed;\n  display: flex;\n  top: 0;\n  left: 0;\n  width: 30%;\n  padding: 15px 20px;\n  background: linear-gradient(rgba(120, 120, 120, 0.4), rgba(120, 120, 120, 0));\n}\n.textWrapperSearchMobile {\n  z-index:20;\n  position: fixed;\n  display: flex;\n  top: 0;\n  left: 0;\n  width: 100%;\n  padding: 15px 20px;\n  background: linear-gradient(rgba(120, 120, 120, 0.4), rgba(120, 120, 120, 0));\n}\n</style>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    :width=\"svgWidth\"\n    :height=\"svgHeight\"\n    :viewBox=\"`0 0 ${svgWidth} ${svgHeight}`\"\n    :id=\"mapID\"\n    style=\"touch-action: none;\"\n  >\n    <MapLayer\n      v-for=\"(layer, index) of layers\"\n      :key=\"index\"\n      :layer-id=\"index\"\n      :map-nodes=\"layer\"\n      :border-color=\"borderColor(index)\"\n      :font-color=\"fontColor(index)\"\n      :font-size=\"fontSize(index)\"\n      :font-opacity=\"fontOpacity(index)\"\n      :selectedNodeId=\"selectedNodeId\"\n      :selectedNodePreconditionIds=\"selectedNodePreconditionIds\"\n      :searchResultNodeIDs=\"searchResultNodeIDs\"\n      :map-id=\"mapID\"\n      @title-dragging=\"draggingNode\"\n      @title-click=\"titleClick\"\n      @title-over=\"titleOver\"\n      @title-leave=\"titleLeave\"\n    />\n    <PreconditionLayer\n      :selectedNodeId=\"selectedNodeId\"\n      :visibleTitleIds=\"visibleTitleIds\"\n      :layer-id=\"`precondition`\"\n      @title-click=\"titleClick\"\n      @title-over=\"titleOver\"\n      @title-leave=\"titleLeave\"\n    />\n    <PinLayer\n      :pinNodes=\"pinNodes\"\n      :layer-id=\"`pinNodes`\"\n      color=\"pink\"\n      :font-size=\"8\"\n      font-weight=\"normal\"\n      text-decoration=\"none\"\n      :selectedNodeId=\"selectedNodeId\"\n      @title-click=\"titleClick\"\n      @title-over=\"titleOver\"\n      @title-leave=\"titleLeave\"\n    />\n    <PinLayer\n      :pinNodes=\"searchResultPinNodes\"\n      :layer-id=\"`searchResultPinNodes`\"\n      color=\"red\"\n      :font-size=\"10\"\n      font-weight=\"bold\"\n      text-decoration=\"underline\"\n      :selectedNodeId=\"selectedNodeId\"\n      @title-click=\"titleClick\"\n      @title-over=\"titleOver\"\n      @title-leave=\"titleLeave\"\n    />\n  </svg>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, onMounted, PropType } from \"vue\";\nimport { MapNode } from \"@/types/graphics\";\nimport MapLayer from \"@/components/map_layer/MapLayer.vue\";\nimport {\n  EventClickNode,\n  EventDraggingNode\n} from \"@/components/map_layer/MapLayer\";\nimport pan from \"./MapPan\";\nimport PinLayer from \"@/components/pin_layer/PinLayer.vue\";\nimport { printError } from \"@/tools/utils\";\nimport PreconditionLayer from \"@/components/precondition_layer/PreconditionLayer.vue\";\nimport {isWideScreen} from \"@/components/helpers\";\n\nconst mapID = \"mapID\";\n\nexport default defineComponent({\n  name: \"Map\",\n  emits: [\n    \"title-dragging\",\n    \"title-click\",\n    \"title-over\",\n    \"title-leave\",\n    \"dragging-background\",\n    \"wheel\"\n  ],\n  components: {\n    PreconditionLayer,\n    PinLayer,\n    MapLayer\n  },\n  props: {\n    layers: Object as PropType<Array<Record<string, MapNode>>>,\n    selectedNodeId: {\n      type: String || null,\n      validator: (prop: string | null) =>\n        typeof prop === \"string\" || prop === null,\n      required: true\n    },\n    selectedNodePreconditionIds: Object as PropType<string[]>,\n    pinNodes: Object as PropType<MapNode[]>,\n    searchResultPinNodes: Object as PropType<MapNode[]>,\n    searchResultNodeIDs: Object as PropType<string[]>\n  },\n  setup(props, ctx) {\n    onMounted(() => {\n      const map = document.getElementById(mapID);\n      if (!map) {\n        printError(\"Map.vue: cannot find map id for event listener\", {});\n        return;\n      }\n\n      /**\n       * Mouse events\n       */\n      map.addEventListener(\"mousedown\", event => {\n        pan.mouseDown();\n      });\n      map.addEventListener(\"mouseup\", event => {\n        pan.mouseUp();\n      });\n      map.addEventListener(\"mousemove\", event => {\n        pan.mouseMove(ctx.emit, {\n          from: {\n            x: event.clientX - event.movementX,\n            y: event.clientY - event.movementY\n          },\n          to: { x: event.clientX, y: event.clientY }\n        });\n      });\n\n      // zoom with mouse wheel\n      map.addEventListener(\n        \"wheel\",\n        event => {\n          ctx.emit(\"wheel\", {\n            delta: -event.deltaY,\n            center: { x: event.clientX, y: event.clientY }\n          });\n        },\n        { passive: true }\n      );\n\n      /**\n       * Mobile touch events\n       */\n      // zoom stuff\n      let prevDist = Infinity;\n      let center = {x:0, y:0};\n      // drag stuff\n      const prevPoint = { x: Infinity, y: Infinity };\n      map.addEventListener(\n        \"touchstart\",\n        e => {\n          if (e.touches.length === 1) {\n            prevPoint.x = e.touches[0].clientX;\n            prevPoint.y = e.touches[0].clientY;\n          }\n          if (e.touches.length === 2) {\n            prevDist = Infinity;\n          }\n\n          pan.mouseDown();\n        },\n        { passive: true }\n      );\n      map.addEventListener(\"touchend\", event => {\n        // zoom stuff\n        center = {x:0, y:0};\n        prevDist = Infinity;\n        // dragging stuff\n        prevPoint.x = Infinity;\n        prevPoint.y = Infinity;\n        pan.mouseUp();\n      });\n\n      // mobile zoom\n      map.addEventListener(\n        \"touchmove\",\n        e => {\n          if (e.touches.length === 1) {\n            if (prevPoint.x != Infinity && prevPoint.y != Infinity) {\n              pan.mouseMove(ctx.emit, {\n                from: prevPoint,\n                to: { x: e.touches[0].clientX, y: e.touches[0].clientY }\n              });\n            }\n            prevPoint.x = e.touches[0].clientX;\n            prevPoint.y = e.touches[0].clientY;\n          } else if (e.touches.length === 2) {\n            let delta = 0;\n            if (prevDist === Infinity) {\n              // init center\n              center = {\n                x: e.touches[0].pageX + (e.touches[0].pageX - e.touches[1].pageX) / 2,\n                y: e.touches[0].pageY + (e.touches[0].pageY - e.touches[1].pageY) / 2\n              };\n            }\n            const dist = Math.max(\n                Math.abs(center.x - e.touches[0].pageX),\n                Math.abs(center.x - e.touches[1].pageX),\n                Math.abs(center.y - e.touches[0].pageY),\n                Math.abs(center.y - e.touches[1].pageY),\n            );\n            if (prevDist !== Infinity) {\n              delta = dist - prevDist;\n            }\n            prevDist = dist;\n\n            ctx.emit(\"wheel\", {\n              delta: 4*delta,\n              center: center,\n            });\n          }\n        },\n        { passive: true }\n      );\n    });\n\n    return {\n      svgWidth: window.innerWidth,\n      svgHeight: window.innerHeight,\n      visibleTitleIds: computed(() => {\n        if (!props.layers) {\n          return [];\n        }\n        const ids = [];\n        for (const layer of props.layers) {\n          for (const idx in layer) {\n            if (layer[idx].title != \"\") {\n              ids.push(idx);\n            }\n          }\n        }\n        return ids;\n      }),\n      draggingNode: (e: EventDraggingNode) => {\n        ctx.emit(\"title-dragging\", {\n          id: e.nodeId,\n          delta: e.delta\n        });\n      },\n      titleClick: (e: EventClickNode) => {\n        ctx.emit(\"title-click\", { id: e.id });\n      },\n      titleOver: (e: EventClickNode) => {\n        ctx.emit(\"title-over\", { id: e.id });\n      },\n      titleLeave: (e: EventClickNode) => {\n        ctx.emit(\"title-leave\", { id: e.id });\n      },\n      mapID,\n      fontSize: (index: number): number => {\n        let size = 0;\n        let levelSizes: Record<number, number>\n        if (isWideScreen()) {\n          levelSizes = {\n            0: 0.4,\n            1: 0.73,\n            2: 1.4,\n            3: 1.86\n          };\n        } else {\n          levelSizes = {\n            0: 1.8*0.4,\n            1: 1.8*0.73,\n            2: 1.8*1.4,\n            3: 1.8*1.86\n          };\n        }\n\n        if (props.layers!.length >= 4) {\n          size = levelSizes[index];\n        }\n        if (props.layers!.length == 3) {\n          size = levelSizes[index + 1];\n        }\n        return size;\n      },\n      fontOpacity: (index: number): number => {\n        let val = 0;\n        const levelSizes: Record<number, number> = {\n          0: 1,\n          1: 1,\n          2: 0.2,\n          3: 1\n        };\n        if (props.layers!.length >= 4) {\n          val = levelSizes[index];\n        }\n        if (props.layers!.length == 3) {\n          val = levelSizes[index + 1];\n        }\n        return val;\n      },\n      fontColor: (index: number): string => {\n        if (props.layers!.length >= 4) {\n          return `rgb(${200 - 100 * index},${200 - 100 * index},${200 -\n            100 * index})`;\n        }\n        if (props.layers!.length == 3) {\n          return `rgb(${200 - 100 * (index + 1)},${200 -\n            100 * (index + 1)},${200 - 100 * (index + 1)})`;\n        }\n        return \"\";\n      },\n      borderColor: (index: number): string => {\n        let color = 0;\n        const levelColors: Record<number, number> = {\n          0: 240,\n          1: 200,\n          2: 100,\n          3: 90\n        };\n        if (props.layers!.length >= 4) {\n          color = levelColors[index];\n        }\n        if (props.layers!.length == 3) {\n          color = levelColors[index + 1];\n        }\n        return `rgb(${color},${color},${color})`;\n      }\n    };\n  }\n});\n</script>\n\n<style scoped></style>\n","<template>\n  <polygon\n    v-for=\"(mapNode, i) of mapNodes\"\n    :key=\"i\"\n    :stroke=\"borderColor\"\n    :fill=\"polygonFill(selectedNodeId, mapNode.id, selectedNodePreconditionIds)\"\n    :fill-opacity=\"\n      polygonFillOpacity(\n        selectedNodeId,\n        mapNode.id,\n        selectedNodePreconditionIds\n      )\n    \"\n    stroke-width=\"2\"\n    :points=\"polygonToPath(mapNode.border)\"\n    pointer-events=\"none\"\n  />\n  <!--    <circle-->\n  <!--      v-for=\"mapNode of mapNodes\"-->\n  <!--      :key=\"mapNode.id\"-->\n  <!--      :cx=\"mapNode.center.x\"-->\n  <!--      :cy=\"mapNode.center.y\"-->\n  <!--      r=\"10\"-->\n  <!--      stroke=\"black\"-->\n  <!--      stroke-width=\"1\"-->\n  <!--      fill=\"red\"-->\n  <!--    />-->\n  <!--  <SVGTextBox> component shows unpredictable behaviour here and I didn't dig the reason so just used copy of SVGTextBox here -->\n  <text\n    v-for=\"mapNode of mapNodes\"\n    :id=\"`${TITLE_PREFIX}${mapNode.id}`\"\n    :key=\"mapNode.id\"\n    font-family=\"Roboto\"\n    :font-size=\"`${fontSize}vmax`\"\n    :font-weight=\"textWeight(mapNode.id, selectedNodeId)\"\n    :fill=\"textColor(mapNode.id, selectedNodeId)\"\n    :fill-opacity=\"fontOpacity\"\n    :text-decoration=\"textDecoration(mapNode.id)\"\n    class=\"text\"\n  >\n    <tspan\n      v-for=\"(line, i) of splitLines(mapNode.title, 20)\"\n      :key=\"i\"\n      :x=\"titleBox[mapNode.id] ? titleBox[mapNode.id].position.x : 0\"\n      :y=\"\n        titleBox[mapNode.id] && innerWidth>0\n          ? titleBox[mapNode.id].position.y + i * fontSize * Math.max(innerWidth, innerHeight)/100\n          : 0\n      \"\n      alignment-baseline=\"hanging\"\n    >\n      {{ line }}\n    </tspan>\n  </text>\n  <!-- Add rectangle to change cursor to pointer when hover on text -->\n  <rect\n    v-for=\"mapNode of mapNodes\"\n    :key=\"mapNode.id\"\n    :x=\"titleBox[mapNode.id] ? titleBox[mapNode.id].position.x : 0\"\n    :y=\"titleBox[mapNode.id] ? titleBox[mapNode.id].position.y : 0\"\n    :width=\"titleBox[mapNode.id] ? titleBox[mapNode.id].bbox.width : 0\"\n    :height=\"titleBox[mapNode.id] ? titleBox[mapNode.id].bbox.height : 0\"\n    fill=\"transparent\"\n    stroke-width=\"0\"\n    @mouseover=\"titleOver(mapNode.id)\"\n    @mouseleave=\"titleLeave(mapNode.id)\"\n    @click=\"titleClick(mapNode.id)\"\n    @mousedown=\"titleMouseDown(mapNode.id)\"\n    stroke=\"pink\"\n    cursor=\"pointer\"\n    pointer-events=\"fill\"\n  />\n</template>\n\n<script lang=\"ts\">\nimport {\n  defineComponent,\n  PropType,\n  toRef,\n  onMounted,\n  onUnmounted,\n  computed\n} from \"vue\";\nimport { MapNode } from \"@/types/graphics\";\nimport {\n  polygonToPath,\n  polygonFill,\n  polygonFillOpacity\n} from \"@/tools/graphics\";\nimport {\n  setTitleBoxes,\n  MouseDownInfo,\n  mouseMoveListener,\n  mouseUpListener\n} from \"@/components/map_layer/MapLayer\";\nimport { printError } from \"@/tools/utils\";\nimport { splitLines } from \"@/components/SVGTextBox\";\nimport { useStore } from \"@/store\";\nimport { TitleBox, mutations as titleBoxMutations } from \"@/store/title_box\";\n\nconst TITLE_PREFIX = \"title_\";\n\nexport default defineComponent({\n  name: \"MapLayer\",\n  emits: [\n    \"title-over\",\n    \"title-leave\",\n    \"title-click\",\n    \"title-drop\",\n    \"title-dragging\"\n  ],\n  props: {\n    layerId: {\n      type: Number\n    },\n    mapId: {\n      type: String,\n      required: true\n    },\n    mapNodes: {\n      type: Object as PropType<Record<string, MapNode>>,\n      required: true\n    },\n    borderColor: {\n      type: String,\n      required: true\n    },\n    fontSize: {\n      type: Number,\n      required: true\n    },\n    fontColor: {\n      type: String,\n      required: true\n    },\n    fontOpacity: {\n      type: Number,\n      required: true\n    },\n    selectedNodeId: {\n      type: String,\n      validator: (prop: string | null) =>\n        typeof prop === \"string\" || prop === null,\n      required: true\n    },\n    selectedNodePreconditionIds: Object as PropType<string[]>,\n    searchResultNodeIDs: Object as PropType<string[]>\n  },\n\n  setup(props, ctx) {\n    const mapNodes = toRef(props, \"mapNodes\");\n\n    const store = useStore();\n    const layerID = \"map_\" + props.layerId;\n    const titleBox = computed(() => {\n      return store.state.titleBox.layerMap[layerID];\n    });\n    setTitleBoxes(\n      TITLE_PREFIX,\n      \"center\",\n      mapNodes,\n      (titleBoxMap: Record<string, TitleBox>) => {\n        store.commit(`titleBox/${titleBoxMutations.SET_MAP}`, {\n          layerName: layerID,\n          titleBoxMap\n        });\n      }\n    );\n\n    /**\n     * Send event on titleBox click, drag and drop\n     */\n    const titleMouseDownInfo: MouseDownInfo = {\n      nodeId: null,\n      dragStart: false\n    };\n    const mouseMove = (event: MouseEvent) =>\n      mouseMoveListener(ctx.emit, event, titleMouseDownInfo);\n    const mouseUp = () => mouseUpListener(ctx.emit, titleMouseDownInfo);\n    onMounted(() => {\n      const map = document.getElementById(props.mapId);\n      if (!map) {\n        printError(\"MapLayer.vue: cannot find map id for event listener\", {});\n        return;\n      }\n      map.addEventListener(\"mousemove\", mouseMove);\n      map.addEventListener(\"mouseup\", mouseUp);\n    });\n    onUnmounted(() => {\n      const map = document.getElementById(props.mapId);\n      if (!map) {\n        printError(\"MapLayer.vue: cannot find map id for event listener\", {});\n        return;\n      }\n      map.removeEventListener(\"mousemove\", mouseMove);\n      map.removeEventListener(\"mouseup\", mouseUp);\n    });\n\n    const searchResultNodeIDsMap = computed(() => {\n      const map = {} as Record<string, boolean>;\n      if (!props.searchResultNodeIDs) {\n        return map;\n      }\n      for (const id of props.searchResultNodeIDs) {\n        map[id] = true;\n      }\n      return map;\n    });\n\n    return {\n      TITLE_PREFIX,\n      titleBox,\n      innerWidth: window.innerWidth,\n      innerHeight: window.innerHeight,\n      textColor: (nodeID: string, selectedNodeId: string) => {\n        if (selectedNodeId && selectedNodeId == nodeID) {\n          return \"#ffa500\";\n        }\n        if (\n          props.selectedNodePreconditionIds &&\n          props.selectedNodePreconditionIds?.indexOf(nodeID) != -1\n        ) {\n          return \"#ffa500\";\n        }\n        if (searchResultNodeIDsMap.value[nodeID]) {\n          return \"red\";\n        }\n\n        return props.fontColor;\n      },\n      textWeight: (nodeID: string, selectedNodeId: string) => {\n        if (selectedNodeId && selectedNodeId == nodeID) {\n          return \"bold\";\n        }\n        if (searchResultNodeIDsMap.value[nodeID]) {\n          return \"bold\";\n        }\n\n        return \"normal\";\n      },\n      textDecoration: (nodeID: string) => {\n        if (searchResultNodeIDsMap.value[nodeID]) {\n          return \"underline\";\n        }\n\n        return \"none\";\n      },\n      titleClick: (nodeID: string) => {\n        ctx.emit(\"title-click\", {\n          id: nodeID\n        });\n      },\n      titleOver: (nodeID: string) => {\n        ctx.emit(\"title-over\", {\n          id: nodeID\n        });\n      },\n      titleLeave: (nodeID: string) => {\n        ctx.emit(\"title-leave\", {\n          id: nodeID\n        });\n      },\n      titleMouseDown: (id: string) => {\n        titleMouseDownInfo.nodeId = id;\n        titleMouseDownInfo.dragStart = false;\n      }\n    };\n  },\n\n  methods: {\n    splitLines,\n    polygonToPath,\n    polygonFill,\n    polygonFillOpacity\n  }\n});\n</script>\n\n<style scoped>\n.text {\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  pointer-events: none;\n}\n</style>\n","import { MapNode, Point } from \"@/types/graphics\";\nimport { nextTick, Ref, watch } from \"vue\";\n\nexport type EventClickNode = {\n  id: string;\n};\n\nexport type EventDraggingNode = {\n  nodeId: string;\n  delta: Point;\n};\n\nexport type MouseDownInfo = {\n  nodeId: string | null;\n  dragStart: boolean;\n};\n\ntype emitDragging = (\n  event: \"title-dragging\",\n  args: { nodeId: string; delta: Point }\n) => void;\ntype emitDrop = (event: \"title-drop\", args: { id: string }) => void;\n\ntype TitleBox = {\n  position: Point;\n  bbox: {\n    width: number;\n    height: number;\n  };\n};\n\nexport const mouseMoveListener = (\n  emit: emitDragging,\n  event: MouseEvent,\n  mouseDownInfo: MouseDownInfo\n) => {\n  if (mouseDownInfo.nodeId) {\n    mouseDownInfo.dragStart = true;\n    emit(\"title-dragging\", {\n      nodeId: mouseDownInfo.nodeId,\n      delta: {\n        x: event.movementX,\n        y: event.movementY\n      }\n    });\n  }\n};\n\nexport const mouseUpListener = (\n  emit: emitDrop,\n  mouseDownInfo: MouseDownInfo\n) => {\n  if (mouseDownInfo.nodeId) {\n    if (mouseDownInfo.dragStart) {\n      emit(\"title-drop\", { id: mouseDownInfo.nodeId });\n    }\n    mouseDownInfo.dragStart = false;\n    mouseDownInfo.nodeId = null;\n  }\n};\n\nexport const nodeToTitleBox = (\n  nodes: Record<string, MapNode>\n): Record<string, TitleBox> => {\n  const titleBox: Record<string, TitleBox> = {};\n  for (const i in nodes) {\n    const node = nodes[i];\n    titleBox[node.id] = {\n      position: node.center,\n      bbox: {\n        width: 0,\n        height: 0\n      }\n    };\n  }\n\n  return titleBox;\n};\n\nconst updateTitleBox = async (\n  titleIdPrefix: string,\n  position: \"center\" | \"left\",\n  mapNodes: Record<string, MapNode>\n): Promise<Record<string, TitleBox>> => {\n  const titleBox = {} as Record<string, TitleBox>;\n\n  // Code that will run only after the entire view has been rendered\n  await nextTick(() => {\n    // fill new ones\n    for (const i in mapNodes) {\n      const node = mapNodes[i];\n      const dom = document.getElementById(`${titleIdPrefix}${node.id}`);\n      if (dom == null) {\n        continue;\n      }\n      if (position == \"center\") {\n        titleBox[node.id] = {\n          position: {\n            x: node.center.x - dom.getBoundingClientRect().width / 2,\n            y: node.center.y - dom.getBoundingClientRect().height / 2\n          },\n          bbox: {\n            width: dom.getBoundingClientRect().width,\n            height: dom.getBoundingClientRect().height\n          }\n        };\n      } else if (position == \"left\") {\n        titleBox[node.id] = {\n          position: {\n            x: node.center.x - dom.getBoundingClientRect().width,\n            y: node.center.y - dom.getBoundingClientRect().height / 2\n          },\n          bbox: {\n            width: dom.getBoundingClientRect().width,\n            height: dom.getBoundingClientRect().height\n          }\n        };\n      }\n    }\n  });\n\n  return titleBox;\n};\n\nexport const setTitleBoxes = (\n  titleIdPrefix: string,\n  position: \"center\" | \"left\",\n  mapNodes: Ref<Record<string, MapNode>>,\n  cb: (titleBoxMap: Record<string, TitleBox>) => void\n) => {\n  cb(nodeToTitleBox(mapNodes.value));\n  /**\n   * Update titleBox on every prop change after DOM rerender\n   */\n  watch(\n    mapNodes,\n    async mps => {\n      return updateTitleBox(titleIdPrefix, position, mps).then(titleBoxMap =>\n        cb(titleBoxMap)\n      );\n    },\n    {\n      immediate: true,\n      deep: true,\n    }\n  );\n};\n","export function splitLines(text: string, maxCharNum: number): string[] {\n  if (maxCharNum <= 0) {\n    return [];\n  }\n  if (text == \"\") {\n    return [];\n  }\n  const words = text.split(\" \");\n  const lines: string[] = [];\n  let currLine: string[] = [];\n  while (words.length) {\n    if (currLine.join(\" \").length > maxCharNum) {\n      const nextLine: string[] = [];\n      if (currLine.length > 1) {\n        nextLine.push(currLine.pop()!);\n      }\n      lines.push(currLine.join(\" \"));\n      currLine = nextLine;\n    } else {\n      currLine.push(words.shift()!);\n    }\n  }\n\n  if (currLine.join(\" \").length > maxCharNum) {\n    const nextLine: string[] = [];\n    if (currLine.length > 1) {\n      nextLine.push(currLine.pop()!);\n    }\n    lines.push(currLine.join(\" \"));\n    currLine = nextLine;\n  }\n  if (currLine.length) {\n    lines.push(currLine.join(\" \"));\n  }\n  return lines;\n}\n","\nimport {\n  defineComponent,\n  PropType,\n  toRef,\n  onMounted,\n  onUnmounted,\n  computed\n} from \"vue\";\nimport { MapNode } from \"@/types/graphics\";\nimport {\n  polygonToPath,\n  polygonFill,\n  polygonFillOpacity\n} from \"@/tools/graphics\";\nimport {\n  setTitleBoxes,\n  MouseDownInfo,\n  mouseMoveListener,\n  mouseUpListener\n} from \"@/components/map_layer/MapLayer\";\nimport { printError } from \"@/tools/utils\";\nimport { splitLines } from \"@/components/SVGTextBox\";\nimport { useStore } from \"@/store\";\nimport { TitleBox, mutations as titleBoxMutations } from \"@/store/title_box\";\n\nconst TITLE_PREFIX = \"title_\";\n\nexport default defineComponent({\n  name: \"MapLayer\",\n  emits: [\n    \"title-over\",\n    \"title-leave\",\n    \"title-click\",\n    \"title-drop\",\n    \"title-dragging\"\n  ],\n  props: {\n    layerId: {\n      type: Number\n    },\n    mapId: {\n      type: String,\n      required: true\n    },\n    mapNodes: {\n      type: Object as PropType<Record<string, MapNode>>,\n      required: true\n    },\n    borderColor: {\n      type: String,\n      required: true\n    },\n    fontSize: {\n      type: Number,\n      required: true\n    },\n    fontColor: {\n      type: String,\n      required: true\n    },\n    fontOpacity: {\n      type: Number,\n      required: true\n    },\n    selectedNodeId: {\n      type: String,\n      validator: (prop: string | null) =>\n        typeof prop === \"string\" || prop === null,\n      required: true\n    },\n    selectedNodePreconditionIds: Object as PropType<string[]>,\n    searchResultNodeIDs: Object as PropType<string[]>\n  },\n\n  setup(props, ctx) {\n    const mapNodes = toRef(props, \"mapNodes\");\n\n    const store = useStore();\n    const layerID = \"map_\" + props.layerId;\n    const titleBox = computed(() => {\n      return store.state.titleBox.layerMap[layerID];\n    });\n    setTitleBoxes(\n      TITLE_PREFIX,\n      \"center\",\n      mapNodes,\n      (titleBoxMap: Record<string, TitleBox>) => {\n        store.commit(`titleBox/${titleBoxMutations.SET_MAP}`, {\n          layerName: layerID,\n          titleBoxMap\n        });\n      }\n    );\n\n    /**\n     * Send event on titleBox click, drag and drop\n     */\n    const titleMouseDownInfo: MouseDownInfo = {\n      nodeId: null,\n      dragStart: false\n    };\n    const mouseMove = (event: MouseEvent) =>\n      mouseMoveListener(ctx.emit, event, titleMouseDownInfo);\n    const mouseUp = () => mouseUpListener(ctx.emit, titleMouseDownInfo);\n    onMounted(() => {\n      const map = document.getElementById(props.mapId);\n      if (!map) {\n        printError(\"MapLayer.vue: cannot find map id for event listener\", {});\n        return;\n      }\n      map.addEventListener(\"mousemove\", mouseMove);\n      map.addEventListener(\"mouseup\", mouseUp);\n    });\n    onUnmounted(() => {\n      const map = document.getElementById(props.mapId);\n      if (!map) {\n        printError(\"MapLayer.vue: cannot find map id for event listener\", {});\n        return;\n      }\n      map.removeEventListener(\"mousemove\", mouseMove);\n      map.removeEventListener(\"mouseup\", mouseUp);\n    });\n\n    const searchResultNodeIDsMap = computed(() => {\n      const map = {} as Record<string, boolean>;\n      if (!props.searchResultNodeIDs) {\n        return map;\n      }\n      for (const id of props.searchResultNodeIDs) {\n        map[id] = true;\n      }\n      return map;\n    });\n\n    return {\n      TITLE_PREFIX,\n      titleBox,\n      innerWidth: window.innerWidth,\n      innerHeight: window.innerHeight,\n      textColor: (nodeID: string, selectedNodeId: string) => {\n        if (selectedNodeId && selectedNodeId == nodeID) {\n          return \"#ffa500\";\n        }\n        if (\n          props.selectedNodePreconditionIds &&\n          props.selectedNodePreconditionIds?.indexOf(nodeID) != -1\n        ) {\n          return \"#ffa500\";\n        }\n        if (searchResultNodeIDsMap.value[nodeID]) {\n          return \"red\";\n        }\n\n        return props.fontColor;\n      },\n      textWeight: (nodeID: string, selectedNodeId: string) => {\n        if (selectedNodeId && selectedNodeId == nodeID) {\n          return \"bold\";\n        }\n        if (searchResultNodeIDsMap.value[nodeID]) {\n          return \"bold\";\n        }\n\n        return \"normal\";\n      },\n      textDecoration: (nodeID: string) => {\n        if (searchResultNodeIDsMap.value[nodeID]) {\n          return \"underline\";\n        }\n\n        return \"none\";\n      },\n      titleClick: (nodeID: string) => {\n        ctx.emit(\"title-click\", {\n          id: nodeID\n        });\n      },\n      titleOver: (nodeID: string) => {\n        ctx.emit(\"title-over\", {\n          id: nodeID\n        });\n      },\n      titleLeave: (nodeID: string) => {\n        ctx.emit(\"title-leave\", {\n          id: nodeID\n        });\n      },\n      titleMouseDown: (id: string) => {\n        titleMouseDownInfo.nodeId = id;\n        titleMouseDownInfo.dragStart = false;\n      }\n    };\n  },\n\n  methods: {\n    splitLines,\n    polygonToPath,\n    polygonFill,\n    polygonFillOpacity\n  }\n});\n","import { render } from \"./MapLayer.vue?vue&type=template&id=182e8a4c&scoped=true\"\nimport script from \"./MapLayer.vue?vue&type=script&lang=ts\"\nexport * from \"./MapLayer.vue?vue&type=script&lang=ts\"\n\nimport \"./MapLayer.vue?vue&type=style&index=0&id=182e8a4c&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-182e8a4c\"\n\nexport default script","import { Vector } from \"@/types/graphics\";\n\nconst mouseDownBg = {\n  on: false\n};\n\nconst mouseDown = () => {\n  mouseDownBg.on = true;\n};\nconst mouseUp = () => {\n  mouseDownBg.on = false;\n};\n\nconst mouseMove = (\n  emit: (name: \"dragging-background\", o: any) => void,\n  vector: Vector\n) => {\n  if (!mouseDownBg.on) {\n    return;\n  }\n  emit(\"dragging-background\", vector);\n};\n\nexport default {\n  mouseDown,\n  mouseUp,\n  mouseMove\n};\n","<template>\n  <!--  <circle-->\n  <!--    v-for=\"node of pinNodes\"-->\n  <!--    :key=\"node.id\"-->\n  <!--    :cx=\"node.center.x\"-->\n  <!--    :cy=\"node.center.y\"-->\n  <!--    r=\"10\"-->\n  <!--    stroke=\"black\"-->\n  <!--    stroke-width=\"1\"-->\n  <!--    fill=\"red\"-->\n  <!--  />-->\n  <PinMarker\n    v-for=\"node of visiblePinNodes\"\n    :key=\"node.id\"\n    :x=\"node.center.x\"\n    :y=\"node.center.y\"\n    :color=\"color\"\n  />\n  <SVGTextBox\n    v-for=\"node of visiblePinNodes\"\n    :text=\"node.title\"\n    :id=\"`${TITLE_PREFIX}${node.id}`\"\n    :key=\"node.id\"\n    :useLineBreak=\"true\"\n    :x=\"titleXY[node.id].x\"\n    :y=\"titleXY[node.id].y\"\n    :line-height=\"8\"\n    :max-char-per-line=\"10\"\n    font-family=\"Roboto\"\n    :font-size=\"fontSize\"\n    :font-weight=\"fontWeight\"\n    :color=\"color\"\n    :text-decoration=\"textDecoration\"\n  />\n  <rect\n    v-for=\"node of pinNodes\"\n    :key=\"node.id\"\n    :x=\"titleXY[node.id].x\"\n    :y=\"titleXY[node.id].y\"\n    :width=\"titleBox[node.id] ? titleBox[node.id].bbox.width : 0\"\n    :height=\"titleBox[node.id] ? titleBox[node.id].bbox.height : 0\"\n    cursor=\"pointer\"\n    fill=\"transparent\"\n    @click=\"titleBoxClick(node.id)\"\n    @mouseover=\"titleOver(node.id)\"\n    @mouseleave=\"titleLeave(node.id)\"\n    stroke-width=\"0\"\n    stroke=\"pink\"\n  />\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, PropType } from \"vue\";\nimport { MapNode, Point } from \"@/types/graphics\";\nimport { setTitleBoxes } from \"@/components/map_layer/MapLayer\";\nimport PinMarker from \"@/components/pin_layer/PinMarker.vue\";\nimport {\n  WIDTH as PIN_MARKER_WIDTH,\n  HEIGHT as PIN_MARKER_HEIGHT\n} from \"@/components/pin_layer/PinMarker.vue\";\nimport SVGTextBox from \"@/components/SVGTextBox.vue\";\nimport { useStore } from \"@/store\";\nimport { mutations as titleBoxMutations, TitleBox } from \"@/store/title_box\";\n\nconst TITLE_PREFIX = \"pin_title_\";\n\nexport default defineComponent({\n  name: \"PinLayer\",\n  components: { SVGTextBox, PinMarker },\n  emits: [\"title-click\", \"title-over\", \"title-leave\"],\n  props: {\n    layerId: String,\n    pinNodes: {\n      type: Object as PropType<MapNode[]>,\n      required: true\n    },\n    selectedNodeId: {\n      type: String,\n      validator: (prop: string | null) =>\n        typeof prop === \"string\" || prop === null,\n      required: true\n    },\n    color: {\n      type: String\n    },\n    fontWeight: {\n      type: String\n    },\n    fontSize: {\n      type: Number\n    },\n    textDecoration: {\n      type: String\n    }\n  },\n  setup(props, ctx) {\n    const allPinNodes = computed(() => {\n      const result: Record<string, MapNode> = {};\n      for (const node of props.pinNodes) {\n        result[node.id] = node;\n      }\n      return result;\n    });\n    const visiblePinNodes = computed(() => {\n      const result: Record<string, MapNode> = {};\n      for (const node of props.pinNodes) {\n        if (node.id != props.selectedNodeId) {\n          result[node.id] = node;\n        }\n      }\n      return result;\n    });\n\n    const store = useStore();\n    const layerID = \"pin_\" + props.layerId;\n    const titleBox = computed(() => store.state.titleBox.layerMap[layerID]);\n    // watch pin nodes and set its title boxes to titleBox store\n    setTitleBoxes(\n      TITLE_PREFIX,\n      \"left\",\n      allPinNodes,\n      (titleBoxMap: Record<string, TitleBox>) => {\n        store.commit(`titleBox/${titleBoxMutations.SET_MAP}`, {\n          layerName: layerID,\n          titleBoxMap\n        });\n      }\n    );\n\n    return {\n      TITLE_PREFIX,\n      PIN_MARKER_HEIGHT,\n      PIN_MARKER_WIDTH,\n      visiblePinNodes,\n      titleBox,\n      titleXY: computed(() => {\n        const alignedXY: Record<string, Point> = {};\n        for (const i in allPinNodes.value) {\n          const node = allPinNodes.value[i];\n          alignedXY[node.id] = {\n            x: titleBox.value[node.id] ? titleBox.value[node.id].position.x : 0,\n            y: titleBox.value[node.id] ? titleBox.value[node.id].position.y : 0\n          };\n        }\n        return alignedXY;\n      }),\n      titleBoxClick: (nodeId: string) => {\n        ctx.emit(\"title-click\", { id: nodeId });\n      },\n      titleOver: (nodeId: string) => {\n        ctx.emit(\"title-over\", { id: nodeId });\n      },\n      titleLeave: (nodeId: string) => {\n        ctx.emit(\"title-leave\", { id: nodeId });\n      }\n    };\n  }\n});\n</script>\n","<template>\n  <g :transform=\"`translate(${x - WIDTH / 2} ${y - HEIGHT}) scale(0.05 0.05)`\">\n    <path\n      :fill=\"`${color}`\"\n      d=\"M182.9,551.7c0,0.1,0.2,0.3,0.2,0.3S358.3,283,358.3,194.6c0-130.1-88.8-186.7-175.4-186.9\n        C96.3,7.9,7.5,64.5,7.5,194.6c0,88.4,175.3,357.4,175.3,357.4S182.9,551.7,182.9,551.7z M122.2,187.2c0-33.6,27.2-60.8,60.8-60.8\n        c33.6,0,60.8,27.2,60.8,60.8S216.5,248,182.9,248C149.4,248,122.2,220.8,122.2,187.2z\"\n    />\n  </g>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\n\nexport const WIDTH = 18;\nexport const HEIGHT = 26;\n\nexport default defineComponent({\n  name: \"PinMarker\",\n  props: {\n    x: {\n      type: Number,\n      required: true\n    },\n    y: {\n      type: Number,\n      required: true\n    },\n    color: {\n      type: String,\n      required: true\n    }\n  },\n  setup() {\n    return {\n      WIDTH,\n      HEIGHT\n    };\n  }\n});\n</script>\n","\nimport { defineComponent } from \"vue\";\n\nexport const WIDTH = 18;\nexport const HEIGHT = 26;\n\nexport default defineComponent({\n  name: \"PinMarker\",\n  props: {\n    x: {\n      type: Number,\n      required: true\n    },\n    y: {\n      type: Number,\n      required: true\n    },\n    color: {\n      type: String,\n      required: true\n    }\n  },\n  setup() {\n    return {\n      WIDTH,\n      HEIGHT\n    };\n  }\n});\n","import { render } from \"./PinMarker.vue?vue&type=template&id=d238f9c2\"\nimport script from \"./PinMarker.vue?vue&type=script&lang=ts\"\nexport * from \"./PinMarker.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<template>\n  <text\n    :id=\"id\"\n    :font-family=\"fontFamily\"\n    :font-size=\"fontSize\"\n    :font-weight=\"fontWeight\"\n    :fill=\"color\"\n    class=\"text\"\n  >\n    <tspan\n      v-for=\"(line, i) of lines\"\n      :key=\"i\"\n      :x=\"x\"\n      :y=\"y > 0 ? y + i * lineHeight : 0\"\n      alignment-baseline=\"hanging\"\n    >\n      {{ line }}\n    </tspan>\n  </text>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nimport { splitLines } from \"@/components/SVGTextBox\";\n\nexport default defineComponent({\n  name: \"SVGTextBox\",\n  props: {\n    id: {\n      type: String,\n      required: true\n    },\n    useLineBreak: {\n      type: Boolean,\n      required: true\n    },\n    text: {\n      type: String,\n      required: true\n    },\n    x: {\n      type: Number,\n      required: true\n    },\n    y: {\n      type: Number,\n      required: true\n    },\n    lineHeight: {\n      type: Number,\n      required: true\n    },\n    maxCharPerLine: {\n      type: Number,\n      required: true\n    },\n    fontFamily: {\n      type: String,\n      required: true\n    },\n    fontSize: {\n      type: Number,\n      required: true\n    },\n    fontWeight: {\n      type: String,\n      required: true\n    },\n    color: {\n      type: String,\n      required: true\n    }\n  },\n  setup(props) {\n    let lines = [];\n    if (props.useLineBreak) {\n      lines = splitLines(props.text, props.maxCharPerLine);\n    } else {\n      lines = [props.text];\n    }\n    return {\n      lines\n    };\n  }\n});\n</script>\n\n<style scoped>\n.text {\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  pointer-events: none;\n}\n</style>\n","\nimport { defineComponent } from \"vue\";\nimport { splitLines } from \"@/components/SVGTextBox\";\n\nexport default defineComponent({\n  name: \"SVGTextBox\",\n  props: {\n    id: {\n      type: String,\n      required: true\n    },\n    useLineBreak: {\n      type: Boolean,\n      required: true\n    },\n    text: {\n      type: String,\n      required: true\n    },\n    x: {\n      type: Number,\n      required: true\n    },\n    y: {\n      type: Number,\n      required: true\n    },\n    lineHeight: {\n      type: Number,\n      required: true\n    },\n    maxCharPerLine: {\n      type: Number,\n      required: true\n    },\n    fontFamily: {\n      type: String,\n      required: true\n    },\n    fontSize: {\n      type: Number,\n      required: true\n    },\n    fontWeight: {\n      type: String,\n      required: true\n    },\n    color: {\n      type: String,\n      required: true\n    }\n  },\n  setup(props) {\n    let lines = [];\n    if (props.useLineBreak) {\n      lines = splitLines(props.text, props.maxCharPerLine);\n    } else {\n      lines = [props.text];\n    }\n    return {\n      lines\n    };\n  }\n});\n","import { render } from \"./SVGTextBox.vue?vue&type=template&id=3400d8a7&scoped=true\"\nimport script from \"./SVGTextBox.vue?vue&type=script&lang=ts\"\nexport * from \"./SVGTextBox.vue?vue&type=script&lang=ts\"\n\nimport \"./SVGTextBox.vue?vue&type=style&index=0&id=3400d8a7&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-3400d8a7\"\n\nexport default script","\nimport { computed, defineComponent, PropType } from \"vue\";\nimport { MapNode, Point } from \"@/types/graphics\";\nimport { setTitleBoxes } from \"@/components/map_layer/MapLayer\";\nimport PinMarker from \"@/components/pin_layer/PinMarker.vue\";\nimport {\n  WIDTH as PIN_MARKER_WIDTH,\n  HEIGHT as PIN_MARKER_HEIGHT\n} from \"@/components/pin_layer/PinMarker.vue\";\nimport SVGTextBox from \"@/components/SVGTextBox.vue\";\nimport { useStore } from \"@/store\";\nimport { mutations as titleBoxMutations, TitleBox } from \"@/store/title_box\";\n\nconst TITLE_PREFIX = \"pin_title_\";\n\nexport default defineComponent({\n  name: \"PinLayer\",\n  components: { SVGTextBox, PinMarker },\n  emits: [\"title-click\", \"title-over\", \"title-leave\"],\n  props: {\n    layerId: String,\n    pinNodes: {\n      type: Object as PropType<MapNode[]>,\n      required: true\n    },\n    selectedNodeId: {\n      type: String,\n      validator: (prop: string | null) =>\n        typeof prop === \"string\" || prop === null,\n      required: true\n    },\n    color: {\n      type: String\n    },\n    fontWeight: {\n      type: String\n    },\n    fontSize: {\n      type: Number\n    },\n    textDecoration: {\n      type: String\n    }\n  },\n  setup(props, ctx) {\n    const allPinNodes = computed(() => {\n      const result: Record<string, MapNode> = {};\n      for (const node of props.pinNodes) {\n        result[node.id] = node;\n      }\n      return result;\n    });\n    const visiblePinNodes = computed(() => {\n      const result: Record<string, MapNode> = {};\n      for (const node of props.pinNodes) {\n        if (node.id != props.selectedNodeId) {\n          result[node.id] = node;\n        }\n      }\n      return result;\n    });\n\n    const store = useStore();\n    const layerID = \"pin_\" + props.layerId;\n    const titleBox = computed(() => store.state.titleBox.layerMap[layerID]);\n    // watch pin nodes and set its title boxes to titleBox store\n    setTitleBoxes(\n      TITLE_PREFIX,\n      \"left\",\n      allPinNodes,\n      (titleBoxMap: Record<string, TitleBox>) => {\n        store.commit(`titleBox/${titleBoxMutations.SET_MAP}`, {\n          layerName: layerID,\n          titleBoxMap\n        });\n      }\n    );\n\n    return {\n      TITLE_PREFIX,\n      PIN_MARKER_HEIGHT,\n      PIN_MARKER_WIDTH,\n      visiblePinNodes,\n      titleBox,\n      titleXY: computed(() => {\n        const alignedXY: Record<string, Point> = {};\n        for (const i in allPinNodes.value) {\n          const node = allPinNodes.value[i];\n          alignedXY[node.id] = {\n            x: titleBox.value[node.id] ? titleBox.value[node.id].position.x : 0,\n            y: titleBox.value[node.id] ? titleBox.value[node.id].position.y : 0\n          };\n        }\n        return alignedXY;\n      }),\n      titleBoxClick: (nodeId: string) => {\n        ctx.emit(\"title-click\", { id: nodeId });\n      },\n      titleOver: (nodeId: string) => {\n        ctx.emit(\"title-over\", { id: nodeId });\n      },\n      titleLeave: (nodeId: string) => {\n        ctx.emit(\"title-leave\", { id: nodeId });\n      }\n    };\n  }\n});\n","import { render } from \"./PinLayer.vue?vue&type=template&id=4510c475\"\nimport script from \"./PinLayer.vue?vue&type=script&lang=ts\"\nexport * from \"./PinLayer.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<template>\n  <defs>\n    <marker\n      id=\"preconditionArrowHead\"\n      markerWidth=\"6\"\n      markerHeight=\"7\"\n      refX=\"3\"\n      refY=\"3.5\"\n      orient=\"auto\"\n    >\n      <polygon fill=\"#aae3b9\" stroke=\"#aae3b9\" points=\"0 0, 6 3.5, 0 7\" />\n    </marker>\n  </defs>\n  <PreconditionArrow\n    v-for=\"precondition of preconditions\"\n    :key=\"precondition.id\"\n    markerId=\"preconditionArrow\"\n    :from=\"precondition.center\"\n    :to=\"selectedNode ? selectedNode.center : null\"\n    color=\"#aae3b9\"\n  />\n  <SVGTextBox\n    v-for=\"node of visibleTitleNodes\"\n    :text=\"node.title\"\n    :id=\"`${TITLE_PREFIX}${node.id}`\"\n    :key=\"node.id\"\n    :useLineBreak=\"true\"\n    :x=\"\n      visibleTitleNodeBoxes[node.id]\n        ? visibleTitleNodeBoxes[node.id].position.x\n        : 0\n    \"\n    :y=\"\n      visibleTitleNodeBoxes[node.id]\n        ? visibleTitleNodeBoxes[node.id].position.y\n        : 0\n    \"\n    :line-height=\"8\"\n    :max-char-per-line=\"10\"\n    font-family=\"Roboto\"\n    :font-size=\"8\"\n    font-weight=\"normal\"\n    color=\"#ffa500\"\n  />\n  <rect\n    v-for=\"node of visibleTitleNodes\"\n    :key=\"node.id\"\n    :x=\"\n      visibleTitleNodeBoxes[node.id]\n        ? visibleTitleNodeBoxes[node.id].position.x\n        : 0\n    \"\n    :y=\"\n      visibleTitleNodeBoxes[node.id]\n        ? visibleTitleNodeBoxes[node.id].position.y\n        : 0\n    \"\n    :width=\"\n      visibleTitleNodeBoxes[node.id]\n        ? visibleTitleNodeBoxes[node.id].bbox.width\n        : 0\n    \"\n    :height=\"\n      visibleTitleNodeBoxes[node.id]\n        ? visibleTitleNodeBoxes[node.id].bbox.height\n        : 0\n    \"\n    cursor=\"pointer\"\n    fill=\"transparent\"\n    @click=\"titleBoxClick(node.id)\"\n    @mouseover=\"titleBoxOver(node.id)\"\n    @mouseleave=\"titleBoxLeave(node.id)\"\n    stroke-width=\"0\"\n    stroke=\"pink\"\n  />\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, PropType, ref, watch } from \"vue\";\nimport PreconditionArrow from \"@/components/precondition_layer/PreconditionArrow.vue\";\nimport { useStore } from \"@/store\";\nimport { MapNode } from \"@/types/graphics\";\nimport { findMapNode, findMapNodes } from \"@/store/tree/helpers\";\nimport { clone } from \"@/tools/utils\";\nimport { zoomAndPanPoint } from \"@/views/Home\";\nimport SVGTextBox from \"@/components/SVGTextBox.vue\";\nimport { setTitleBoxes } from \"@/components/map_layer/MapLayer\";\nimport { mutations as titleBoxMutations, TitleBox } from \"@/store/title_box\";\nimport isMobile from \"ismobilejs\";\n\nconst TITLE_PREFIX = \"precondition_title_\";\n\nexport default defineComponent({\n  name: \"PreconditionLayer\",\n  emits: [\"title-over\", \"title-leave\", \"title-click\"],\n  components: { SVGTextBox, PreconditionArrow },\n  props: {\n    layerId: String,\n    selectedNodeId: String,\n    visibleTitleIds: Object as PropType<Array<string>> // all visible titles on page\n  },\n  setup(props, ctx) {\n    const store = useStore();\n    const zoomPanState = store.state.zoomPan;\n\n    /**\n     * compute selectedNode\n     */\n    const selectedNode = computed(() => {\n      if (props.selectedNodeId && store.state.tree.mapNodeLayers) {\n        const [mapNode] = findMapNode(\n          props.selectedNodeId,\n          store.state.tree.mapNodeLayers\n        );\n        if (!mapNode) {\n          return null;\n        }\n        const zoomedPannedSelectedNode = clone(mapNode);\n        if (isMobile().phone) {\n          zoomedPannedSelectedNode.center = zoomAndPanPoint(\n              zoomedPannedSelectedNode.center,\n              zoomPanState.debouncedZoom,\n              zoomPanState.debouncedPan\n          );\n        } else {\n          zoomedPannedSelectedNode.center = zoomAndPanPoint(\n              zoomedPannedSelectedNode.center,\n              zoomPanState.zoom,\n              zoomPanState.pan\n          );\n        }\n\n        return zoomedPannedSelectedNode;\n      } else {\n        return null;\n      }\n    });\n\n    /**\n     * compute selectedNodePreconditions\n     */\n    const preconditions = ref<Record<string, MapNode>>({});\n    const extraPreconditionTitles = ref<Record<string, MapNode>>({});\n\n    const layerID = \"precondition\";\n    const visibleTitleNodeBoxes = computed(\n      () => store.state.titleBox.layerMap[layerID]\n    );\n    setTitleBoxes(\n      TITLE_PREFIX,\n      \"left\",\n      extraPreconditionTitles,\n      (titleBoxMap: Record<string, TitleBox>) => {\n        store.commit(`titleBox/${titleBoxMutations.SET_MAP}`, {\n          layerName: layerID,\n          titleBoxMap\n        });\n      }\n    );\n\n    watch(\n() => {\n        return isMobile().phone ? [\n          zoomPanState.debouncedZoom,\n          zoomPanState.debouncedPan,\n          props.selectedNodeId,\n          store.state.precondition.preconditions,\n          props.visibleTitleIds,\n        ] : [\n          zoomPanState.zoom,\n          zoomPanState.pan,\n          props.selectedNodeId,\n          store.state.precondition.preconditions,\n          props.visibleTitleIds,\n        ]\n      },\n  () => {\n        preconditions.value = {};\n        // some precondition nodes may be not visible on current layout\n        // so collect these extra titles into extraPreconditionTitles and show them\n        extraPreconditionTitles.value = {};\n        if (\n            props.selectedNodeId &&\n            store.state.precondition.preconditions[props.selectedNodeId] &&\n            store.state.tree.mapNodeLayers\n        ) {\n          const nodes = clone(\n              findMapNodes(\n                  store.state.precondition.preconditions[props.selectedNodeId],\n                  store.state.tree.mapNodeLayers\n              )\n          );\n          for (const node of nodes) {\n            if (isMobile().phone) {\n              node.center = zoomAndPanPoint(\n                  node.center,\n                  zoomPanState.debouncedZoom,\n                  zoomPanState.debouncedPan\n              );\n            } else {\n              node.center = zoomAndPanPoint(\n                  node.center,\n                  zoomPanState.zoom,\n                  zoomPanState.pan\n              );\n            }\n\n            preconditions.value[node.id] = node;\n          }\n        }\n        for (const id in preconditions.value) {\n          if (props.visibleTitleIds?.indexOf(id) == -1) {\n            extraPreconditionTitles.value[id] = preconditions.value[id];\n          }\n        }\n        if (\n            props.selectedNodeId &&\n            selectedNode.value &&\n            store.state.tree.mapNodeLayers &&\n            props.visibleTitleIds?.indexOf(props.selectedNodeId) == -1\n        ) {\n          extraPreconditionTitles.value[props.selectedNodeId] = selectedNode.value;\n        }\n  },\n{immediate:true, deep:true});\n\n    return {\n      TITLE_PREFIX,\n      selectedNode,\n      preconditions,\n      visibleTitleNodes: extraPreconditionTitles,\n      visibleTitleNodeBoxes,\n      titleBoxClick: (nodeId: string) => {\n        ctx.emit(\"title-click\", { id: nodeId });\n      },\n      titleBoxOver: (nodeId: string) => {\n        ctx.emit(\"title-over\", { id: nodeId });\n      },\n      titleBoxLeave: (nodeId: string) => {\n        ctx.emit(\"title-leave\", { id: nodeId });\n      }\n    };\n  }\n});\n</script>\n","<template>\n  <line\n    v-if=\"from && to\"\n    :x1=\"from.x\"\n    :y1=\"from.y\"\n    :x2=\"to.x\"\n    :y2=\"to.y\"\n    :stroke=\"color\"\n    stroke-width=\"1\"\n    marker-end=\"url(#preconditionArrowHead)\"\n  />\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from \"vue\";\nimport { Point } from \"@/types/graphics\";\n\nexport default defineComponent({\n  name: \"PreconditionArrow\",\n  props: {\n    markerId: String,\n    color: String,\n    from: Object as PropType<Point>,\n    to: Object as PropType<Point> || null\n  }\n});\n</script>\n","\nimport { defineComponent, PropType } from \"vue\";\nimport { Point } from \"@/types/graphics\";\n\nexport default defineComponent({\n  name: \"PreconditionArrow\",\n  props: {\n    markerId: String,\n    color: String,\n    from: Object as PropType<Point>,\n    to: Object as PropType<Point> || null\n  }\n});\n","import { render } from \"./PreconditionArrow.vue?vue&type=template&id=005525a2\"\nimport script from \"./PreconditionArrow.vue?vue&type=script&lang=ts\"\nexport * from \"./PreconditionArrow.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","import {NodeRecordItem} from \"@/store/tree\";\nimport { Tree } from \"@/types/graphics\";\n\nexport function idToLink(id: string, nodeRecord: Record<string, NodeRecordItem>): string {\n  return `<a href='/${id}'>${nodeRecord[id] ? nodeRecord[id].node.title : 'undefined'}</a>`\n}\n\nexport function getArrayDiff(beforeArr: Array<string>, afterArr: Array<string>) {\n  const beforeMap = {} as Record<string, boolean>\n  for (const idx in beforeArr) {\n    beforeMap[beforeArr[idx]] = true\n  }\n  const afterMap = {} as Record<string, boolean>\n  for (const idx in afterArr) {\n    afterMap[afterArr[idx]] = true\n  }\n  const added = []\n  for (const id in afterMap) {\n    if (!beforeMap[id]) {\n      added.push(id)\n    }\n  }\n  const removed = []\n  for (const id in beforeMap) {\n    if (!afterMap[id]) {\n      removed.push(id)\n    }\n  }\n\n  return [added, removed]\n}\n\nexport function getTreePathNodes(id: string,  records: Record<string, NodeRecordItem>): Array<Tree> {\n  if (!records[id] || records[id].parent == null) {\n    return []\n  }\n  const result = []\n  let parent = records[records[id].parent!.id]\n  while (parent !== null) {\n    result.push(parent.node)\n    if (parent.parent == null) {\n      break;\n    }\n    parent = records[parent.parent.id]\n  }\n  return result\n}\n\nexport function getTreePathString(id: string,  records: Record<string, NodeRecordItem>): string {\n  return getTreePathNodes(id, records).filter((node)=>node.id !== '0').map((node)=>node.title).reverse().join('/')\n}\n\nexport function isWideScreen() {\n  return window.innerWidth > window.innerHeight\n}\n","import { MapNode, Point, Polygon, Viewport } from \"@/types/graphics\";\nimport { area, getVectorLength, isInside } from \"@/tools/graphics\";\nimport { ErrorKV } from \"@/types/errorkv\";\nimport NewErrorKV from \"@/tools/errorkv\";\nimport { NodeRecordItem } from \"@/store/tree\";\nimport { findMapNode } from \"@/store/tree/helpers\";\nimport { clone } from \"@/tools/utils\";\nimport {isWideScreen} from \"@/components/helpers\";\n\nconst MIN_VISIBLE_NODES_NUM = isWideScreen() ? 3 : 1;\n\nexport function zoomAndPanPoint(p: Point, zoom: number, pan: Point): Point {\n  return { x: p.x * zoom + pan.x, y: p.y * zoom + pan.y };\n}\n\nexport function zoomAndPanPolygon(\n  p: Polygon,\n  zoom: number,\n  pan: Point\n): Polygon {\n  return p.map(point => zoomAndPanPoint(point, zoom, pan));\n}\n\nexport function zoomAndPanPointInPlace(\n  p: Point,\n  newZoom: number,\n  oldZoom: number,\n  newPan: Point,\n  oldPan: Point,\n) {\n  p.x = ((p.x-oldPan.x)/oldZoom)*newZoom + newPan.x\n  p.y = ((p.y-oldPan.y)/oldZoom)*newZoom + newPan.y\n}\n\nexport function zoomAndPanPolygonInPlace(\n  p: Polygon,\n  newZoom: number,\n  oldZoom: number,\n  newPan: Point,\n  oldPan: Point,\n) {\n  p.forEach(point => zoomAndPanPointInPlace(point, newZoom, oldZoom, newPan, oldPan));\n}\n\n/**\n * CentralNode вычисляется следующим образом.\n * Начинаем смотреть с самого верхнего слоя.\n * Для каждого узла слоя применяем zoomFactor, затем pan\n * Потом смотрим находиться ли focusPoint внутри него.\n * Если да, то это претендент на currentNode (назовем его N).\n * Мы берем его полную площадь и умножаем на MIN_VISIBLE_NODES_NUM.\n * Если получившееся значение ≤ площади экрана, то мы считаем что currentNode это parent узла N\n * Если больше, то повторяем итерацию, но только с детьми N.\n * @param layers\n * @param nodeRecord\n * @param viewport\n * @param zoomFactor\n * @param pan\n * @param focusPoint\n */\nexport function findCentralNode(\n  layers: Array<Record<string, MapNode>>,\n  nodeRecord: Record<string, NodeRecordItem>,\n  viewport: Viewport,\n  zoomFactor: number,\n  pan: Point,\n  focusPoint: Point\n): [string, ErrorKV] {\n  if (!layers || layers.length == 0) {\n    return [\"\", null];\n  }\n\n  let underFocusPointNodeId = null;\n  const viewportArea = viewport.width * viewport.height;\n  let nodesToCheck = layers[0];\n  while (Object.keys(nodesToCheck).length) {\n    underFocusPointNodeId = \"\";\n\n    for (const nodeId in nodesToCheck) {\n      const borderToCheck = zoomAndPanPolygon(\n        nodesToCheck[nodeId].border,\n        zoomFactor,\n        pan\n      );\n      if (isInside(focusPoint, borderToCheck)) {\n        underFocusPointNodeId = nodeId;\n        break;\n      }\n    }\n\n    if (underFocusPointNodeId === \"\") {\n      // if focusPoint is outside a map, take the closest node\n      let minDist = Infinity;\n      for (const nodeId in nodesToCheck) {\n        const nodeCenter = zoomAndPanPoint(\n          nodesToCheck[nodeId].center,\n          zoomFactor,\n          pan\n        );\n        const dist = getVectorLength({ from: nodeCenter, to: focusPoint });\n        if (dist < minDist) {\n          minDist = dist;\n          underFocusPointNodeId = nodeId;\n        }\n      }\n    }\n\n    const underCursorNodeArea = area(\n      zoomAndPanPolygon(nodesToCheck[underFocusPointNodeId].border, zoomFactor, pan)\n    );\n    if (\n      Math.floor(underCursorNodeArea)*MIN_VISIBLE_NODES_NUM <= Math.floor(viewportArea)\n    ) {\n      if (nodeRecord[underFocusPointNodeId].parent == null) {\n        return [underFocusPointNodeId, null];\n      }\n      return [nodeRecord[underFocusPointNodeId].parent!.id, null];\n    } else {\n      nodesToCheck = {};\n      if (!nodeRecord[underFocusPointNodeId]) {\n        return [\n          \"\",\n          NewErrorKV(\n            \"findCurrentNode: cannot find underFocusPointNodeId in nodeRecord\",\n            { maxIntersectNodeId: underFocusPointNodeId, nodeRecord }\n          )\n        ];\n      }\n      for (const child of nodeRecord[underFocusPointNodeId].node.children) {\n        const [mapNode] = findMapNode(child.id, layers);\n        if (mapNode == null) {\n          return [\n            \"\",\n            NewErrorKV(\"filterNodesAndLayers: Cannot find node in layers\", {\n              \"child.id\": child.id,\n              layers: layers\n            })\n          ];\n        }\n        nodesToCheck[child.id] = mapNode;\n      }\n\n      if (Object.keys(nodesToCheck).length === 0) {\n        return [underFocusPointNodeId, null];\n      }\n    }\n  }\n\n  return [\"\", NewErrorKV(\"filterNodesAndLayers: unknown error\", {})];\n}\n\n/**\n * Мы показываем слой в котором находится currentNode (без названий) плюс еще 3.\n * Причем полноценно мы показываем только подузлы currentNode.\n * Узлы слоя currentNode отображаются только если у них тот же parent что и у\n * currentNode. Плюс подузлы НЕ ИЗ currentNode мы отображаем только одного следующего слоя.\n * @param layers\n * @param nodeRecord\n * @param currentNodeId\n */\nexport function filterNodesAndLayers(\n  layers: Array<Record<string, MapNode>>,\n  nodeRecord: Record<string, NodeRecordItem>,\n  currentNodeId: string\n): [Array<Record<number, MapNode>>, ErrorKV] {\n  if (!layers || !layers.length) {\n    return [[], null];\n  }\n  const resultLayers = [];\n\n  // узнаем какой слой у currentNode\n  const [currentNode, level] = findMapNode(currentNodeId, layers);\n  if (currentNode == null || level == null) {\n    return [\n      [],\n      NewErrorKV(\"filterNodesAndLayers-currentNode: error in findMapNode\", {\n        currentNodeId,\n        layers\n      })\n    ];\n  }\n\n  // убираем из этого слоя все кроме детей currentNode.parent\n  const upperLayer: Record<string, MapNode> = {};\n  if (nodeRecord[currentNode.id].parent == null) {\n    upperLayer[currentNode.id] = clone(currentNode);\n  } else {\n    for (const child of nodeRecord[currentNode.id].parent!.children) {\n      const [mapNode, l] = findMapNode(child.id, [layers[level]]);\n      if (mapNode == null || l === null) {\n        return [\n          [],\n          NewErrorKV(\"filterNodesAndLayers-upperLayer: error in findMapNode\", {\n            \"child.id\": child.id,\n            level,\n            layers: [layers[level]]\n          })\n        ];\n      }\n      upperLayer[child.id] = clone(mapNode);\n      upperLayer[child.id].title = \"\";\n    }\n  }\n  resultLayers.push(upperLayer);\n\n  // следующий слой это дети всех узлов из upperLayer, но дети всех кроме currentNode не имеют названий\n  const firstLayer: Record<string, MapNode> = {};\n  for (const nodeId in upperLayer) {\n    for (const child of nodeRecord[nodeId].node.children) {\n      const [mapNode, l] = findMapNode(child.id, [layers[level + 1]]);\n      if (mapNode == null || l === null) {\n        return [\n          [],\n          NewErrorKV(\"filterNodesAndLayers-firstLayer: error in findMapNode\", {\n            \"child.id\": child.id,\n            layers: [layers[level + 1]]\n          })\n        ];\n      }\n      if (nodeId != currentNodeId) {\n        firstLayer[child.id] = clone(mapNode);\n        firstLayer[child.id].title = \"\";\n      } else {\n        firstLayer[child.id] = clone(mapNode);\n      }\n    }\n  }\n\n  if (Object.keys(firstLayer).length > 0) {\n    resultLayers.push(firstLayer);\n  }\n\n  // следующий слой это дети детей currentNode\n  const secondLayer: Record<string, MapNode> = {};\n  //for (const childId in firstLayer) {\n  for (const child of nodeRecord[currentNodeId].node.children) {\n    for (const childOfChild of nodeRecord[child.id].node.children) {\n      const [mapNode, l] = findMapNode(childOfChild.id, [layers[level + 2]]);\n      if (mapNode == null || l === null) {\n        return [\n          [],\n          NewErrorKV(\"filterNodesAndLayers-secondLayer: error in findMapNode\", {\n            \"child.id\": child.id,\n            layers: [layers[level + 2]]\n          })\n        ];\n      }\n      secondLayer[childOfChild.id] = clone(mapNode);\n    }\n  }\n\n  if (Object.keys(secondLayer).length > 0) {\n    resultLayers.push(secondLayer);\n  }\n\n  // следующий это дети узлов из secondLayer и у них нет названий\n  const thirdLayer: Record<string, MapNode> = {};\n  for (const nodeId in secondLayer) {\n    for (const child of nodeRecord[nodeId].node.children) {\n      const [mapNode, l] = findMapNode(child.id, [layers[level + 3]]);\n      if (mapNode == null || l === null) {\n        return [\n          [],\n          NewErrorKV(\"filterNodesAndLayers-thirdLayer:cannot findMapNode\", {\n            \"child.id\": child.id,\n            level: level + 3,\n            layers: [layers[level + 3]]\n          })\n        ];\n      }\n      thirdLayer[child.id] = clone(mapNode);\n      thirdLayer[child.id].title = \"\";\n    }\n  }\n\n  if (Object.keys(thirdLayer).length > 0) {\n    resultLayers.push(thirdLayer);\n  }\n\n  return [resultLayers, null];\n}\n\nexport function zoomAnPanLayersInPlace(\n  layers: Array<Record<number, MapNode>>,\n  newZoom: number,\n  newPan: Point,\n  oldZoom: number,\n  oldPan: Point,\n) {\n  if (!layers || layers.length == 0) {\n    return [];\n  }\n  for (const idx in layers) {\n    const layer = {} as Record<number, MapNode>\n    for (const id in layers[idx]) {\n      zoomAndPanPointInPlace(layers[idx][id].center, newZoom, oldZoom, newPan, oldPan)\n      zoomAndPanPolygonInPlace(layers[idx][id].border, newZoom, oldZoom, newPan, oldPan)\n    }\n  }\n}\n\nexport function zoomAnPanLayers(\n  layers: Array<Record<number, MapNode>>,\n  zoom: number,\n  pan: Point\n): Array<Record<number, MapNode>> {\n  if (!layers || layers.length == 0) {\n    return [];\n  }\n  const resultLayers = [] as Array<Record<number, MapNode>>\n  for (const idx in layers) {\n    const layer = {} as Record<number, MapNode>\n    for (const id in layers[idx]) {\n      const node = layers[idx][id];\n      layer[id] = {\n        id: node.id,\n        title: node.title,\n        center:  zoomAndPanPoint(node.center, zoom, pan),\n        border: zoomAndPanPolygon(node.border, zoom, pan),\n      }\n    }\n    resultLayers.push(layer)\n  }\n\n  return resultLayers;\n}\n","\nimport { computed, defineComponent, PropType, ref, watch } from \"vue\";\nimport PreconditionArrow from \"@/components/precondition_layer/PreconditionArrow.vue\";\nimport { useStore } from \"@/store\";\nimport { MapNode } from \"@/types/graphics\";\nimport { findMapNode, findMapNodes } from \"@/store/tree/helpers\";\nimport { clone } from \"@/tools/utils\";\nimport { zoomAndPanPoint } from \"@/views/Home\";\nimport SVGTextBox from \"@/components/SVGTextBox.vue\";\nimport { setTitleBoxes } from \"@/components/map_layer/MapLayer\";\nimport { mutations as titleBoxMutations, TitleBox } from \"@/store/title_box\";\nimport isMobile from \"ismobilejs\";\n\nconst TITLE_PREFIX = \"precondition_title_\";\n\nexport default defineComponent({\n  name: \"PreconditionLayer\",\n  emits: [\"title-over\", \"title-leave\", \"title-click\"],\n  components: { SVGTextBox, PreconditionArrow },\n  props: {\n    layerId: String,\n    selectedNodeId: String,\n    visibleTitleIds: Object as PropType<Array<string>> // all visible titles on page\n  },\n  setup(props, ctx) {\n    const store = useStore();\n    const zoomPanState = store.state.zoomPan;\n\n    /**\n     * compute selectedNode\n     */\n    const selectedNode = computed(() => {\n      if (props.selectedNodeId && store.state.tree.mapNodeLayers) {\n        const [mapNode] = findMapNode(\n          props.selectedNodeId,\n          store.state.tree.mapNodeLayers\n        );\n        if (!mapNode) {\n          return null;\n        }\n        const zoomedPannedSelectedNode = clone(mapNode);\n        if (isMobile().phone) {\n          zoomedPannedSelectedNode.center = zoomAndPanPoint(\n              zoomedPannedSelectedNode.center,\n              zoomPanState.debouncedZoom,\n              zoomPanState.debouncedPan\n          );\n        } else {\n          zoomedPannedSelectedNode.center = zoomAndPanPoint(\n              zoomedPannedSelectedNode.center,\n              zoomPanState.zoom,\n              zoomPanState.pan\n          );\n        }\n\n        return zoomedPannedSelectedNode;\n      } else {\n        return null;\n      }\n    });\n\n    /**\n     * compute selectedNodePreconditions\n     */\n    const preconditions = ref<Record<string, MapNode>>({});\n    const extraPreconditionTitles = ref<Record<string, MapNode>>({});\n\n    const layerID = \"precondition\";\n    const visibleTitleNodeBoxes = computed(\n      () => store.state.titleBox.layerMap[layerID]\n    );\n    setTitleBoxes(\n      TITLE_PREFIX,\n      \"left\",\n      extraPreconditionTitles,\n      (titleBoxMap: Record<string, TitleBox>) => {\n        store.commit(`titleBox/${titleBoxMutations.SET_MAP}`, {\n          layerName: layerID,\n          titleBoxMap\n        });\n      }\n    );\n\n    watch(\n() => {\n        return isMobile().phone ? [\n          zoomPanState.debouncedZoom,\n          zoomPanState.debouncedPan,\n          props.selectedNodeId,\n          store.state.precondition.preconditions,\n          props.visibleTitleIds,\n        ] : [\n          zoomPanState.zoom,\n          zoomPanState.pan,\n          props.selectedNodeId,\n          store.state.precondition.preconditions,\n          props.visibleTitleIds,\n        ]\n      },\n  () => {\n        preconditions.value = {};\n        // some precondition nodes may be not visible on current layout\n        // so collect these extra titles into extraPreconditionTitles and show them\n        extraPreconditionTitles.value = {};\n        if (\n            props.selectedNodeId &&\n            store.state.precondition.preconditions[props.selectedNodeId] &&\n            store.state.tree.mapNodeLayers\n        ) {\n          const nodes = clone(\n              findMapNodes(\n                  store.state.precondition.preconditions[props.selectedNodeId],\n                  store.state.tree.mapNodeLayers\n              )\n          );\n          for (const node of nodes) {\n            if (isMobile().phone) {\n              node.center = zoomAndPanPoint(\n                  node.center,\n                  zoomPanState.debouncedZoom,\n                  zoomPanState.debouncedPan\n              );\n            } else {\n              node.center = zoomAndPanPoint(\n                  node.center,\n                  zoomPanState.zoom,\n                  zoomPanState.pan\n              );\n            }\n\n            preconditions.value[node.id] = node;\n          }\n        }\n        for (const id in preconditions.value) {\n          if (props.visibleTitleIds?.indexOf(id) == -1) {\n            extraPreconditionTitles.value[id] = preconditions.value[id];\n          }\n        }\n        if (\n            props.selectedNodeId &&\n            selectedNode.value &&\n            store.state.tree.mapNodeLayers &&\n            props.visibleTitleIds?.indexOf(props.selectedNodeId) == -1\n        ) {\n          extraPreconditionTitles.value[props.selectedNodeId] = selectedNode.value;\n        }\n  },\n{immediate:true, deep:true});\n\n    return {\n      TITLE_PREFIX,\n      selectedNode,\n      preconditions,\n      visibleTitleNodes: extraPreconditionTitles,\n      visibleTitleNodeBoxes,\n      titleBoxClick: (nodeId: string) => {\n        ctx.emit(\"title-click\", { id: nodeId });\n      },\n      titleBoxOver: (nodeId: string) => {\n        ctx.emit(\"title-over\", { id: nodeId });\n      },\n      titleBoxLeave: (nodeId: string) => {\n        ctx.emit(\"title-leave\", { id: nodeId });\n      }\n    };\n  }\n});\n","import { render } from \"./PreconditionLayer.vue?vue&type=template&id=3d8253a9\"\nimport script from \"./PreconditionLayer.vue?vue&type=script&lang=ts\"\nexport * from \"./PreconditionLayer.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","\nimport { computed, defineComponent, onMounted, PropType } from \"vue\";\nimport { MapNode } from \"@/types/graphics\";\nimport MapLayer from \"@/components/map_layer/MapLayer.vue\";\nimport {\n  EventClickNode,\n  EventDraggingNode\n} from \"@/components/map_layer/MapLayer\";\nimport pan from \"./MapPan\";\nimport PinLayer from \"@/components/pin_layer/PinLayer.vue\";\nimport { printError } from \"@/tools/utils\";\nimport PreconditionLayer from \"@/components/precondition_layer/PreconditionLayer.vue\";\nimport {isWideScreen} from \"@/components/helpers\";\n\nconst mapID = \"mapID\";\n\nexport default defineComponent({\n  name: \"Map\",\n  emits: [\n    \"title-dragging\",\n    \"title-click\",\n    \"title-over\",\n    \"title-leave\",\n    \"dragging-background\",\n    \"wheel\"\n  ],\n  components: {\n    PreconditionLayer,\n    PinLayer,\n    MapLayer\n  },\n  props: {\n    layers: Object as PropType<Array<Record<string, MapNode>>>,\n    selectedNodeId: {\n      type: String || null,\n      validator: (prop: string | null) =>\n        typeof prop === \"string\" || prop === null,\n      required: true\n    },\n    selectedNodePreconditionIds: Object as PropType<string[]>,\n    pinNodes: Object as PropType<MapNode[]>,\n    searchResultPinNodes: Object as PropType<MapNode[]>,\n    searchResultNodeIDs: Object as PropType<string[]>\n  },\n  setup(props, ctx) {\n    onMounted(() => {\n      const map = document.getElementById(mapID);\n      if (!map) {\n        printError(\"Map.vue: cannot find map id for event listener\", {});\n        return;\n      }\n\n      /**\n       * Mouse events\n       */\n      map.addEventListener(\"mousedown\", event => {\n        pan.mouseDown();\n      });\n      map.addEventListener(\"mouseup\", event => {\n        pan.mouseUp();\n      });\n      map.addEventListener(\"mousemove\", event => {\n        pan.mouseMove(ctx.emit, {\n          from: {\n            x: event.clientX - event.movementX,\n            y: event.clientY - event.movementY\n          },\n          to: { x: event.clientX, y: event.clientY }\n        });\n      });\n\n      // zoom with mouse wheel\n      map.addEventListener(\n        \"wheel\",\n        event => {\n          ctx.emit(\"wheel\", {\n            delta: -event.deltaY,\n            center: { x: event.clientX, y: event.clientY }\n          });\n        },\n        { passive: true }\n      );\n\n      /**\n       * Mobile touch events\n       */\n      // zoom stuff\n      let prevDist = Infinity;\n      let center = {x:0, y:0};\n      // drag stuff\n      const prevPoint = { x: Infinity, y: Infinity };\n      map.addEventListener(\n        \"touchstart\",\n        e => {\n          if (e.touches.length === 1) {\n            prevPoint.x = e.touches[0].clientX;\n            prevPoint.y = e.touches[0].clientY;\n          }\n          if (e.touches.length === 2) {\n            prevDist = Infinity;\n          }\n\n          pan.mouseDown();\n        },\n        { passive: true }\n      );\n      map.addEventListener(\"touchend\", event => {\n        // zoom stuff\n        center = {x:0, y:0};\n        prevDist = Infinity;\n        // dragging stuff\n        prevPoint.x = Infinity;\n        prevPoint.y = Infinity;\n        pan.mouseUp();\n      });\n\n      // mobile zoom\n      map.addEventListener(\n        \"touchmove\",\n        e => {\n          if (e.touches.length === 1) {\n            if (prevPoint.x != Infinity && prevPoint.y != Infinity) {\n              pan.mouseMove(ctx.emit, {\n                from: prevPoint,\n                to: { x: e.touches[0].clientX, y: e.touches[0].clientY }\n              });\n            }\n            prevPoint.x = e.touches[0].clientX;\n            prevPoint.y = e.touches[0].clientY;\n          } else if (e.touches.length === 2) {\n            let delta = 0;\n            if (prevDist === Infinity) {\n              // init center\n              center = {\n                x: e.touches[0].pageX + (e.touches[0].pageX - e.touches[1].pageX) / 2,\n                y: e.touches[0].pageY + (e.touches[0].pageY - e.touches[1].pageY) / 2\n              };\n            }\n            const dist = Math.max(\n                Math.abs(center.x - e.touches[0].pageX),\n                Math.abs(center.x - e.touches[1].pageX),\n                Math.abs(center.y - e.touches[0].pageY),\n                Math.abs(center.y - e.touches[1].pageY),\n            );\n            if (prevDist !== Infinity) {\n              delta = dist - prevDist;\n            }\n            prevDist = dist;\n\n            ctx.emit(\"wheel\", {\n              delta: 4*delta,\n              center: center,\n            });\n          }\n        },\n        { passive: true }\n      );\n    });\n\n    return {\n      svgWidth: window.innerWidth,\n      svgHeight: window.innerHeight,\n      visibleTitleIds: computed(() => {\n        if (!props.layers) {\n          return [];\n        }\n        const ids = [];\n        for (const layer of props.layers) {\n          for (const idx in layer) {\n            if (layer[idx].title != \"\") {\n              ids.push(idx);\n            }\n          }\n        }\n        return ids;\n      }),\n      draggingNode: (e: EventDraggingNode) => {\n        ctx.emit(\"title-dragging\", {\n          id: e.nodeId,\n          delta: e.delta\n        });\n      },\n      titleClick: (e: EventClickNode) => {\n        ctx.emit(\"title-click\", { id: e.id });\n      },\n      titleOver: (e: EventClickNode) => {\n        ctx.emit(\"title-over\", { id: e.id });\n      },\n      titleLeave: (e: EventClickNode) => {\n        ctx.emit(\"title-leave\", { id: e.id });\n      },\n      mapID,\n      fontSize: (index: number): number => {\n        let size = 0;\n        let levelSizes: Record<number, number>\n        if (isWideScreen()) {\n          levelSizes = {\n            0: 0.4,\n            1: 0.73,\n            2: 1.4,\n            3: 1.86\n          };\n        } else {\n          levelSizes = {\n            0: 1.8*0.4,\n            1: 1.8*0.73,\n            2: 1.8*1.4,\n            3: 1.8*1.86\n          };\n        }\n\n        if (props.layers!.length >= 4) {\n          size = levelSizes[index];\n        }\n        if (props.layers!.length == 3) {\n          size = levelSizes[index + 1];\n        }\n        return size;\n      },\n      fontOpacity: (index: number): number => {\n        let val = 0;\n        const levelSizes: Record<number, number> = {\n          0: 1,\n          1: 1,\n          2: 0.2,\n          3: 1\n        };\n        if (props.layers!.length >= 4) {\n          val = levelSizes[index];\n        }\n        if (props.layers!.length == 3) {\n          val = levelSizes[index + 1];\n        }\n        return val;\n      },\n      fontColor: (index: number): string => {\n        if (props.layers!.length >= 4) {\n          return `rgb(${200 - 100 * index},${200 - 100 * index},${200 -\n            100 * index})`;\n        }\n        if (props.layers!.length == 3) {\n          return `rgb(${200 - 100 * (index + 1)},${200 -\n            100 * (index + 1)},${200 - 100 * (index + 1)})`;\n        }\n        return \"\";\n      },\n      borderColor: (index: number): string => {\n        let color = 0;\n        const levelColors: Record<number, number> = {\n          0: 240,\n          1: 200,\n          2: 100,\n          3: 90\n        };\n        if (props.layers!.length >= 4) {\n          color = levelColors[index];\n        }\n        if (props.layers!.length == 3) {\n          color = levelColors[index + 1];\n        }\n        return `rgb(${color},${color},${color})`;\n      }\n    };\n  }\n});\n","import { render } from \"./Map.vue?vue&type=template&id=1596e3ea\"\nimport script from \"./Map.vue?vue&type=script&lang=ts\"\nexport * from \"./Map.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<template>\n  <div v-if=\"show && selectedNode\" :class=\"`${wrapperClass()}`\" :style=\"!isWideScreen() ? `height:${wrapperHeight}px;` : ''\">\n    <div class=\"p-fluid\">\n      <!-- Image -->\n      <TitleImage\n        v-if=\"isWideScreen()\"\n        :nodeID=\"selectedNodeContent ? selectedNodeContent.nodeID : ''\"\n        :nodeContent=\"selectedNodeContent ? selectedNodeContent.content : ''\"\n      />\n\n      <!-- Content -->\n      <div class=\"p-field p-grid\">\n        <div v-if=\"isWideScreen()\" class=\"p-col-12\">\n          <div style=\"height: 240px\"></div>\n        </div>\n        <div class=\"p-col-9\">\n          <Title\n            :content=\"selectedNodeContent ? selectedNode.title : ''\"\n            @content-changed=\"changeNodeTitle($event)\"\n          />\n        </div>\n        <div class=\"p-col-1\">\n          <SubscribeButton :nodeID=\"selectedNodeContent ? selectedNodeContent.nodeID : ''\" />\n        </div>\n        <div class=\"p-col-2\">\n          <PinButton />\n        </div>\n        <div class=\"p-col-12\">\n          <Markdown\n            :content=\"selectedNodeContent ? selectedNodeContent.content : ''\"\n            :rows=\"20\"\n            @content-changed=\"changeContent($event)\"\n          />\n        </div>\n      </div>\n\n      <!-- Comment -->\n      <div class=\"p-field p-grid\">\n        <div class=\"p-col-12 p-md-12\">\n          <TextArea\n            id=\"comment\"\n            placeholder=\"Personal notes. DO NOT WRITE SENSITIVE INFORMATION HERE! (on scimap.org your notes will be visible only to you, but anyone can get access to it from publicly available backups)\"\n            :autoResize=\"true\"\n            rows=\"2\"\n            :value=\"selectedNodeComment\"\n            @update:modelValue=\"changeComment($event)\"\n            v-on:keydown=\"checkAuthorized\"\n          />\n        </div>\n      </div>\n\n      <!-- 'Based on' section -->\n      <div class=\"p-field p-grid\">\n        <div :class=\"`p-col-10 ${$style.section} p-pt-2`\">\n          based on\n        </div>\n        <div class=\"p-col-2\">\n          <AddBasedOnButton\n            :clickedTitleId=\"clickedTitleId\"\n            @select-precondition-is-on=\"$emit('select-precondition-is-on')\"\n            @select-precondition-is-off=\"$emit('select-precondition-is-off')\"\n          />\n        </div>\n      </div>\n      <SectionPreconditions\n        v-if=\"selectedNodeContent\"\n        :node-id=\"selectedNode.id\"\n      />\n\n      <!-- 'Basis for' section -->\n      <div v-if=\"selectedNodeContent && usedBy && usedBy.length > 0\">\n        <div class=\"p-field p-grid\">\n          <div :class=\"`p-col-12 ${$style.section} p-pt-5`\">\n            basis for\n          </div>\n        </div>\n        <SectionUsedBy :nodeIDs=\"usedBy\" />\n      </div>\n\n      <!-- ChangeLog section -->\n      <ChangeLog :node-id=\"selectedNode.id\" />\n    </div>\n  </div>\n  <div v-else-if=\"editModeOn\" :class=\"`${wrapperClass()}`\" :style=\"!isWideScreen() ? `height:${wrapperHeight}px;` : ''\">\n    <div class=\"p-fluid\">\n      <div class=\"p-field p-grid\">\n        <div class=\"p-col-12\">\n          <div style=\"height: 60px;\"></div>\n        </div>\n        <div class=\"p-col-12\">\n          <div :class=\"$style.title\">\n            Map edit mode is on\n          </div>\n        </div>\n        <div :class=\"`p-col-12 ${$style.list}`\">\n          In this mode you can change map structure but cannot edit contents of individual nodes. To return back to content editing push \"edit map\" button again.\n        </div>\n        <div :class=\"`p-col-1 ${$style.icon}`\">\n          <img\n              alt=\"logo\"\n              src=\"../../assets/images/add-off.svg\"\n              style=\"width: 30px\"\n          />\n        </div>\n        <div :class=\"`p-col-11 ${$style.list}`\">\n          To add new node 1) select parent node on map and then 2) click \"add\" button in upper menu.\n        </div>\n        <div :class=\"`p-col-1 ${$style.icon}`\">\n          <img\n            alt=\"logo\"\n            src=\"../../assets/images/remove-off.svg\"\n            style=\"width: 30px\"\n          />\n        </div>\n        <div :class=\"`p-col-11 ${$style.list}`\">\n          To remove node 1) select it on map and 2) click \"delete\" button in upper menu.\n        </div>\n        <div :class=\"`p-col-1 ${$style.icon}`\">\n          <img\n            alt=\"logo\"\n            src=\"../../assets/images/cut.svg\"\n            style=\"width: 30px\"\n          />\n        </div>\n        <div :class=\"`p-col-11 ${$style.list}`\">\n          To move node 1) select it on map, then 2) press \"cut\" button, then 3) select its new parent and 4) press \"paste\" button.\n        </div>\n        <div :class=\"`p-col-1 ${$style.icon}`\">\n          <img\n            alt=\"logo\"\n            src=\"../../assets/images/log.svg\"\n            style=\"width: 30px\"\n          />\n        </div>\n        <div :class=\"`p-col-11 ${$style.list}`\">\n          You can use \"log\" to see log of map edits and revert or complain any unfortunate edit.\n        </div>\n        <div :class=\"`p-col-12 ${$style.list}`\">\n            After add, paste or remove you can drag node title and its neighbours to adjust node centers position.\n        </div>\n      </div>\n    </div>\n  </div>\n  <div v-else :class=\"`${wrapperClass()}`\" :style=\"!isWideScreen() ? `height:${wrapperHeight}px;` : ''\">\n    <div class=\"p-fluid\">\n      <div class=\"p-field p-grid\">\n        <div v-if=\"isWideScreen()\" class=\"p-col-12\">\n          <div style=\"height: 60px;\"></div>\n        </div>\n        <div class=\"p-col-12\" style=\"margin-bottom:2em;\">\n          <iframe width=\"100%\" src=\"https://www.youtube.com/embed/DuiTlnrK6G4?si=HuVA4cs5U86H9E3l\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen></iframe>\n        </div>\n        <div :class=\"`${$style.list}`\">\n          The goal  of the project is to\n          <br><br>1. Collect the <b>best explanations</b> of the most important knowledge. Correctness of these explanations can be tracked down to fundamental theories/experiments using \"based on\" feature of SciMap.\n          <br><br>2. Help to <b>discover and join communities</b> that use this knowledge to solve hard problems of humanity.\n          <br><br>Here are the features:\n        </div>\n        <div :class=\"`p-col-2 ${$style.icon}`\">\n          <img\n            alt=\"logo\"\n            src=\"../../assets/images/sign-in.svg\"\n            style=\"width: 25px\"\n          />\n        </div>\n        <div :class=\"`p-col-10 ${$style.list}`\">\n          Sign in to edit map\n        </div>\n        <div :class=\"`p-col-2 ${$style.icon}`\">\n          <img\n            alt=\"logo\"\n            src=\"../../assets/images/goal.svg\"\n            style=\"width: 30px\"\n          />\n        </div>\n        <div v-tooltip=\"{ escape:false,\n         autoHide: false,\n         pt: {\n          root: {\n            style: {\n              'max-width': 'fit-content',\n            },\n          },\n          arrow: {\n            style: {\n              borderRightColor: '#dcdcde',\n              borderBottomColor: 'rgb(255 255 255 / 0)',\n              borderTopColor: 'rgb(255 255 255 / 0)'\n            }\n          },\n          text: {\n            style: {\n              'background-color': '#dcdcde',\n              'color': 'black'\n            }\n          }\n         },\n        value: `\n<div style='padding-left: 20px; width:410px;height:600px;'>\n  Use <a target='_blank' href='https://markdown-it.github.io/'>markdown</a> to format text\n  and <a target='_blank' href='https://katex.org/docs/supported.html'>katex</a> notation to write formulas.\n For example write\n <textarea rows='3' cols='43'>$$\n\\\\sum_{\\\\mathclap{1\\\\le i\\\\le j\\\\le n}} x_{ij}\n$$</textarea>\n  to render formula:\n  ${md.render(`$$\n\\\\sum_{\\\\mathclap{1\\\\le i\\\\le j\\\\le n}} x_{ij}\n$$`)}\n  <div style='margin-top: -4em;'>\n  Or write\n   <textarea rows='5' cols='43'>\n   ![](https://cdn.scimap.org/images/default.jpg =340x)\n   @[youtube](https://www.youtube.com/watch?v=E8YCQ0zjCZA)\n   </textarea>\n   to insert image or video:\n   ${md.render(`@[youtube](https://www.youtube.com/watch?v=E8YCQ0zjCZA)`)}\n   </div>\n</div>`\n        }\" :class=\"`p-col-10 ${$style.list}`\">\n          Keep node content <b>focused and simple but profound</b> (you can use <a target='_blank' href='https://markdown-it.github.io/'>markdown</a> and <a target='_blank' href='https://katex.org/docs/supported.html'>katex</a>&nbsp;<img\n            alt=\"logo\"\n            src=\"../../assets/images/question.svg\"\n            style=\"width: 20px; margin-bottom:-5px;\"\n        />)\n        </div>\n        <div :class=\"`p-col-2 ${$style.icon}`\">\n          <img\n            alt=\"logo\"\n            src=\"../../assets/images/plugin.svg\"\n            style=\"width: 30px\"\n          />\n        </div>\n        <div :class=\"`p-col-10 ${$style.list}`\">\n          Use <b>\"based on\"</b> to link nodes that are necessary for solid\n          understanding of your description\n        </div>\n        <div :class=\"`p-col-2 ${$style.icon}`\">\n          <img\n              alt=\"logo\"\n              src=\"../../assets/images/chat.svg\"\n              style=\"width: 20px\"\n          />\n        </div>\n        <div :class=\"`p-col-10 ${$style.list}`\">\n          Talk to your coauthors in <a target=\"_blank\" href=\"https://discord.com/channels/1171118046543347782/1171118047587745953\">chat</a> to adapt community rules and create a great content\n        </div>\n        <div :class=\"`p-col-2 ${$style.icon}`\" style=\"color: #3B6BF9; padding-left:10px; font-weight: bold; font-size:1.5em;\">\n          W\n        </div>\n        <div :class=\"`p-col-10 ${$style.list}`\">\n          Use Wikipedia core content policies: neutral point of view, verifiability, and no original research\n        </div>\n        <div :class=\"`p-col-2 ${$style.icon}`\">\n          <img\n            alt=\"logo\"\n            src=\"../../assets/images/pin-on.svg\"\n            style=\"width: 30px\"\n          />\n        </div>\n        <div :class=\"`p-col-10 ${$style.list}`\">\n          Pin nodes that you are currently interested in\n        </div>\n        <div :class=\"`p-col-2 ${$style.icon}`\">\n          <img\n            alt=\"logo\"\n            src=\"../../assets/images/eye-on.svg\"\n            style=\"width: 30px\"\n          />\n        </div>\n        <div :class=\"`p-col-10 ${$style.list}`\">\n          Subscribe to node changes to receive updates on email\n        </div>\n        <div :class=\"`p-col-2 ${$style.icon}`\" style=\"color: #3B6BF9;\">\n          [ORG]\n        </div>\n        <div :class=\"`p-col-10 ${$style.list}`\">\n          If you know actions one can take to push\n          knowledge further (jobs, crowdsourcing, etc.) - you can also add it!\n        </div>\n        <div :class=\"`p-col-2 ${$style.icon}`\" style=\"color: #3B6BF9;\">\n          Open\n        </div>\n        <div :class=\"`p-col-10 ${$style.list}`\">\n          Project is <a target=\"_blank\" href=\"https://github.com/igbatov/sci-map\">open source</a> and data is <a target=\"_blank\" href=\"https://github.com/igbatov/scimap-backup-list/blob/main/backup-list.json\">publicly available</a> on <b>decentralized storage</b> in JSON format\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { actions, useStore } from \"@/store\";\nimport { actions as nodeContentActions } from \"@/store/node_content\";\nimport { computed, defineComponent, useCssModule } from \"vue\";\nimport TextArea from \"primevue/textarea\";\nimport SectionPreconditions from \"./Preconditions.vue\";\nimport SectionUsedBy from \"./UsedBy.vue\";\nimport { Tree } from \"@/types/graphics\";\nimport { EmptyNodeContent, NodeContent } from \"@/store/node_content\";\nimport { clone, printError } from \"@/tools/utils\";\nimport { useConfirm } from \"primevue/useconfirm\";\nimport api from \"@/api/api\";\nimport Markdown from \"./Markdown.vue\";\nimport ChangeLog from \"./ChangeLog.vue\";\nimport PinButton from \"./PinButton.vue\";\nimport SubscribeButton from \"./SubscribeButton.vue\";\nimport Title from \"@/components/node_content/Title.vue\";\nimport AddBasedOnButton from \"@/components/node_content/AddBasedOnButton.vue\";\nimport TitleImage from \"@/components/node_content/TitleImage.vue\";\nimport MarkdownIt from \"markdown-it\";\nimport { isWideScreen } from \"../helpers\";\nimport {add as textSearchAdd, SearchFieldName} from \"@/tools/textsearch\";\nconst mdKatex = require('markdown-it-katex'); // eslint-disable-line\nconst mdImsize = require('markdown-it-imsize'); // eslint-disable-line\nconst mdVideo = require('markdown-it-block-embed'); // eslint-disable-line\nconst md = new MarkdownIt();\nmd\n  .use(mdKatex, { output: \"html\" })\n  .use(mdImsize)\n  .use(mdVideo, {\n    containerClassName: \"video-embed\",\n    youtube: {\n      width: 370,\n      height: 209,\n    }\n  });\n\nexport default defineComponent({\n  name: \"NodeContent\",\n  components: {\n    TitleImage,\n    AddBasedOnButton,\n    Title,\n    SectionUsedBy,\n    Markdown,\n    TextArea,\n    SectionPreconditions,\n    ChangeLog,\n    PinButton,\n    SubscribeButton,\n  },\n  emits: [\"select-precondition-is-on\", \"select-precondition-is-off\"],\n  props: {\n    show: {\n      type: Boolean,\n      required: true\n    },\n    selectedNodeId: {\n      type: String || null,\n      validator: (prop: string | null) =>\n        typeof prop === \"string\" || prop === null,\n      required: true\n    },\n    clickedTitleId: {\n      type: String,\n      required: true\n    },\n    wrapperHeight: {\n      type: Number,\n      required: true\n    }\n  },\n  setup(props) {\n    const $style = useCssModule()\n    const store = useStore();\n    const confirm = useConfirm();\n    const tree = store.state.tree;\n\n    const selectedNode = computed<Tree | null>(() =>\n      props.selectedNodeId && tree.nodeRecord[props.selectedNodeId]\n        ? tree.nodeRecord[props.selectedNodeId].node\n        : null\n    );\n\n    const selectedNodeContent = computed<NodeContent | null>(() => {\n      if (\n        props.selectedNodeId &&\n        store.state.nodeContent.nodeContents[props.selectedNodeId]\n      ) {\n        return store.state.nodeContent.nodeContents[props.selectedNodeId];\n      }\n      const newContent = clone(EmptyNodeContent);\n      newContent.nodeID = props.selectedNodeId;\n      return newContent;\n    });\n\n    const selectedNodeComment = computed<string>(() =>\n      props.selectedNodeId &&\n      store.state.nodeContent.userNodeComments[props.selectedNodeId]\n        ? store.state.nodeContent.userNodeComments[props.selectedNodeId].comment\n        : \"\"\n    );\n\n    return {\n      md,\n      usedBy: computed(() => store.state.precondition.reverseIndex[props.selectedNodeId]),\n      editModeOn: computed(() => store.state.editModeOn),\n      selectedNode,\n      selectedNodeContent,\n      checkAuthorized: async (e: Event) => {\n        if (!store.state.user.user || store.state.user.user.isAnonymous) {\n          await store.dispatch(`${actions.confirmSignInPopup}`, {confirm, message:\"Please authorize to add comments and edit content\"});\n          e.preventDefault();\n        }\n      },\n      selectedNodeComment,\n      changeNodeTitle: async (value: string) => {\n        if (!selectedNode.value || !selectedNode.value.id) {\n          return;\n        }\n        const err = await api.debouncedUpdate({\n          [`map/${selectedNode.value.id}/name`]: value\n        });\n\n        if (err) {\n          printError(err.error.message, err.kv);\n        }\n      },\n      changeContent: async (value: string) => {\n        const err = await store.dispatch(\n          `nodeContent/${nodeContentActions.setNodeContent}`,\n          {\n            nodeID: selectedNode.value!.id,\n            content: value\n          }\n        );\n\n        if (err) {\n          printError(err, {});\n        }\n      },\n      changeComment: async (value: string) => {\n        textSearchAdd(selectedNode.value!.id, SearchFieldName.UserComment, value);\n        const err = await store.dispatch(\n          `nodeContent/${nodeContentActions.setNodeComment}`,\n          {\n            nodeID: selectedNode.value!.id,\n            comment: value\n          }\n        );\n\n        if (err) {\n          printError(err, {});\n        }\n      },\n      isWideScreen,\n      wrapperClass: () => {\n        return isWideScreen() ? $style.wrapperContent : $style.wrapperContentMobile;\n      },\n    };\n  }\n});\n</script>\n\n<style module>\n.wrapperContentMobile {\n  z-index:10;\n  padding: 24px;\n  background-color: rgba(255, 255, 255, 1);\n  font-family: Roboto, Arial, sans-serif;\n  color: rgb(73, 80, 87);\n  overflow-y: scroll;\n}\n.wrapperContent {\n  z-index:10;\n  position: absolute;\n  width: 30%;\n  height: 100%;\n  padding: 24px;\n  overflow-y: scroll;\n  background-color: rgba(255, 255, 255, 1);\n  font-family: Roboto, Arial, sans-serif;\n  color: rgb(73, 80, 87);\n\n  border-right: 1px solid rgb(218, 220, 224);\n  box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);\n  clip-path: inset(0px -5px 0px 0px);\n}\n.title {\n  font-family: \"Google Sans\", Roboto, Arial, sans-serif;\n  font-size: 1.250rem;\n  font-weight: 400;\n  letter-spacing: 0;\n  line-height: 1.75rem;\n  color: #202124;\n  margin-bottom: 20px;\n}\n.list {\n  font-family: Roboto, Arial, sans-serif;\n  font-size: 0.875rem;\n  font-weight: 400;\n  letter-spacing: 0;\n  padding-left: 20px;\n  margin-bottom: 10px;\n  margin-top: 10px;\n}\n.icon {\n  margin-top: 9px;\n}\n.section {\n  font-family: \"Google Sans\", Roboto, Arial, sans-serif;\n  font-size: 1rem;\n  font-weight: 500;\n  letter-spacing: 0;\n  line-height: 1.5rem;\n}\n</style>\n","<template>\n  <div\n    v-for=\"precondition of preconditions\"\n    :class=\"`p-grid ${$style.precondition} p-p-md-0`\"\n    :key=\"precondition.id\"\n  >\n    <div class=\"p-col-10 p-pl-md-2\">\n        <p :class=\"`${$style.preconditionPath}`\">\n          {{preconditionPaths[precondition.id]}}\n        </p>\n        <p :class=\"`${$style.title}`\">\n          <Link :nodeID=\"precondition.id\" :nodeTitle=\"precondition.title\" />\n        </p>\n    </div>\n    <div class=\"p-col-2 p-p-md-0\">\n      <RemoveIcon @click=\"remove(precondition.id)\" />\n    </div>\n  </div>\n\n</template>\n\n<script lang=\"ts\">\nimport { ref, watchEffect, defineComponent } from \"vue\";\nimport {actions, useStore} from \"@/store\";\nimport api from \"@/api/api\";\nimport { Tree } from \"@/types/graphics\";\nimport RemoveIcon from \"@/components/node_content/RemoveIcon.vue\";\nimport {useConfirm} from \"primevue/useconfirm\";\nimport {mutations as preconditionMutations} from \"@/store/precondition\";\nimport {getTreePathString} from \"../helpers\";\nimport Link from \"@/components/Link.vue\";\n\nexport default defineComponent({\n  name: \"Preconditions\",\n  props: {\n    nodeId: {\n      type: String,\n      required: true\n    }\n  },\n  components: {\n    Link,\n    RemoveIcon\n  },\n  setup(props) {\n    const store = useStore();\n    const confirm = useConfirm();\n    const preconditions = ref<Array<Tree>>([]);\n    const preconditionPaths = ref<Record<string, string>>({});\n    watchEffect(() => {\n      preconditions.value = [];\n      preconditionPaths.value = {};\n      if (\n        props.nodeId &&\n        store.state.precondition.preconditions[props.nodeId]\n      ) {\n        for (const id of store.state.precondition.preconditions[props.nodeId]) {\n          preconditions.value.push(store.state.tree.nodeRecord[id].node);\n          preconditionPaths.value[id] = getTreePathString(id, store.state.tree.nodeRecord)\n        }\n      }\n    });\n\n    return {\n      preconditions,\n      preconditionPaths,\n      remove: async (id: string) => {\n        if (!(store.state.user && store.state.user.user && !store.state.user.user.isAnonymous)) {\n          await store.dispatch(`${actions.confirmSignInPopup}`, {confirm, message:\"Please authorize to added node prerequisites\"});\n          return\n        }\n\n        store.commit(`precondition/${preconditionMutations.REMOVE_PRECONDITION}`, {\n          nodeID: props.nodeId,\n          preconditionID: id,\n        });\n        api.savePreconditions(store.state.user.user, {\n          nodeId: props.nodeId,\n          preconditionIds: store.state.precondition.preconditions[props.nodeId]\n        });\n      }\n    };\n  }\n});\n</script>\n\n<style module>\n.title {\n  margin: 0;\n  padding: 0;\n}\n.precondition {\n  margin: 0;\n}\n.precondition:hover {\n  background-color: rgb(3, 219, 252, 0.2);\n}\n.preconditionPath {\n  margin: 0;\n  padding: 0;\n  font-size: 0.8rem;\n}\n</style>\n","<template>\n  <div\n    style=\"cursor: pointer;\"\n    @mouseenter=\"mouseOver = true\"\n    @mouseleave=\"mouseOver = false\"\n  >\n    <div v-if=\"mouseOver\" class=\"custom\">\n      <img\n        style=\"height: 35px\"\n        alt=\"pin-off\"\n        src=\"../../assets/images/remove-on.svg\"\n      />\n    </div>\n    <div v-else class=\"custom\">\n      <img\n        style=\"height: 35px\"\n        alt=\"pin-on\"\n        src=\"../../assets/images/remove-off.svg\"\n      />\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref } from \"vue\";\n\nexport default {\n  name: \"RemoveIcon\",\n  setup() {\n    const mouseOver = ref(false);\n    return {\n      mouseOver\n    };\n  }\n};\n</script>\n\n<style scoped>\n.custom {\n  margin-top: 8px;\n  margin-left: 22px;\n}\n</style>\n","import { render } from \"./RemoveIcon.vue?vue&type=template&id=154fe046&scoped=true\"\nimport script from \"./RemoveIcon.vue?vue&type=script&lang=js\"\nexport * from \"./RemoveIcon.vue?vue&type=script&lang=js\"\n\nimport \"./RemoveIcon.vue?vue&type=style&index=0&id=154fe046&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-154fe046\"\n\nexport default script","<template>\n  <a href=\"#\" @click=\"goto($event, nodeID)\">{{ nodeTitle }}</a>\n</template>\n\n<script lang=\"ts\">\nimport {useRouter} from \"vue-router\";\nimport {defineComponent} from \"vue\";\nimport {useStore} from \"@/store\";\nimport { findMapNode } from \"@/store/tree/helpers\";\nimport {mutations as zoomPanMutations} from \"@/store/zoom_pan\";\n\nexport default defineComponent({\n  name: \"Link\",\n  props: {\n    nodeID: {\n      type: String,\n      required: true\n    },\n    nodeTitle: {\n      type: String,\n      required: true\n    },\n  },\n  setup() {\n    const store = useStore();\n    const router = useRouter();\n    const treeState = store.state.tree;\n\n    return {\n      goto: (event: Event, id: string) => {\n        event.preventDefault();\n        const [firstNode] = findMapNode(\n            id,\n            treeState.mapNodeLayers\n        );\n        if (firstNode != null) {\n          router.push({ name: \"node\", params: { id } });\n          store.commit(`zoomPan/${zoomPanMutations.RESET_ZOOM_AND_PAN}`)\n          store.commit(`zoomPan/${zoomPanMutations.SET_PAN}`, {\n            x: -firstNode.center.x + treeState.mapNodeLayers[0][\"0\"].center.x,\n            y: -firstNode.center.y + treeState.mapNodeLayers[0][\"0\"].center.y\n          });\n        }\n      },\n    }\n  }\n})\n</script>\n","\nimport {useRouter} from \"vue-router\";\nimport {defineComponent} from \"vue\";\nimport {useStore} from \"@/store\";\nimport { findMapNode } from \"@/store/tree/helpers\";\nimport {mutations as zoomPanMutations} from \"@/store/zoom_pan\";\n\nexport default defineComponent({\n  name: \"Link\",\n  props: {\n    nodeID: {\n      type: String,\n      required: true\n    },\n    nodeTitle: {\n      type: String,\n      required: true\n    },\n  },\n  setup() {\n    const store = useStore();\n    const router = useRouter();\n    const treeState = store.state.tree;\n\n    return {\n      goto: (event: Event, id: string) => {\n        event.preventDefault();\n        const [firstNode] = findMapNode(\n            id,\n            treeState.mapNodeLayers\n        );\n        if (firstNode != null) {\n          router.push({ name: \"node\", params: { id } });\n          store.commit(`zoomPan/${zoomPanMutations.RESET_ZOOM_AND_PAN}`)\n          store.commit(`zoomPan/${zoomPanMutations.SET_PAN}`, {\n            x: -firstNode.center.x + treeState.mapNodeLayers[0][\"0\"].center.x,\n            y: -firstNode.center.y + treeState.mapNodeLayers[0][\"0\"].center.y\n          });\n        }\n      },\n    }\n  }\n})\n","import { render } from \"./Link.vue?vue&type=template&id=4c2537d2\"\nimport script from \"./Link.vue?vue&type=script&lang=ts\"\nexport * from \"./Link.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","\nimport { ref, watchEffect, defineComponent } from \"vue\";\nimport {actions, useStore} from \"@/store\";\nimport api from \"@/api/api\";\nimport { Tree } from \"@/types/graphics\";\nimport RemoveIcon from \"@/components/node_content/RemoveIcon.vue\";\nimport {useConfirm} from \"primevue/useconfirm\";\nimport {mutations as preconditionMutations} from \"@/store/precondition\";\nimport {getTreePathString} from \"../helpers\";\nimport Link from \"@/components/Link.vue\";\n\nexport default defineComponent({\n  name: \"Preconditions\",\n  props: {\n    nodeId: {\n      type: String,\n      required: true\n    }\n  },\n  components: {\n    Link,\n    RemoveIcon\n  },\n  setup(props) {\n    const store = useStore();\n    const confirm = useConfirm();\n    const preconditions = ref<Array<Tree>>([]);\n    const preconditionPaths = ref<Record<string, string>>({});\n    watchEffect(() => {\n      preconditions.value = [];\n      preconditionPaths.value = {};\n      if (\n        props.nodeId &&\n        store.state.precondition.preconditions[props.nodeId]\n      ) {\n        for (const id of store.state.precondition.preconditions[props.nodeId]) {\n          preconditions.value.push(store.state.tree.nodeRecord[id].node);\n          preconditionPaths.value[id] = getTreePathString(id, store.state.tree.nodeRecord)\n        }\n      }\n    });\n\n    return {\n      preconditions,\n      preconditionPaths,\n      remove: async (id: string) => {\n        if (!(store.state.user && store.state.user.user && !store.state.user.user.isAnonymous)) {\n          await store.dispatch(`${actions.confirmSignInPopup}`, {confirm, message:\"Please authorize to added node prerequisites\"});\n          return\n        }\n\n        store.commit(`precondition/${preconditionMutations.REMOVE_PRECONDITION}`, {\n          nodeID: props.nodeId,\n          preconditionID: id,\n        });\n        api.savePreconditions(store.state.user.user, {\n          nodeId: props.nodeId,\n          preconditionIds: store.state.precondition.preconditions[props.nodeId]\n        });\n      }\n    };\n  }\n});\n","import { render } from \"./Preconditions.vue?vue&type=template&id=c5b277c6\"\nimport script from \"./Preconditions.vue?vue&type=script&lang=ts\"\nexport * from \"./Preconditions.vue?vue&type=script&lang=ts\"\n\nconst cssModules = script.__cssModules = {}\nimport style0 from \"./Preconditions.vue?vue&type=style&index=0&id=c5b277c6&module=true&lang=css\"\ncssModules[\"$style\"] = style0\nscript.render = render\n\nexport default script","<template>\n  <div v-for=\"usedByNode of usedBy\"\n       :class=\"`p-grid ${$style.precondition} p-p-md-0`\"\n       :key=\"usedByNode.id\"\n  >\n    <div class=\"p-col-12\">\n      <p :class=\"`${$style.preconditionPath}`\">\n        {{usedByPaths[usedByNode.id]}}\n      </p>\n      <p :class=\"`${$style.title}`\">\n        <Link :nodeID=\"usedByNode.id\" :nodeTitle=\"usedByNode.title\" />\n      </p>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport {ref, watchEffect, defineComponent, PropType} from \"vue\";\nimport { useStore } from \"@/store\";\nimport { Tree } from \"@/types/graphics\";\nimport {getTreePathString} from \"@/components/helpers\";\nimport Link from \"@/components/Link.vue\";\n\nexport default defineComponent({\n  name: \"UsedBy\",\n  components: {\n    Link,\n  },\n  props: {\n    nodeIDs: Object as PropType<Array<string>>\n  },\n  setup(props) {\n    const store = useStore();\n    const usedBy = ref<Array<Tree>>([]);\n    const usedByPaths = ref<Record<string, string>>({});\n    watchEffect(() => {\n      usedBy.value = [];\n      usedByPaths.value = {};\n      if (props.nodeIDs) {\n        for (const id of props.nodeIDs) {\n          if (!store.state.tree.nodeRecord[id]) {\n            console.log(\"UsedBy: cannot find id in nodeRecord\", id);\n          } else {\n            usedBy.value.push(store.state.tree.nodeRecord[id].node);\n            usedByPaths.value[id] = getTreePathString(id, store.state.tree.nodeRecord)\n          }\n        }\n      }\n    });\n\n    return {\n      usedBy,\n      usedByPaths,\n    };\n  }\n});\n</script>\n\n\n<style module>\n.title {\n  margin: 0;\n  padding: 0;\n}\n.precondition {\n  margin: 0;\n}\n.precondition:hover {\n  background-color: rgb(3, 219, 252, 0.2);\n}\n.preconditionPath {\n  margin: 0;\n  padding: 0;\n  font-size: 0.8rem;\n}\n</style>\n","\nimport {ref, watchEffect, defineComponent, PropType} from \"vue\";\nimport { useStore } from \"@/store\";\nimport { Tree } from \"@/types/graphics\";\nimport {getTreePathString} from \"@/components/helpers\";\nimport Link from \"@/components/Link.vue\";\n\nexport default defineComponent({\n  name: \"UsedBy\",\n  components: {\n    Link,\n  },\n  props: {\n    nodeIDs: Object as PropType<Array<string>>\n  },\n  setup(props) {\n    const store = useStore();\n    const usedBy = ref<Array<Tree>>([]);\n    const usedByPaths = ref<Record<string, string>>({});\n    watchEffect(() => {\n      usedBy.value = [];\n      usedByPaths.value = {};\n      if (props.nodeIDs) {\n        for (const id of props.nodeIDs) {\n          if (!store.state.tree.nodeRecord[id]) {\n            console.log(\"UsedBy: cannot find id in nodeRecord\", id);\n          } else {\n            usedBy.value.push(store.state.tree.nodeRecord[id].node);\n            usedByPaths.value[id] = getTreePathString(id, store.state.tree.nodeRecord)\n          }\n        }\n      }\n    });\n\n    return {\n      usedBy,\n      usedByPaths,\n    };\n  }\n});\n","import { render } from \"./UsedBy.vue?vue&type=template&id=b8b30aac\"\nimport script from \"./UsedBy.vue?vue&type=script&lang=ts\"\nexport * from \"./UsedBy.vue?vue&type=script&lang=ts\"\n\nconst cssModules = script.__cssModules = {}\nimport style0 from \"./UsedBy.vue?vue&type=style&index=0&id=b8b30aac&module=true&lang=css\"\ncssModules[\"$style\"] = style0\nscript.render = render\n\nexport default script","<template>\n  <p v-if=\"isAuthorized\"\n    v-show=\"!editOn\"\n    v-html=\"renderedContent\"\n    @click=\"setEditOn(true)\"\n    class=\"renderedContent\"\n  />\n  <p v-else\n    v-html=\"renderedContent\"\n    class=\"renderedContent\"\n  />\n  <textarea\n    class=\"rawContent p-inputtextarea p-inputtext p-component p-inputtextarea-resizable\"\n    style=\"display: none\"\n    ref=\"txtarea\"\n    :rows=\"rows\"\n    :value=\"content\"\n    @input=\"changeContent($event.target.value)\"\n    @focusout=\"setEditOn(false)\"\n  />\n</template>\n\n<script lang=\"ts\">\nimport { computed, ref } from \"vue\";\nimport MarkdownIt from \"markdown-it\";\nimport {useStore} from \"@/store\";\nconst mdKatex = require('markdown-it-katex'); // eslint-disable-line\nconst mdImsize = require('markdown-it-imsize'); // eslint-disable-line\nconst mdContainer = require('markdown-it-container'); // eslint-disable-line\nconst mdVideo = require('markdown-it-block-embed'); // eslint-disable-line\nconst md = new MarkdownIt();\nmd.use(mdKatex, { output: \"html\" })\n  .use(mdImsize)\n  .use(mdVideo, {\n    containerClassName: \"video-embed\",\n    youtube: {\n      width: 370,\n      height: 209,\n    }\n  })\n  .use(mdContainer, \"warning\", {\n    validate: function(params: any) {\n      console.log(\"validate\", params.trim(), params.trim() == \"warning\");\n      return params.trim().match(/^warning$/);\n    },\n    render: function(tokens: any, idx: any) {\n      const m = tokens[idx].info.trim().match(/^warning(.*)$/);\n      if (tokens[idx].nesting === 1) {\n        // opening tag\n        return (\n          '<div style=\"background-color: #c6f68d; padding: 8px;\">' +\n          md.utils.escapeHtml(m[1]) +\n          \"\\n\"\n        );\n      } else {\n        // closing tag\n        return \"</div>\\n\";\n      }\n    }\n  });\n\nexport default {\n  name: \"Markdown\",\n  emits: [\"content-changed\"],\n  props: {\n    content: {\n      type: String,\n      required: true\n    },\n    rows: {\n      type: Number,\n      required: true\n    }\n  },\n  setup(props: any, ctx: any) {\n    const store = useStore();\n    const renderedContent = computed(() => {\n      return md.render(props.content);\n    });\n    const editOn = ref(false);\n\n    const txtarea = ref<HTMLDivElement | null>(null);\n\n    return {\n      isAuthorized: computed(()=>store.state.user && store.state.user.user && !store.state.user.user.isAnonymous),\n      editOn,\n      txtarea,\n      setEditOn: (val: boolean) => {\n        editOn.value = val;\n        if (val && txtarea.value) {\n          txtarea.value.style.display = \"block\";\n          txtarea.value.focus();\n        }\n        if (!val && txtarea.value) {\n          txtarea.value.style.display = \"none\";\n        }\n      },\n      renderedContent,\n      changeContent: (value: string) => {\n        ctx.emit(\"content-changed\", value);\n      }\n    };\n  }\n};\n</script>\n\n<style scoped>\n@import \"../../../node_modules/katex/dist/katex.min.css\";\n.renderedContent {\n  color: rgb(32, 33, 36);\n  font-family: Roboto, Arial, sans-serif;\n  font-size: 14px;\n  font-weight: 400;\n  letter-spacing: normal;\n  line-height: 20px;\n  margin-right: 4px;\n  text-align: left;\n  text-wrap: wrap;\n  overflow-y: scroll;\n  height: 300px;\n  table :is(td, th) {\n    border-top: 1px solid black;\n    padding: 0.3em;\n  }\n  table {\n    border-spacing: 0;\n    border-collapse: collapse;\n  }\n  tr:nth-child(even) {\n    background-color: #f9f9f9;\n  }\n}\n.rawContent {\n  overflow-y: scroll;\n  height: 100%;\n}\n</style>\n","\nimport { computed, ref } from \"vue\";\nimport MarkdownIt from \"markdown-it\";\nimport {useStore} from \"@/store\";\nconst mdKatex = require('markdown-it-katex'); // eslint-disable-line\nconst mdImsize = require('markdown-it-imsize'); // eslint-disable-line\nconst mdContainer = require('markdown-it-container'); // eslint-disable-line\nconst mdVideo = require('markdown-it-block-embed'); // eslint-disable-line\nconst md = new MarkdownIt();\nmd.use(mdKatex, { output: \"html\" })\n  .use(mdImsize)\n  .use(mdVideo, {\n    containerClassName: \"video-embed\",\n    youtube: {\n      width: 370,\n      height: 209,\n    }\n  })\n  .use(mdContainer, \"warning\", {\n    validate: function(params: any) {\n      console.log(\"validate\", params.trim(), params.trim() == \"warning\");\n      return params.trim().match(/^warning$/);\n    },\n    render: function(tokens: any, idx: any) {\n      const m = tokens[idx].info.trim().match(/^warning(.*)$/);\n      if (tokens[idx].nesting === 1) {\n        // opening tag\n        return (\n          '<div style=\"background-color: #c6f68d; padding: 8px;\">' +\n          md.utils.escapeHtml(m[1]) +\n          \"\\n\"\n        );\n      } else {\n        // closing tag\n        return \"</div>\\n\";\n      }\n    }\n  });\n\nexport default {\n  name: \"Markdown\",\n  emits: [\"content-changed\"],\n  props: {\n    content: {\n      type: String,\n      required: true\n    },\n    rows: {\n      type: Number,\n      required: true\n    }\n  },\n  setup(props: any, ctx: any) {\n    const store = useStore();\n    const renderedContent = computed(() => {\n      return md.render(props.content);\n    });\n    const editOn = ref(false);\n\n    const txtarea = ref<HTMLDivElement | null>(null);\n\n    return {\n      isAuthorized: computed(()=>store.state.user && store.state.user.user && !store.state.user.user.isAnonymous),\n      editOn,\n      txtarea,\n      setEditOn: (val: boolean) => {\n        editOn.value = val;\n        if (val && txtarea.value) {\n          txtarea.value.style.display = \"block\";\n          txtarea.value.focus();\n        }\n        if (!val && txtarea.value) {\n          txtarea.value.style.display = \"none\";\n        }\n      },\n      renderedContent,\n      changeContent: (value: string) => {\n        ctx.emit(\"content-changed\", value);\n      }\n    };\n  }\n};\n","import { render } from \"./Markdown.vue?vue&type=template&id=a238a804&scoped=true\"\nimport script from \"./Markdown.vue?vue&type=script&lang=ts\"\nexport * from \"./Markdown.vue?vue&type=script&lang=ts\"\n\nimport \"./Markdown.vue?vue&type=style&index=0&id=a238a804&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-a238a804\"\n\nexport default script","<template>\n  <ChangeLogComplain\n    :show=\"complainModalVisible\"\n    :complainChangeLink=\"complainChangeLink\"\n    @hide=\"complainModalVisible = false\"\n  />\n  <Fieldset\n    legend=\"change log\"\n    :toggleable=\"true\"\n    :collapsed=\"collapsed\"\n    @update:collapsed=\"toggle($event)\"\n    :pt=\"{\n      legend: { class: 'bg-primary' }\n    }\"\n  >\n    <div v-if=\"!isAuthorized\">\n      Sign in to see node change log\n    </div>\n    <div v-else class=\"m-0\">\n      <Card v-for=\"(event, i) of changes\" :key=\"i\" class=\"mt-3\">\n        <template #title>\n          {{ new Date(event.timestamp).toLocaleDateString() }}\n          {{ new Date(event.timestamp).toLocaleTimeString() }} /\n          {{ event.action }} change\n        </template>\n        <template #subtitle>\n          {{\n            !!event.userDisplayName\n              ? event.userDisplayName\n              : `user id ${event.userID}`\n          }}\n          / <a href=\"#\" @click=\"showComplain(event.changeLogID)\">Complain</a>\n        </template>\n        <template #content v-if=\"event.action == ActionType.Name\">\n          {{ event.newName }}\n        </template>\n        <template #content v-else-if=\"event.action == ActionType.Content\">\n          <Markdown :content=\"event.newContent\" :rows=\"10\" />\n        </template>\n        <template #content v-else-if=\"event.action == ActionType.Precondition\">\n          <div v-html=\"getContent(event)\" />\n        </template>\n      </Card>\n    </div>\n  </Fieldset>\n</template>\n\n<script lang=\"ts\">\nimport Fieldset from \"primevue/fieldset\";\nimport Card from \"primevue/card\";\nimport { subscribeChangeLogEnriched, GetNodeUrl } from \"@/api/change_log\";\nimport { computed, reactive, ref, watch, defineComponent } from \"vue\";\nimport {\n  ActionType,\n  ChangeLogEnriched,\n  ChangeLogNodePrecondition\n} from \"@/store/change_log\";\nimport { useStore } from \"@/store\";\nimport ChangeLogComplain from \"@/components/node_content/ChangeLogComplain.vue\";\nimport Markdown from \"@/components/node_content/Markdown.vue\";\n\nexport default defineComponent({\n  name: \"ChangeLog\",\n  computed: {\n    ActionType() {\n      return ActionType;\n    }\n  },\n  props: {\n    nodeId: {\n      type: String,\n      required: true\n    }\n  },\n  components: {\n    Markdown,\n    ChangeLogComplain,\n    Fieldset,\n    Card\n  },\n  setup(props) {\n    const store = useStore();\n    const isAuthorized = computed(\n      () => store.state.user.user && !store.state.user.user.isAnonymous\n    );\n    const complainChangeLink = ref(\"\");\n    const complainModalVisible = ref(false);\n    const collapsed = ref(true);\n    const changes = reactive([]) as Array<ChangeLogEnriched>;\n    let unsubscribe = () => {\n      /**/\n    };\n    watch(\n      () => [props.nodeId, collapsed.value],\n      async (newArgs, oldArgs) => {\n        if (newArgs[0] != oldArgs[0]) {\n          collapsed.value = true;\n        }\n        unsubscribe();\n        unsubscribe = () => {\n          /**/\n        };\n        if (collapsed.value == false) {\n          unsubscribe = await subscribeChangeLogEnriched(\n            [ActionType.Name, ActionType.Content, ActionType.Precondition],\n            [props.nodeId],\n            changeLogs => {\n              changes.splice(0, changes.length, ...changeLogs);\n            }\n          );\n        }\n      }\n    );\n    return {\n      changes,\n      collapsed,\n      toggle: (event: boolean) => {\n        collapsed.value = event;\n      },\n      showComplain: (id: string) => {\n        complainModalVisible.value = true;\n        complainChangeLink.value = \"https://scimap.org/change/\" + id;\n      },\n      getContent: (event: ChangeLogEnriched) => {\n        event = event as ChangeLogNodePrecondition;\n        const removed = [];\n        for (const cd of event.removed) {\n          removed.push(GetNodeUrl(cd.idPath, cd.id, cd.name));\n        }\n        const added = [];\n        for (const cd of event.added) {\n          added.push(GetNodeUrl(cd.idPath, cd.id, cd.name));\n        }\n\n        let result = \"\";\n        if (removed.length > 0) {\n          result += `removed: ${removed.join(\", \")}`;\n        }\n        if (added.length > 0) {\n          result += `<br> added: ${added.join(\", \")}`;\n        }\n        return result;\n      },\n      complainModalVisible,\n      complainChangeLink,\n      isAuthorized\n    };\n  }\n});\n</script>\n","export enum ActionType {\n  /**\n   * /map\n   */\n  Name = \"name\",\n  ParentID = \"parentID\",\n\n  /**\n   * /node_content\n   */\n  Content = \"content\",\n\n  /**\n   * /precondition\n   */\n  Precondition = \"precondition\",\n\n  /**\n   * /cmd/remove\n   */\n  Remove = \"remove\",\n\n  /**\n   * /cmd/restore\n   */\n  Restore = \"restore\",\n}\n\nexport type Node = {\n  id: string;\n  idPath: string;\n  name: string;\n};\n\nexport type ChangeLog = {\n  changeLogID: string;\n  nodeID: string;\n  userID: string;\n  timestamp: number;\n  action: ActionType;\n  attributes: {\n    value: any;\n    valueBefore: any;\n    valueAfter: any;\n    added: any;\n    removed: any;\n    parentNodeID: any;\n  };\n};\n\nexport type ChangeLogNodePrecondition = {\n  changeLogID: string;\n\n  timestamp: number;\n  action: ActionType;\n\n  userID: string;\n  userDisplayName: string;\n\n  removed: Array<Node>;\n  added: Array<Node>;\n};\n\nexport type ChangeLogNodeContent = {\n  changeLogID: string;\n\n  timestamp: number;\n  action: ActionType;\n\n  userID: string;\n  userDisplayName: string;\n\n  node: Node;\n\n  newContent: string;\n};\n\nexport type ChangeLogNodeName = {\n  changeLogID: string;\n\n  timestamp: number;\n  action: ActionType;\n\n  userID: string;\n  userDisplayName: string;\n\n  node: Node;\n\n  newName: string;\n};\n\nexport type ChangeLogNodeParent = {\n  changeLogID: string;\n\n  timestamp: number;\n  action: ActionType;\n\n  userID: string;\n  userDisplayName: string;\n\n  parentNodeBefore: Node | null;\n  parentNodeAfter: Node | null;\n  node: Node;\n\n  isRemoved: boolean;\n  isAdded: boolean;\n};\n\nexport type ChangeLogEnriched =\n  | ChangeLogNodeContent\n  | ChangeLogNodeName\n  | ChangeLogNodePrecondition\n  | ChangeLogNodeParent;\n","import { ActionType, ChangeLog, ChangeLogEnriched } from \"@/store/change_log\";\nimport { QueryFilterConstraint } from \"@firebase/firestore\";\nimport {\n  and,\n  collection,\n  getFirestore,\n  onSnapshot,\n  orderBy,\n  query,\n  where\n} from \"firebase/firestore\";\nimport firebase from \"firebase/compat\";\n\n/**\n * TODO: add limit\n * @param actions\n * @param nodeIDs\n * @param cb\n */\nexport async function subscribeChangeLog(\n  actions: Array<ActionType>,\n  nodeIDs: Array<string>,\n  cb: (changeLogs: Array<ChangeLog>) => void\n) {\n  const andConditions = [] as Array<QueryFilterConstraint>;\n  if (nodeIDs.length) {\n    andConditions.push(where(\"node_id\", \"in\", nodeIDs));\n  }\n  if (actions.length) {\n    andConditions.push(where(\"action\", \"in\", actions));\n  }\n  // 'remove' and 'restore' changes is made by firebase functions (but logged anyway in firestore)\n  // here we skip most details made by function and show only action made by user\n  andConditions.push(where(\"user_id\", \"!=\", \"function\"));\n  const q = query(\n    collection(getFirestore(), \"changes\"),\n    and(...andConditions),\n    orderBy(\"timestamp\", \"desc\")\n  );\n\n  return onSnapshot(q, snapshot => {\n    const changeLogs = [] as Array<ChangeLog>;\n    snapshot.forEach(doc => {\n      changeLogs.push({\n        changeLogID: doc.id,\n        nodeID: doc.get(\"node_id\"),\n        userID: doc.get(\"user_id\"),\n        timestamp: doc.get(\"timestamp\"),\n        action: doc.get(\"action\"),\n        attributes: {\n          value: doc.get(\"attributes.value\"),\n          valueBefore: doc.get(\"attributes.valueBefore\"),\n          valueAfter: doc.get(\"attributes.valueAfter\"),\n          added: doc.get(\"attributes.added\"),\n          removed: doc.get(\"attributes.removed\"),\n          parentNodeID: doc.get(\"attributes.parentNodeID\"),\n        }\n      });\n    });\n    cb(changeLogs);\n  });\n}\n\n/**\n * @param nodeID\n */\nexport async function getNodeName(\n  nodeID: string\n): Promise<Record<string, string>> {\n  const nodeName = {} as Record<string, string>;\n  const pr = await firebase\n    .database()\n    .ref(`map/${nodeID}/name`)\n    .get();\n  if (pr.exists()) {\n    nodeName[`map/${nodeID}`] = pr.val();\n  } else {\n    const prTrash = await firebase\n      .database()\n      .ref(`trash/${nodeID}/map/name`)\n      .get();\n    if (prTrash.exists()) {\n      nodeName[`trash/${nodeID}`] = prTrash.val();\n    }\n  }\n\n  return nodeName;\n}\n\n/**\n * @param userID\n */\nexport async function getUserDisplayName(\n  userID: string\n): Promise<Record<string, string>> {\n  const userName = {} as Record<string, string>;\n  const pr = await firebase\n    .database()\n    .ref(`public_user_data/${userID}/displayName`)\n    .get();\n  if (pr.exists()) {\n    userName[`${userID}`] = pr.val();\n  }\n  return userName;\n}\n\nexport async function getUserDisplayNames(\n  userIDs: Array<string>\n): Promise<Record<string, string>> {\n  const fetches = [];\n  for (const userID of userIDs) {\n    fetches.push(getUserDisplayName(userID));\n  }\n  const responses = await Promise.all(fetches);\n  const result = {} as Record<string, string>;\n  for (const response of responses) {\n    result[Object.keys(response)[0]] = Object.values(response)[0];\n  }\n  return result;\n}\n\n// Note: realtime database charges for bandwidth and does not have batch fetch for multiple paths\n// If someday we switch to Firestore this must be implemented in other way\nexport async function getNodeNames(\n  nodeIDs: Array<string>\n): Promise<Record<string, string>> {\n  const fetches = [];\n  for (const nodeID of nodeIDs) {\n    fetches.push(getNodeName(nodeID));\n  }\n  const responses = await Promise.all(fetches);\n  const result = {} as Record<string, string>;\n  for (const response of responses) {\n    result[Object.keys(response)[0]] = Object.values(response)[0];\n  }\n  return result;\n}\n\nfunction getPathFromNodeName(\n  nodeID: string | null,\n  nodeNames: Record<string, string>\n): string {\n  if (nodeID == null) {\n    return \"\";\n  }\n  let nodePath = \"\";\n  if (nodeNames[`map/${nodeID}`] != null) {\n    nodePath = `map/${nodeID}`;\n  } else if (nodeNames[`trash/${nodeID}`] != null) {\n    nodePath = `trash/${nodeID}`;\n  }\n  return nodePath;\n}\n\n/**\n * Same as subscribeChangeLog but enriched with username\n * @param actions\n * @param nodeIDs\n * @param cb\n */\nexport async function subscribeChangeLogEnriched(\n  actions: Array<ActionType>,\n  nodeIDs: Array<string>,\n  cb: (changeLogsEnriched: Array<ChangeLogEnriched>) => void\n) {\n  return subscribeChangeLog(\n    actions,\n    nodeIDs,\n    (changeLogs: Array<ChangeLog>) => {\n      // collect userIDs to request names\n      // and nodeIDs to request node names\n      const userNames = {} as Record<string, string>;\n      const nodeNames = {} as Record<string, string>;\n      for (const changeLog of changeLogs) {\n        userNames[changeLog.userID] = \"\";\n        nodeNames[changeLog.nodeID] = \"\";\n        if (changeLog.action == ActionType.ParentID) {\n          if (changeLog.attributes.valueBefore != null) {\n            nodeNames[changeLog.attributes.valueBefore] = \"\";\n          }\n          if (changeLog.attributes.valueAfter != null) {\n            nodeNames[changeLog.attributes.valueAfter] = \"\";\n          }\n        }\n        if (changeLog.action == ActionType.Restore) {\n          if (changeLog.attributes.parentNodeID != null) {\n            nodeNames[changeLog.attributes.parentNodeID] = \"\";\n          }\n        }\n        if (changeLog.action == ActionType.Precondition) {\n          if (changeLog.attributes.removed != null) {\n            for (const id of changeLog.attributes.removed) {\n              nodeNames[id] = \"\";\n            }\n          }\n          if (changeLog.attributes.added != null) {\n            for (const id of changeLog.attributes.added) {\n              nodeNames[id] = \"\";\n            }\n          }\n        }\n      }\n      // fetch node and usernames\n      const nodeIDs = [];\n      for (const nodeID in nodeNames) {\n        nodeIDs.push(nodeID);\n      }\n      const userIDs = [];\n      for (const userID in userNames) {\n        userIDs.push(userID);\n      }\n      Promise.all([getNodeNames(nodeIDs), getUserDisplayNames(userIDs)]).then(\n        resp => {\n          const nodeNames = resp[0];\n          const userNames = resp[1];\n          const changeLogsEnriched = [] as Array<ChangeLogEnriched>;\n          changeLogs.forEach(log => {\n            const nodePath = getPathFromNodeName(log.nodeID, nodeNames);\n            if (log.action == ActionType.Name) {\n              changeLogsEnriched.push({\n                changeLogID: log.changeLogID,\n\n                timestamp: log.timestamp,\n                action: log.action,\n\n                userID: log.userID,\n                userDisplayName: userNames[log.userID],\n\n                node: {\n                  id: log.nodeID,\n                  idPath: nodePath,\n                  name: nodeNames[nodePath]\n                },\n\n                newName: log.attributes.value\n              });\n            } else if (log.action == ActionType.Content) {\n              changeLogsEnriched.push({\n                changeLogID: log.changeLogID,\n\n                timestamp: log.timestamp,\n                action: log.action,\n\n                userID: log.userID,\n                userDisplayName: userNames[log.userID],\n\n                node: {\n                  id: log.nodeID,\n                  idPath: nodePath,\n                  name: nodeNames[nodePath]\n                },\n\n                newContent: log.attributes.value\n              });\n            } else if (log.action == ActionType.Precondition) {\n              const removed = [];\n              if (log.attributes.removed) {\n                for (const id of log.attributes.removed) {\n                  removed.push({\n                    id: id,\n                    idPath: getPathFromNodeName(id, nodeNames),\n                    name: nodeNames[getPathFromNodeName(id, nodeNames)]\n                  });\n                }\n              }\n              const added = [];\n              if (log.attributes.added) {\n                for (const id of log.attributes.added) {\n                  added.push({\n                    id: id,\n                    idPath: getPathFromNodeName(id, nodeNames),\n                    name: nodeNames[getPathFromNodeName(id, nodeNames)]\n                  });\n                }\n              }\n\n              changeLogsEnriched.push({\n                changeLogID: log.changeLogID,\n\n                timestamp: log.timestamp,\n                action: log.action,\n\n                userID: log.userID,\n                userDisplayName: userNames[log.userID],\n\n                node: {\n                  id: log.nodeID,\n                  idPath: nodePath,\n                  name: nodeNames[nodePath]\n                },\n\n                removed,\n                added\n              });\n            } else if (log.action == ActionType.ParentID && log.attributes.valueAfter !== null) {\n              const beforePath = getPathFromNodeName(\n                log.attributes.valueBefore,\n                nodeNames\n              );\n              const afterPath = getPathFromNodeName(\n                log.attributes.valueAfter,\n                nodeNames\n              );\n              changeLogsEnriched.push({\n                changeLogID: log.changeLogID,\n\n                timestamp: log.timestamp,\n                action: log.action,\n\n                userID: log.userID,\n                userDisplayName: userNames[log.userID],\n\n                node: {\n                  id: log.nodeID,\n                  idPath: nodePath,\n                  name: nodeNames[nodePath]\n                },\n\n                parentNodeBefore: {\n                  id: log.attributes.valueBefore,\n                  idPath: beforePath,\n                  name: nodeNames[beforePath]\n                },\n\n                parentNodeAfter: {\n                  id: log.attributes.valueAfter,\n                  idPath: afterPath,\n                  name: nodeNames[afterPath]\n                },\n\n                isRemoved: false,\n                isAdded: log.attributes.valueBefore == null\n              });\n            } else if (log.action == ActionType.Remove) {\n              const beforePath = getPathFromNodeName(\n                log.attributes.parentNodeID,\n                nodeNames\n              );\n              changeLogsEnriched.push({\n                changeLogID: log.changeLogID,\n\n                timestamp: log.timestamp,\n                action: log.action,\n\n                userID: log.userID,\n                userDisplayName: userNames[log.userID],\n\n                node: {\n                  id: log.nodeID,\n                  idPath: nodePath,\n                  name: nodeNames[nodePath]\n                },\n\n                parentNodeBefore: {\n                  id: log.attributes.parentNodeID,\n                  idPath: beforePath,\n                  name: nodeNames[beforePath]\n                },\n\n                parentNodeAfter: null,\n\n                isRemoved: true,\n                isAdded: false\n              });\n            } else if (log.action == ActionType.Restore) {\n              const afterPath = getPathFromNodeName(\n                log.attributes.parentNodeID,\n                nodeNames\n              );\n              changeLogsEnriched.push({\n                changeLogID: log.changeLogID,\n\n                timestamp: log.timestamp,\n                action: log.action,\n\n                userID: log.userID,\n                userDisplayName: userNames[log.userID],\n\n                node: {\n                  id: log.nodeID,\n                  idPath: nodePath,\n                  name: nodeNames[nodePath]\n                },\n\n                parentNodeBefore: null,\n\n                parentNodeAfter: {\n                  id: log.attributes.parentNodeID,\n                  idPath: afterPath,\n                  name: nodeNames[afterPath]\n                },\n\n                isRemoved: false,\n                isAdded: true\n              });\n            }\n          });\n          cb(changeLogsEnriched);\n        }\n      );\n    }\n  );\n}\n\nexport function IsNodeInTrash(nodeIDPath: string): boolean {\n  return nodeIDPath.startsWith(\"trash\")\n}\n\nexport function GetNodeUrl(\n  nodeIDPath: string,\n  nodeID: string,\n  nodeName: string\n): string {\n  if (IsNodeInTrash(nodeIDPath)) {\n    return `<a target=\"_blank\" href=\"/node_description/${nodeID}\">${nodeName}</a>`;\n  } else {\n    return `<a target=\"_blank\" href=\"/${nodeID}\">${nodeName}</a>`;\n  }\n}\n","<template>\n  <Dialog\n    v-model:visible=\"complainModalVisible\"\n    @hide=\"$emit('hide')\"\n    :dismissableMask=\"true\"\n    :closable=\"true\"\n    :modal=\"true\"\n    :closeOnEscape=\"true\"\n  >\n    <template #header>\n      <h3>\n        {{\n          `Please use our discord channel to complain about inappropriate changes`\n        }}\n      </h3>\n    </template>\n    <h3>\n      <a\n        target=\"_blank\"\n        href=\"https://discord.com/channels/1171118046543347782/1196694554791915600\"\n        >Discord edit-complains channel</a\n      >\n    </h3>\n    <p>\n      You can use the following text:\n    </p>\n    <code>\n      Hi, I think I found changes that was inappropriate because ... <br />\n      Here is the changes I am talking about {{ complainChangeLink }} <br />\n      This is the ...st time I found inappropriate changes from this user.\n      <br />\n    </code>\n    <template #footer> </template>\n  </Dialog>\n</template>\n<script lang=\"ts\">\nimport Dialog from \"primevue/dialog\";\nimport { ref, watch, defineComponent } from \"vue\";\n\nexport default defineComponent({\n  name: \"ChangeLogComplain\",\n  props: {\n    show: Boolean,\n    complainChangeLink: String\n  },\n  components: {\n    Dialog\n  },\n  emits: [\"hide\"],\n  setup(props) {\n    const complainModalVisible = ref(false);\n    watch(\n      () => [props.show],\n      async (newArgs, oldArgs) => {\n        complainModalVisible.value = newArgs[0];\n      }\n    );\n    return {\n      complainModalVisible\n    };\n  }\n});\n</script>\n","\nimport Dialog from \"primevue/dialog\";\nimport { ref, watch, defineComponent } from \"vue\";\n\nexport default defineComponent({\n  name: \"ChangeLogComplain\",\n  props: {\n    show: Boolean,\n    complainChangeLink: String\n  },\n  components: {\n    Dialog\n  },\n  emits: [\"hide\"],\n  setup(props) {\n    const complainModalVisible = ref(false);\n    watch(\n      () => [props.show],\n      async (newArgs, oldArgs) => {\n        complainModalVisible.value = newArgs[0];\n      }\n    );\n    return {\n      complainModalVisible\n    };\n  }\n});\n","import { render } from \"./ChangeLogComplain.vue?vue&type=template&id=0a57cd10\"\nimport script from \"./ChangeLogComplain.vue?vue&type=script&lang=ts\"\nexport * from \"./ChangeLogComplain.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","\nimport Fieldset from \"primevue/fieldset\";\nimport Card from \"primevue/card\";\nimport { subscribeChangeLogEnriched, GetNodeUrl } from \"@/api/change_log\";\nimport { computed, reactive, ref, watch, defineComponent } from \"vue\";\nimport {\n  ActionType,\n  ChangeLogEnriched,\n  ChangeLogNodePrecondition\n} from \"@/store/change_log\";\nimport { useStore } from \"@/store\";\nimport ChangeLogComplain from \"@/components/node_content/ChangeLogComplain.vue\";\nimport Markdown from \"@/components/node_content/Markdown.vue\";\n\nexport default defineComponent({\n  name: \"ChangeLog\",\n  computed: {\n    ActionType() {\n      return ActionType;\n    }\n  },\n  props: {\n    nodeId: {\n      type: String,\n      required: true\n    }\n  },\n  components: {\n    Markdown,\n    ChangeLogComplain,\n    Fieldset,\n    Card\n  },\n  setup(props) {\n    const store = useStore();\n    const isAuthorized = computed(\n      () => store.state.user.user && !store.state.user.user.isAnonymous\n    );\n    const complainChangeLink = ref(\"\");\n    const complainModalVisible = ref(false);\n    const collapsed = ref(true);\n    const changes = reactive([]) as Array<ChangeLogEnriched>;\n    let unsubscribe = () => {\n      /**/\n    };\n    watch(\n      () => [props.nodeId, collapsed.value],\n      async (newArgs, oldArgs) => {\n        if (newArgs[0] != oldArgs[0]) {\n          collapsed.value = true;\n        }\n        unsubscribe();\n        unsubscribe = () => {\n          /**/\n        };\n        if (collapsed.value == false) {\n          unsubscribe = await subscribeChangeLogEnriched(\n            [ActionType.Name, ActionType.Content, ActionType.Precondition],\n            [props.nodeId],\n            changeLogs => {\n              changes.splice(0, changes.length, ...changeLogs);\n            }\n          );\n        }\n      }\n    );\n    return {\n      changes,\n      collapsed,\n      toggle: (event: boolean) => {\n        collapsed.value = event;\n      },\n      showComplain: (id: string) => {\n        complainModalVisible.value = true;\n        complainChangeLink.value = \"https://scimap.org/change/\" + id;\n      },\n      getContent: (event: ChangeLogEnriched) => {\n        event = event as ChangeLogNodePrecondition;\n        const removed = [];\n        for (const cd of event.removed) {\n          removed.push(GetNodeUrl(cd.idPath, cd.id, cd.name));\n        }\n        const added = [];\n        for (const cd of event.added) {\n          added.push(GetNodeUrl(cd.idPath, cd.id, cd.name));\n        }\n\n        let result = \"\";\n        if (removed.length > 0) {\n          result += `removed: ${removed.join(\", \")}`;\n        }\n        if (added.length > 0) {\n          result += `<br> added: ${added.join(\", \")}`;\n        }\n        return result;\n      },\n      complainModalVisible,\n      complainChangeLink,\n      isAuthorized\n    };\n  }\n});\n","import { render } from \"./ChangeLog.vue?vue&type=template&id=1f629591\"\nimport script from \"./ChangeLog.vue?vue&type=script&lang=ts\"\nexport * from \"./ChangeLog.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<template>\n  <PinIcon @click=\"clickPin\"/>\n  <Dialog\n    v-model:visible=\"addDialogVisible\"\n    :dismissableMask=\"true\"\n    :closable=\"true\"\n    :modal=\"true\"\n    :closeOnEscape=\"true\"\n  >\n    <template #header>\n      <h3>\n        {{ `Choose parent from which pin will be visible` }}\n      </h3>\n    </template>\n\n    <Listbox v-model=\"selectedParent\" :options=\"parents\" optionLabel=\"title\" />\n\n    <template #footer>\n      <Button\n        label=\"No\"\n        icon=\"pi pi-times\"\n        class=\"p-button-text\"\n        @click=\"cancelAdd\"\n      />\n      <Button label=\"Yes\" icon=\"pi pi-check\" @click=\"add\" />\n    </template>\n  </Dialog>\n</template>\n\n<script>\nimport Dialog from \"primevue/dialog\";\nimport Button from \"primevue/button\";\nimport Listbox from \"primevue/listbox\";\nimport {actions, useStore} from \"@/store\";\nimport { computed, ref } from \"vue\";\nimport { actions as pinActions } from \"@/store/pin\";\nimport api from \"@/api/api\";\nimport PinIcon from \"@/components/node_content/PinIcon.vue\";\nimport {useConfirm} from \"primevue/useconfirm\";\n\nexport default {\n  name: \"PinButton\",\n  components: {\n    PinIcon,\n    Dialog,\n    Button,\n    Listbox\n  },\n  setup() {\n    const store = useStore();\n    const confirm = useConfirm();\n    const treeState = store.state.tree;\n    const addDialogVisible = ref(false);\n    const selectedParent = ref(false);\n    const selectedNode = computed(() => store.getters[\"tree/selectedNode\"]);\n    const newNodeTitle = ref(\"\");\n    const parents = computed(() => {\n      const selectedNodeParents = [];\n      let currentParent = treeState.nodeRecord[treeState.selectedNodeId].parent;\n      while (treeState.nodeRecord[currentParent.id].parent) {\n        selectedNodeParents.push({\n          title: currentParent.title,\n          id: currentParent.id\n        });\n        currentParent = treeState.nodeRecord[currentParent.id].parent;\n      }\n      selectedNodeParents.push({ title: \"root\", id: 0 });\n      return selectedNodeParents;\n    });\n\n    return {\n      clickPin: async () => {\n        if (!(store.state.user && store.state.user.user && !store.state.user.user.isAnonymous)) {\n          await store.dispatch(`${actions.confirmSignInPopup}`, {confirm, message:\"Please authorize to pin nodes\"});\n          return\n        }\n        if (\n          store.state.pin.pins[store.state.tree.selectedNodeId] !== undefined\n        ) {\n          store.dispatch(\n            `pin/${pinActions.RemovePin}`,\n            store.state.tree.selectedNodeId\n          );\n          api.savePins(store.state.user.user, store.state.pin.pins);\n        } else {\n          addDialogVisible.value = !addDialogVisible.value;\n        }\n      },\n      selectedParent,\n      parents,\n      add: () => {\n        addDialogVisible.value = false;\n        store.dispatch(`pin/${pinActions.AddPin}`, {\n          parentId: selectedParent.value.id,\n          nodeId: selectedNode.value.id\n        });\n        api.savePins(store.state.user.user, store.state.pin.pins);\n        selectedParent.value = null;\n      },\n      cancelAdd: () => {\n        addDialogVisible.value = false;\n      },\n      addDialogVisible,\n      newNodeTitle\n    };\n  }\n};\n</script>\n","<template>\n  <div\n    style=\"cursor: pointer;\"\n    @mouseenter=\"mouseOver = true\"\n    @mouseleave=\"mouseOver = false\"\n  >\n    <div v-if=\"isPinned || mouseOver\" class=\"pin\">\n      <img\n        style=\"height: 35px\"\n        alt=\"pin-off\"\n        src=\"../../assets/images/pin-on.svg\"\n      />\n    </div>\n    <div v-else class=\"pin\">\n      <img\n        style=\"height: 35px\"\n        alt=\"pin-on\"\n        src=\"../../assets/images/pin-off.svg\"\n      />\n    </div>\n  </div>\n</template>\n\n<script>\nimport { useStore } from \"@/store\";\nimport {computed, ref, watch} from \"vue\";\n\nexport default {\n  name: \"PinIcon\",\n  setup() {\n    const store = useStore();\n    const mouseOver = ref(false);\n    watch(\n        () => store.state.tree.selectedNodeId,\n        async () => {\n          mouseOver.value = false;\n        }\n    )\n    return {\n      isPinned: computed(\n        () =>\n          store.state.pin.pins[store.state.tree.selectedNodeId] !== undefined\n      ),\n      mouseOver\n    };\n  }\n};\n</script>\n\n<style scoped>\n.pin {\n  margin-top: 15px;\n  margin-left: 15px;\n}\n</style>\n","import { render } from \"./PinIcon.vue?vue&type=template&id=4ed46db5&scoped=true\"\nimport script from \"./PinIcon.vue?vue&type=script&lang=js\"\nexport * from \"./PinIcon.vue?vue&type=script&lang=js\"\n\nimport \"./PinIcon.vue?vue&type=style&index=0&id=4ed46db5&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-4ed46db5\"\n\nexport default script","import { render } from \"./PinButton.vue?vue&type=template&id=60471805\"\nimport script from \"./PinButton.vue?vue&type=script&lang=js\"\nexport * from \"./PinButton.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","<template>\n  <SubscribeIcon @click=\"toggleSubscribe\" :is-on=\"isOn\"/>\n</template>\n<script lang=\"ts\">\nimport {computed, defineComponent} from \"vue\";\nimport SubscribeIcon from \"@/components/node_content/SubscribeIcon.vue\";\nimport { actions as subscriptionsActions } from \"@/store/subscriptions\";\nimport {useStore} from \"@/store\";\n\nexport default defineComponent({\n  name: \"SubscribeButton\",\n  components: {\n    SubscribeIcon,\n  },\n  props: {\n    nodeID: {\n      type: String,\n      required: true,\n    },\n  },\n  setup(props) {\n    const store = useStore();\n    return {\n      isOn: computed(\n          () => !!store.state.subscriptions.subscriptions[props.nodeID] && store.state.subscriptions.subscriptions[props.nodeID] == 1\n      ),\n      toggleSubscribe: () => {\n        store.dispatch(`subscriptions/${subscriptionsActions.ToggleSubscription}`, props.nodeID)\n      }\n    }\n  }\n})\n</script>\n","<template>\n  <div\n      style=\"cursor: pointer;\"\n      @mouseenter=\"mouseOver = true\"\n      @mouseleave=\"mouseOver = false\"\n  >\n    <div v-if=\"isOn || mouseOver\" class=\"subscribe\">\n      <img\n          style=\"height: 35px\"\n          alt=\"img\"\n          src=\"../../assets/images/eye-on.svg\"\n      />\n    </div>\n    <div v-else class=\"subscribe\">\n      <img\n          style=\"height: 35px\"\n          alt=\"img\"\n          src=\"../../assets/images/eye-off.svg\"\n      />\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref } from \"vue\";\n\nexport default {\n  name: \"SubscribeIcon\",\n  props: {\n    isOn: Boolean,\n  },\n  setup() {\n    const mouseOver = ref(false);\n    return {\n      mouseOver\n    };\n  }\n};\n</script>\n\n<style scoped>\n.subscribe {\n  margin-top: 15px;\n}\n</style>\n","import { render } from \"./SubscribeIcon.vue?vue&type=template&id=5d02b387&scoped=true\"\nimport script from \"./SubscribeIcon.vue?vue&type=script&lang=js\"\nexport * from \"./SubscribeIcon.vue?vue&type=script&lang=js\"\n\nimport \"./SubscribeIcon.vue?vue&type=style&index=0&id=5d02b387&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-5d02b387\"\n\nexport default script","\nimport {computed, defineComponent} from \"vue\";\nimport SubscribeIcon from \"@/components/node_content/SubscribeIcon.vue\";\nimport { actions as subscriptionsActions } from \"@/store/subscriptions\";\nimport {useStore} from \"@/store\";\n\nexport default defineComponent({\n  name: \"SubscribeButton\",\n  components: {\n    SubscribeIcon,\n  },\n  props: {\n    nodeID: {\n      type: String,\n      required: true,\n    },\n  },\n  setup(props) {\n    const store = useStore();\n    return {\n      isOn: computed(\n          () => !!store.state.subscriptions.subscriptions[props.nodeID] && store.state.subscriptions.subscriptions[props.nodeID] == 1\n      ),\n      toggleSubscribe: () => {\n        store.dispatch(`subscriptions/${subscriptionsActions.ToggleSubscription}`, props.nodeID)\n      }\n    }\n  }\n})\n","import { render } from \"./SubscribeButton.vue?vue&type=template&id=252cc317\"\nimport script from \"./SubscribeButton.vue?vue&type=script&lang=ts\"\nexport * from \"./SubscribeButton.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<template>\n  <p\n    v-show=\"!editOn\"\n    v-html=\"renderedContent\"\n    @click=\"setEditOn(true)\"\n    class=\"title\"\n  />\n  <textarea\n    class=\"title rawTitle p-inputtextarea p-inputtext p-component p-inputtextarea-resizable\"\n    style=\"display: none\"\n    ref=\"txtarea\"\n    rows=\"1\"\n    :value=\"content\"\n    @input=\"changeContent($event.target.value)\"\n    @focusout=\"setEditOn(false)\"\n  />\n</template>\n\n<script lang=\"ts\">\nimport { computed, ref } from \"vue\";\nimport {useStore} from \"@/store\";\n\nexport default {\n  name: \"Title\",\n  emits: [\"content-changed\"],\n  props: {\n    content: {\n      type: String,\n      required: true\n    }\n  },\n  setup(props: any, ctx: any) {\n    const renderedContent = computed(() => {\n      return props.content;\n    });\n    const editOn = ref(false);\n    const store = useStore();\n    const txtarea = ref<HTMLDivElement | null>(null);\n\n    return {\n      editOn,\n      txtarea,\n      setEditOn: (val: boolean) => {\n        if (!store.state.user ||\n            !store.state.user.user ||\n            store.state.user.user.isAnonymous) {\n          return\n        }\n        editOn.value = val;\n        if (val && txtarea.value) {\n          txtarea.value.style.display = \"block\";\n          txtarea.value.focus();\n        }\n        if (!val && txtarea.value) {\n          txtarea.value.style.display = \"none\";\n        }\n      },\n      renderedContent,\n      changeContent: (value: string) => {\n        ctx.emit(\"content-changed\", value);\n      }\n    };\n  }\n};\n</script>\n\n<style scoped>\n.title {\n  font-family: \"Google Sans\", Roboto, Arial, sans-serif;\n  font-size: 1.375rem;\n  font-weight: 400;\n  letter-spacing: 0;\n  line-height: 1.75rem;\n}\n.rawTitle {\n  margin-top: 10px;\n}\n</style>\n","\nimport { computed, ref } from \"vue\";\nimport {useStore} from \"@/store\";\n\nexport default {\n  name: \"Title\",\n  emits: [\"content-changed\"],\n  props: {\n    content: {\n      type: String,\n      required: true\n    }\n  },\n  setup(props: any, ctx: any) {\n    const renderedContent = computed(() => {\n      return props.content;\n    });\n    const editOn = ref(false);\n    const store = useStore();\n    const txtarea = ref<HTMLDivElement | null>(null);\n\n    return {\n      editOn,\n      txtarea,\n      setEditOn: (val: boolean) => {\n        if (!store.state.user ||\n            !store.state.user.user ||\n            store.state.user.user.isAnonymous) {\n          return\n        }\n        editOn.value = val;\n        if (val && txtarea.value) {\n          txtarea.value.style.display = \"block\";\n          txtarea.value.focus();\n        }\n        if (!val && txtarea.value) {\n          txtarea.value.style.display = \"none\";\n        }\n      },\n      renderedContent,\n      changeContent: (value: string) => {\n        ctx.emit(\"content-changed\", value);\n      }\n    };\n  }\n};\n","import { render } from \"./Title.vue?vue&type=template&id=00857be5&scoped=true\"\nimport script from \"./Title.vue?vue&type=script&lang=ts\"\nexport * from \"./Title.vue?vue&type=script&lang=ts\"\n\nimport \"./Title.vue?vue&type=style&index=0&id=00857be5&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-00857be5\"\n\nexport default script","<template>\n  <AddBasedOnIcon @click=\"showAddBanner\" />\n  <Dialog\n    v-model:visible=\"addBannerVisible\"\n    :dismissableMask=\"false\"\n    :closable=\"true\"\n    :modal=\"false\"\n    :closeOnEscape=\"true\"\n    @mousedown.stop\n  >\n    <template #header>\n      <h3>\n        Set \"{{\n          preconditionNode.title\n            ? preconditionNode.title\n            : selectedNode\n            ? selectedNode.title\n            : \"\"\n        }}\" as precondition for \"{{ targetNode ? targetNode.title : \"\" }}\"\n      </h3>\n    </template>\n\n    <template #footer>\n      <Button\n        label=\"Cancel\"\n        icon=\"pi pi-times\"\n        class=\"p-button-text\"\n        @click=\"cancelAdd\"\n      />\n      <Button label=\"Done\" icon=\"pi pi-check\" @click=\"add\" />\n    </template>\n  </Dialog>\n</template>\n\n<script>\nimport Dialog from \"primevue/dialog\";\nimport Button from \"primevue/button\";\nimport {actions, useStore} from \"@/store\";\nimport { computed, ref, watch } from \"vue\";\nimport api from \"@/api/api\";\nimport AddBasedOnIcon from \"@/components/node_content/AddBasedOnIcon.vue\";\nimport {useConfirm} from \"primevue/useconfirm\";\n\nexport default {\n  name: \"AddBasedOnButton\",\n  components: {\n    Dialog,\n    Button,\n    AddBasedOnIcon\n  },\n  emits: [\"select-precondition-is-on\", \"select-precondition-is-off\"],\n  props: {\n    clickedTitleId: {\n      type: String,\n      required: true\n    }\n  },\n  setup(props, ctx) {\n    const store = useStore();\n    const confirm = useConfirm();\n    const addBannerVisible = ref(false);\n    const targetNode = ref({}); // node where precondition must be added\n    const preconditionNode = ref({}); // node where precondition must be added\n    const selectedNode = computed(() => store.getters[\"tree/selectedNode\"]); // current selected node\n\n    watch(\n      () => props.clickedTitleId,\n      () => {\n        if (addBannerVisible.value &&\n          props.clickedTitleId !== \"-1\" &&\n          store.state.tree.nodeRecord[props.clickedTitleId]\n        ) {\n          preconditionNode.value =\n            store.state.tree.nodeRecord[props.clickedTitleId].node;\n        }\n      },\n      { immediate: true }\n    );\n\n    return {\n      showAddBanner: async () => {\n        if (!(store.state.user && store.state.user.user && !store.state.user.user.isAnonymous)) {\n          await store.dispatch(`${actions.confirmSignInPopup}`, {confirm, message:\"Please authorize to added node prerequisites\"});\n          return\n        }\n        ctx.emit(\"select-precondition-is-on\");\n        targetNode.value = store.getters[\"tree/selectedNode\"];\n        addBannerVisible.value = !addBannerVisible.value;\n      },\n      add: () => {\n        let preconditionsIDs = [];\n        if (store.state.precondition.preconditions[targetNode.value.id]) {\n          preconditionsIDs =\n            store.state.precondition.preconditions[targetNode.value.id];\n        }\n        preconditionsIDs.push(preconditionNode.value.id);\n\n        api.savePreconditions(store.state.user.user, {\n          nodeId: targetNode.value.id,\n          preconditionIds: preconditionsIDs\n        });\n        ctx.emit(\"select-precondition-is-off\");\n        addBannerVisible.value = false;\n        preconditionNode.value = {};\n      },\n      cancelAdd: () => {\n        addBannerVisible.value = false;\n        preconditionNode.value = {};\n        ctx.emit(\"select-precondition-is-off\");\n      },\n      addBannerVisible,\n      targetNode,\n      preconditionNode,\n      selectedNode\n    };\n  }\n};\n</script>\n","<template>\n  <div\n    style=\"cursor: pointer;\"\n    @mouseenter=\"mouseOver = true\"\n    @mouseleave=\"mouseOver = false\"\n  >\n    <div v-if=\"mouseOver\" class=\"custom\">\n      <img\n        style=\"height: 35px\"\n        alt=\"pin-off\"\n        src=\"../../assets/images/add-on.svg\"\n      />\n    </div>\n    <div v-else class=\"custom\">\n      <img\n        style=\"height: 35px\"\n        alt=\"pin-on\"\n        src=\"../../assets/images/add-off.svg\"\n      />\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref } from \"vue\";\n\nexport default {\n  name: \"AddBasedOnIcon\",\n  setup() {\n    const mouseOver = ref(false);\n    return {\n      mouseOver\n    };\n  }\n};\n</script>\n\n<style scoped>\n.custom {\n  margin-left: 15px;\n}\n</style>\n","import { render } from \"./AddBasedOnIcon.vue?vue&type=template&id=2494d1ac&scoped=true\"\nimport script from \"./AddBasedOnIcon.vue?vue&type=script&lang=js\"\nexport * from \"./AddBasedOnIcon.vue?vue&type=script&lang=js\"\n\nimport \"./AddBasedOnIcon.vue?vue&type=style&index=0&id=2494d1ac&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-2494d1ac\"\n\nexport default script","import { render } from \"./AddBasedOnButton.vue?vue&type=template&id=a23459a8\"\nimport script from \"./AddBasedOnButton.vue?vue&type=script&lang=js\"\nexport * from \"./AddBasedOnButton.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","<template>\n  <img v-if=\"isAuthorized\"\n    style=\"position: absolute; left:0; top:0; width: 100%; height: 240px; cursor: pointer;\"\n    alt=\"welcome\"\n    :src=\"defaultImageURL\"\n    @click=\"toggleAddDialog\"\n  />\n  <img v-else\n       style=\"position: absolute; left:0; top:0; width: 100%; height: 240px;\"\n       alt=\"welcome\"\n       :src=\"defaultImageURL\"\n  />\n  <input\n    type=\"file\"\n    ref=\"input\"\n    style=\"display: none\"\n    @change=\"onInputChange\"\n    accept=\"image/*\"\n  />\n  <Dialog\n    v-model:visible=\"addDialogVisible\"\n    :dismissableMask=\"true\"\n    :closable=\"true\"\n    :modal=\"true\"\n    :closeOnEscape=\"true\"\n    @mousedown.stop\n  >\n    <template #header>\n      <div style=\"width:431px; padding-right:10px;\">\n        Press \"copy markdown link\" button to add image into this node description\n      </div>\n    </template>\n    <Button rounded @click=\"triggerUpload\">upload</Button>\n    <div style=\"height:10px;\"></div>\n    <ProgressBar v-if=\"showProgressBar\" mode=\"indeterminate\" style=\"height: 6px\"></ProgressBar>\n    <div style=\"height:10px;\"></div>\n    <Card v-for=\"(item, i) of items\" :key=\"i\" class=\"p-mt-1\">\n      <template #content>\n        <img alt=\"image\" :src=\"item.url\" style=\"width:431px;\" />\n      </template>\n      <template #footer>\n        <div style=\"display:flex; flex-direction: row; justify-content: space-between;\">\n          <Button rounded @click=\"setAsDefault(item.url)\">set as default</Button>\n          <Button rounded @click=\"copyMDLink(item.url)\">copy markdown link</Button>\n          <Button v-if=\"showRemoveButton(item.id)\" @click=\"toTrash(item.id)\" severity=\"danger\" text raised rounded aria-label=\"Delete\">\n            <template v-slot:icon>\n              <span class=\"material-symbols-outlined\">delete</span>\n            </template>\n          </Button>\n        </div>\n      </template>\n    </Card>\n  </Dialog>\n</template>\n\n<script lang=\"ts\">\nimport Dialog from \"primevue/dialog\";\nimport Card from \"primevue/card\";\nimport Button from \"primevue/button\";\nimport {computed, defineComponent, ref, watchEffect} from \"vue\";\nimport { useStore } from \"@/store\";\nimport firebase from \"firebase/compat\";\nimport { useToast } from \"primevue/usetoast\";\nimport ProgressBar from 'primevue/progressbar';\nimport { fromBlob } from 'image-resize-compress';\nconst fileFormat = 'webp'\nimport { useConfirm } from \"primevue/useconfirm\";\nimport {DBImage} from \"@/api/types\";\n\nexport default defineComponent({\n  name: \"TitleImage\",\n  components: {\n    Button,\n    Card,\n    Dialog,\n    ProgressBar,\n  },\n  props: {\n    nodeID: {\n      type: String,\n      required: true\n    },\n    nodeContent: {\n      type: String,\n      required: true\n    },\n  },\n  setup(props) {\n    const toast = useToast();\n    const store = useStore();\n    const confirm = useConfirm();\n    const addDialogVisible = ref(false);\n    const input = ref();\n    const defaultURL = \"https://cdn.scimap.org/images/default.jpg\";\n    const items = ref([] as Array<{\n      id: string,\n      timestamp: number, // it is also a unique key of image\n      name: string,\n      url: string,\n      removed: number,\n    }>);\n    const showProgressBar = ref(false);\n    const defaultImageURL = ref(defaultURL);\n    const dbNodeImgPath = computed(() => `/node_image/${props.nodeID}`);\n    const getImageURL = function(image: DBImage) {\n      if (process.env.VUE_APP_PROJECT === \"prod\") {\n        return 'https://cdn.scimap.org'+image.path;\n      }\n      if (process.env.VUE_APP_PROJECT === \"stage\") {\n        return 'https://firebasestorage.googleapis.com/v0/b/sci-map-stg.appspot.com/o/'+encodeURIComponent(image.path.substring(1))+'?alt=media';\n      }\n      if (process.env.VUE_APP_PROJECT === \"emulator\") {\n        return image.url;\n      }\n      return '';\n    }\n    watchEffect(\n        () => {\n          const images = store.state.image.images[props.nodeID]\n          items.value = []\n          items.value.push({\n            id: \"\",\n            timestamp: Infinity,\n            name: \"default\",\n            url: defaultURL,\n            removed: 0,\n          })\n          defaultImageURL.value = defaultURL\n          for (const key in images) {\n            if (key == \"default\") {\n              defaultImageURL.value =  images[key].url;\n              continue;\n            }\n            items.value.push({\n              id: key,\n              timestamp: Number(key),\n              name: images[key].name,\n              url: getImageURL(images[key]),\n              removed: images[key].removed,\n            });\n          }\n          // desc sort by timestamp\n          items.value = items.value.filter((item)=>!item.removed).sort((a,b) => b.timestamp - a.timestamp);\n        }\n    )\n    return {\n      items,\n      isAuthorized: computed(()=>store.state.user && store.state.user.user && !store.state.user.user.isAnonymous),\n      defaultImageURL,\n      setAsDefault: async (url: string) => {\n        await firebase\n          .database()\n          .ref(`${dbNodeImgPath.value}`)\n          .update({\n            default: {\n              url,\n              name: \"\"\n            }\n          });\n      },\n      copyMDLink: async (url: string) => {\n        await navigator.clipboard.writeText(`![](${url} =350x)`);\n        toast.add({\n          severity: \"info\",\n          summary: \"Copied\",\n          detail: \"You can now paste it into node description. Please, do not use this link in other node description as someone can remove it from this node images as not used!\",\n          life: 1000\n        });\n      },\n      showRemoveButton: (id: string) => {\n        if (!id) {\n          // if there is no id it is the default stub image\n          return false\n        }\n        // check that image is not used in node description\n        if (props.nodeContent.length && props.nodeContent.includes(id)) {\n          return false\n        }\n\n        return true\n      },\n      toTrash: async (id: string) => {\n        confirm.require({\n          message: 'Are you sure you want to delete this image?',\n          header: 'Confirmation',\n          icon: 'pi pi-exclamation-triangle',\n          rejectClass: 'p-button-secondary p-button-outlined',\n          rejectLabel: 'Cancel',\n          acceptLabel: 'Delete',\n          accept: async () => {\n            await firebase\n                .database()\n                .ref(`${dbNodeImgPath.value}/${id}`)\n                .update({removed: new Date().getTime()});\n            toast.add({ severity: 'info', summary: 'Image was deleted', detail: '', life: 3000 });\n          },\n          // reject: () => {}\n        });\n\n      },\n      toggleAddDialog: () => {\n        addDialogVisible.value = !addDialogVisible.value\n      },\n      addDialogVisible,\n      input,\n      triggerUpload: () => {\n        input.value.click();\n      },\n      showProgressBar,\n      onInputChange: async (event: {\n        target: {\n          files: Array<File>;\n        };\n      }) => {\n        if (\n          !store.state.user ||\n          !store.state.user.user ||\n          store.state.user.user.isAnonymous ||\n          props.nodeID.length == 0\n        ) {\n          return;\n        }\n        showProgressBar.value = true;\n\n        const imgFile = event.target.files[0] as File;\n        let compressedBlob = await fromBlob(imgFile, 90, 0, 0, fileFormat)\n        if (compressedBlob.size > 500_000) {\n          // try to resize\n          compressedBlob = await fromBlob(imgFile, 90, 1200, 'auto', fileFormat)\n          if (compressedBlob.size > 500_000) {\n            // if still large, then give up\n            toast.add({\n              severity: \"info\",\n              summary: \"Sorry\",\n              detail: \"Cannot compress file, please try to resize/compress it to less than 500Kb\",\n              life: 3000\n            });\n            return;\n          }\n        }\n\n        const name = imgFile.name;\n        const fileName = new Date().getTime();\n        const filePath = `/user/${store.state.user.user.uid}/image/${fileName}.${fileFormat}`\n        const storageRef = firebase\n          .storage()\n          .ref(filePath)\n          .put(compressedBlob);\n        storageRef.on(\n          \"state_changed\",\n          snapshot => {\n            // uploadProgress.value = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\n          },\n          error => {\n            console.log(error.message);\n          },\n          () => {\n            showProgressBar.value = false;\n            storageRef.snapshot.ref.getDownloadURL().then(url => {\n              let parsedURL = {} as URL\n              try {\n                parsedURL = new URL(url);\n              } catch (error) {\n                console.log(error);\n                return\n              }\n              // removed token=... from url\n              const preparedURL = parsedURL.protocol+'//'+parsedURL.hostname+(parsedURL.port == '' ? '' : ':'+parsedURL.port)+parsedURL.pathname+'?alt=media';\n              firebase\n                .database()\n                .ref(`${dbNodeImgPath.value}/${fileName}`)\n                .update({\n                  name,\n                  path: filePath,\n                  url: preparedURL,\n                });\n            });\n          }\n        );\n      }\n    };\n  }\n});\n</script>\n","\nimport Dialog from \"primevue/dialog\";\nimport Card from \"primevue/card\";\nimport Button from \"primevue/button\";\nimport {computed, defineComponent, ref, watchEffect} from \"vue\";\nimport { useStore } from \"@/store\";\nimport firebase from \"firebase/compat\";\nimport { useToast } from \"primevue/usetoast\";\nimport ProgressBar from 'primevue/progressbar';\nimport { fromBlob } from 'image-resize-compress';\nconst fileFormat = 'webp'\nimport { useConfirm } from \"primevue/useconfirm\";\nimport {DBImage} from \"@/api/types\";\n\nexport default defineComponent({\n  name: \"TitleImage\",\n  components: {\n    Button,\n    Card,\n    Dialog,\n    ProgressBar,\n  },\n  props: {\n    nodeID: {\n      type: String,\n      required: true\n    },\n    nodeContent: {\n      type: String,\n      required: true\n    },\n  },\n  setup(props) {\n    const toast = useToast();\n    const store = useStore();\n    const confirm = useConfirm();\n    const addDialogVisible = ref(false);\n    const input = ref();\n    const defaultURL = \"https://cdn.scimap.org/images/default.jpg\";\n    const items = ref([] as Array<{\n      id: string,\n      timestamp: number, // it is also a unique key of image\n      name: string,\n      url: string,\n      removed: number,\n    }>);\n    const showProgressBar = ref(false);\n    const defaultImageURL = ref(defaultURL);\n    const dbNodeImgPath = computed(() => `/node_image/${props.nodeID}`);\n    const getImageURL = function(image: DBImage) {\n      if (process.env.VUE_APP_PROJECT === \"prod\") {\n        return 'https://cdn.scimap.org'+image.path;\n      }\n      if (process.env.VUE_APP_PROJECT === \"stage\") {\n        return 'https://firebasestorage.googleapis.com/v0/b/sci-map-stg.appspot.com/o/'+encodeURIComponent(image.path.substring(1))+'?alt=media';\n      }\n      if (process.env.VUE_APP_PROJECT === \"emulator\") {\n        return image.url;\n      }\n      return '';\n    }\n    watchEffect(\n        () => {\n          const images = store.state.image.images[props.nodeID]\n          items.value = []\n          items.value.push({\n            id: \"\",\n            timestamp: Infinity,\n            name: \"default\",\n            url: defaultURL,\n            removed: 0,\n          })\n          defaultImageURL.value = defaultURL\n          for (const key in images) {\n            if (key == \"default\") {\n              defaultImageURL.value =  images[key].url;\n              continue;\n            }\n            items.value.push({\n              id: key,\n              timestamp: Number(key),\n              name: images[key].name,\n              url: getImageURL(images[key]),\n              removed: images[key].removed,\n            });\n          }\n          // desc sort by timestamp\n          items.value = items.value.filter((item)=>!item.removed).sort((a,b) => b.timestamp - a.timestamp);\n        }\n    )\n    return {\n      items,\n      isAuthorized: computed(()=>store.state.user && store.state.user.user && !store.state.user.user.isAnonymous),\n      defaultImageURL,\n      setAsDefault: async (url: string) => {\n        await firebase\n          .database()\n          .ref(`${dbNodeImgPath.value}`)\n          .update({\n            default: {\n              url,\n              name: \"\"\n            }\n          });\n      },\n      copyMDLink: async (url: string) => {\n        await navigator.clipboard.writeText(`![](${url} =350x)`);\n        toast.add({\n          severity: \"info\",\n          summary: \"Copied\",\n          detail: \"You can now paste it into node description. Please, do not use this link in other node description as someone can remove it from this node images as not used!\",\n          life: 1000\n        });\n      },\n      showRemoveButton: (id: string) => {\n        if (!id) {\n          // if there is no id it is the default stub image\n          return false\n        }\n        // check that image is not used in node description\n        if (props.nodeContent.length && props.nodeContent.includes(id)) {\n          return false\n        }\n\n        return true\n      },\n      toTrash: async (id: string) => {\n        confirm.require({\n          message: 'Are you sure you want to delete this image?',\n          header: 'Confirmation',\n          icon: 'pi pi-exclamation-triangle',\n          rejectClass: 'p-button-secondary p-button-outlined',\n          rejectLabel: 'Cancel',\n          acceptLabel: 'Delete',\n          accept: async () => {\n            await firebase\n                .database()\n                .ref(`${dbNodeImgPath.value}/${id}`)\n                .update({removed: new Date().getTime()});\n            toast.add({ severity: 'info', summary: 'Image was deleted', detail: '', life: 3000 });\n          },\n          // reject: () => {}\n        });\n\n      },\n      toggleAddDialog: () => {\n        addDialogVisible.value = !addDialogVisible.value\n      },\n      addDialogVisible,\n      input,\n      triggerUpload: () => {\n        input.value.click();\n      },\n      showProgressBar,\n      onInputChange: async (event: {\n        target: {\n          files: Array<File>;\n        };\n      }) => {\n        if (\n          !store.state.user ||\n          !store.state.user.user ||\n          store.state.user.user.isAnonymous ||\n          props.nodeID.length == 0\n        ) {\n          return;\n        }\n        showProgressBar.value = true;\n\n        const imgFile = event.target.files[0] as File;\n        let compressedBlob = await fromBlob(imgFile, 90, 0, 0, fileFormat)\n        if (compressedBlob.size > 500_000) {\n          // try to resize\n          compressedBlob = await fromBlob(imgFile, 90, 1200, 'auto', fileFormat)\n          if (compressedBlob.size > 500_000) {\n            // if still large, then give up\n            toast.add({\n              severity: \"info\",\n              summary: \"Sorry\",\n              detail: \"Cannot compress file, please try to resize/compress it to less than 500Kb\",\n              life: 3000\n            });\n            return;\n          }\n        }\n\n        const name = imgFile.name;\n        const fileName = new Date().getTime();\n        const filePath = `/user/${store.state.user.user.uid}/image/${fileName}.${fileFormat}`\n        const storageRef = firebase\n          .storage()\n          .ref(filePath)\n          .put(compressedBlob);\n        storageRef.on(\n          \"state_changed\",\n          snapshot => {\n            // uploadProgress.value = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\n          },\n          error => {\n            console.log(error.message);\n          },\n          () => {\n            showProgressBar.value = false;\n            storageRef.snapshot.ref.getDownloadURL().then(url => {\n              let parsedURL = {} as URL\n              try {\n                parsedURL = new URL(url);\n              } catch (error) {\n                console.log(error);\n                return\n              }\n              // removed token=... from url\n              const preparedURL = parsedURL.protocol+'//'+parsedURL.hostname+(parsedURL.port == '' ? '' : ':'+parsedURL.port)+parsedURL.pathname+'?alt=media';\n              firebase\n                .database()\n                .ref(`${dbNodeImgPath.value}/${fileName}`)\n                .update({\n                  name,\n                  path: filePath,\n                  url: preparedURL,\n                });\n            });\n          }\n        );\n      }\n    };\n  }\n});\n","import { render } from \"./TitleImage.vue?vue&type=template&id=2e6e3325\"\nimport script from \"./TitleImage.vue?vue&type=script&lang=ts\"\nexport * from \"./TitleImage.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","\nimport { actions, useStore } from \"@/store\";\nimport { actions as nodeContentActions } from \"@/store/node_content\";\nimport { computed, defineComponent, useCssModule } from \"vue\";\nimport TextArea from \"primevue/textarea\";\nimport SectionPreconditions from \"./Preconditions.vue\";\nimport SectionUsedBy from \"./UsedBy.vue\";\nimport { Tree } from \"@/types/graphics\";\nimport { EmptyNodeContent, NodeContent } from \"@/store/node_content\";\nimport { clone, printError } from \"@/tools/utils\";\nimport { useConfirm } from \"primevue/useconfirm\";\nimport api from \"@/api/api\";\nimport Markdown from \"./Markdown.vue\";\nimport ChangeLog from \"./ChangeLog.vue\";\nimport PinButton from \"./PinButton.vue\";\nimport SubscribeButton from \"./SubscribeButton.vue\";\nimport Title from \"@/components/node_content/Title.vue\";\nimport AddBasedOnButton from \"@/components/node_content/AddBasedOnButton.vue\";\nimport TitleImage from \"@/components/node_content/TitleImage.vue\";\nimport MarkdownIt from \"markdown-it\";\nimport { isWideScreen } from \"../helpers\";\nimport {add as textSearchAdd, SearchFieldName} from \"@/tools/textsearch\";\nconst mdKatex = require('markdown-it-katex'); // eslint-disable-line\nconst mdImsize = require('markdown-it-imsize'); // eslint-disable-line\nconst mdVideo = require('markdown-it-block-embed'); // eslint-disable-line\nconst md = new MarkdownIt();\nmd\n  .use(mdKatex, { output: \"html\" })\n  .use(mdImsize)\n  .use(mdVideo, {\n    containerClassName: \"video-embed\",\n    youtube: {\n      width: 370,\n      height: 209,\n    }\n  });\n\nexport default defineComponent({\n  name: \"NodeContent\",\n  components: {\n    TitleImage,\n    AddBasedOnButton,\n    Title,\n    SectionUsedBy,\n    Markdown,\n    TextArea,\n    SectionPreconditions,\n    ChangeLog,\n    PinButton,\n    SubscribeButton,\n  },\n  emits: [\"select-precondition-is-on\", \"select-precondition-is-off\"],\n  props: {\n    show: {\n      type: Boolean,\n      required: true\n    },\n    selectedNodeId: {\n      type: String || null,\n      validator: (prop: string | null) =>\n        typeof prop === \"string\" || prop === null,\n      required: true\n    },\n    clickedTitleId: {\n      type: String,\n      required: true\n    },\n    wrapperHeight: {\n      type: Number,\n      required: true\n    }\n  },\n  setup(props) {\n    const $style = useCssModule()\n    const store = useStore();\n    const confirm = useConfirm();\n    const tree = store.state.tree;\n\n    const selectedNode = computed<Tree | null>(() =>\n      props.selectedNodeId && tree.nodeRecord[props.selectedNodeId]\n        ? tree.nodeRecord[props.selectedNodeId].node\n        : null\n    );\n\n    const selectedNodeContent = computed<NodeContent | null>(() => {\n      if (\n        props.selectedNodeId &&\n        store.state.nodeContent.nodeContents[props.selectedNodeId]\n      ) {\n        return store.state.nodeContent.nodeContents[props.selectedNodeId];\n      }\n      const newContent = clone(EmptyNodeContent);\n      newContent.nodeID = props.selectedNodeId;\n      return newContent;\n    });\n\n    const selectedNodeComment = computed<string>(() =>\n      props.selectedNodeId &&\n      store.state.nodeContent.userNodeComments[props.selectedNodeId]\n        ? store.state.nodeContent.userNodeComments[props.selectedNodeId].comment\n        : \"\"\n    );\n\n    return {\n      md,\n      usedBy: computed(() => store.state.precondition.reverseIndex[props.selectedNodeId]),\n      editModeOn: computed(() => store.state.editModeOn),\n      selectedNode,\n      selectedNodeContent,\n      checkAuthorized: async (e: Event) => {\n        if (!store.state.user.user || store.state.user.user.isAnonymous) {\n          await store.dispatch(`${actions.confirmSignInPopup}`, {confirm, message:\"Please authorize to add comments and edit content\"});\n          e.preventDefault();\n        }\n      },\n      selectedNodeComment,\n      changeNodeTitle: async (value: string) => {\n        if (!selectedNode.value || !selectedNode.value.id) {\n          return;\n        }\n        const err = await api.debouncedUpdate({\n          [`map/${selectedNode.value.id}/name`]: value\n        });\n\n        if (err) {\n          printError(err.error.message, err.kv);\n        }\n      },\n      changeContent: async (value: string) => {\n        const err = await store.dispatch(\n          `nodeContent/${nodeContentActions.setNodeContent}`,\n          {\n            nodeID: selectedNode.value!.id,\n            content: value\n          }\n        );\n\n        if (err) {\n          printError(err, {});\n        }\n      },\n      changeComment: async (value: string) => {\n        textSearchAdd(selectedNode.value!.id, SearchFieldName.UserComment, value);\n        const err = await store.dispatch(\n          `nodeContent/${nodeContentActions.setNodeComment}`,\n          {\n            nodeID: selectedNode.value!.id,\n            comment: value\n          }\n        );\n\n        if (err) {\n          printError(err, {});\n        }\n      },\n      isWideScreen,\n      wrapperClass: () => {\n        return isWideScreen() ? $style.wrapperContent : $style.wrapperContentMobile;\n      },\n    };\n  }\n});\n","import { render } from \"./Index.vue?vue&type=template&id=cf7d7f8c\"\nimport script from \"./Index.vue?vue&type=script&lang=ts\"\nexport * from \"./Index.vue?vue&type=script&lang=ts\"\n\nconst cssModules = script.__cssModules = {}\nimport style0 from \"./Index.vue?vue&type=style&index=0&id=cf7d7f8c&module=true&lang=css\"\ncssModules[\"$style\"] = style0\nscript.render = render\n\nexport default script","<template>\n  <div :class=\"$style.wrapper\">\n    <div v-if=\"email\" style=\"width:100%\">\n      <div style=\"position: absolute; right: 1.5rem; top:1.2rem;\">\n        <MenuButton @click=\"toggleUserMenu\">\n          <img\n            alt=\"user\"\n            src=\"../../assets/images/menu.svg\"\n            style=\"width: 1.2rem\"\n          />\n        </MenuButton>\n        <PrimeMenu ref=\"menu\" id=\"overlay_menu\" :model=\"items\" :popup=\"true\" />\n      </div>\n      <div v-if=\"isWideScreen()\" style=\"position: absolute; right: 5.3rem; top:1.2rem;\">\n        <Help />\n      </div>\n      <div v-if=\"isWideScreen()\" style=\"position: absolute; right: 8.8rem; top:1.2rem;\">\n        <Feedback />\n      </div>\n\n      <EditMode v-if=\"isWideScreen()\" :isNodeSelected=\"isNodeSelected\" style=\"position: absolute; right: 15rem; top:1.2rem;\" />\n      <div\n          v-if=\"editModeOn && isWideScreen()\"\n          style=\"position: absolute; right: 23rem; top:1.2rem;\"\n      >\n        <MapChangeLog\n            @restore-select-new-parent-is-on=\"$emit('restore-select-new-parent-is-on')\"\n            @restore-select-new-parent-is-off=\"$emit('restore-select-new-parent-is-off')\"\n            :clickedTitleId=\"clickedTitleId\"\n        />\n      </div>\n      <div v-if=\"editModeOn\" style=\"position: absolute; right: 28.3rem; top:1.2rem;\">\n        <AddNode />\n      </div>\n      <div v-if=\"editModeOn\" style=\"position: absolute; right: 34rem; top:1.2rem;\">\n        <RemoveNode />\n      </div>\n      <div\n        v-if=\"editModeOn\"\n        style=\"position: absolute; right: 40.7rem; top:1.2rem;\"\n      >\n        <CutPaste />\n      </div>\n    </div>\n    <div v-else>\n      <Button\n        @click=\"signIn\"\n        style=\"position: absolute; right: 2rem; top: 1.2rem;\"\n        rounded\n        size=\"small\"\n        icon=\"pi pi-sign-in\"\n        :label=\"isWideScreen() ? 'sign in' : ''\"\n      />\n    </div>\n  </div>\n</template>\n\n<script>\nimport { useStore } from \"@/store\";\nimport {computed, ref, useCssModule} from \"vue\";\nimport { actions as userActions } from \"@/store/user\";\nimport AddNode from \"./AddNode\";\nimport RemoveNode from \"./RemoveNode\";\nimport EditMode from \"./EditMode\";\nimport CutPaste from \"@/components/menu/CutPaste\";\nimport Feedback from \"@/components/menu/Feedback\";\nimport MapChangeLog from \"@/components/menu/MapChangeLog\";\nimport MenuButton from \"@/components/menu/MenuButton\";\nimport Help from \"@/components/menu/Help\";\nimport PrimeMenu from \"primevue/tieredmenu\";\nimport Button from \"primevue/button\";\nimport {isWideScreen} from \"@/components/helpers\";\n\nexport default {\n  name: \"Menu\",\n  components: {\n    Button,\n    PrimeMenu,\n    MenuButton,\n    Feedback,\n    Help,\n    CutPaste,\n    AddNode,\n    RemoveNode,\n    EditMode,\n    MapChangeLog\n  },\n  emits: [\"restore-select-new-parent-is-on\", \"restore-select-new-parent-is-off\"],\n  props: {\n    clickedTitleId: {\n      type: String,\n      required: true\n    }\n  },\n  setup() {\n    const $style = useCssModule()\n    const store = useStore();\n    const user = store.state.user;\n    const menu = ref();\n\n    // user info\n    const userPhotoURL = computed(() =>\n      user.user && user.user.photoURL\n        ? user.user.photoURL\n        : \"../../assets/images/user.svg\"\n    );\n    const email = computed(() => (user.user ? user.user.email : null));\n    const editModeOn = computed(() => store.state.editModeOn);\n    const items = computed(() => {\n      const res = [\n        {\n          label: email.value,\n        },\n        {\n          separator: true\n        }]\n      // if (!isWideScreen()) {\n      //   res.push(...[\n      //     {\n      //       label: editModeOn.value ? \"edit map is ON\" : \"edit map is OFF\",\n      //       icon: editModeOn.value ? \"mdi mdi-power-on\" : \"mdi mdi-power-off\",\n      //       style: editModeOn.value ? \"background-color: lightgrey\" : \"\",\n      //       command: () => {\n      //         if (editModeOn.value) {\n      //           store.dispatch(`${actions.setEditMode}`, false);\n      //         } else {\n      //           store.dispatch(`${actions.setEditMode}`, true);\n      //         }\n      //       }\n      //     }\n      //   ])\n      //\n      //   if (editModeOn.value) {\n      //     res.push(...[\n      //       {\n      //\n      //       }\n      //     ])\n      //   }\n      // }\n      res.push(...[\n        {\n          label: \"email changes - \"+(user.subscribePeriod ? user.subscribePeriod : 'weekly'),\n          icon: \"pi pi-eye\",\n          items: [\n            {\n              label: \"weekly\",\n              icon: \"pi pi-calendar\",\n              command: () => {\n                store.dispatch(`user/${userActions.setSubscribePeriod}`, 'weekly');\n              }\n            },\n            {\n              label: \"daily\",\n              icon: \"pi pi-tablet\",\n              command: () => {\n                store.dispatch(`user/${userActions.setSubscribePeriod}`, 'daily');\n              }\n            },\n            {\n              label: \"on pause\",\n              icon: \"pi pi-pause\",\n              command: () => {\n                store.dispatch(`user/${userActions.setSubscribePeriod}`, 'on pause');\n              }\n            },\n          ]\n        },\n        {\n          label: \"sign out\",\n          icon: \"pi pi-sign-out\",\n          command: () => {\n            store.dispatch(`user/${userActions.signOut}`);\n          }\n        },\n      ]);\n      return res;\n    });\n    return {\n      isWideScreen,\n      email,\n      userPhotoURL,\n      editModeOn,\n      isNodeSelected: computed(() => {\n        return !!store.state.tree.selectedNodeId && store.state.tree.selectedNodeId.length > 0\n      }),\n      isPinned: computed(\n        () =>\n          store.state.pin.pins[store.state.tree.selectedNodeId] !== undefined\n      ),\n      // SignIn\n      signIn: () => store.dispatch(`user/${userActions.signIn}`),\n      // User Menu\n      menu,\n      toggleUserMenu: event => {\n        menu.value.toggle(event);\n      },\n      items\n    };\n  }\n};\n</script>\n\n<style module>\n.wrapper {\n  z-index:20;\n  position: fixed;\n  display: flex;\n  top: 0;\n  right: 0;\n  padding: 8px;\n  background-color: rgba(255, 255, 255, 0.2);\n  width: 70%;\n}\n.customSvgIcon {\n  background: url(\"../../assets/images/user.svg\");\n  fill: red;\n  height: 20px;\n  width: 20px;\n}\n</style>\n","<template>\n  <MenuButton @click=\"toggleAddDialog\" :disabled=\"!selectedNode\">\n    <img alt=\"icon\" src=\"../../assets/images/add-off.svg\" style=\"width: 20px\" />\n    <span class=\"p-ml-2\">add</span>\n  </MenuButton>\n  <Dialog\n    v-model:visible=\"addDialogVisible\"\n    :dismissableMask=\"true\"\n    :closable=\"true\"\n    :modal=\"true\"\n    :closeOnEscape=\"true\"\n    @mousedown.stop\n  >\n    <template #header>\n      <h3>\n        {{\n          selectedNodeTitle\n            ? `Add subsection to ${selectedNodeTitle}`\n            : `Add section`\n        }}\n      </h3>\n    </template>\n\n    <Input type=\"text\" v-model=\"newNodeTitle\" />\n\n    <template #footer>\n      <Button\n        label=\"No\"\n        icon=\"pi pi-times\"\n        class=\"p-button-text\"\n        @click=\"cancelAdd\"\n      />\n      <Button label=\"Yes\" icon=\"pi pi-check\" @click=\"add\" />\n    </template>\n  </Dialog>\n</template>\n\n<script>\nimport Dialog from \"primevue/dialog\";\nimport Button from \"primevue/button\";\nimport Input from \"primevue/inputtext\";\nimport { useStore, actions } from \"@/store\";\nimport { computed, ref } from \"vue\";\nimport { mutations as positionChangePermitMutations } from \"@/store/position_change_permits\";\nimport MenuButton from \"@/components/menu/MenuButton.vue\";\n\nexport default {\n  name: \"AddNode\",\n  components: {\n    MenuButton,\n    Dialog,\n    Button,\n    Input\n  },\n  setup() {\n    const store = useStore();\n    const addDialogVisible = ref(false);\n    const selectedNode = computed(() => store.getters[\"tree/selectedNode\"]);\n    const newNodeTitle = ref(\"\");\n\n    return {\n      selectedNode,\n      selectedNodeTitle: computed(() =>\n        selectedNode.value ? selectedNode.value.title : \"\"\n      ),\n      toggleAddDialog: () => (addDialogVisible.value = !addDialogVisible.value),\n      add: async () => {\n        const newNodeID = await store.dispatch(`${actions.createNode}`, {\n          parentID: selectedNode.value ? selectedNode.value.id : 0,\n          title: newNodeTitle.value\n        });\n        store.commit(\n          `positionChangePermits/${positionChangePermitMutations.ADD_NODES}`,\n          [\n            newNodeID,\n            ...store.state.tree.nodeRecord[\n              selectedNode.value.id\n            ].node.children.map(node => node.id)\n          ]\n        );\n        newNodeTitle.value = \"\";\n        addDialogVisible.value = false;\n      },\n      cancelAdd: () => {\n        newNodeTitle.value = \"\";\n        addDialogVisible.value = false;\n      },\n      addDialogVisible,\n      newNodeTitle\n    };\n  }\n};\n</script>\n","<template>\n  <Button\n    size=\"small\"\n    rounded\n    @mouseenter=\"mouseover = true\"\n    @mouseleave=\"mouseover = false\"\n    :style=\"\n      (mouseover\n        ? `background-color: #03dbfc; `\n        : bgColor\n        ? `background-color: ${bgColor};`\n        : `background-color: white;`) + `color: black; border-color:#3B6BF9;`\n    \"\n  >\n    <slot></slot>\n  </Button>\n</template>\n\n<script>\nimport Button from \"primevue/button\";\nimport { ref, defineComponent } from \"vue\";\n\nexport default defineComponent({\n  name: \"MenuButton\",\n  components: {\n    Button\n  },\n  props: {\n    bgColor: String\n  },\n  setup() {\n    const mouseover = ref(false);\n    return {\n      mouseover\n    };\n  }\n});\n</script>\n","import { render } from \"./MenuButton.vue?vue&type=template&id=4db6f65c\"\nimport script from \"./MenuButton.vue?vue&type=script&lang=js\"\nexport * from \"./MenuButton.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","import { render } from \"./AddNode.vue?vue&type=template&id=5960daf3\"\nimport script from \"./AddNode.vue?vue&type=script&lang=js\"\nexport * from \"./AddNode.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","<template>\n  <MenuButton @click=\"toggleDialog\" :disabled=\"!selectedNodeTitle\">\n    <img alt=\"icon\" src=\"../../assets/images/remove-off.svg\" style=\"width: 20px\" />\n    <span class=\"p-ml-2\">delete</span>\n  </MenuButton>\n  <Dialog\n    v-model:visible=\"addDialogVisible\"\n    :dismissableMask=\"true\"\n    :closable=\"true\"\n    :modal=\"true\"\n    :closeOnEscape=\"true\"\n  >\n    <template #header>\n      <h3>\n        {{ `Remove \"${selectedNodeTitle}\" and all its descendants?` }}\n      </h3>\n    </template>\n\n    <template #footer>\n      <Button\n        label=\"No\"\n        icon=\"pi pi-times\"\n        class=\"p-button-text\"\n        @click=\"cancel\"\n      />\n      <Button label=\"Yes\" icon=\"pi pi-check\" @click=\"remove\" />\n    </template>\n  </Dialog>\n</template>\n\n<script lang=\"ts\">\nimport Dialog from \"primevue/dialog\";\nimport Button from \"primevue/button\";\nimport { useStore, actions } from \"@/store\";\nimport { computed, ref } from \"vue\";\nimport { mutations as positionChangePermitMutations } from \"@/store/position_change_permits\";\nimport MenuButton from \"@/components/menu/MenuButton.vue\";\nimport {mutations as treeMutations} from \"@/store/tree\";\nimport {useToast} from \"primevue/usetoast\";\nimport {getArrayDiff, idToLink} from \"../helpers\";\n\nexport default {\n  name: \"RemoveNode\",\n  components: {\n    MenuButton,\n    Dialog,\n    Button\n  },\n  setup() {\n    const store = useStore();\n    const toast = useToast();\n    const addDialogVisible = ref(false);\n    const selectedNode = computed(() => store.getters[\"tree/selectedNode\"]);\n\n    return {\n      selectedNodeTitle: computed(() =>\n        selectedNode.value ? selectedNode.value.title : \"\"\n      ),\n      toggleDialog: () => {\n        const nodeID = selectedNode.value.id\n\n        // collect all children IDs recursively\n        let stack = [nodeID];\n        const allChildrenIDs = [];\n        while (stack.length>0) {\n          const id = stack.pop()\n          allChildrenIDs.push(id)\n          stack.push(...store.state.tree.nodeRecord[id].node.children.map((node)=>node.id))\n        }\n\n        // collect all nodes where nodeID or its children were set as preconditions for nodes outside allChildrenIDs\n        stack = [nodeID];\n        const usedByNodes = {} as Record<string, Array<string>>;\n        while (stack.length>0) {\n          const id = stack.pop()\n          const [added, removed] = getArrayDiff(allChildrenIDs, store.state.precondition.reverseIndex[id])\n          if (store.state.precondition.reverseIndex[id] && added.length>0\n          ) {\n            usedByNodes[id] = added\n          }\n          stack.push(...store.state.tree.nodeRecord[id].node.children.map((node)=>node.id))\n        }\n\n        // show deny message\n        if (Object.keys(usedByNodes).length > 0) {\n          const nr = store.state.tree.nodeRecord\n          let detailText = ''\n          for (const id in usedByNodes) {\n            detailText += `<div>- remove ${idToLink(id, nr)} from 'based on' of ${usedByNodes[id].map((id)=>idToLink(id, nr)).join(', ')}</div>`\n          }\n          toast.add({\n            severity: \"info\",\n            summary: \"Cannot remove node until some other nodes use it or its children in their 'based on'\",\n            detail: \"If you are sure you want to remove it, please: \"+detailText,\n            life: 30000\n          });\n\n          return\n        }\n        addDialogVisible.value = !addDialogVisible.value\n      },\n      remove: () => {\n        addDialogVisible.value = false;\n        toast.add({\n          severity: \"info\",\n          summary: \"Please, wait\",\n          detail: \"Removal can take up to 15 seconds\",\n          life: 15000\n        });\n        store.dispatch(`${actions.removeNode}`, selectedNode.value.id);\n        store.commit(\n          `positionChangePermits/${positionChangePermitMutations.ADD_NODES}`,\n          store.state.tree.nodeRecord[\n            selectedNode.value.id\n          ].parent!.children.map(node => node.id)\n        );\n        // switch selectedNodeId to parent of removed node\n        store.commit(\n            `tree/${treeMutations.SET_SELECTED_NODE_ID}`,\n            store.state.tree.nodeRecord[\n                selectedNode.value.id\n                ].parent!.id\n        );\n      },\n      cancel: () => {\n        addDialogVisible.value = false;\n      },\n      addDialogVisible\n    };\n  }\n};\n</script>\n","\nimport Dialog from \"primevue/dialog\";\nimport Button from \"primevue/button\";\nimport { useStore, actions } from \"@/store\";\nimport { computed, ref } from \"vue\";\nimport { mutations as positionChangePermitMutations } from \"@/store/position_change_permits\";\nimport MenuButton from \"@/components/menu/MenuButton.vue\";\nimport {mutations as treeMutations} from \"@/store/tree\";\nimport {useToast} from \"primevue/usetoast\";\nimport {getArrayDiff, idToLink} from \"../helpers\";\n\nexport default {\n  name: \"RemoveNode\",\n  components: {\n    MenuButton,\n    Dialog,\n    Button\n  },\n  setup() {\n    const store = useStore();\n    const toast = useToast();\n    const addDialogVisible = ref(false);\n    const selectedNode = computed(() => store.getters[\"tree/selectedNode\"]);\n\n    return {\n      selectedNodeTitle: computed(() =>\n        selectedNode.value ? selectedNode.value.title : \"\"\n      ),\n      toggleDialog: () => {\n        const nodeID = selectedNode.value.id\n\n        // collect all children IDs recursively\n        let stack = [nodeID];\n        const allChildrenIDs = [];\n        while (stack.length>0) {\n          const id = stack.pop()\n          allChildrenIDs.push(id)\n          stack.push(...store.state.tree.nodeRecord[id].node.children.map((node)=>node.id))\n        }\n\n        // collect all nodes where nodeID or its children were set as preconditions for nodes outside allChildrenIDs\n        stack = [nodeID];\n        const usedByNodes = {} as Record<string, Array<string>>;\n        while (stack.length>0) {\n          const id = stack.pop()\n          const [added, removed] = getArrayDiff(allChildrenIDs, store.state.precondition.reverseIndex[id])\n          if (store.state.precondition.reverseIndex[id] && added.length>0\n          ) {\n            usedByNodes[id] = added\n          }\n          stack.push(...store.state.tree.nodeRecord[id].node.children.map((node)=>node.id))\n        }\n\n        // show deny message\n        if (Object.keys(usedByNodes).length > 0) {\n          const nr = store.state.tree.nodeRecord\n          let detailText = ''\n          for (const id in usedByNodes) {\n            detailText += `<div>- remove ${idToLink(id, nr)} from 'based on' of ${usedByNodes[id].map((id)=>idToLink(id, nr)).join(', ')}</div>`\n          }\n          toast.add({\n            severity: \"info\",\n            summary: \"Cannot remove node until some other nodes use it or its children in their 'based on'\",\n            detail: \"If you are sure you want to remove it, please: \"+detailText,\n            life: 30000\n          });\n\n          return\n        }\n        addDialogVisible.value = !addDialogVisible.value\n      },\n      remove: () => {\n        addDialogVisible.value = false;\n        toast.add({\n          severity: \"info\",\n          summary: \"Please, wait\",\n          detail: \"Removal can take up to 15 seconds\",\n          life: 15000\n        });\n        store.dispatch(`${actions.removeNode}`, selectedNode.value.id);\n        store.commit(\n          `positionChangePermits/${positionChangePermitMutations.ADD_NODES}`,\n          store.state.tree.nodeRecord[\n            selectedNode.value.id\n          ].parent!.children.map(node => node.id)\n        );\n        // switch selectedNodeId to parent of removed node\n        store.commit(\n            `tree/${treeMutations.SET_SELECTED_NODE_ID}`,\n            store.state.tree.nodeRecord[\n                selectedNode.value.id\n                ].parent!.id\n        );\n      },\n      cancel: () => {\n        addDialogVisible.value = false;\n      },\n      addDialogVisible\n    };\n  }\n};\n","import { render } from \"./RemoveNode.vue?vue&type=template&id=c6fa37a2\"\nimport script from \"./RemoveNode.vue?vue&type=script&lang=ts\"\nexport * from \"./RemoveNode.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<template>\n  <div>\n    <MenuButton v-if=\"!editModeOn\" @click=\"on\" style=\"height:35px\">\n      <img\n        alt=\"icon\"\n        src=\"../../assets/images/switch-on.svg\"\n        style=\"width: 20px\"\n      />\n      <span class=\"p-ml-2\">edit map</span>\n    </MenuButton>\n    <MenuButton v-if=\"editModeOn\" @click=\"off\" style=\"height:35px;\" bg-color=\"#03dbfc;\">\n      <img\n        alt=\"icon\"\n        src=\"../../assets/images/switch-off.svg\"\n        style=\"width: 20px\"\n      />\n      <span class=\"p-ml-2\">edit map</span>\n    </MenuButton>\n  </div>\n</template>\n\n<script>\nimport { actions, useStore } from \"@/store\";\nimport { computed } from \"vue\";\nimport MenuButton from \"@/components/menu/MenuButton.vue\";\nimport {useToast} from \"primevue/usetoast\";\n\nexport default {\n  name: \"EditMode\",\n  components: {\n    MenuButton\n  },\n  props: {\n    isNodeSelected: {\n      type: Boolean,\n      required: true\n    },\n  },\n  setup(props) {\n    const store = useStore();\n    const toast = useToast();\n\n    return {\n      editModeOn: computed(() => store.state.editModeOn),\n      on: () => {\n        if (props.isNodeSelected) {\n          store.dispatch(`${actions.setEditMode}`, true);\n        } else {\n          toast.add({\n            severity: \"info\",\n            summary: \"Please, select node you want to edit\",\n            life: 2000\n          });\n        }\n      },\n      off: () => {\n        store.dispatch(`${actions.setEditMode}`, false);\n      }\n    };\n  }\n};\n</script>\n","import { render } from \"./EditMode.vue?vue&type=template&id=73de1988\"\nimport script from \"./EditMode.vue?vue&type=script&lang=js\"\nexport * from \"./EditMode.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","<template>\n  <MenuButton v-if=\"cutNodeID == null\" @click=\"cut\" :disabled=\"!selectedNode\">\n    <img alt=\"icon\" src=\"../../assets/images/cut.svg\" style=\"width: 20px\" />\n    <span class=\"p-ml-2\">cut</span>\n  </MenuButton>\n  <MenuButton v-if=\"cutNodeID != null\" @click=\"paste\">\n    <img alt=\"icon\" src=\"../../assets/images/paste.svg\" style=\"width: 20px\" />\n    <span class=\"p-ml-2\">paste</span>\n  </MenuButton>\n</template>\n\n<script>\nimport { useStore, actions } from \"@/store\";\nimport { computed, ref } from \"vue\";\nimport { mutations as positionChangePermitMutations } from \"@/store/position_change_permits\";\nimport MenuButton from \"@/components/menu/MenuButton.vue\";\n\nexport default {\n  name: \"CutPaste\",\n  components: { MenuButton },\n  setup() {\n    const store = useStore();\n    const selectedNode = computed(() => store.getters[\"tree/selectedNode\"]);\n    const cutNodeID = ref(null);\n\n    return {\n      selectedNode,\n      cutNodeID,\n      cut: () => {\n        cutNodeID.value = selectedNode.value.id;\n      },\n      paste: () => {\n        // permit to move children of both new and old parents\n        const oldParentChildrenID = store.state.tree.nodeRecord[\n          cutNodeID.value\n        ].parent.children.map(node => node.id);\n        const newParentChildrenID = store.state.tree.nodeRecord[\n          selectedNode.value.id\n        ].node.children.map(node => node.id);\n        store.commit(\n          `positionChangePermits/${positionChangePermitMutations.ADD_NODES}`,\n          [...oldParentChildrenID, ...newParentChildrenID]\n        );\n\n        // do cut and paste of node\n        store.dispatch(`${actions.cutPasteNode}`, {\n          nodeID: cutNodeID.value,\n          parentID: selectedNode.value.id\n        });\n\n        cutNodeID.value = null;\n      }\n    };\n  }\n};\n</script>\n","import { render } from \"./CutPaste.vue?vue&type=template&id=44f29dda\"\nimport script from \"./CutPaste.vue?vue&type=script&lang=js\"\nexport * from \"./CutPaste.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","<template>\n  <MenuButton @click=\"send\">\n    <img alt=\"icon\" src=\"../../assets/images/chat.svg\" style=\"width: 20px\" />\n    <span class=\"p-ml-2\">chat</span>\n  </MenuButton>\n</template>\n\n<script>\nimport MenuButton from \"@/components/menu/MenuButton.vue\";\n\nexport default {\n  name: \"Feedback\",\n  components: {\n    MenuButton\n  },\n  setup() {\n    return {\n      send: () => {\n        window.open(\n          \"https://discord.com/channels/1171118046543347782/1171118047105396749\",\n          \"_blank\"\n        );\n      }\n    };\n  }\n};\n</script>\n","import { render } from \"./Feedback.vue?vue&type=template&id=60cc13ba\"\nimport script from \"./Feedback.vue?vue&type=script&lang=js\"\nexport * from \"./Feedback.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","<template>\n  <ChangeLogComplain\n    :show=\"complainModalVisible\"\n    :complainChangeLink=\"complainChangeLink\"\n    @hide=\"complainModalVisible = false\"\n  />\n  <MenuButton @click=\"toggleAddDialog\">\n    <img alt=\"icon\" src=\"../../assets/images/log.svg\" style=\"width: 20px\" />\n    <span class=\"p-ml-2\">log</span>\n  </MenuButton>\n  <Dialog\n    v-model:visible=\"addDialogVisible\"\n    :dismissableMask=\"false\"\n    :closable=\"true\"\n    :modal=\"false\"\n    :closeOnEscape=\"true\"\n    @mousedown.stop\n  >\n    <template #header>\n      <h3>\n        Map change log\n      </h3>\n    </template>\n    <Card v-for=\"(event, i) of changes\" :key=\"i\" class=\"p-mt-3\">\n      <template #title>\n        <div class=\"p-grid\">\n          <div class=\"p-col-1\">\n            <img alt=\"add_icon\" v-if=\"event.isAdded\" src=\"../../assets/images/add-off.svg\"  style=\"width: 20px\"/>\n            <img alt=\"add_icon\" v-else-if=\"event.isRemoved\" src=\"../../assets/images/remove-off.svg\"  style=\"width: 20px\"/>\n            <img alt=\"add_icon\" v-else src=\"../../assets/images/move.svg\"  style=\"width: 20px\"/>\n          </div>\n          <div class=\"p-col-6\">\n            {{ new Date(event.timestamp).toLocaleDateString() }}\n            {{ new Date(event.timestamp).toLocaleTimeString() }}\n          </div>\n          <div class=\"p-col-5\">\n            <RestoreNode\n                @restore-select-new-parent-is-on=\"$emit('restore-select-new-parent-is-on')\"\n                @restore-select-new-parent-is-off=\"$emit('restore-select-new-parent-is-off')\"\n                :clickedTitleId=\"clickedTitleId\"\n                :event=\"event\"\n            />\n          </div>\n        </div>\n      </template>\n      <template #subtitle>\n        {{ event.userDisplayName }} /\n        <a href=\"#\" @click=\"showComplain(event.changeLogID)\">Complain</a>\n      </template>\n      <template #content>\n        <div style=\"width:20rem;\" v-html=\"getActionDescription(event)\"></div>\n      </template>\n    </Card>\n  </Dialog>\n</template>\n\n<script lang=\"ts\">\nimport Dialog from \"primevue/dialog\";\nimport Card from \"primevue/card\";\nimport {defineComponent, reactive, ref} from \"vue\";\nimport {ActionType, ChangeLogNodeParent} from \"@/store/change_log\";\nimport {GetNodeUrl, subscribeChangeLogEnriched} from \"@/api/change_log\";\nimport ChangeLogComplain from \"@/components/node_content/ChangeLogComplain.vue\";\nimport MenuButton from \"@/components/menu/MenuButton.vue\";\nimport RestoreNode from \"@/components/menu/RestoreNode.vue\";\n\nexport default defineComponent({\n  name: \"MapChangeLog\",\n  components: {\n    RestoreNode,\n    MenuButton,\n    ChangeLogComplain,\n    Card,\n    Dialog\n  },\n  emits: [\"restore-select-new-parent-is-on\", \"restore-select-new-parent-is-off\"],\n  props: {\n    clickedTitleId: {\n      type: String,\n      required: true\n    }\n  },\n  setup() {\n    const complainChangeLink = ref(\"\");\n    const complainModalVisible = ref(false);\n    const addDialogVisible = ref(false);\n    const changes = reactive([]) as Array<ChangeLogNodeParent>;\n    subscribeChangeLogEnriched([ActionType.ParentID, ActionType.Remove, ActionType.Restore], [], changeLogs => {\n      changes.splice(\n        0,\n        changes.length,\n        ...(changeLogs as Array<ChangeLogNodeParent>)\n      );\n    });\n\n    return {\n      complainChangeLink,\n      complainModalVisible,\n      showComplain: (id: string) => {\n        complainModalVisible.value = true;\n        complainChangeLink.value = \"https://scimap.org/change/\" + id;\n      },\n      toggleAddDialog: () => (addDialogVisible.value = !addDialogVisible.value),\n      addDialogVisible,\n      changes,\n      getActionDescription: (event: ChangeLogNodeParent): string => {\n        if (event.action === ActionType.Restore) {\n          return `node ${GetNodeUrl(\n            event.node.idPath,\n            event.node.id,\n            event.node.name\n          )} was restored to ${GetNodeUrl(\n            event.parentNodeAfter!.idPath,\n            event.parentNodeAfter!.id,\n            event.parentNodeAfter!.name\n          )}`;\n        }\n        if (event.isAdded) {\n          return `node ${GetNodeUrl(\n            event.node.idPath,\n            event.node.id,\n            event.node.name\n          )} was added to ${GetNodeUrl(\n            event.parentNodeAfter!.idPath,\n            event.parentNodeAfter!.id,\n            event.parentNodeAfter!.name\n          )}`;\n        }\n        if (event.isRemoved) {\n          return `node ${GetNodeUrl(\n            event.node.idPath,\n            event.node.id,\n            event.node.name\n          )} was removed from ${GetNodeUrl(\n            event.parentNodeBefore!.idPath,\n            event.parentNodeBefore!.id,\n            event.parentNodeBefore!.name\n          )}`;\n        }\n\n        return `node ${GetNodeUrl(\n          event.node.idPath,\n          event.node.id,\n          event.node.name\n        )} was moved from ${GetNodeUrl(\n          event.parentNodeBefore!.idPath,\n          event.parentNodeBefore!.id,\n          event.parentNodeBefore!.name\n        )} to ${GetNodeUrl(\n          event.parentNodeAfter!.idPath,\n          event.parentNodeAfter!.id,\n          event.parentNodeAfter!.name\n        )}`;\n      }\n    };\n  }\n});\n</script>\n","<template>\n  <img\n      alt=\"add_icon\"\n      v-if=\"event.isRemoved && IsNodeInTrash(event.node.idPath)\"\n      src=\"../../assets/images/revert.svg\"\n      style=\"width: 30px; cursor: pointer;\"\n      @click=\"revertRemove(event)\"\n  />\n<!--  In case parent node was deleted show Dialog to select new parent -->\n  <Dialog\n      v-model:visible=\"newParentDialogVisible\"\n      :dismissableMask=\"false\"\n      :closable=\"true\"\n      :modal=\"false\"\n      :closeOnEscape=\"true\"\n      @mousedown.stop\n  >\n    <template #header>\n      <h3>\n        Parent node of this node was deleted, please select new parent.\n      </h3>\n    </template>\n    Set \"{{\n      newParentNode && newParentNode.title\n          ? newParentNode.title\n          : \"\"\n    }}\" as new parent node.\n    <template #footer>\n      <Button\n          label=\"Cancel\"\n          icon=\"pi pi-times\"\n          class=\"p-button-text\"\n          @click=\"cancelAdd\"\n      />\n      <Button label=\"Done\" icon=\"pi pi-check\" @click=\"add\" />\n    </template>\n  </Dialog>\n</template>\n\n<script lang=\"ts\">\nimport {defineComponent, PropType, ref, watch} from \"vue\";\nimport {ChangeLogNodeParent} from \"@/store/change_log\";\nimport {IsNodeInTrash} from \"@/api/change_log\";\nimport api from \"@/api/api\";\nimport {useStore} from \"@/store\";\nimport {Tree} from \"@/types/graphics\";\nimport Dialog from \"primevue/dialog\";\nimport Button from \"primevue/button\";\nimport {useToast} from \"primevue/usetoast\";\n\nexport default defineComponent({\n  name: \"RestoreNode\",\n  components: {\n    Dialog,\n    Button,\n  },\n  emits: [\"restore-select-new-parent-is-on\", \"restore-select-new-parent-is-off\"],\n  props: {\n    event: {\n      type: Object as PropType<ChangeLogNodeParent>,\n      required: true,\n    },\n    clickedTitleId: {\n      type: String,\n      required: true,\n    },\n  },\n  setup(props, ctx) {\n    // select new parent Dialog stuff\n    const store = useStore();\n    const toast = useToast();\n    const newParentDialogVisible = ref(false);\n    const newParentNode = ref(null as Tree | null);\n    const nodeIdToRestore = ref(\"\");\n    watch(\n        () => props.clickedTitleId,\n        () => {\n          if (\n              newParentDialogVisible.value &&\n              nodeIdToRestore.value &&\n              props.clickedTitleId !== \"-1\" &&\n              store.state.tree.nodeRecord[props.clickedTitleId]\n          ) {\n            newParentNode.value =\n                store.state.tree.nodeRecord[props.clickedTitleId].node;\n          }\n        },\n        { immediate: true }\n    );\n\n    const restoreNodeWithChildren = async (nodeID: string, parentID: string) => {\n      // do main actions on backend (see functions/cmd_restore.js)\n      return await api.update({ [`cmd/restore`]: {\n          nodeID,\n          parentID,\n        }\n      });\n    }\n    return {\n      newParentDialogVisible,\n      newParentNode,\n      cancelAdd: () => {\n        newParentDialogVisible.value = false;\n        nodeIdToRestore.value = \"\";\n        newParentNode.value = null;\n        ctx.emit(\"restore-select-new-parent-is-off\");\n      },\n      add: async () => {\n        toast.add({\n          severity: \"info\",\n          summary: \"Please, wait\",\n          detail: \"Restore can take up to 15 seconds\",\n          life: 15000\n        });\n        await restoreNodeWithChildren(nodeIdToRestore.value, newParentNode.value!.id)\n        ctx.emit(\"restore-select-new-parent-is-off\");\n        newParentDialogVisible.value = false;\n        nodeIdToRestore.value = \"\";\n        newParentNode.value = null;\n      },\n      IsNodeInTrash,\n      revertRemove: async (event: ChangeLogNodeParent) => {\n        if (!event.isRemoved) {\n          return\n        }\n\n        if (event.parentNodeBefore && !IsNodeInTrash(event.parentNodeBefore.idPath)) {\n          if (IsNodeInTrash(event.node.idPath)) {\n            toast.add({\n              severity: \"info\",\n              summary: \"Please, wait\",\n              detail: \"Restore can take up to 15 seconds\",\n              life: 15000\n            });\n            await restoreNodeWithChildren(event.node.id, event.parentNodeBefore.id)\n          }\n        } else {\n          // parent node is in trash - let user choose new parent\n          ctx.emit('restore-select-new-parent-is-on');\n          newParentDialogVisible.value = true;\n          nodeIdToRestore.value = event.node.id;\n        }\n      },\n    }\n  }\n})\n</script>\n","\nimport {defineComponent, PropType, ref, watch} from \"vue\";\nimport {ChangeLogNodeParent} from \"@/store/change_log\";\nimport {IsNodeInTrash} from \"@/api/change_log\";\nimport api from \"@/api/api\";\nimport {useStore} from \"@/store\";\nimport {Tree} from \"@/types/graphics\";\nimport Dialog from \"primevue/dialog\";\nimport Button from \"primevue/button\";\nimport {useToast} from \"primevue/usetoast\";\n\nexport default defineComponent({\n  name: \"RestoreNode\",\n  components: {\n    Dialog,\n    Button,\n  },\n  emits: [\"restore-select-new-parent-is-on\", \"restore-select-new-parent-is-off\"],\n  props: {\n    event: {\n      type: Object as PropType<ChangeLogNodeParent>,\n      required: true,\n    },\n    clickedTitleId: {\n      type: String,\n      required: true,\n    },\n  },\n  setup(props, ctx) {\n    // select new parent Dialog stuff\n    const store = useStore();\n    const toast = useToast();\n    const newParentDialogVisible = ref(false);\n    const newParentNode = ref(null as Tree | null);\n    const nodeIdToRestore = ref(\"\");\n    watch(\n        () => props.clickedTitleId,\n        () => {\n          if (\n              newParentDialogVisible.value &&\n              nodeIdToRestore.value &&\n              props.clickedTitleId !== \"-1\" &&\n              store.state.tree.nodeRecord[props.clickedTitleId]\n          ) {\n            newParentNode.value =\n                store.state.tree.nodeRecord[props.clickedTitleId].node;\n          }\n        },\n        { immediate: true }\n    );\n\n    const restoreNodeWithChildren = async (nodeID: string, parentID: string) => {\n      // do main actions on backend (see functions/cmd_restore.js)\n      return await api.update({ [`cmd/restore`]: {\n          nodeID,\n          parentID,\n        }\n      });\n    }\n    return {\n      newParentDialogVisible,\n      newParentNode,\n      cancelAdd: () => {\n        newParentDialogVisible.value = false;\n        nodeIdToRestore.value = \"\";\n        newParentNode.value = null;\n        ctx.emit(\"restore-select-new-parent-is-off\");\n      },\n      add: async () => {\n        toast.add({\n          severity: \"info\",\n          summary: \"Please, wait\",\n          detail: \"Restore can take up to 15 seconds\",\n          life: 15000\n        });\n        await restoreNodeWithChildren(nodeIdToRestore.value, newParentNode.value!.id)\n        ctx.emit(\"restore-select-new-parent-is-off\");\n        newParentDialogVisible.value = false;\n        nodeIdToRestore.value = \"\";\n        newParentNode.value = null;\n      },\n      IsNodeInTrash,\n      revertRemove: async (event: ChangeLogNodeParent) => {\n        if (!event.isRemoved) {\n          return\n        }\n\n        if (event.parentNodeBefore && !IsNodeInTrash(event.parentNodeBefore.idPath)) {\n          if (IsNodeInTrash(event.node.idPath)) {\n            toast.add({\n              severity: \"info\",\n              summary: \"Please, wait\",\n              detail: \"Restore can take up to 15 seconds\",\n              life: 15000\n            });\n            await restoreNodeWithChildren(event.node.id, event.parentNodeBefore.id)\n          }\n        } else {\n          // parent node is in trash - let user choose new parent\n          ctx.emit('restore-select-new-parent-is-on');\n          newParentDialogVisible.value = true;\n          nodeIdToRestore.value = event.node.id;\n        }\n      },\n    }\n  }\n})\n","import { render } from \"./RestoreNode.vue?vue&type=template&id=58f7a4c8\"\nimport script from \"./RestoreNode.vue?vue&type=script&lang=ts\"\nexport * from \"./RestoreNode.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","\nimport Dialog from \"primevue/dialog\";\nimport Card from \"primevue/card\";\nimport {defineComponent, reactive, ref} from \"vue\";\nimport {ActionType, ChangeLogNodeParent} from \"@/store/change_log\";\nimport {GetNodeUrl, subscribeChangeLogEnriched} from \"@/api/change_log\";\nimport ChangeLogComplain from \"@/components/node_content/ChangeLogComplain.vue\";\nimport MenuButton from \"@/components/menu/MenuButton.vue\";\nimport RestoreNode from \"@/components/menu/RestoreNode.vue\";\n\nexport default defineComponent({\n  name: \"MapChangeLog\",\n  components: {\n    RestoreNode,\n    MenuButton,\n    ChangeLogComplain,\n    Card,\n    Dialog\n  },\n  emits: [\"restore-select-new-parent-is-on\", \"restore-select-new-parent-is-off\"],\n  props: {\n    clickedTitleId: {\n      type: String,\n      required: true\n    }\n  },\n  setup() {\n    const complainChangeLink = ref(\"\");\n    const complainModalVisible = ref(false);\n    const addDialogVisible = ref(false);\n    const changes = reactive([]) as Array<ChangeLogNodeParent>;\n    subscribeChangeLogEnriched([ActionType.ParentID, ActionType.Remove, ActionType.Restore], [], changeLogs => {\n      changes.splice(\n        0,\n        changes.length,\n        ...(changeLogs as Array<ChangeLogNodeParent>)\n      );\n    });\n\n    return {\n      complainChangeLink,\n      complainModalVisible,\n      showComplain: (id: string) => {\n        complainModalVisible.value = true;\n        complainChangeLink.value = \"https://scimap.org/change/\" + id;\n      },\n      toggleAddDialog: () => (addDialogVisible.value = !addDialogVisible.value),\n      addDialogVisible,\n      changes,\n      getActionDescription: (event: ChangeLogNodeParent): string => {\n        if (event.action === ActionType.Restore) {\n          return `node ${GetNodeUrl(\n            event.node.idPath,\n            event.node.id,\n            event.node.name\n          )} was restored to ${GetNodeUrl(\n            event.parentNodeAfter!.idPath,\n            event.parentNodeAfter!.id,\n            event.parentNodeAfter!.name\n          )}`;\n        }\n        if (event.isAdded) {\n          return `node ${GetNodeUrl(\n            event.node.idPath,\n            event.node.id,\n            event.node.name\n          )} was added to ${GetNodeUrl(\n            event.parentNodeAfter!.idPath,\n            event.parentNodeAfter!.id,\n            event.parentNodeAfter!.name\n          )}`;\n        }\n        if (event.isRemoved) {\n          return `node ${GetNodeUrl(\n            event.node.idPath,\n            event.node.id,\n            event.node.name\n          )} was removed from ${GetNodeUrl(\n            event.parentNodeBefore!.idPath,\n            event.parentNodeBefore!.id,\n            event.parentNodeBefore!.name\n          )}`;\n        }\n\n        return `node ${GetNodeUrl(\n          event.node.idPath,\n          event.node.id,\n          event.node.name\n        )} was moved from ${GetNodeUrl(\n          event.parentNodeBefore!.idPath,\n          event.parentNodeBefore!.id,\n          event.parentNodeBefore!.name\n        )} to ${GetNodeUrl(\n          event.parentNodeAfter!.idPath,\n          event.parentNodeAfter!.id,\n          event.parentNodeAfter!.name\n        )}`;\n      }\n    };\n  }\n});\n","import { render } from \"./MapChangeLog.vue?vue&type=template&id=388bfcf8\"\nimport script from \"./MapChangeLog.vue?vue&type=script&lang=ts\"\nexport * from \"./MapChangeLog.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<template>\n  <MenuButton @click=\"toggleHelp\">\n    <img alt=\"icon\" src=\"../../assets/images/help-question.svg\" style=\"width: 15px; padding-top:3px; padding-bottom:2px;\" />\n  </MenuButton>\n  <Dialog\n      v-model:visible=\"isHelpVisible\"\n      :dismissableMask=\"false\"\n      :closable=\"true\"\n      :modal=\"false\"\n      :closeOnEscape=\"true\"\n      @mousedown.stop\n  >\n    <template #header>\n      <h3>Help</h3>\n    </template>\n    <div style=\"width:40em;\">\n      The goal is to:\n      <br><br>1. Collect the <b>best explanations</b> of the most important knowledge. Correctness of these explanations can be tracked down to fundamental theories/experiments using <b>\"based on\"</b> feature of SciMap.\n      <br><br>2. Help to <b>discover and join communities</b> that use this knowledge to solve hard problems of humanity.\n      <br><br>\n      <div style=\"text-align:center\">\n        <iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/DuiTlnrK6G4?si=HuVA4cs5U86H9E3l\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen></iframe>\n      </div>\n\n\n      <br/><br/>Everyone can edit this map (just like Wikipedia). Here is how you can do it.\n      <br/>When \"edit map\" mode is off <img src=\"../../assets/images/edit-map-off.png\" style=\"height: 2em;\"/> you can edit node contents.\n      <br/>Just click on title or content and write your text in <a target='_blank' href='https://markdown-it.github.io/'>markdown</a>.\n      <br/>You can use <a target='_blank' href='https://katex.org/docs/supported.html'>katex</a> notation to write formulas.\n      <br/>- To add \"based on\" links between nodes, press plus button.\n      <br/>- To add video just insert link from youtube in a form\n      <div style=\"background-color: lightgrey; width: 31em;\">\n        @[youtube](https://www.youtube.com/watch?v=MmG2ah5Df4g)\n      </div>\n      - To add add image click on header image, then \"upload\" and copy URL to node's content.\n      <br/>\n      <br/>\n      <div style=\"text-align:center\">\n        <iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/7W9npc90Vp4?si=h4j3CNhG4tqLhz6z\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen></iframe>\n      </div>\n      <br/>When \"edit map\" mode is on <img src=\"../../assets/images/edit-map-on.png\" style=\"height: 2em;\"/> you can add/remove new nodes but cannot edit node content.\n      <br/>In this mode click on node, then click \"add\", \"delete\" or \"cut\" and \"paste\".\n      <br/>To recover removed node use \"log\".\n\n      <br/><br/>Press \"eye\" button to receive node updates on email. You can receive changes daily or weekly.\n\n    </div>\n  </Dialog>\n</template>\n\n<script lang=\"ts\">\nimport Dialog from \"primevue/dialog\";\nimport {defineComponent, ref} from \"vue\";\nimport MenuButton from \"@/components/menu/MenuButton.vue\";\n\nexport default defineComponent({\n  name: \"Help\",\n  components: {\n    MenuButton,\n    Dialog\n  },\n  setup() {\n    const isHelpVisible = ref(false);\n\n    return {\n      toggleHelp: () => (isHelpVisible.value = !isHelpVisible.value),\n      isHelpVisible,\n    };\n  }\n});\n</script>\n","\nimport Dialog from \"primevue/dialog\";\nimport {defineComponent, ref} from \"vue\";\nimport MenuButton from \"@/components/menu/MenuButton.vue\";\n\nexport default defineComponent({\n  name: \"Help\",\n  components: {\n    MenuButton,\n    Dialog\n  },\n  setup() {\n    const isHelpVisible = ref(false);\n\n    return {\n      toggleHelp: () => (isHelpVisible.value = !isHelpVisible.value),\n      isHelpVisible,\n    };\n  }\n});\n","import { render } from \"./Help.vue?vue&type=template&id=8fd36a5c\"\nimport script from \"./Help.vue?vue&type=script&lang=ts\"\nexport * from \"./Help.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","import { render } from \"./Index.vue?vue&type=template&id=b5d62c42\"\nimport script from \"./Index.vue?vue&type=script&lang=js\"\nexport * from \"./Index.vue?vue&type=script&lang=js\"\n\nconst cssModules = script.__cssModules = {}\nimport style0 from \"./Index.vue?vue&type=style&index=0&id=b5d62c42&module=true&lang=css\"\ncssModules[\"$style\"] = style0\nscript.render = render\n\nexport default script","<template>\n  <span class=\"p-input-icon-right\" style=\"width: 100%\">\n    <i class=\"pi pi-times\" style=\"right: 1.2rem; cursor: pointer;\" @click=\"clearBox\" />\n    <InputText\n      :class=\"$style['searchBox']\"\n      placeholder=\"Search SciMap\"\n      v-model=\"value\"\n      @update:modelValue=\"doSearch($event)\"\n    />\n  </span>\n</template>\n\n<script lang=\"ts\">\nimport InputText from \"primevue/inputtext\";\nimport { search } from \"@/tools/textsearch\";\nimport { mutations as searchMutations } from \"@/store/search_result\";\nimport { useStore } from \"@/store\";\nimport { ref } from \"vue\";\nimport api from \"@/api/api\";\nimport { debounce } from \"lodash\";\n\nexport default {\n  name: \"TextSearch\",\n  components: {\n    InputText\n  },\n\n  setup() {\n    const value = ref(\"\");\n    const store = useStore();\n    const debouncedLog = debounce(api.setUserLastSearch, 2000)\n    const doSearch = async(value: string) => {\n      const res = await search(value);\n      store.commit(`searchResult/${searchMutations.SET_NODE_IDS}`, res);\n      if (value.length > 0) {\n        debouncedLog(store.state.user.user!.uid, value);\n      }\n      return res;\n    }\n\n    return {\n      doSearch,\n      value,\n      clearBox: async () => {\n        value.value = \"\";\n        await doSearch('')\n      }\n    };\n  }\n};\n</script>\n\n<style module>\n.searchBox {\n  border-radius: 2rem !important;\n  padding: 0.8rem 2rem !important;\n  width: 100%;\n}\n</style>\n","\nimport InputText from \"primevue/inputtext\";\nimport { search } from \"@/tools/textsearch\";\nimport { mutations as searchMutations } from \"@/store/search_result\";\nimport { useStore } from \"@/store\";\nimport { ref } from \"vue\";\nimport api from \"@/api/api\";\nimport { debounce } from \"lodash\";\n\nexport default {\n  name: \"TextSearch\",\n  components: {\n    InputText\n  },\n\n  setup() {\n    const value = ref(\"\");\n    const store = useStore();\n    const debouncedLog = debounce(api.setUserLastSearch, 2000)\n    const doSearch = async(value: string) => {\n      const res = await search(value);\n      store.commit(`searchResult/${searchMutations.SET_NODE_IDS}`, res);\n      if (value.length > 0) {\n        debouncedLog(store.state.user.user!.uid, value);\n      }\n      return res;\n    }\n\n    return {\n      doSearch,\n      value,\n      clearBox: async () => {\n        value.value = \"\";\n        await doSearch('')\n      }\n    };\n  }\n};\n","import { render } from \"./Textsearch.vue?vue&type=template&id=01a2cb92\"\nimport script from \"./Textsearch.vue?vue&type=script&lang=ts\"\nexport * from \"./Textsearch.vue?vue&type=script&lang=ts\"\n\nconst cssModules = script.__cssModules = {}\nimport style0 from \"./Textsearch.vue?vue&type=style&index=0&id=01a2cb92&module=true&lang=css\"\ncssModules[\"$style\"] = style0\nscript.render = render\n\nexport default script","<template>\n  <div style=\"text-align:center;\">\n    <svg\n        :height=\"isWideScreen() ? 0.8*wrapHeight : ''\"\n        :width=\"isWideScreen() ? '': wrapWidth\"\n        xmlns:dc=\"http://purl.org/dc/elements/1.1/\"\n        xmlns:cc=\"http://creativecommons.org/ns#\"\n        xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"\n        xmlns:svg=\"http://www.w3.org/2000/svg\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        id=\"svg33\"\n        xml:space=\"preserve\"\n        viewBox=\"0 0 1024 768\"\n        y=\"0px\"\n        x=\"0px\"\n        version=\"1.1\"><metadata\n     id=\"metadata39\"><rdf:RDF><cc:Work\n         rdf:about=\"\"><dc:format>image/svg+xml</dc:format><dc:type\n        rdf:resource=\"http://purl.org/dc/dcmitype/StillImage\" /></cc:Work></rdf:RDF></metadata><defs\n        id=\"defs37\" /><rect\n        id=\"rect2\"\n        fill=\"#f4ece4\" /><g\n        transform=\"matrix(1.1095,0,0,1.1095,-56.049,-47.895)\"\n        id=\"logo-group\"><path\n       stroke-miterlimit=\"2\"\n       d=\"m 326.81,529.4 h -6.1402 l 0.22464,-1.1482 h 13.578 l -0.2496,1.1482 h -6.1402 l -3.5443,16.573 h -1.248 z\"\n       style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n       id=\"path60730\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 341.63,527.75 h 1.248 l -1.7722,8.3366 q 1.0733,-1.5226 2.5958,-2.4211 1.5226,-0.89856 3.0701,-0.89856 1.5725,0 2.2714,0.89856 0.69888,0.8736 0.69888,2.471 0,0.52416 -0.0749,1.1232 -0.0499,0.59904 -0.19968,1.248 l -1.5725,7.463 h -1.248 l 1.5226,-7.2384 q 0.2496,-1.1731 0.2496,-2.0717 0,-2.7456 -2.2714,-2.7456 -0.7488,0 -1.5475,0.29952 -0.77376,0.29952 -1.5226,0.84864 -0.72384,0.54912 -1.3478,1.2979 -0.624,0.72384 -1.0234,1.5725 l -1.6973,8.0371 h -1.248 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60732\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 361.53,546.22 q -1.1731,0 -2.0966,-0.42432 -0.89856,-0.44928 -1.5475,-1.1981 -0.624,-0.7488 -0.94848,-1.7472 -0.32448,-0.9984 -0.32448,-2.1216 0,-1.5226 0.57408,-2.9453 0.59904,-1.4477 1.6474,-2.5459 1.0483,-1.1232 2.4461,-1.7971 1.4227,-0.67392 3.0701,-0.67392 0.77376,0 1.4976,0.22464 0.72384,0.22464 1.273,0.67392 0.57408,0.42432 0.89856,1.0733 0.34944,0.64896 0.34944,1.4976 0,3.744 -6.7891,3.744 -0.79872,0 -1.6973,-0.025 -0.8736,-0.025 -1.9469,-0.0998 -0.025,0.19968 -0.0499,0.42432 0,0.22464 0,0.42432 0,0.92352 0.22464,1.7472 0.2496,0.82368 0.72384,1.4477 0.4992,0.59904 1.223,0.97344 0.7488,0.34944 1.7222,0.34944 0.624,0 1.273,-0.17472 0.67392,-0.19968 1.273,-0.52416 0.59904,-0.34944 1.0982,-0.82368 0.52416,-0.4992 0.8736,-1.0982 l 1.0483,0.32448 q -0.44928,0.7488 -1.0982,1.3478 -0.624,0.59904 -1.3978,1.0483 -0.7488,0.42432 -1.5974,0.64896 -0.84864,0.2496 -1.7222,0.2496 z m 2.6707,-12.43 q -1.1731,0 -2.1715,0.44928 -0.97344,0.42432 -1.7472,1.1482 -0.77376,0.69888 -1.3229,1.6224 -0.54912,0.92352 -0.82368,1.897 1.0483,0.0749 1.872,0.0998 0.84864,0.025 1.6474,0.025 1.5475,0 2.5958,-0.19968 1.0733,-0.22464 1.7222,-0.59904 0.64896,-0.3744 0.92352,-0.8736 0.29952,-0.52416 0.29952,-1.1482 0,-0.624 -0.27456,-1.0733 -0.2496,-0.47424 -0.67392,-0.77376 -0.39936,-0.29952 -0.94848,-0.42432 -0.54912,-0.14976 -1.0982,-0.14976 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60734\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 385.71,546.22 q -1.1731,0 -2.0966,-0.42432 -0.89856,-0.44928 -1.5475,-1.1981 -0.624,-0.7488 -0.94848,-1.7472 -0.32448,-0.9984 -0.32448,-2.1216 0,-1.5226 0.57408,-2.9453 0.59904,-1.4477 1.6474,-2.5459 1.0483,-1.1232 2.4461,-1.7971 1.4227,-0.67392 3.0701,-0.67392 0.77376,0 1.4976,0.22464 0.72384,0.22464 1.273,0.67392 0.57408,0.42432 0.89856,1.0733 0.34944,0.64896 0.34944,1.4976 0,3.744 -6.7891,3.744 -0.79872,0 -1.6973,-0.025 -0.8736,-0.025 -1.9469,-0.0998 -0.025,0.19968 -0.0499,0.42432 0,0.22464 0,0.42432 0,0.92352 0.22464,1.7472 0.2496,0.82368 0.72384,1.4477 0.4992,0.59904 1.223,0.97344 0.7488,0.34944 1.7222,0.34944 0.624,0 1.273,-0.17472 0.67392,-0.19968 1.273,-0.52416 0.59904,-0.34944 1.0982,-0.82368 0.52416,-0.4992 0.8736,-1.0982 l 1.0483,0.32448 q -0.44928,0.7488 -1.0982,1.3478 -0.624,0.59904 -1.3978,1.0483 -0.7488,0.42432 -1.5974,0.64896 -0.84864,0.2496 -1.7222,0.2496 z m 2.6707,-12.43 q -1.1731,0 -2.1715,0.44928 -0.97344,0.42432 -1.7472,1.1482 -0.77376,0.69888 -1.3229,1.6224 -0.54912,0.92352 -0.82368,1.897 1.0483,0.0749 1.872,0.0998 0.84864,0.025 1.6474,0.025 1.5475,0 2.5958,-0.19968 1.0733,-0.22464 1.7222,-0.59904 0.64896,-0.3744 0.92352,-0.8736 0.29952,-0.52416 0.29952,-1.1482 0,-0.624 -0.27456,-1.0733 -0.2496,-0.47424 -0.67392,-0.77376 -0.39936,-0.29952 -0.94848,-0.42432 -0.54912,-0.14976 -1.0982,-0.14976 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60736\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 402.18,546.22 q -1.4227,0 -2.6458,-0.4992 -1.1981,-0.4992 -1.9469,-1.4976 l 0.77376,-0.84864 q 0.82368,0.94848 1.7722,1.3978 0.97344,0.44928 2.2464,0.44928 0.89856,0 1.6474,-0.22464 0.77376,-0.22464 1.3229,-0.624 0.57408,-0.39936 0.8736,-0.97344 0.32448,-0.57408 0.32448,-1.2979 0,-0.94848 -0.8736,-1.3978 -0.8736,-0.44928 -2.496,-0.8736 -0.8736,-0.22464 -1.5226,-0.44928 -0.64896,-0.22464 -1.0982,-0.4992 -0.42432,-0.29952 -0.64896,-0.69888 -0.22464,-0.39936 -0.22464,-0.97344 0,-1.0733 0.44928,-1.897 0.44928,-0.84864 1.1981,-1.3978 0.7488,-0.57408 1.7222,-0.84864 0.9984,-0.29952 2.0717,-0.29952 1.4477,0 2.4461,0.52416 1.0234,0.4992 1.4477,1.2979 l -0.82368,0.67392 q -0.42432,-0.7488 -1.3478,-1.1232 -0.89856,-0.3744 -2.0218,-0.3744 -0.77376,0 -1.4726,0.19968 -0.69888,0.17472 -1.248,0.57408 -0.52416,0.3744 -0.84864,0.97344 -0.32448,0.57408 -0.32448,1.3728 0,0.42432 0.17472,0.72384 0.17472,0.27456 0.4992,0.4992 0.34944,0.19968 0.8736,0.3744 0.52416,0.14976 1.223,0.32448 0.97344,0.2496 1.7222,0.4992 0.77376,0.2496 1.2979,0.59904 0.54912,0.32448 0.82368,0.79872 0.27456,0.44928 0.27456,1.0982 0,0.97344 -0.42432,1.7971 -0.42432,0.79872 -1.1731,1.3978 -0.7488,0.57408 -1.7971,0.89856 -1.0234,0.32448 -2.2464,0.32448 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60738\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 418.36,546.22 q -1.4227,0 -2.6458,-0.4992 -1.1981,-0.4992 -1.9469,-1.4976 l 0.77376,-0.84864 q 0.82368,0.94848 1.7722,1.3978 0.97344,0.44928 2.2464,0.44928 0.89856,0 1.6474,-0.22464 0.77376,-0.22464 1.3229,-0.624 0.57408,-0.39936 0.8736,-0.97344 0.32448,-0.57408 0.32448,-1.2979 0,-0.94848 -0.8736,-1.3978 -0.8736,-0.44928 -2.496,-0.8736 -0.8736,-0.22464 -1.5226,-0.44928 -0.64896,-0.22464 -1.0982,-0.4992 -0.42432,-0.29952 -0.64896,-0.69888 -0.22464,-0.39936 -0.22464,-0.97344 0,-1.0733 0.44928,-1.897 0.44928,-0.84864 1.1981,-1.3978 0.7488,-0.57408 1.7222,-0.84864 0.9984,-0.29952 2.0717,-0.29952 1.4477,0 2.4461,0.52416 1.0234,0.4992 1.4477,1.2979 l -0.82368,0.67392 q -0.42432,-0.7488 -1.3478,-1.1232 -0.89856,-0.3744 -2.0218,-0.3744 -0.77376,0 -1.4726,0.19968 -0.69888,0.17472 -1.248,0.57408 -0.52416,0.3744 -0.84864,0.97344 -0.32448,0.57408 -0.32448,1.3728 0,0.42432 0.17472,0.72384 0.17472,0.27456 0.4992,0.4992 0.34944,0.19968 0.8736,0.3744 0.52416,0.14976 1.223,0.32448 0.97344,0.2496 1.7222,0.4992 0.77376,0.2496 1.2979,0.59904 0.54912,0.32448 0.82368,0.79872 0.27456,0.44928 0.27456,1.0982 0,0.97344 -0.42432,1.7971 -0.42432,0.79872 -1.1731,1.3978 -0.7488,0.57408 -1.7971,0.89856 -1.0234,0.32448 -2.2464,0.32448 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60740\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 435.97,546.22 q -1.1731,0 -2.0966,-0.42432 -0.89856,-0.44928 -1.5475,-1.1981 -0.624,-0.7488 -0.94848,-1.7472 -0.32448,-0.9984 -0.32448,-2.1216 0,-1.5226 0.57408,-2.9453 0.59904,-1.4477 1.6474,-2.5459 1.0483,-1.1232 2.4461,-1.7971 1.4227,-0.67392 3.0701,-0.67392 0.77376,0 1.4976,0.22464 0.72384,0.22464 1.273,0.67392 0.57408,0.42432 0.89856,1.0733 0.34944,0.64896 0.34944,1.4976 0,3.744 -6.7891,3.744 -0.79872,0 -1.6973,-0.025 -0.8736,-0.025 -1.9469,-0.0998 -0.025,0.19968 -0.0499,0.42432 0,0.22464 0,0.42432 0,0.92352 0.22464,1.7472 0.2496,0.82368 0.72384,1.4477 0.4992,0.59904 1.223,0.97344 0.7488,0.34944 1.7222,0.34944 0.624,0 1.273,-0.17472 0.67392,-0.19968 1.273,-0.52416 0.59904,-0.34944 1.0982,-0.82368 0.52416,-0.4992 0.8736,-1.0982 l 1.0483,0.32448 q -0.44928,0.7488 -1.0982,1.3478 -0.624,0.59904 -1.3978,1.0483 -0.7488,0.42432 -1.5974,0.64896 -0.84864,0.2496 -1.7222,0.2496 z m 2.6707,-12.43 q -1.1731,0 -2.1715,0.44928 -0.97344,0.42432 -1.7472,1.1482 -0.77376,0.69888 -1.3229,1.6224 -0.54912,0.92352 -0.82368,1.897 1.0483,0.0749 1.872,0.0998 0.84864,0.025 1.6474,0.025 1.5475,0 2.5958,-0.19968 1.0733,-0.22464 1.7222,-0.59904 0.64896,-0.3744 0.92352,-0.8736 0.29952,-0.52416 0.29952,-1.1482 0,-0.624 -0.27456,-1.0733 -0.2496,-0.47424 -0.67392,-0.77376 -0.39936,-0.29952 -0.94848,-0.42432 -0.54912,-0.14976 -1.0982,-0.14976 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60742\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 451.31,533 h 1.1731 l -0.67392,3.095 q 0.52416,-0.7488 1.223,-1.3478 0.69888,-0.624 1.4726,-1.0483 0.79872,-0.44928 1.6224,-0.67392 0.84864,-0.2496 1.6723,-0.2496 1.4976,0 2.1466,0.79872 0.64896,0.79872 0.64896,2.3213 0,0.57408 -0.0998,1.223 -0.0749,0.64896 -0.22464,1.3978 l -1.5725,7.463 h -1.248 l 1.5226,-7.2384 q 0.14976,-0.69888 0.19968,-1.273 0.0749,-0.57408 0.0749,-1.0483 0,-2.496 -2.0717,-2.496 -0.77376,0 -1.5974,0.29952 -0.82368,0.29952 -1.5974,0.84864 -0.7488,0.54912 -1.3978,1.2979 -0.64896,0.72384 -1.0733,1.5725 l -1.6973,8.0371 h -1.248 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60744\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 472.29,546.22 q -1.1232,0 -2.0218,-0.42432 -0.89857,-0.42432 -1.5475,-1.1731 -0.62399,-0.7488 -0.97344,-1.7472 -0.32448,-0.9984 -0.32448,-2.1466 0,-1.5974 0.62401,-3.0202 0.624,-1.4477 1.6723,-2.5459 1.0733,-1.0982 2.4461,-1.7472 1.3978,-0.64896 2.9453,-0.64896 1.6973,0 2.7955,0.79872 1.1232,0.79872 1.4726,2.2214 l -1.3229,0.39936 q -0.29953,-1.0733 -1.1731,-1.6723 -0.8736,-0.624 -2.0717,-0.624 -1.1731,0 -2.2714,0.54912 -1.0982,0.52416 -1.9469,1.4477 -0.84865,0.89856 -1.3728,2.1216 -0.52416,1.1981 -0.52416,2.5459 0,0.94848 0.27455,1.7971 0.27457,0.82368 0.74881,1.4477 0.4992,0.59904 1.1981,0.94848 0.69887,0.34944 1.5226,0.34944 0.64896,0 1.3229,-0.19968 0.67393,-0.19968 1.273,-0.52416 0.59905,-0.32448 1.0483,-0.7488 0.47424,-0.44928 0.72384,-0.92352 l 1.1482,0.34944 q -0.3744,0.67392 -0.99841,1.273 -0.59903,0.57408 -1.3478,0.9984 -0.74879,0.42432 -1.6224,0.64896 -0.84864,0.2496 -1.6973,0.2496 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60746\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 489.89,546.22 q -1.1731,0 -2.0966,-0.42432 -0.89856,-0.44928 -1.5475,-1.1981 -0.624,-0.7488 -0.94848,-1.7472 -0.32448,-0.9984 -0.32448,-2.1216 0,-1.5226 0.57408,-2.9453 0.59903,-1.4477 1.6474,-2.5459 1.0483,-1.1232 2.4461,-1.7971 1.4227,-0.67392 3.0701,-0.67392 0.77377,0 1.4976,0.22464 0.72384,0.22464 1.273,0.67392 0.57408,0.42432 0.89856,1.0733 0.34944,0.64896 0.34944,1.4976 0,3.744 -6.7891,3.744 -0.79872,0 -1.6973,-0.025 -0.8736,-0.025 -1.9469,-0.0998 -0.025,0.19968 -0.0499,0.42432 0,0.22464 0,0.42432 0,0.92352 0.22464,1.7472 0.2496,0.82368 0.72384,1.4477 0.4992,0.59904 1.223,0.97344 0.7488,0.34944 1.7222,0.34944 0.624,0 1.273,-0.17472 0.67392,-0.19968 1.273,-0.52416 0.59904,-0.34944 1.0982,-0.82368 0.52416,-0.4992 0.8736,-1.0982 l 1.0483,0.32448 q -0.44928,0.7488 -1.0982,1.3478 -0.624,0.59904 -1.3978,1.0483 -0.7488,0.42432 -1.5974,0.64896 -0.84864,0.2496 -1.7222,0.2496 z m 2.6707,-12.43 q -1.1731,0 -2.1715,0.44928 -0.97343,0.42432 -1.7472,1.1482 -0.77376,0.69888 -1.3229,1.6224 -0.54912,0.92352 -0.82369,1.897 1.0483,0.0749 1.872,0.0998 0.84863,0.025 1.6474,0.025 1.5475,0 2.5958,-0.19968 1.0733,-0.22464 1.7222,-0.59904 0.64896,-0.3744 0.92353,-0.8736 0.29952,-0.52416 0.29952,-1.1482 0,-0.624 -0.27456,-1.0733 -0.24961,-0.47424 -0.67392,-0.77376 -0.39936,-0.29952 -0.94848,-0.42432 -0.54913,-0.14976 -1.0982,-0.14976 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60748\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 513.92,546.22 q -1.1232,0 -2.0218,-0.42432 -0.8736,-0.42432 -1.4976,-1.1482 -0.59904,-0.7488 -0.94849,-1.7222 -0.32448,-0.9984 -0.32448,-2.1216 0,-1.5725 0.62401,-3.0202 0.64896,-1.4726 1.7222,-2.5709 1.0733,-1.1232 2.4461,-1.7722 1.3978,-0.67392 2.8704,-0.67392 1.0982,0 1.9718,0.44928 0.89855,0.42432 1.4976,1.1731 0.624,0.72384 0.94848,1.7222 0.34944,0.9984 0.34944,2.1216 0,1.5475 -0.64896,2.9952 -0.62399,1.4477 -1.6973,2.5709 -1.0483,1.0982 -2.4211,1.7722 -1.3728,0.64896 -2.8704,0.64896 z m 0.22463,-1.1232 q 1.1232,0 2.2214,-0.54912 1.1232,-0.54912 1.9718,-1.4726 0.8736,-0.92352 1.3978,-2.1216 0.54913,-1.223 0.54913,-2.5459 0,-0.94848 -0.27456,-1.7722 -0.27457,-0.82368 -0.77376,-1.4227 -0.47424,-0.624 -1.1731,-0.97344 -0.69887,-0.34944 -1.5226,-0.34944 -1.1232,0 -2.2214,0.54912 -1.0733,0.54912 -1.9469,1.4976 -0.8736,0.92352 -1.4227,2.1466 -0.52416,1.223 -0.52416,2.5709 0,0.94848 0.27455,1.7722 0.27456,0.79872 0.7488,1.3978 0.4992,0.59904 1.1731,0.94848 0.69889,0.32448 1.5226,0.32448 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60750\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 530.47,534.02 h -1.7222 l 0.22464,-1.0234 h 1.7472 l 0.0749,-0.42432 q 0.47424,-2.3962 1.6973,-3.719 1.248,-1.3478 2.8954,-1.3478 0.69887,0 1.2979,0.22464 0.624,0.22464 0.99839,0.59904 l -0.64896,0.89856 q -0.24959,-0.27456 -0.72383,-0.44928 -0.44928,-0.17472 -0.94849,-0.17472 -1.1981,0 -2.0966,0.9984 -0.89856,0.9984 -1.223,2.9453 l -0.0749,0.44928 h 3.4694 l -0.22463,1.0234 h -3.4944 l -3.6442,17.272 h -1.248 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60752\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 549.65,527.75 h 1.248 l -1.9469,9.2102 q 1.4227,-1.9469 3.0202,-3.095 1.6224,-1.1482 3.3946,-1.1482 1.4227,0 2.1466,0.69888 0.74881,0.69888 0.74881,1.9219 0,1.6474 -1.3229,2.9203 -1.2979,1.273 -3.6941,1.9219 l 2.9453,5.7907 h -1.3728 l -3.095,-6.3648 q 2.6208,-0.54912 3.9686,-1.6474 1.3728,-1.0982 1.3728,-2.4461 0,-0.8736 -0.52416,-1.2979 -0.52416,-0.44928 -1.4726,-0.44928 -1.6474,0 -3.3446,1.3728 -1.6973,1.3478 -3.1949,3.7939 l -1.4976,7.0387 h -1.248 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60754\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 566.41,533 h 1.1731 l -0.67392,3.095 q 0.52416,-0.7488 1.223,-1.3478 0.69888,-0.624 1.4726,-1.0483 0.79873,-0.44928 1.6224,-0.67392 0.84864,-0.2496 1.6723,-0.2496 1.4976,0 2.1466,0.79872 0.64895,0.79872 0.64895,2.3213 0,0.57408 -0.0998,1.223 -0.0749,0.64896 -0.22465,1.3978 l -1.5725,7.463 h -1.248 l 1.5226,-7.2384 q 0.14976,-0.69888 0.19968,-1.273 0.0749,-0.57408 0.0749,-1.0483 0,-2.496 -2.0717,-2.496 -0.77375,0 -1.5974,0.29952 -0.82368,0.29952 -1.5974,0.84864 -0.7488,0.54912 -1.3978,1.2979 -0.64896,0.72384 -1.0733,1.5725 l -1.6973,8.0371 h -1.248 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60756\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 587.29,546.22 q -1.1232,0 -2.0218,-0.42432 -0.87359,-0.42432 -1.4976,-1.1482 -0.59905,-0.7488 -0.94848,-1.7222 -0.32448,-0.9984 -0.32448,-2.1216 0,-1.5725 0.624,-3.0202 0.64896,-1.4726 1.7222,-2.5709 1.0733,-1.1232 2.4461,-1.7722 1.3978,-0.67392 2.8704,-0.67392 1.0982,0 1.9718,0.44928 0.89856,0.42432 1.4976,1.1731 0.624,0.72384 0.94848,1.7222 0.34944,0.9984 0.34944,2.1216 0,1.5475 -0.64896,2.9952 -0.624,1.4477 -1.6973,2.5709 -1.0483,1.0982 -2.4211,1.7722 -1.3728,0.64896 -2.8704,0.64896 z m 0.22463,-1.1232 q 1.1232,0 2.2214,-0.54912 1.1232,-0.54912 1.9718,-1.4726 0.8736,-0.92352 1.3978,-2.1216 0.54912,-1.223 0.54912,-2.5459 0,-0.94848 -0.27455,-1.7722 -0.27457,-0.82368 -0.77376,-1.4227 -0.47424,-0.624 -1.1731,-0.97344 -0.69888,-0.34944 -1.5226,-0.34944 -1.1232,0 -2.2214,0.54912 -1.0733,0.54912 -1.9469,1.4976 -0.8736,0.92352 -1.4227,2.1466 -0.52416,1.223 -0.52416,2.5709 0,0.94848 0.27456,1.7722 0.27456,0.79872 0.7488,1.3978 0.4992,0.59904 1.1731,0.94848 0.69888,0.32448 1.5226,0.32448 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60758\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 601.72,533 h 1.2979 l 2.1216,11.731 q 1.1731,-1.3229 2.1466,-2.7706 0.97345,-1.4477 1.7722,-2.9203 l -1.2979,-6.0403 h 1.2979 l 0.8736,4.393 q 0.57408,-1.1482 0.9984,-2.2464 0.42432,-1.0982 0.74879,-2.1466 h 1.1981 q -0.89857,2.9702 -2.5709,6.0653 l 1.1482,5.6659 q 2.3462,-2.7955 3.9437,-5.8656 1.5974,-3.0701 2.4211,-5.8656 h 1.223 q -0.9984,3.2698 -2.7706,6.5395 -1.7722,3.2698 -4.4928,6.4397 h -1.2979 l -1.0733,-5.4163 q -0.79872,1.3728 -1.7722,2.7456 -0.97344,1.3478 -2.1466,2.6707 h -1.2979 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60760\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 626.1,546.12 q -0.84864,0 -1.3229,-0.44928 -0.47424,-0.47424 -0.47424,-1.273 0,-0.27456 0.0749,-0.624 l 3.3946,-16.024 h 1.248 l -3.3197,15.65 q -0.025,0.1248 -0.0499,0.22464 0,0.0998 0,0.22464 0,0.52416 0.29952,0.82368 0.32448,0.29952 0.92352,0.29952 0.27456,0 0.64896,-0.0499 0.3744,-0.0749 0.69888,-0.19968 v 0.9984 q -0.42432,0.17472 -1.0733,0.27456 -0.624,0.1248 -1.0483,0.1248 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60762\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 639.84,546.22 q -1.1731,0 -2.0966,-0.42432 -0.89856,-0.44928 -1.5475,-1.1981 -0.62401,-0.7488 -0.94849,-1.7472 -0.32448,-0.9984 -0.32448,-2.1216 0,-1.5226 0.57408,-2.9453 0.59904,-1.4477 1.6474,-2.5459 1.0483,-1.1232 2.4461,-1.7971 1.4227,-0.67392 3.0701,-0.67392 0.77376,0 1.4976,0.22464 0.72384,0.22464 1.273,0.67392 0.57408,0.42432 0.89856,1.0733 0.34944,0.64896 0.34944,1.4976 0,3.744 -6.7891,3.744 -0.79872,0 -1.6973,-0.025 -0.8736,-0.025 -1.9469,-0.0998 -0.025,0.19968 -0.0499,0.42432 0,0.22464 0,0.42432 0,0.92352 0.22464,1.7472 0.2496,0.82368 0.72384,1.4477 0.4992,0.59904 1.223,0.97344 0.7488,0.34944 1.7222,0.34944 0.624,0 1.273,-0.17472 0.67392,-0.19968 1.273,-0.52416 0.59904,-0.34944 1.0982,-0.82368 0.52416,-0.4992 0.8736,-1.0982 l 1.0483,0.32448 q -0.44928,0.7488 -1.0982,1.3478 -0.624,0.59904 -1.3978,1.0483 -0.7488,0.42432 -1.5974,0.64896 -0.84864,0.2496 -1.7222,0.2496 z m 2.6707,-12.43 q -1.1731,0 -2.1715,0.44928 -0.97345,0.42432 -1.7472,1.1482 -0.77377,0.69888 -1.3229,1.6224 -0.54911,0.92352 -0.82368,1.897 1.0483,0.0749 1.872,0.0998 0.84864,0.025 1.6474,0.025 1.5475,0 2.5958,-0.19968 1.0733,-0.22464 1.7222,-0.59904 0.64896,-0.3744 0.92352,-0.8736 0.29952,-0.52416 0.29952,-1.1482 0,-0.624 -0.27456,-1.0733 -0.2496,-0.47424 -0.67392,-0.77376 -0.39936,-0.29952 -0.94848,-0.42432 -0.54912,-0.14976 -1.0982,-0.14976 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60764\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 657.48,546.22 q -1.0982,0 -1.9718,-0.44928 -0.8736,-0.44928 -1.4726,-1.1981 -0.59904,-0.7488 -0.92352,-1.7222 -0.29951,-0.9984 -0.29951,-2.0966 0,-1.5226 0.59903,-2.9453 0.59905,-1.4477 1.5974,-2.5709 1.0234,-1.1232 2.3213,-1.7971 1.3229,-0.67392 2.7456,-0.67392 0.79872,0 1.4477,0.2496 0.67392,0.2496 1.1981,0.67392 0.52416,0.39936 0.89856,0.94848 0.3744,0.54912 0.59904,1.1731 l 1.6973,-8.0621 h 1.273 l -3.4944,16.424 q -0.0499,0.2496 -0.0499,0.29952 0,0.3744 0.42432,0.3744 l -0.2496,1.1232 q -0.17472,0.025 -0.29952,0.025 -0.1248,0 -0.2496,0 -0.84864,-0.1248 -0.84864,-0.89856 0,-0.0749 0,-0.14976 0.025,-0.0998 0.0499,-0.27456 0.025,-0.19968 0.0749,-0.4992 0.0749,-0.29952 0.17472,-0.79872 -1.0234,1.2979 -2.4461,2.0717 -1.4227,0.77376 -2.7955,0.77376 z m 0.47424,-1.1232 q 0.624,0 1.3978,-0.27456 0.79872,-0.27456 1.5226,-0.7488 0.72384,-0.4992 1.2979,-1.1232 0.59904,-0.624 0.82368,-1.3478 l 0.89856,-4.2682 q -0.0998,-0.69888 -0.44928,-1.3229 -0.34944,-0.64896 -0.87359,-1.0982 -0.49921,-0.47424 -1.1482,-0.7488 -0.62399,-0.27456 -1.2979,-0.27456 -1.223,0 -2.3213,0.59904 -1.0982,0.59904 -1.9219,1.5725 -0.82368,0.94848 -1.2979,2.1466 -0.47424,1.1731 -0.47424,2.3462 0,0.92352 0.27457,1.7472 0.27455,0.82368 0.77375,1.4477 0.4992,0.624 1.1981,0.9984 0.72384,0.34944 1.5974,0.34944 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60766\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 675.71,551.54 q -2.1466,0 -3.2698,-0.82368 -1.0982,-0.79872 -1.5725,-2.1715 l 0.94849,-0.57408 q 0.44928,1.3229 1.5725,1.9219 1.1232,0.624 2.5459,0.624 0.92353,0 1.8221,-0.27456 0.89857,-0.27456 1.6224,-0.82368 0.7488,-0.52416 1.273,-1.3229 0.54912,-0.79872 0.77377,-1.872 l 0.59903,-2.8454 q -0.4992,0.624 -1.1232,1.1482 -0.62399,0.4992 -1.2979,0.8736 -0.67392,0.3744 -1.3978,0.57408 -0.72384,0.19968 -1.3978,0.19968 -1.0733,0 -1.9219,-0.44928 -0.84864,-0.44928 -1.4477,-1.1981 -0.57408,-0.7488 -0.89856,-1.7222 -0.29952,-0.97344 -0.29952,-2.0467 0,-1.4976 0.59904,-2.9203 0.59904,-1.4477 1.5974,-2.5709 1.0234,-1.1232 2.3462,-1.7971 1.3229,-0.69888 2.7955,-0.69888 1.5974,0 2.5958,0.89856 1.0234,0.8736 1.5974,2.1466 l 0.59904,-2.8205 h 1.1232 l -2.8205,13.229 q -0.27456,1.3229 -0.97344,2.3213 -0.67392,0.9984 -1.6224,1.6474 -0.94848,0.67392 -2.0717,0.9984 -1.1232,0.34944 -2.2963,0.34944 z m 1.6474,-6.4397 q 0.77376,0 1.5725,-0.29952 0.82368,-0.32448 1.5226,-0.82368 0.69888,-0.4992 1.223,-1.1232 0.52416,-0.624 0.7488,-1.248 l 0.89857,-4.2682 q -0.12481,-0.7488 -0.47424,-1.3728 -0.32448,-0.64896 -0.82369,-1.0982 -0.4992,-0.44928 -1.1482,-0.69888 -0.64895,-0.27456 -1.3478,-0.27456 -1.273,0 -2.3712,0.624 -1.0733,0.624 -1.897,1.5974 -0.79872,0.94848 -1.273,2.1466 -0.44928,1.1731 -0.44928,2.2963 0,0.92352 0.27456,1.7472 0.27456,0.82368 0.77376,1.4477 0.4992,0.624 1.1981,0.9984 0.69887,0.34944 1.5725,0.34944 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60768\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 696.49,546.22 q -1.1731,0 -2.0966,-0.42432 -0.89855,-0.44928 -1.5475,-1.1981 -0.62401,-0.7488 -0.94849,-1.7472 -0.32448,-0.9984 -0.32448,-2.1216 0,-1.5226 0.57408,-2.9453 0.59904,-1.4477 1.6474,-2.5459 1.0483,-1.1232 2.4461,-1.7971 1.4227,-0.67392 3.0701,-0.67392 0.77376,0 1.4976,0.22464 0.72384,0.22464 1.273,0.67392 0.57408,0.42432 0.89856,1.0733 0.34944,0.64896 0.34944,1.4976 0,3.744 -6.7891,3.744 -0.79872,0 -1.6973,-0.025 -0.8736,-0.025 -1.9469,-0.0998 -0.025,0.19968 -0.0499,0.42432 0,0.22464 0,0.42432 0,0.92352 0.22464,1.7472 0.2496,0.82368 0.72384,1.4477 0.4992,0.59904 1.223,0.97344 0.7488,0.34944 1.7222,0.34944 0.624,0 1.273,-0.17472 0.67392,-0.19968 1.273,-0.52416 0.59904,-0.34944 1.0982,-0.82368 0.52416,-0.4992 0.8736,-1.0982 l 1.0483,0.32448 q -0.44928,0.7488 -1.0982,1.3478 -0.624,0.59904 -1.3978,1.0483 -0.7488,0.42432 -1.5974,0.64896 -0.84864,0.2496 -1.7222,0.2496 z m 2.6707,-12.43 q -1.1731,0 -2.1715,0.44928 -0.97344,0.42432 -1.7472,1.1482 -0.77376,0.69888 -1.3229,1.6224 -0.54912,0.92352 -0.82368,1.897 1.0483,0.0749 1.872,0.0998 0.84864,0.025 1.6474,0.025 1.5475,0 2.5958,-0.19968 1.0733,-0.22464 1.7222,-0.59904 0.64896,-0.3744 0.92352,-0.8736 0.29952,-0.52416 0.29952,-1.1482 0,-0.624 -0.27456,-1.0733 -0.2496,-0.47424 -0.67392,-0.77376 -0.39936,-0.29952 -0.94848,-0.42432 -0.54912,-0.14976 -1.0982,-0.14976 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60770\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 335.37,388.67 c -4.8096,-2.7655 -10.581,-4.2084 -17.435,-4.2084 -6.3727,0 -12.144,1.0822 -17.194,3.006 -5.0501,1.9238 -9.1382,4.8096 -12.024,8.537 -2.8858,3.7274 -4.3286,8.1763 -4.3286,13.226 0,7.3346 2.7655,13.467 8.537,18.276 5.6513,4.8096 13.467,7.6954 23.447,8.6573 7.2144,0.72144 12.505,2.7655 16.112,6.012 3.487,3.2465 5.2906,7.0942 5.2906,11.663 0,4.8096 -2.1643,8.6573 -6.2525,11.423 -4.2084,2.7655 -9.2585,4.0882 -15.27,4.0882 -5.1703,0 -9.8597,-1.0822 -14.068,-3.2465 -4.3286,-2.1643 -7.0942,-4.8096 -8.537,-7.9358 -0.6012,-1.2024 -1.4429,-2.2846 -2.6453,-3.006 -1.2024,-0.72144 -2.4048,-1.2024 -3.6072,-1.2024 -0.6012,0 -0.96192,0.12024 -1.2024,0.12024 -1.5631,0.36072 -2.7655,0.96192 -3.6072,1.9238 -0.96192,0.96192 -1.3226,1.9238 -1.3226,3.1262 0,0.72144 0.12024,1.4429 0.6012,2.4048 2.4048,5.7715 6.7334,10.341 13.106,13.828 6.3727,3.6072 13.467,5.2906 21.282,5.2906 5.8918,0 11.423,-0.96192 16.593,-3.006 5.1703,-2.0441 9.3787,-5.1703 12.505,-9.2585 3.1262,-4.0882 4.6894,-9.1382 4.6894,-14.91 0,-7.9358 -2.6453,-14.309 -7.9358,-19.118 -5.2906,-4.8096 -12.745,-7.8156 -22.365,-8.7775 -8.6573,-0.84168 -14.669,-2.6453 -18.036,-5.531 -3.3667,-2.7655 -5.0501,-6.2525 -5.0501,-10.461 0,-4.4489 1.8036,-7.8156 5.6513,-10.22 3.7274,-2.4048 8.6573,-3.6072 14.79,-3.6072 4.9298,0 9.018,0.96192 12.264,2.8858 3.2465,1.9238 6.012,4.5691 8.1763,8.1763 0.48096,1.0822 1.3226,1.9238 2.4048,2.525 0.96193,0.6012 2.1643,0.84168 3.3667,0.84168 1.2024,0 2.1643,-0.24048 3.1262,-0.84168 1.5631,-1.0822 2.4048,-2.525 2.4048,-4.3286 0,-1.3226 -0.48096,-2.7655 -1.4429,-4.3286 -3.3667,-5.1703 -7.3346,-9.1382 -12.024,-12.024 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60773\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 420.68,424.02 c -6.2525,-7.2144 -14.188,-10.822 -23.567,-10.822 -6.2525,0 -11.904,1.4429 -16.834,4.3286 -5.0501,2.8858 -8.8978,6.8537 -11.663,11.904 -2.7655,5.0501 -4.0882,10.822 -4.0882,17.194 0,6.2525 1.3226,12.024 4.2084,17.074 2.8858,5.0501 6.8537,9.018 11.904,11.904 5.0501,2.8858 10.701,4.3286 17.074,4.3286 8.6573,0 15.872,-2.6453 21.643,-8.0561 0.96192,-0.96192 1.4429,-2.0441 1.4429,-3.2465 0,-1.5631 -0.84168,-3.006 -2.2846,-4.3286 -0.96192,-0.72144 -2.0441,-1.0822 -3.1262,-1.0822 -1.4429,0 -3.006,0.6012 -4.4489,1.6834 -3.3667,2.8858 -7.8156,4.2084 -13.226,4.2084 -4.2084,0 -7.9358,-0.96192 -11.182,-2.8858 -3.2465,-1.9238 -5.7715,-4.5691 -7.5751,-7.9358 -1.8036,-3.3667 -2.6453,-7.3346 -2.6453,-11.663 0,-6.7334 1.9238,-12.264 5.7715,-16.353 3.8477,-4.0882 8.7775,-6.2525 15.03,-6.2525 3.006,0 5.6513,0.6012 8.0561,1.5631 2.4048,0.96192 4.5691,2.525 6.6132,4.6894 1.2024,1.4429 2.7655,2.1643 4.6894,2.1643 0.96192,0 1.9238,-0.24048 2.7655,-0.84168 1.6834,-1.2024 2.6453,-2.6453 2.6453,-4.4489 0,-1.2024 -0.48096,-2.1643 -1.2024,-3.1262 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60775\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 443.11,415.36 c -1.2024,1.2024 -1.6834,2.6453 -1.6834,4.4489 v 53.507 c 0,1.8036 0.48096,3.2465 1.6834,4.4489 1.20244,1.2024 2.6453,1.6834 4.4489,1.6834 1.8036,0 3.2465,-0.48096 4.4489,-1.6834 1.0822,-1.2024 1.6834,-2.6453 1.6834,-4.4489 v -53.507 c 0,-1.8036 -0.6012,-3.2465 -1.6834,-4.4489 -1.2024,-1.0822 -2.6453,-1.6834 -4.4489,-1.6834 -1.8036,0 -3.2465,0.6012 -4.4489,1.6834 z m 9.9799,-25.852 c -1.5631,-1.5631 -3.3667,-2.4048 -5.531,-2.4048 -2.1643,0 -4.0882,0.84168 -5.6513,2.4048 -1.5631,1.56312 -2.2846,3.3667 -2.2846,5.531 0,2.1643 0.72144,4.0882 2.2846,5.6513 1.5631,1.5631 3.487,2.2846 5.6513,2.2846 2.1643,0 3.9679,-0.72144 5.531,-2.2846 1.5631,-1.5631 2.4048,-3.487 2.4048,-5.6513 0,-2.1643 -0.84168,-3.9679 -2.4048,-5.531 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60777\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 570.05,387.34 c -1.2024,-1.2024 -2.7655,-1.8036 -4.4489,-1.8036 -2.4048,0 -4.3286,1.2024 -5.531,3.3667 l -34.749,71.543 -35.711,-71.543 c -1.3226,-2.1643 -3.1262,-3.3667 -5.531,-3.3667 -1.8036,0 -3.2465,0.6012 -4.4489,1.8036 -1.2024,1.2024 -1.8036,2.7655 -1.8036,4.4489 v 81.402 c 0,1.8036 0.6012,3.2465 1.8036,4.4489 1.2024,1.2024 2.6453,1.8036 4.4489,1.8036 1.6833,0 3.2465,-0.6012 4.4489,-1.8036 1.2024,-1.2024 1.8036,-2.6453 1.8036,-4.4489 v -58.677 l 28.737,57.595 c 1.2024,2.525 3.1263,3.7274 5.7715,3.7274 2.1643,0 3.9679,-0.96192 5.4108,-3.1262 l 29.098,-59.278 v 59.759 c 0,1.8036 0.6012,3.2465 1.8036,4.4489 1.2024,1.2024 2.6453,1.8036 4.4489,1.8036 1.6834,0 3.1262,-0.6012 4.3286,-1.8036 1.2024,-1.2024 1.9239,-2.6453 1.9239,-4.4489 v -81.39 c 0,-1.6834 -0.60122,-3.2465 -1.8036,-4.4489 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60779\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 647.9,423.06 c -6.493,-6.493 -14.309,-9.8597 -23.567,-9.8597 -9.1382,0 -17.074,3.3667 -23.567,9.8597 -6.493,6.493 -9.7394,14.309 -9.7394,23.567 0,9.2585 3.2465,17.074 9.7394,23.567 6.493,6.493 14.429,9.7394 23.567,9.7394 8.2966,0 15.631,-2.6453 21.884,-8.0561 v 2.2846 c 0,1.6834 0.48096,3.006 1.6834,4.0882 1.0822,1.2024 2.4048,1.6834 4.0882,1.6834 1.5631,0 2.8858,-0.48096 4.0882,-1.6834 1.0822,-1.0822 1.6834,-2.4048 1.6834,-4.0882 v -27.535 c 0,-9.2585 -3.2465,-17.074 -9.8597,-23.567 z m -23.567,45.33 c -6.012,0 -11.182,-2.0441 -15.391,-6.3727 -4.3286,-4.2084 -6.3727,-9.3787 -6.3727,-15.391 0,-6.012 2.0441,-11.182 6.3727,-15.391 4.2084,-4.3286 9.3787,-6.493 15.391,-6.493 6.012,0 11.182,2.1643 15.391,6.493 4.3286,4.2084 6.493,9.3787 6.493,15.391 0,6.012 -2.1643,11.182 -6.493,15.391 -4.2084,4.3286 -9.3787,6.3727 -15.391,6.3727 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60781\" /><path\n        stroke-miterlimit=\"2\"\n        d=\"m 732.88,423.06 c -6.493,-6.493 -14.309,-9.7394 -23.567,-9.7394 -9.2585,0 -17.074,3.2465 -23.567,9.7394 -6.493,6.493 -9.7394,14.429 -9.7394,23.567 v 55.31 c 0,1.6834 0.48096,3.006 1.6834,4.0882 1.0822,1.2024 2.4048,1.6834 4.0882,1.6834 1.5631,0 2.8858,-0.48096 3.9679,-1.6834 1.2024,-1.0822 1.8036,-2.4048 1.8036,-4.0882 v -30.06 c 6.1322,5.4108 13.467,8.1763 21.763,8.1763 9.2585,0 17.074,-3.2465 23.567,-9.7394 6.493,-6.6132 9.8597,-14.429 9.8597,-23.687 0,-9.1382 -3.3667,-17.074 -9.8597,-23.567 z m -23.567,45.451 c -6.012,0 -11.182,-2.1643 -15.391,-6.3727 -4.3286,-4.3286 -6.3727,-9.499 -6.3727,-15.511 0,-3.8477 0.96192,-7.5751 2.8858,-10.942 1.9238,-3.3667 4.5691,-6.012 7.9358,-7.9358 3.3667,-1.9238 6.9739,-2.8858 10.942,-2.8858 6.012,0 11.182,2.1643 15.391,6.3727 4.3286,4.3286 6.493,9.3787 6.493,15.391 0,6.012 -2.1643,11.182 -6.493,15.511 -4.2084,4.2084 -9.3787,6.3727 -15.391,6.3727 z\"\n        style=\"font-variant-ligatures:none;fill:#5a4031;stroke-width:0;stroke-miterlimit:2\"\n        id=\"path60783\" /><path\n        style=\"fill:#c3ab9a;stroke-width:0.75\"\n        d=\"m 506.76,227.02 c -0.41909,0.003 -0.8724,0.0213 -1.007,0.0409 -0.13469,0.0196 -0.4391,0.0826 -0.67679,0.13969 -0.23727,0.0575 -0.61507,0.17223 -0.8394,0.25479 -0.22393,0.083 -0.64176,0.26772 -0.92865,0.41075 -0.28648,0.14344 -0.69597,0.36862 -0.90945,0.50082 -0.2135,0.1326 -0.57921,0.38281 -0.81315,0.55627 -0.23352,0.17348 -0.5938,0.45704 -0.80025,0.63009 -0.20641,0.17306 -0.63843,0.57797 -0.95955,0.9003 -0.32151,0.32193 -0.74059,0.7731 -0.93112,1.0024 -0.19099,0.22935 -0.48289,0.59506 -0.64927,0.81315 -0.16638,0.21767 -0.43576,0.59423 -0.59881,0.8361 -0.16305,0.24186 -0.42117,0.64552 -0.57296,0.89655 -0.1522,0.25104 -0.45119,0.80648 -0.66469,1.2339 -0.21351,0.42785 -0.48498,1.0238 -0.6034,1.3244 -0.11843,0.30107 -0.28148,0.74851 -0.36237,0.99495 -0.0809,0.24645 -0.21017,0.70098 -0.28815,1.0108 -0.0776,0.30941 -0.17848,0.7881 -0.22435,1.0634 -0.0463,0.27522 -0.10591,0.74226 -0.13302,1.0383 -0.0296,0.32109 -0.04,0.82485 -0.0254,1.251 0.0133,0.40074 0.0596,0.92325 0.1055,1.1926 0.045,0.26355 0.13178,0.67512 0.19308,0.9141 0.0609,0.23895 0.18681,0.6401 0.27939,0.89153 0.0926,0.25186 0.25186,0.63801 0.35403,0.85815 0.10216,0.22017 0.32817,0.63884 0.50206,0.9303 0.17389,0.29148 0.45495,0.71349 0.62467,0.9387 0.16972,0.22476 0.48747,0.6109 0.70639,0.85777 0.21893,0.24687 0.59465,0.62676 0.83528,0.84398 0.2406,0.21726 0.65677,0.56003 0.9249,0.76185 0.26771,0.20182 0.65594,0.47121 0.86235,0.59881 0.20641,0.12761 0.57254,0.33694 0.81315,0.46496 0.24103,0.12843 0.65552,0.32651 0.92197,0.43993 0.26605,0.11385 0.72225,0.28439 1.0137,0.37905 0.29148,0.0951 0.72099,0.21851 0.95453,0.2748 0.23394,0.0559 0.6501,0.14053 0.92535,0.18723 0.27522,0.0471 0.83355,0.10759 1.2406,0.13427 0.56921,0.0375 0.90158,0.0375 1.4386,-8.2e-4 0.38406,-0.0271 0.93158,-0.088 1.2168,-0.13469 0.28523,-0.0467 0.70557,-0.13219 0.93405,-0.19016 0.22893,-0.0584 0.61425,-0.1718 0.85613,-0.25312 0.24228,-0.0809 0.67596,-0.24894 0.9633,-0.37321 0.28773,-0.12468 0.71057,-0.3311 0.9399,-0.45953 0.22935,-0.12802 0.62341,-0.36821 0.8757,-0.53418 0.25228,-0.16555 0.65594,-0.45745 0.89655,-0.64802 0.24103,-0.19099 0.71181,-0.62091 1.0467,-0.95617 0.33526,-0.33485 0.76522,-0.80603 0.95617,-1.0467 0.19057,-0.24103 0.50124,-0.67263 0.69014,-0.9591 0.18931,-0.2869 0.44744,-0.71849 0.57463,-0.9591 0.12718,-0.24103 0.3165,-0.63134 0.42158,-0.86738 0.10467,-0.23644 0.26271,-0.64009 0.35111,-0.89655 0.0884,-0.25687 0.20934,-0.64551 0.26813,-0.86317 0.0588,-0.21809 0.14554,-0.59048 0.19266,-0.82815 0.0476,-0.23811 0.11426,-0.66012 0.14887,-0.93825 0.0342,-0.27856 0.0743,-0.82523 0.088,-1.2152 0.0146,-0.39657 0.005,-1.0179 -0.0217,-1.4107 -0.0259,-0.38572 -0.0759,-0.9195 -0.11093,-1.1864 -0.035,-0.26646 -0.11092,-0.72849 -0.16929,-1.0267 -0.058,-0.29816 -0.18933,-0.834 -0.29149,-1.1906 -0.10217,-0.35654 -0.29065,-0.91118 -0.41825,-1.2322 -0.1276,-0.32109 -0.36446,-0.84315 -0.52626,-1.1601 -0.16179,-0.3165 -0.43826,-0.79523 -0.61382,-1.0634 -0.17555,-0.26771 -0.47621,-0.6843 -0.66761,-0.9249 -0.19141,-0.24103 -0.56546,-0.65511 -0.83108,-0.92033 -0.26562,-0.26563 -0.66094,-0.62341 -0.879,-0.7956 -0.21767,-0.1718 -0.56503,-0.42534 -0.77145,-0.56253 -0.20641,-0.13761 -0.54418,-0.34569 -0.7506,-0.46287 -0.20641,-0.11718 -0.52542,-0.28147 -0.7089,-0.3657 -0.18348,-0.0838 -0.4662,-0.20559 -0.62842,-0.27064 -0.16221,-0.065 -0.49998,-0.18473 -0.7506,-0.26562 -0.25062,-0.0809 -0.6059,-0.18431 -0.78938,-0.23019 -0.18348,-0.0454 -0.53334,-0.12092 -0.7773,-0.16721 -0.24394,-0.0467 -0.71724,-0.11385 -1.0516,-0.14887 -0.34402,-0.0363 -0.93907,-0.0617 -1.3702,-0.0588 z m 27.992,9.4822 c -0.24061,-0.01 -0.53627,4.2e-4 -0.65677,0.0221 -0.12051,0.0217 -0.32943,0.0842 -0.46413,0.13886 -0.13469,0.055 -0.35611,0.17514 -0.49122,0.26688 -0.13553,0.0917 -0.36529,0.29482 -0.51124,0.45078 -0.14595,0.15596 -0.37739,0.4537 -0.51417,0.66137 -0.13677,0.20767 -0.36612,0.61216 -0.50957,0.89903 -0.14345,0.28647 -0.34861,0.72349 -0.45578,0.9708 -0.10717,0.24728 -0.30524,0.71932 -0.43993,1.0496 -0.13428,0.32985 -0.28399,0.75518 -0.33194,0.94493 -0.0492,0.19557 -0.0863,0.47246 -0.0855,0.63926 10e-4,0.16888 0.0321,0.3778 0.073,0.49039 0.0392,0.108 0.13178,0.28106 0.20517,0.38489 0.0738,0.10384 0.26146,0.28231 0.417,0.39658 0.15596,0.11467 0.46162,0.30107 0.67929,0.41449 0.21809,0.11384 0.6526,0.31984 0.96615,0.45828 0.31358,0.13844 0.76395,0.34862 1.0008,0.46746 0.23686,0.11842 0.77768,0.40741 1.2022,0.64176 0.42451,0.23435 1.128,0.61424 1.5638,0.84398 0.43577,0.23018 1.4399,0.75187 2.231,1.1596 0.79148,0.40782 1.8294,0.95535 2.3073,1.2164 0.47747,0.26146 1.1718,0.65594 1.5429,0.87698 0.37071,0.22101 0.93075,0.56628 1.2443,0.76725 0.31317,0.20099 0.80107,0.53 1.0842,0.731 0.28272,0.20058 0.7114,0.51874 0.95205,0.70598 0.24102,0.18765 0.60673,0.48581 0.81315,0.66261 0.20641,0.17681 0.76935,0.68137 1.251,1.1205 0.48163,0.43952 1.3836,1.3056 2.0041,1.9249 0.62049,0.61924 1.4274,1.4541 1.7936,1.8556 0.36613,0.40116 0.79815,0.87991 0.95992,1.0634 0.1618,0.18347 0.52835,0.61507 0.8148,0.95909 0.28606,0.34403 0.74685,0.91613 1.0241,1.2719 0.27731,0.35528 0.69515,0.90907 0.9291,1.2301 0.23394,0.3211 0.64594,0.91201 0.91613,1.3136 0.2698,0.40115 0.63717,0.96412 0.81645,1.251 0.17931,0.28648 0.52792,0.87323 0.77437,1.304 0.24645,0.43035 0.64469,1.1714 0.88485,1.6472 0.24019,0.47539 0.58213,1.1927 0.75938,1.5942 0.17764,0.40116 0.44035,1.03 0.58422,1.397 0.14386,0.36695 0.36737,0.97702 0.49706,1.3552 0.12969,0.37821 0.32818,1.007 0.44077,1.397 0.113,0.38989 0.2798,1.0196 0.37155,1.3994 0.0913,0.37989 0.23226,1.0392 0.31275,1.4654 0.0809,0.42617 0.19348,1.1192 0.25061,1.5404 0.0567,0.42118 0.13594,1.1126 0.17598,1.5371 0.0546,0.58338 0.073,1.1984 0.0746,2.5228 0.001,1.1034 -0.0179,1.9907 -0.0526,2.3978 -0.0296,0.35528 -0.0909,0.96367 -0.13594,1.3515 -0.0446,0.38823 -0.12718,0.9987 -0.18307,1.3569 -0.0563,0.3582 -0.16054,0.95077 -0.23227,1.3168 -0.0717,0.36654 -0.2039,0.98497 -0.29439,1.3748 -0.0901,0.3899 -0.27981,1.1217 -0.42117,1.6263 -0.14178,0.50457 -0.42993,1.424 -0.64052,2.0433 -0.21016,0.61925 -0.44368,1.2948 -0.51874,1.5012 l -0.13637,0.3753 -0.0392,1.2927 c -0.0213,0.71099 -0.0288,1.4524 -0.0166,1.6476 0.0125,0.19515 0.0688,0.53709 0.12552,0.7602 0.0563,0.22268 0.18264,0.56003 0.28022,0.74977 0.12968,0.25187 0.26312,0.43034 0.49289,0.65886 0.17306,0.17264 0.412,0.36529 0.53085,0.42826 0.11842,0.0634 0.3607,0.15179 0.53834,0.19724 0.22143,0.0567 0.46037,0.0826 0.76395,0.0826 0.24269,0 0.59172,-0.0267 0.7752,-0.0588 0.18348,-0.0325 0.48706,-0.0984 0.67471,-0.14637 0.18765,-0.0479 0.50665,-0.14511 0.7089,-0.216 0.20224,-0.0709 0.59756,-0.23811 0.87817,-0.37197 0.28064,-0.13386 0.66512,-0.33735 0.85485,-0.45244 0.18932,-0.11551 0.49082,-0.32651 0.66971,-0.46913 0.17889,-0.14303 0.41825,-0.38322 0.53167,-0.53376 0.1839,-0.24477 0.23769,-0.37155 0.49748,-1.1709 0.16055,-0.49331 0.37739,-1.1968 0.48247,-1.5638 0.10508,-0.36696 0.30275,-1.1084 0.4391,-1.6472 0.13636,-0.53918 0.36863,-1.5338 0.51666,-2.2101 0.14763,-0.67679 0.4095,-1.962 0.58172,-2.8564 0.1718,-0.89445 0.42159,-2.1801 0.5542,-2.8564 l 0.24144,-1.2302 -0.008,-0.72975 c -0.005,-0.40157 -0.0284,-1.0396 -0.053,-1.4178 -0.025,-0.37863 -0.0738,-1.0354 -0.10843,-1.4595 -0.035,-0.4245 -0.10091,-1.1092 -0.14636,-1.522 -0.0451,-0.41283 -0.12969,-1.0976 -0.18765,-1.522 -0.058,-0.4245 -0.17097,-1.1655 -0.25145,-1.6472 -0.0801,-0.48163 -0.21184,-1.2043 -0.29273,-1.6054 -0.0805,-0.40157 -0.23728,-1.1238 -0.34778,-1.6054 -0.11092,-0.48163 -0.29774,-1.2322 -0.41575,-1.668 -0.11801,-0.43576 -0.33818,-1.196 -0.48914,-1.6888 -0.15054,-0.49289 -0.42367,-1.319 -0.60674,-1.8348 -0.18264,-0.51624 -0.47413,-1.2948 -0.64718,-1.7306 -0.17306,-0.43576 -0.44619,-1.0925 -0.60632,-1.4595 -0.16013,-0.36696 -0.46287,-1.0238 -0.67262,-1.4595 -0.20975,-0.43576 -0.56128,-1.1392 -0.7806,-1.5638 -0.21976,-0.4245 -0.61883,-1.1542 -0.8874,-1.6217 -0.26813,-0.46787 -0.65886,-1.1246 -0.8682,-1.4595 -0.20933,-0.33527 -0.60465,-0.94703 -0.87862,-1.3598 -0.27398,-0.41283 -0.74143,-1.0909 -1.0383,-1.5066 -0.29733,-0.41616 -0.82815,-1.1264 -1.1793,-1.5784 -0.35154,-0.45245 -0.93953,-1.1818 -1.306,-1.6209 -0.36655,-0.4391 -0.85905,-1.0145 -1.0934,-1.2781 -0.23477,-0.26396 -0.73225,-0.80812 -1.1055,-1.2093 -0.37322,-0.40157 -1.2485,-1.2932 -1.9444,-1.982 -0.69597,-0.68847 -1.6501,-1.5992 -2.1205,-2.0237 -0.46996,-0.4245 -1.1267,-1.007 -1.4595,-1.2952 -0.33235,-0.28773 -0.97995,-0.83153 -1.4386,-1.2088 -0.4587,-0.37697 -1.1434,-0.93075 -1.522,-1.2306 -0.37822,-0.29941 -1.1101,-0.86235 -1.6263,-1.251 -0.51583,-0.38864 -1.1634,-0.84863 -1.4386,-1.0229 -0.27522,-0.17388 -0.76312,-0.45912 -1.0842,-0.63342 -0.32109,-0.1743 -0.89362,-0.46078 -1.2718,-0.63634 -0.37822,-0.17556 -1.065,-0.47413 -1.5262,-0.66386 -0.46078,-0.18974 -1.4082,-0.56462 -2.1058,-0.83318 -0.69722,-0.26854 -1.6976,-0.65719 -2.2234,-0.86317 -0.52542,-0.20642 -1.1355,-0.42117 -1.3552,-0.47664 -0.24937,-0.0634 -0.5642,-0.10842 -0.8373,-0.11926 z m -51.482,8.5725 c -0.20641,0.001 -0.5521,0.0392 -0.76815,0.0847 -0.21642,0.0454 -0.57296,0.1497 -0.7923,0.23186 -0.21976,0.0817 -0.58714,0.24311 -0.81645,0.35778 -0.22935,0.11468 -0.60465,0.32193 -0.834,0.45996 -0.22935,0.13803 -0.83482,0.53084 -1.3453,0.8724 -0.51083,0.34194 -1.2051,0.82027 -1.5429,1.0629 -0.33819,0.24269 -0.87734,0.63926 -1.1984,0.88155 -0.32109,0.24186 -0.76185,0.58088 -0.97995,0.75307 -0.21767,0.17264 -0.65844,0.53001 -0.97912,0.79478 -0.32067,0.26479 -0.82733,0.69472 -1.1259,0.95535 -0.29858,0.26104 -0.86198,0.77017 -1.2518,1.1318 -0.3899,0.36196 -1.1222,1.0771 -1.6276,1.59 -0.50498,0.51291 -1.1713,1.2139 -1.4804,1.5584 -0.30899,0.34402 -0.76934,0.86947 -1.0233,1.1676 -0.25394,0.29773 -0.66511,0.79477 -0.91365,1.1046 -0.24811,0.30983 -0.71723,0.9195 -1.0417,1.3552 -0.32484,0.43576 -0.74101,1.0083 -0.9249,1.2718 -0.1839,0.26354 -0.46829,0.67971 -0.63176,0.92407 -0.16346,0.24437 -0.50457,0.7752 -0.7581,1.1801 -0.25395,0.40491 -0.67428,1.1055 -0.9345,1.5571 -0.2602,0.45203 -0.62591,1.1072 -0.81314,1.4558 -0.18682,0.34903 -0.53251,1.0246 -0.76816,1.5012 -0.2356,0.47705 -0.58088,1.2047 -0.76725,1.6175 -0.18639,0.41283 -0.47954,1.0884 -0.65135,1.5012 -0.1718,0.41283 -0.43868,1.0788 -0.59297,1.4804 -0.15429,0.40115 -0.40198,1.0767 -0.55044,1.5012 -0.14846,0.4245 -0.39115,1.1468 -0.53876,1.6054 -0.14804,0.4587 -0.39741,1.2844 -0.55419,1.8348 -0.15721,0.55044 -0.39907,1.4512 -0.53751,2.0016 -0.13845,0.55044 -0.33611,1.3852 -0.43911,1.8556 -0.10341,0.46996 -0.26313,1.2393 -0.35528,1.7097 -0.0922,0.46996 -0.24269,1.3052 -0.33485,1.8556 -0.0917,0.55044 -0.21434,1.329 -0.27188,1.7306 -0.058,0.40115 -0.16097,1.1893 -0.22935,1.7514 -0.068,0.5617 -0.1618,1.4061 -0.20808,1.8765 -0.0463,0.46995 -0.12219,1.3427 -0.16806,1.939 -0.0463,0.59631 -0.10299,1.5437 -0.12635,2.1058 -0.0229,0.56169 -0.0725,1.5471 -0.10925,2.1892 -0.0404,0.6993 -0.0571,1.3894 -0.0421,1.7206 0.0138,0.30441 0.0459,0.68888 0.0705,0.85485 0.025,0.16596 0.0926,0.48914 0.1497,0.71808 0.0571,0.22893 0.2231,0.80107 0.36862,1.2718 0.14553,0.47079 0.39699,1.2176 0.55837,1.6605 0.16137,0.44243 0.39906,1.0617 0.52833,1.3761 0.12927,0.314 0.4758,1.0591 0.77063,1.6555 0.2944,0.59631 0.66345,1.2998 0.81937,1.5638 0.22518,0.3803 0.31484,0.49456 0.43285,0.55253 0.093,0.0454 0.32818,0.0871 0.62925,0.11175 0.30024,0.0246 0.68888,0.0246 1.0346,0 0.30441,-0.0217 0.74017,-0.0771 0.96788,-0.12385 0.22768,-0.0463 0.48329,-0.11217 0.56837,-0.14595 0.0992,-0.0396 0.19348,-0.12426 0.26521,-0.23852 0.0613,-0.0972 0.15263,-0.28023 0.20267,-0.40616 0.05,-0.12635 0.13552,-0.37739 0.19015,-0.55795 0.0546,-0.18097 0.12802,-0.46745 0.16305,-0.63676 0.035,-0.16971 0.083,-0.49539 0.10634,-0.72391 0.0296,-0.28856 0.0288,-0.5496 -0.002,-0.85485 -0.0246,-0.24186 -0.1005,-0.71557 -0.16931,-1.0533 -0.0684,-0.33777 -0.16054,-0.8298 -0.20558,-1.0938 -0.0446,-0.26354 -0.11885,-0.8832 -0.16514,-1.3761 -0.0459,-0.49331 -0.11175,-1.2627 -0.14595,-1.7097 -0.0346,-0.44744 -0.0821,-1.1321 -0.10591,-1.522 -0.0238,-0.3899 -0.0613,-1.1593 -0.0842,-1.7097 -0.0225,-0.55044 -0.0409,-1.5262 -0.0409,-2.1684 0,-0.64218 0.0192,-1.5804 0.0425,-2.085 0.0234,-0.50457 0.0705,-1.2647 0.10508,-1.6888 0.0346,-0.42451 0.10008,-1.0904 0.14553,-1.4804 0.0459,-0.38989 0.13094,-1.0187 0.18974,-1.397 0.0588,-0.37864 0.17305,-1.0162 0.25354,-1.417 0.0805,-0.40115 0.23727,-1.0954 0.34819,-1.5429 0.11134,-0.44785 0.29524,-1.1238 0.4095,-1.502 0.11425,-0.37864 0.31191,-0.98078 0.4391,-1.3386 0.1276,-0.35779 0.41991,-1.1217 0.65052,-1.698 0.23018,-0.57588 0.59422,-1.4562 0.80895,-1.9557 0.21475,-0.49957 0.54669,-1.2552 0.73809,-1.6797 0.19099,-0.42451 0.68971,-1.4566 1.108,-2.2935 0.41826,-0.83693 0.97455,-1.907 1.2364,-2.3769 0.26187,-0.47038 0.60298,-1.0708 0.75727,-1.3344 0.15471,-0.26354 0.46162,-0.77062 0.6818,-1.1259 0.22059,-0.3557 0.66469,-1.0404 0.98745,-1.522 0.32275,-0.48164 0.76057,-1.115 0.97372,-1.4074 0.21267,-0.29232 0.623,-0.83647 0.91238,-1.2093 0.28898,-0.37279 0.71349,-0.90277 0.94365,-1.178 0.23018,-0.27522 0.6355,-0.74435 0.90075,-1.0425 0.26521,-0.29816 0.80107,-0.8682 1.1909,-1.2673 0.3899,-0.39865 0.97328,-0.97245 1.2964,-1.2752 0.32318,-0.30232 0.83903,-0.76522 1.1468,-1.0288 0.30733,-0.26313 0.80985,-0.67971 1.1168,-0.92573 0.3065,-0.24603 0.89573,-0.69347 1.3098,-0.99367 0.41367,-0.30066 1.073,-0.75683 1.4649,-1.0142 0.39198,-0.25729 0.99413,-0.63718 1.3382,-0.84398 0.34403,-0.20683 0.95408,-0.5592 1.3552,-0.7827 0.40157,-0.22351 0.86108,-0.49122 1.0216,-0.59422 0.16055,-0.10342 0.44202,-0.30483 0.6255,-0.44786 0.18348,-0.14303 0.47079,-0.40491 0.63884,-0.58171 0.16806,-0.17681 0.39573,-0.46037 0.50624,-0.62967 0.1105,-0.16931 0.25771,-0.44453 0.32692,-0.61174 0.0692,-0.16722 0.14887,-0.42159 0.17723,-0.56545 0.0317,-0.16263 0.043,-0.45453 0.0304,-0.77145 -0.0179,-0.44577 -0.0396,-0.56754 -0.17472,-0.9687 -0.0847,-0.25229 -0.2306,-0.59965 -0.32443,-0.77145 -0.0938,-0.17223 -0.28481,-0.48164 -0.42408,-0.68805 -0.14804,-0.21935 -0.45287,-0.57421 -0.73434,-0.85485 -0.26438,-0.26397 -0.58797,-0.54252 -0.71933,-0.61925 -0.13135,-0.0771 -0.35278,-0.1864 -0.49289,-0.24269 -0.1397,-0.0563 -0.37947,-0.12927 -0.53251,-0.1618 -0.1545,-0.0337 -0.44925,-0.0592 -0.6555,-0.0585 z m 28.252,22.621 c -0.51583,-0.009 -1.1726,-8.2e-4 -1.4595,0.0192 -0.28648,0.02 -0.76523,0.0667 -1.0634,0.10383 -0.29815,0.0375 -0.87278,0.13261 -1.2772,0.21184 -0.40449,0.0792 -1.042,0.21935 -1.417,0.31192 -0.37488,0.0922 -0.93659,0.24144 -1.2485,0.33152 -0.31192,0.0901 -0.87525,0.26979 -1.2518,0.39906 -0.37697,0.12927 -0.91028,0.32526 -1.1855,0.43494 -0.27522,0.11008 -0.72558,0.29773 -1.0008,0.41783 -0.27522,0.11968 -0.76312,0.34903 -1.0842,0.50957 -0.32109,0.16054 -0.86527,0.45078 -1.2093,0.64552 -0.34402,0.19473 -0.94785,0.56712 -1.3415,0.82777 -0.39364,0.26021 -0.9378,0.64052 -1.2093,0.84525 -0.27146,0.20475 -0.73725,0.57504 -1.0354,0.82313 -0.29816,0.24811 -0.93743,0.84607 -1.4207,1.3286 -0.48289,0.48289 -1.0759,1.1122 -1.3168,1.399 -0.24103,0.28647 -0.61674,0.75562 -0.83483,1.0425 -0.21851,0.28648 -0.5567,0.75562 -0.75187,1.0425 -0.19557,0.28647 -0.51458,0.78397 -0.7089,1.105 -0.19433,0.32109 -0.50749,0.8715 -0.69514,1.2226 -0.18807,0.35153 -0.47204,0.91785 -0.63093,1.2585 -0.15929,0.3411 -0.36653,0.804 -0.46078,1.0292 -0.0942,0.22518 -0.24645,0.60631 -0.3386,0.84735 -0.0926,0.2406 -0.2698,0.73809 -0.3949,1.105 -0.12468,0.36696 -0.30983,0.94867 -0.41075,1.2927 -0.10091,0.34402 -0.26104,0.93495 -0.3557,1.3136 -0.0947,0.37821 -0.25437,1.1008 -0.35445,1.6054 -0.1005,0.50457 -0.23852,1.3018 -0.30732,1.7722 -0.0692,0.46995 -0.15387,1.1176 -0.18891,1.4386 -0.035,0.32109 -0.0922,0.93075 -0.12718,1.3552 -0.0346,0.42409 -0.0826,1.4374 -0.10592,2.2518 -0.0292,1.0029 -0.0663,1.6284 -0.11509,1.939 -0.0517,0.32901 -0.0721,0.70639 -0.0717,1.3344 8.2e-4,0.74184 0.0154,0.9474 0.0951,1.344 0.0517,0.25729 0.14178,0.63258 0.20016,0.834 0.058,0.20099 0.19808,0.60089 0.31109,0.88822 0.11342,0.28731 0.32776,0.76395 0.47663,1.0592 0.14929,0.29524 0.44453,0.82695 0.65677,1.1818 0.21184,0.35487 0.66137,1.0508 0.99833,1.5471 0.33735,0.49623 1.0233,1.5116 1.525,2.2572 0.50124,0.74518 1.1572,1.768 1.4574,2.2731 0.30066,0.50498 0.69597,1.1443 0.879,1.4211 0.18264,0.27689 0.54376,0.78315 0.8019,1.1254 0.25853,0.34235 0.68096,0.8661 0.93907,1.1643 0.25812,0.29815 0.75773,0.82402 1.1101,1.1684 0.35236,0.34403 0.80939,0.76725 1.0158,0.94035 0.20641,0.17265 0.53501,0.43702 0.72974,0.58672 0.19516,0.15012 0.56087,0.41367 0.81315,0.5863 0.25229,0.17223 0.67471,0.44077 0.93826,0.59673 0.26396,0.15596 0.81562,0.44911 1.2259,0.65136 0.41075,0.20265 0.99248,0.46495 1.2927,0.58338 0.30066,0.11843 0.70598,0.26979 0.90075,0.3361 0.19515,0.0659 0.65468,0.20266 1.0216,0.30358 0.36697,0.10132 0.93953,0.24019 1.2727,0.30899 0.33277,0.0692 0.87698,0.16388 1.2093,0.21017 0.33194,0.0467 0.83858,0.10843 1.1251,0.13719 0.30524,0.0308 1.0825,0.0526 1.8765,0.0521 0.7456,-4.2e-4 1.6088,-0.0242 1.9182,-0.0526 0.30984,-0.0284 0.78811,-0.0801 1.0634,-0.11468 0.27522,-0.0346 0.78104,-0.11009 1.1238,-0.16721 0.34277,-0.0575 0.91784,-0.16972 1.2772,-0.24937 0.35988,-0.0797 0.92821,-0.22018 1.2631,-0.31192 0.33485,-0.0917 0.9045,-0.26229 1.266,-0.37905 0.36196,-0.11676 0.92993,-0.31525 1.2622,-0.44077 0.33277,-0.12552 0.84862,-0.33235 1.1468,-0.45911 0.29815,-0.12719 0.84232,-0.37531 1.2093,-0.5517 0.36696,-0.17639 0.96743,-0.48705 1.3344,-0.69013 0.36696,-0.20308 0.93907,-0.53751 1.2718,-0.74309 0.33235,-0.20517 0.89783,-0.57838 1.256,-0.82815 0.35863,-0.2502 0.89326,-0.64844 1.1885,-0.8853 0.29565,-0.23686 0.80024,-0.6743 1.1221,-0.972 0.32193,-0.29816 0.81188,-0.79313 1.0896,-1.1008 0.27771,-0.30733 0.60714,-0.68097 0.73224,-0.82981 0.12552,-0.14928 0.41283,-0.51499 0.63843,-0.81315 0.22601,-0.29815 0.60215,-0.83317 0.8361,-1.1884 0.23352,-0.3557 0.58047,-0.91784 0.77063,-1.2497 0.19015,-0.33194 0.5471,-1.0166 0.79312,-1.522 0.24603,-0.5054 0.59673,-1.294 0.7794,-1.7527 0.18265,-0.45869 0.44619,-1.1814 0.58548,-1.6054 0.13927,-0.4245 0.33818,-1.0813 0.44202,-1.4595 0.10382,-0.37864 0.26395,-1.0259 0.35569,-1.4387 0.0922,-0.41282 0.22351,-1.0792 0.29232,-1.4803 0.0688,-0.40158 0.16263,-1.0208 0.20892,-1.3761 0.0459,-0.3557 0.11426,-0.97492 0.15137,-1.3761 0.0409,-0.44286 0.0759,-1.3586 0.0892,-2.3285 0.0129,-0.9858 0.003,-1.9048 -0.0267,-2.3978 -0.0267,-0.43952 -0.0942,-1.2118 -0.15053,-1.7164 -0.0567,-0.50457 -0.1593,-1.2518 -0.2281,-1.6609 -0.0692,-0.40866 -0.19141,-1.0467 -0.2723,-1.4178 -0.0805,-0.37071 -0.24061,-1.0179 -0.35613,-1.4374 -0.11509,-0.41992 -0.29481,-1.0204 -0.39948,-1.3344 -0.10467,-0.31442 -0.28064,-0.80603 -0.39031,-1.0925 -0.11009,-0.2869 -0.2969,-0.74643 -0.41534,-1.0216 -0.11842,-0.27522 -0.40782,-0.8757 -0.64301,-1.3344 -0.23518,-0.4587 -0.60256,-1.1251 -0.81607,-1.4804 -0.21351,-0.3557 -0.54711,-0.8811 -0.74185,-1.1676 -0.19474,-0.2869 -0.56753,-0.8052 -0.82814,-1.1518 -0.26105,-0.34695 -0.70599,-0.90075 -0.98955,-1.2302 -0.28314,-0.32984 -0.75728,-0.85109 -1.0533,-1.1584 -0.29607,-0.30774 -0.8244,-0.81772 -1.1743,-1.1342 -0.35028,-0.31609 -0.92242,-0.80108 -1.2718,-1.078 -0.34986,-0.27648 -0.88905,-0.68013 -1.1989,-0.89656 -0.30984,-0.21641 -0.83528,-0.56086 -1.168,-0.76559 -0.33276,-0.20433 -0.87113,-0.51583 -1.196,-0.69181 -0.32484,-0.17597 -0.86865,-0.44827 -1.2088,-0.60548 -0.33986,-0.15679 -0.88448,-0.39072 -1.2101,-0.51958 -0.32568,-0.12885 -0.8511,-0.31984 -1.1676,-0.42409 -0.3165,-0.10425 -0.8469,-0.26396 -1.1788,-0.35487 -0.33235,-0.0913 -0.87652,-0.22059 -1.2093,-0.28773 -0.33319,-0.0671 -0.86865,-0.15971 -1.1897,-0.20599 -0.32108,-0.0459 -0.79934,-0.10342 -1.0634,-0.12802 -0.26354,-0.0242 -0.90157,-0.0521 -1.4178,-0.0617 z m 41.137,42.655 c -0.8094,-0.01 -1.3136,0.004 -1.6434,0.043 -0.26146,0.0317 -0.64635,0.088 -0.85485,0.12594 -0.2085,0.0375 -0.60423,0.1251 -0.87945,0.1939 -0.27522,0.0688 -0.70139,0.19016 -0.94702,0.26939 -0.24562,0.0796 -0.67679,0.23893 -0.95828,0.35486 -0.28148,0.11551 -0.7481,0.33068 -1.0371,0.47746 -0.28856,0.14679 -0.70056,0.37281 -0.9153,0.50208 -0.21476,0.12927 -0.57587,0.3682 -0.80228,0.53042 -0.22684,0.16221 -0.60339,0.46537 -0.83692,0.67387 -0.23352,0.2085 -0.6059,0.59005 -0.82815,0.84735 -0.22184,0.2577 -0.53751,0.66969 -0.70181,0.91575 -0.16388,0.24603 -0.44535,0.74768 -0.6255,1.1146 -0.17973,0.36696 -0.41408,0.92032 -0.52041,1.2302 -0.10634,0.30941 -0.25896,0.82312 -0.33945,1.1417 -0.0801,0.31817 -0.19932,0.89985 -0.2652,1.2927 -0.0659,0.39239 -0.14888,1.0046 -0.18432,1.3603 -0.0358,0.3557 -0.0834,0.9558 -0.1055,1.3344 -0.0225,0.37822 -0.0534,1.2602 -0.0688,1.9599 -0.0171,0.80355 -0.01,1.5792 0.0204,2.1058 0.0267,0.4587 0.0767,1.0871 0.11092,1.397 0.0346,0.30941 0.11009,0.83482 0.16721,1.1668 0.0572,0.33235 0.16848,0.8703 0.24687,1.1955 0.0784,0.32526 0.22893,0.85613 0.33444,1.1793 0.10591,0.32359 0.28647,0.81773 0.40115,1.0984 0.11509,0.28064 0.33526,0.7539 0.48997,1.0521 0.1543,0.29815 0.39699,0.72724 0.53919,0.95325 0.14219,0.22642 0.41616,0.62049 0.6084,0.8757 0.19265,0.25561 0.53709,0.67095 0.76605,0.92325 0.22893,0.25228 0.60382,0.62424 0.83317,0.8265 0.22977,0.20183 0.56504,0.48122 0.7456,0.62091 0.18056,0.13928 0.54752,0.39907 0.81562,0.57713 0.26814,0.17764 0.73726,0.46036 1.0425,0.628 0.30525,0.16722 0.78022,0.40116 1.0554,0.52 0.27522,0.11885 0.74435,0.29524 1.0425,0.39198 0.29816,0.0972 0.7965,0.22852 1.1072,0.29273 0.31067,0.0642 0.81735,0.14012 1.1259,0.16847 0.35195,0.0326 0.81735,0.0425 1.2489,0.0263 0.37864,-0.0142 0.88155,-0.0542 1.1176,-0.0888 0.23644,-0.0346 0.64843,-0.11175 0.9153,-0.17181 0.2673,-0.0596 0.74268,-0.1914 1.0567,-0.29273 0.31442,-0.10133 0.78187,-0.26896 1.0392,-0.37321 0.25687,-0.10383 0.71391,-0.309 1.0154,-0.45537 0.30148,-0.14637 0.74893,-0.37947 0.99495,-0.5175 0.24562,-0.13802 0.67721,-0.39489 0.9591,-0.57129 0.28148,-0.17597 0.756,-0.49122 1.0538,-0.69972 0.29774,-0.20892 0.72725,-0.52751 0.95407,-0.70806 0.22686,-0.18057 0.6376,-0.54711 0.91283,-0.81398 0.27522,-0.26688 0.65844,-0.67303 0.85193,-0.9024 0.19307,-0.22935 0.51583,-0.66136 0.71723,-0.96037 0.201,-0.29899 0.47038,-0.74018 0.5984,-0.97995 0.12844,-0.24019 0.319,-0.63843 0.42367,-0.8853 0.10509,-0.24687 0.25771,-0.64968 0.33986,-0.8949 0.0821,-0.24562 0.21309,-0.70641 0.29107,-1.0238 0.078,-0.31776 0.18014,-0.83445 0.22643,-1.1484 0.0467,-0.314 0.10383,-0.7773 0.12677,-1.0296 0.0229,-0.25229 0.0412,-1.078 0.0412,-1.8348 -4.2e-4,-0.75683 -0.0192,-1.6951 -0.0421,-2.085 -0.023,-0.3899 -0.0701,-0.98123 -0.10509,-1.3136 -0.0355,-0.33235 -0.10216,-0.84863 -0.14929,-1.1468 -0.0467,-0.29816 -0.14094,-0.7956 -0.2085,-1.105 -0.0679,-0.30984 -0.19849,-0.8223 -0.28981,-1.1392 -0.0917,-0.31692 -0.26688,-0.83273 -0.38948,-1.1468 -0.1226,-0.31359 -0.29774,-0.73184 -0.38906,-0.9291 -0.0917,-0.19725 -0.28398,-0.56295 -0.42742,-0.81315 -0.14346,-0.24978 -0.38532,-0.63551 -0.53752,-0.8565 -0.15179,-0.22101 -0.42909,-0.58714 -0.61633,-0.8136 -0.18723,-0.22644 -0.525,-0.59006 -0.7506,-0.80813 -0.22559,-0.21809 -0.55836,-0.51666 -0.73975,-0.66386 -0.18098,-0.1472 -0.56546,-0.42576 -0.85485,-0.61883 -0.28898,-0.19349 -0.89115,-0.53334 -1.3386,-0.756 -0.44703,-0.22226 -0.9633,-0.46704 -1.1468,-0.54335 -0.18348,-0.0767 -0.57046,-0.22893 -0.85943,-0.3386 -0.28939,-0.10925 -0.8244,-0.28356 -1.1884,-0.38698 -0.36445,-0.10342 -0.84067,-0.22601 -1.0588,-0.27188 -0.21768,-0.0463 -0.65886,-0.12469 -0.97995,-0.17431 -0.46787,-0.0721 -0.81563,-0.093 -1.7514,-0.10425 z m -85.17,2.9282 c -0.28648,-0.0108 -0.80272,-0.005 -1.1468,0.0121 -0.34402,0.0176 -0.83857,0.0638 -1.0992,0.103 -0.26062,0.0396 -0.72975,0.13511 -1.0425,0.21267 -0.31275,0.0776 -0.75645,0.20474 -0.9858,0.28273 -0.22935,0.0784 -0.58172,0.21058 -0.78315,0.2944 -0.20099,0.0834 -0.61341,0.27605 -0.91612,0.42742 -0.30233,0.15179 -0.78773,0.42368 -1.0784,0.60424 -0.29107,0.18055 -0.73267,0.48121 -0.9816,0.66844 -0.24895,0.18682 -0.62133,0.4854 -0.82778,0.66262 -0.20642,0.17764 -0.6476,0.60173 -0.9804,0.94283 -0.33277,0.34069 -0.75225,0.80355 -0.93203,1.0283 -0.17973,0.22518 -0.46704,0.60924 -0.63842,0.85403 -0.1714,0.24477 -0.42993,0.64259 -0.57421,0.88402 -0.1447,0.24144 -0.35779,0.61716 -0.4733,0.83483 -0.11592,0.21767 -0.32275,0.65886 -0.45912,0.97995 -0.13636,0.32109 -0.32526,0.81817 -0.4195,1.105 -0.0942,0.28647 -0.21767,0.6993 -0.2748,0.9174 -0.0571,0.21767 -0.1497,0.64926 -0.206,0.9591 -0.0563,0.30941 -0.1251,0.78562 -0.15262,1.058 -0.0317,0.31108 -0.0421,0.8382 -0.0288,1.4178 0.0159,0.67721 0.0455,1.0558 0.1105,1.4232 0.0488,0.27522 0.15304,0.74434 0.23144,1.0425 0.0784,0.29815 0.2185,0.76057 0.31066,1.0279 0.0926,0.2673 0.26355,0.70848 0.37989,0.97995 0.11676,0.27188 0.35904,0.77813 0.53919,1.1254 0.18014,0.34736 0.47246,0.86318 0.6501,1.1468 0.17764,0.28356 0.4541,0.70098 0.61465,0.92745 0.16012,0.22643 0.4733,0.63926 0.69514,0.9174 0.22184,0.27814 0.60131,0.72099 0.84277,0.98498 0.24144,0.26354 0.63468,0.6672 0.8736,0.89655 0.23895,0.22935 0.62175,0.57796 0.85065,0.77475 0.22935,0.19682 0.61383,0.50832 0.8544,0.6918 0.24103,0.1839 0.6351,0.46578 0.8757,0.62675 0.24103,0.16096 0.64385,0.41116 0.89528,0.55586 0.25145,0.1447 0.68388,0.37154 0.96037,0.50415 0.27689,0.13219 0.72809,0.32443 1.0024,0.42701 0.27439,0.10258 0.66762,0.23436 0.87405,0.29274 0.20642,0.0583 0.56295,0.14344 0.7923,0.1889 0.22935,0.0459 0.62342,0.10508 0.8757,0.13219 0.28398,0.0305 0.7285,0.0401 1.1676,0.0242 0.3899,-0.0134 0.98123,-0.0546 1.3136,-0.0913 0.33277,-0.0367 0.85815,-0.113 1.1676,-0.17013 0.30984,-0.0571 0.74351,-0.14928 0.96368,-0.20517 0.22059,-0.0559 0.6109,-0.16721 0.86737,-0.24769 0.25688,-0.0805 0.66762,-0.22435 0.91283,-0.32026 0.24561,-0.0955 0.64051,-0.26396 0.8778,-0.37447 0.23727,-0.11091 0.60298,-0.29898 0.81315,-0.41825 0.20975,-0.11968 0.5692,-0.34235 0.79852,-0.49581 0.22935,-0.15346 0.59548,-0.41575 0.81315,-0.58297 0.21809,-0.16721 0.68722,-0.59631 1.0433,-0.95407 0.3557,-0.35737 0.78982,-0.83775 0.96367,-1.0671 0.17431,-0.22935 0.42284,-0.58005 0.55295,-0.77978 0.1301,-0.19932 0.35653,-0.59339 0.50332,-0.8757 0.14678,-0.28189 0.35153,-0.71932 0.4541,-0.97162 0.103,-0.25229 0.25521,-0.68305 0.33861,-0.957 0.083,-0.27439 0.20558,-0.77145 0.27188,-1.105 0.0667,-0.3336 0.14095,-0.7902 0.16555,-1.015 0.0242,-0.22434 0.0555,-0.68388 0.0696,-1.0216 0.0142,-0.33735 0.004,-0.95115 -0.0225,-1.364 -0.0267,-0.41283 -0.0763,-0.99458 -0.11051,-1.2927 -0.0342,-0.29816 -0.108,-0.81443 -0.16388,-1.1468 -0.0559,-0.33277 -0.15763,-0.85028 -0.2256,-1.15 -0.0684,-0.30024 -0.17347,-0.72224 -0.23394,-0.93825 -0.0609,-0.21601 -0.18598,-0.62759 -0.27814,-0.9141 -0.0926,-0.2869 -0.28064,-0.80273 -0.41783,-1.1468 -0.13761,-0.34403 -0.39698,-0.92573 -0.57671,-1.2927 -0.17973,-0.36696 -0.45578,-0.88403 -0.61382,-1.1488 -0.15804,-0.2648 -0.43952,-0.70598 -0.62592,-0.97995 -0.18599,-0.27397 -0.49665,-0.69681 -0.68972,-0.93953 -0.19348,-0.24269 -0.5275,-0.62716 -0.74309,-0.85485 -0.21517,-0.22767 -0.55461,-0.56712 -0.75435,-0.7548 -0.19933,-0.18765 -0.54085,-0.48455 -0.75893,-0.66011 -0.21809,-0.17514 -0.66469,-0.49706 -0.99247,-0.71473 -0.33026,-0.21976 -0.912,-0.55128 -1.3048,-0.74477 -0.3899,-0.1914 -0.9153,-0.42409 -1.1676,-0.51666 -0.25228,-0.0922 -0.62758,-0.21642 -0.83399,-0.27605 -0.20642,-0.0596 -0.58255,-0.15304 -0.83566,-0.20809 -0.25311,-0.0554 -0.67554,-0.12802 -0.93825,-0.16179 -0.2627,-0.0337 -0.71223,-0.0705 -0.99914,-0.0809 z m 21.417,26.872 c -0.23143,0.002 -0.51083,0.0283 -0.62133,0.0588 -0.11009,0.0304 -0.30649,0.10717 -0.43619,0.17055 -0.13677,0.0668 -0.34986,0.23019 -0.50832,0.38948 -0.15012,0.15053 -0.33485,0.39115 -0.41074,0.53459 -0.0759,0.14345 -0.18223,0.39073 -0.23644,0.54961 -0.0538,0.15888 -0.12093,0.42992 -0.14886,0.60298 -0.033,0.20475 -0.0425,0.55044 -0.0275,0.9933 0.0154,0.45619 0.0517,0.8094 0.10967,1.0754 0.048,0.21767 0.15387,0.60256 0.23561,0.85484 0.0817,0.25229 0.27688,0.72141 0.4341,1.0425 0.1572,0.3211 0.37405,0.71516 0.48205,0.8757 0.108,0.16055 0.30191,0.42159 0.43077,0.58005 0.12926,0.15888 0.48789,0.51833 0.79769,0.79935 0.30942,0.28106 0.73184,0.64719 0.93826,0.81361 0.20641,0.16638 0.54418,0.42742 0.75059,0.57962 0.20642,0.15263 0.55378,0.39991 0.77145,0.54961 0.2181,0.14971 0.6818,0.44453 1.0308,0.65469 0.34903,0.20975 0.9591,0.54919 1.3553,0.7539 0.39657,0.20475 0.97784,0.48581 1.2922,0.62467 0.31442,0.13886 0.81188,0.34819 1.105,0.46579 0.29316,0.11718 0.97456,0.36028 1.5133,0.54001 0.53918,0.17973 1.3298,0.42034 1.7568,0.53418 0.42742,0.11426 1.1042,0.28314 1.5037,0.37571 0.3999,0.0926 1.0821,0.23603 1.5166,0.3186 0.43452,0.0822 1.2026,0.21391 1.7072,0.29231 0.50457,0.0784 1.3678,0.19807 1.9182,0.26605 0.55044,0.0679 1.226,0.14303 1.5012,0.16638 0.27522,0.0238 1.3919,0.0655 2.4812,0.0926 1.0896,0.0271 2.5437,0.0479 3.2318,0.0463 0.68805,-10e-4 1.5325,-0.0238 1.8765,-0.0492 0.34403,-0.025 0.94448,-0.0838 1.3344,-0.1301 0.38989,-0.0463 1.0654,-0.13094 1.5012,-0.18765 0.43576,-0.0571 1.1864,-0.16055 1.668,-0.22976 0.48164,-0.0697 1.2135,-0.18182 1.6263,-0.2502 0.41283,-0.0679 1.1446,-0.19933 1.6263,-0.2919 0.48163,-0.0926 1.2135,-0.24312 1.6263,-0.33402 0.41283,-0.0909 1.1072,-0.25771 1.5429,-0.3703 0.43577,-0.11259 1.0909,-0.29148 1.4553,-0.3974 0.36487,-0.10592 0.94658,-0.28689 1.2927,-0.40241 0.34653,-0.11509 0.95827,-0.33235 1.3594,-0.48247 0.40157,-0.15012 1.0754,-0.422 1.4983,-0.60423 0.42243,-0.18222 1.0888,-0.49164 1.4804,-0.68763 0.39155,-0.19599 0.96494,-0.49748 1.2748,-0.67012 0.30983,-0.17264 0.84443,-0.49123 1.1884,-0.70848 0.34402,-0.21726 0.90697,-0.59423 1.251,-0.83775 0.34402,-0.24353 0.74935,-0.56504 0.9003,-0.71432 0.15346,-0.15179 0.35987,-0.41742 0.46788,-0.60173 0.10592,-0.18181 0.26729,-0.50082 0.35862,-0.7089 0.0909,-0.20809 0.21434,-0.5471 0.27397,-0.75352 0.0592,-0.20601 0.13552,-0.5321 0.16929,-0.72475 0.0334,-0.19224 0.0609,-0.4758 0.0609,-0.62967 0,-0.15388 -0.0259,-0.36571 -0.0575,-0.4708 -0.0313,-0.10466 -0.12885,-0.30941 -0.21601,-0.45494 -0.0905,-0.14971 -0.35862,-0.46246 -0.62049,-0.7235 -0.25354,-0.25311 -0.63509,-0.5813 -0.84735,-0.72975 -0.21267,-0.14886 -0.59506,-0.38655 -0.85027,-0.52875 -0.2552,-0.1422 -0.63884,-0.33527 -0.85275,-0.42909 -0.2135,-0.0938 -0.57755,-0.23561 -0.80813,-0.31484 -0.32275,-0.11092 -0.48664,-0.14428 -0.71224,-0.14428 -0.16095,0 -0.42867,0.028 -0.59505,0.0625 -0.16597,0.0342 -0.51708,0.13469 -0.78023,0.22351 -0.26271,0.0884 -0.87195,0.32109 -1.3536,0.51666 -0.48163,0.19599 -1.291,0.50749 -1.799,0.69264 -0.5079,0.18473 -1.4086,0.50373 -2.0016,0.70848 -0.59298,0.20433 -1.5004,0.50457 -2.0166,0.6672 -0.51582,0.16221 -1.4261,0.43451 -2.0224,0.60465 -0.59631,0.17055 -1.4595,0.40491 -1.9182,0.52125 -0.4587,0.11634 -1.2602,0.30524 -1.7814,0.41992 -0.52125,0.11467 -1.3657,0.28523 -1.8765,0.37864 -0.51082,0.0934 -1.3794,0.23394 -1.9299,0.31275 -0.55044,0.0784 -1.3852,0.18056 -1.8556,0.22643 -0.46995,0.0463 -1.1363,0.10342 -1.4804,0.12718 -0.34402,0.0242 -1.1884,0.055 -1.8765,0.0692 -0.74268,0.015 -1.6492,0.006 -2.231,-0.0221 -0.53876,-0.0263 -1.2894,-0.0759 -1.668,-0.1105 -0.37821,-0.0346 -0.97867,-0.10092 -1.3344,-0.14679 -0.35528,-0.0459 -0.8715,-0.12093 -1.1468,-0.1668 -0.27522,-0.0459 -0.79102,-0.14053 -1.1468,-0.21017 -0.35528,-0.07 -0.98415,-0.21058 -1.397,-0.31275 -0.41283,-0.10258 -1.0117,-0.26145 -1.3311,-0.35403 -0.319,-0.0922 -0.89115,-0.27147 -1.2718,-0.39823 -0.3803,-0.12635 -0.9633,-0.33402 -1.296,-0.46079 -0.33234,-0.12718 -0.9141,-0.36195 -1.2927,-0.52209 -0.37821,-0.16012 -1.1384,-0.51291 -1.6888,-0.78397 -0.55044,-0.27105 -1.2635,-0.6401 -1.5846,-0.82065 -0.32109,-0.18056 -0.79942,-0.45787 -1.0634,-0.61592 -0.26354,-0.15846 -0.77017,-0.47579 -1.1259,-0.70473 -0.3557,-0.22935 -0.81817,-0.49789 -1.0279,-0.59755 -0.20975,-0.0997 -0.52709,-0.21809 -0.70515,-0.26355 -0.22601,-0.058 -0.45078,-0.0817 -0.74435,-0.0792 z\"\n        id=\"icon\" /></g></svg>\n    <div :style=\"`padding-left:${wrapWidth/4}px; padding-right:${wrapWidth/4}px;`\">\n      <ProgressBar mode=\"indeterminate\" :style=\"`height: 6px;`\"></ProgressBar>\n    </div>\n  </div>\n</template>\n<script lang=\"ts\">\nimport {defineComponent} from \"vue\";\nimport {isWideScreen} from \"@/components/helpers\";\nimport ProgressBar from 'primevue/progressbar';\n\nexport default defineComponent({\n  name: \"LogoDummy\",\n  methods: {isWideScreen},\n  components: {\n    ProgressBar,\n  },\n  props: {\n    wrapWidth: {\n      type: Number,\n    },\n    wrapHeight: {\n      type: Number,\n    },\n  }\n})\n</script>\n","\nimport {defineComponent} from \"vue\";\nimport {isWideScreen} from \"@/components/helpers\";\nimport ProgressBar from 'primevue/progressbar';\n\nexport default defineComponent({\n  name: \"LogoDummy\",\n  methods: {isWideScreen},\n  components: {\n    ProgressBar,\n  },\n  props: {\n    wrapWidth: {\n      type: Number,\n    },\n    wrapHeight: {\n      type: Number,\n    },\n  }\n})\n","import { render } from \"./LogoDummy.vue?vue&type=template&id=10356a64\"\nimport script from \"./LogoDummy.vue?vue&type=script&lang=ts\"\nexport * from \"./LogoDummy.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","\nimport { computed, defineComponent, ref, watch } from \"vue\";\nimport Map from \"@/components/map/Map.vue\";\nimport NodeContent from \"@/components/node_content/Index.vue\";\nimport ConfirmDialog from \"primevue/confirmdialog\";\nimport Toast from \"primevue/toast\";\nimport {\n  EventClickNode,\n  EventDraggingBackground,\n  EventDraggingNode,\n  EventWheel\n} from \"@/components/map/Map\";\nimport Menu from \"@/components/menu/Index.vue\";\nimport { useStore } from \"@/store\";\nimport { useRouter, useRoute, onBeforeRouteUpdate } from \"vue-router\";\nimport { mutations as treeMutations, NodeRecordItem } from \"@/store/tree\";\nimport { mutations as zoomPanMutations } from \"@/store/zoom_pan\";\nimport { actions } from \"@/store/\";\nimport {\n  filterNodesAndLayers,\n  findCentralNode,\n  zoomAndPanPoint,\n  zoomAnPanLayers,\n  zoomAnPanLayersInPlace\n} from \"@/views/Home\";\nimport { clone, printError } from \"@/tools/utils\";\nimport { MapNode, Point } from \"@/types/graphics\";\nimport { findMapNode, findMapNodes } from \"@/store/tree/helpers\";\nimport { actions as positionChangePermitsActions } from \"@/store/position_change_permits\";\nimport api from \"@/api/api\";\nimport isMobile from 'ismobilejs';\nimport TextSearch from \"@/components/menu/Textsearch.vue\";\nimport {isWideScreen} from \"@/components/helpers\";\nimport Splitter, { SplitterResizeEvent } from 'primevue/splitter';\nimport SplitterPanel from 'primevue/splitterpanel';\nimport LogoDummy from \"@/views/LogoDummy.vue\";\n\nexport default defineComponent({\n  name: \"Home\",\n\n  components: {\n    LogoDummy,\n    Splitter,\n    SplitterPanel,\n    TextSearch,\n    Map,\n    Menu,\n    NodeContent,\n    ConfirmDialog,\n    Toast\n  },\n\n  setup() {\n    const store = useStore();\n    const router = useRouter();\n    const route = useRoute();\n    const treeState = store.state.tree;\n    const zoomPanState = store.state.zoomPan;\n    const pinState = store.state.pin;\n    const searchResultState = store.state.searchResult;\n    const clickedTitleId = ref(\"-1\");\n    let selectPreconditionIsOn = false;\n    let restoreSelectNewParentIsOn = false;\n    let titleOver = false;\n\n    // Set node from URL as selected\n    watch(\n      () => route.params.id,\n      () => {\n        store.commit(\n          `tree/${treeMutations.SET_SELECTED_NODE_ID}`,\n          route.params.id\n        );\n      },\n      { immediate: true }\n    );\n\n    /**\n     * Method updateLayers extracts visibleLayers and nodes from mapNodeLayers.\n     * These are the nodes that will be visible to the user\n     * (and are always just a small part of all nodes of the map).\n     * @param centralNodeId\n     * @param mapNodeLayers\n     * @param nodeRecord\n     */\n    const updateLayers = (\n      centralNodeId: string,\n      mapNodeLayers: Array<Record<string, MapNode>>,\n      nodeRecord: Record<string, NodeRecordItem>\n    ): Array<Record<number, MapNode>> => {\n      // Вычленяем слои и узлы которые мы хотим показывать учитывая что текущий видимый узел это centralNodeId\n      const [filteredLayers, err] = filterNodesAndLayers(\n        mapNodeLayers,\n        nodeRecord,\n        centralNodeId\n      );\n      if (err) {\n        printError(\"Home.vue: error in filterNodesAndLayers:\", { err });\n        return [];\n      }\n      return filteredLayers.reverse();\n    };\n\n    const centralNodeId = ref<string | null>(null);\n    // visibleLayers consists only from user visible nodes and visibleLayers of all (which is treeState.mapNodeLayers)\n    const visibleLayers = ref<Array<Record<string, MapNode>>>([]);\n\n    // Ugly hack to determine a first load of page\n    let isFirstPageLoad = true;\n    onBeforeRouteUpdate(async (to, from) => {\n      isFirstPageLoad = false;\n    });\n    // If this is isFirstPageLoad then pan map to node in URL\n    watch(\n      () => [treeState.mapNodeLayers],\n      () => {\n        if (\n          isFirstPageLoad &&\n          route.params.id.length > 0 &&\n          treeState.mapNodeLayers.length > 0\n        ) {\n          const [firstNode] = findMapNode(\n            route.params.id as string,\n            treeState.mapNodeLayers\n          );\n          if (firstNode != null) {\n            store.commit(`zoomPan/${zoomPanMutations.SET_PAN}`, {\n              x: -firstNode.center.x + treeState.mapNodeLayers[0][\"0\"].center.x,\n              y: -firstNode.center.y + treeState.mapNodeLayers[0][\"0\"].center.y\n            });\n          }\n        }\n      }\n    );\n\n    // Determine which nodes to show based on current pan and zoom\n    watch(\n      () => [\n        treeState.mapNodeLayers,\n        zoomPanState.debouncedZoom,\n        zoomPanState.debouncedPan\n      ],\n      () => {\n        const [newCentralNodeId, err] = findCentralNode(\n          treeState.mapNodeLayers,\n          treeState.nodeRecord,\n          { width: window.innerWidth, height: window.innerHeight },\n          zoomPanState.debouncedZoom,\n          zoomPanState.pan,\n            {x:api.ROOT_CENTER_X, y:api.ROOT_CENTER_Y}\n          // zoomPanState.zoomCenter\n        );\n        if (err != null) {\n          printError(\"filterNodesAndLayers: error in findCurrentNode\", { err });\n        }\n\n        centralNodeId.value = newCentralNodeId;\n        visibleLayers.value = updateLayers(\n          newCentralNodeId,\n          treeState.mapNodeLayers,\n          treeState.nodeRecord\n        );\n      },\n      { immediate: true, deep: true }\n    );\n\n    const visibleZoomedPanedLayers = ref<Array<Record<string, MapNode>>>([]);\n    let layersToZoomAndPan = [] as Array<Record<string, MapNode>>;\n    watch(visibleLayers, ()=>{\n      // visibleLayers это всегда слои с zoom=1 и pan={0, 0} состоящие только из видимых прямо сейчас элементов.\n      // Мы применяем к этому объекту текущий zoomPanState, но сам эталон не трогаем, поэтому здесь clone\n      const svg = document.getElementById(\"mapID\") as any\n      if (svg && isMobile().phone) {\n        // сбрасываем svg трансформацию\n        svg.setAttribute('transform', ` scale(1 1)`);\n        const viewBox = svg.viewBox.baseVal;\n        // сбрасываем pan viewBox\n        viewBox.x = 0;\n        viewBox.y = 0;\n      }\n      layersToZoomAndPan = clone(visibleLayers.value);\n      visibleZoomedPanedLayers.value = zoomAnPanLayers(\n          layersToZoomAndPan,\n          zoomPanState.zoom,\n          zoomPanState.pan\n      );\n    },{ immediate: true, deep: true })\n    watch(\n      () => [\n        zoomPanState.zoom,\n        zoomPanState.pan,\n      ],\n        (newArgs, oldArgs) => {\n        if (!oldArgs) {\n          visibleZoomedPanedLayers.value = zoomAnPanLayers(\n              layersToZoomAndPan,\n              zoomPanState.zoom,\n              zoomPanState.pan\n          )\n        } else {\n          const svg = document.getElementById(\"mapID\") as any\n          if (svg && isMobile().phone) {\n            // для мобильного в реальном времени pan и zoom делаем через svg transform\n            // т к на мобильном пересчет через zoomAnPanLayersInPlace притормаживает\n            svg.setAttribute('transform-origin', ` ${zoomPanState.zoomCenter.x}px ${zoomPanState.zoomCenter.y}px`);\n            svg.setAttribute('transform', ` scale(${zoomPanState.relative.zoom})`);\n            // TODO: для pan вместо viewBox лучше использовать svg transform translate для единообразия\n            // svg.setAttribute('transform', ` scale(${zoomPanState.relative.zoom}) translate(${zoomPanState.relative.pan.x} ${zoomPanState.relative.pan.y})`);\n            // Но при таком подходе после pan обрезается все что вне экрана (так же как сейчас при zoom)\n            // Если же использовать viewBox для zoom начинается какой-то неадекват с определением bbox для title:\n            // viewBox.width =  viewBox.width/zoomPanState.relative.zoom\n            // viewBox.height =  viewBox.height/zoomPanState.relative.zoom\n            // Разбираться не стал, в результате пока что такой вот костыль из смеси viewBox и transform\n            const viewBox = svg.viewBox.baseVal;\n            viewBox.x = -zoomPanState.relative.pan.x;\n            viewBox.y = -zoomPanState.relative.pan.y;\n          } else {\n            zoomAnPanLayersInPlace(\n                visibleZoomedPanedLayers.value,\n                newArgs[0] as number,\n                newArgs[1] as Point,\n                oldArgs[0] as number,\n                oldArgs[1] as Point,\n            );\n          }\n        }\n      },\n      { immediate: true, deep: true }\n    );\n\n    const contentSplitHeight = ref(window.innerHeight*0.4);\n\n    return {\n      innerHeight: window.innerHeight,\n      innerWidth: window.innerWidth,\n      isWideScreen,\n      /**\n       * pinNodes\n       */\n      pinNodes: computed(() => {\n        if (centralNodeId.value == null) {\n          return [];\n        }\n        const pinNodeIDs = pinState.pinsReverse[centralNodeId.value];\n        if (!pinNodeIDs) {\n          return [];\n        }\n\n        // remove pins that already exists on visibleLayers\n        for (const layer of visibleLayers.value) {\n          for (const nodeID in layer) {\n            const node = layer[nodeID];\n            if (node.title != \"\") {\n              const ind = pinNodeIDs.indexOf(node.id);\n              if (ind != -1) {\n                pinNodeIDs.splice(ind, 1);\n              }\n            }\n          }\n        }\n\n        const pinMapNodes = findMapNodes(pinNodeIDs, treeState.mapNodeLayers);\n        const result = [];\n        for (const pinMapNode of pinMapNodes) {\n          const cl = clone(pinMapNode);\n          if (isMobile().phone) {\n            cl.center = zoomAndPanPoint(\n                pinMapNode.center,\n                zoomPanState.debouncedZoom,\n                zoomPanState.debouncedPan\n            );\n          } else {\n            cl.center = zoomAndPanPoint(\n                pinMapNode.center,\n                zoomPanState.zoom,\n                zoomPanState.pan\n            );\n          }\n\n          result.push(cl);\n        }\n\n        return result;\n      }),\n\n      /**\n       * searchResultNodeIDs\n       */\n      searchResultNodeIDs: computed(() => {\n        return searchResultState.nodeIDs;\n      }),\n\n      /**\n       * searchResultPinNodes\n       */\n      searchResultPinNodes: computed(() => {\n        if (centralNodeId.value == null) {\n          return [];\n        }\n        const searchResultNodeIDs = clone(searchResultState.nodeIDs);\n        if (!searchResultNodeIDs) {\n          return [];\n        }\n\n        // remove pins that already exists on visibleLayers\n        for (const layer of visibleLayers.value) {\n          for (const nodeID in layer) {\n            const node = layer[nodeID];\n            if (node.title != \"\") {\n              const ind = searchResultNodeIDs.indexOf(node.id);\n              if (ind != -1) {\n                searchResultNodeIDs.splice(ind, 1);\n              }\n            }\n          }\n        }\n\n        const searchResultMapNodes = findMapNodes(\n          searchResultNodeIDs,\n          treeState.mapNodeLayers\n        );\n        const result = [];\n        for (const searchResultMapNode of searchResultMapNodes) {\n          const cl = clone(searchResultMapNode);\n          if (isMobile().phone) {\n            cl.center = zoomAndPanPoint(\n                searchResultMapNode.center,\n                zoomPanState.debouncedZoom,\n                zoomPanState.debouncedPan\n            );\n          } else {\n            cl.center = zoomAndPanPoint(\n                searchResultMapNode.center,\n                zoomPanState.zoom,\n                zoomPanState.pan\n            );\n          }\n\n          result.push(cl);\n        }\n\n        return result;\n      }),\n\n      editModeOn: computed(() => store.state.editModeOn),\n      selectedNodeId: computed(() => treeState.selectedNodeId),\n      selectedNodePreconditionIds: computed(() =>\n        treeState.selectedNodeId\n          ? store.state.precondition.preconditions[treeState.selectedNodeId]\n          : []\n      ),\n      visibleZoomedPanedLayers: visibleZoomedPanedLayers,\n      nodeDragging: async (e: EventDraggingNode) => {\n        const hasDragPermit = await store.dispatch(\n          `positionChangePermits/${positionChangePermitsActions.CheckNodeID}`,\n          e.id\n        );\n        if (!hasDragPermit) {\n          return;\n        }\n        await store.dispatch(`${actions.updateNodePosition}`, {\n          nodeId: e.id,\n          delta: {\n            x: e.delta.x / zoomPanState.zoom,\n            y: e.delta.y / zoomPanState.zoom\n          }\n        });\n      },\n      setSelectPreconditionON: () => {\n        selectPreconditionIsOn = true;\n      },\n      setSelectPreconditionOFF: () => {\n        selectPreconditionIsOn = false;\n        clickedTitleId.value = \"-1\"\n      },\n      setRestoreSelectNewParentON: () => {\n        restoreSelectNewParentIsOn = true;\n      },\n      setRestoreSelectNewParentOFF: () => {\n        restoreSelectNewParentIsOn = false;\n      },\n      clickedTitleId,\n      titleClick: (e: EventClickNode) => {\n        if (restoreSelectNewParentIsOn || selectPreconditionIsOn) {\n          clickedTitleId.value = e.id;\n        } else {\n          router.push({ name: \"node\", params: { id: e.id } });\n        }\n      },\n      titleOver: (e: EventClickNode) => {\n        titleOver = true;\n        store.commit(`tree/${treeMutations.SET_SELECTED_NODE_ID}`, e.id);\n      },\n      titleLeave: (e: EventClickNode) => {\n        titleOver = false;\n        store.commit(\n          `tree/${treeMutations.SET_SELECTED_NODE_ID}`,\n          route.params.id\n        );\n      },\n      mapDragging: (event: EventDraggingBackground) => {\n        if (store.state.editModeOn && titleOver) {\n          // to prevent pan while node position editing ( = title dragging in edit mode)\n          return;\n        }\n        store.commit(`zoomPan/${zoomPanMutations.ADD_PAN}`, event);\n        store.commit(`zoomPan/${zoomPanMutations.ADD_RELATIVE_PAN}`, event);\n      },\n      zoom: (event: EventWheel) => {\n        // initial value of a center (when root.border == viewport)\n        const initial = {\n          x: (event.center.x - zoomPanState.pan.x) / zoomPanState.zoom,\n          y: (event.center.y - zoomPanState.pan.y) / zoomPanState.zoom\n        };\n        store.commit(\n            `zoomPan/${zoomPanMutations.SET_ZOOM_CENTER}`,\n            event.center\n        );\n        store.commit(`zoomPan/${zoomPanMutations.ADD_ZOOM}`, event.delta);\n        const after = {\n          x: initial.x * zoomPanState.zoom + zoomPanState.pan.x,\n          y: initial.y * zoomPanState.zoom + zoomPanState.pan.y\n        };\n        store.commit(`zoomPan/${zoomPanMutations.ADD_PAN}`, {\n          from: after,\n          to: event.center\n        });\n      },\n      splitterResize: (event: SplitterResizeEvent) => {\n        contentSplitHeight.value = window.innerHeight*event.sizes[1]/100\n      },\n      contentSplitHeight,\n    };\n  }\n});\n","import { render } from \"./Home.vue?vue&type=template&id=354a2316\"\nimport script from \"./Home.vue?vue&type=script&lang=ts\"\nexport * from \"./Home.vue?vue&type=script&lang=ts\"\n\nconst cssModules = script.__cssModules = {}\nimport style0 from \"./Home.vue?vue&type=style&index=0&id=354a2316&module=true&lang=css\"\ncssModules[\"$style\"] = style0\nscript.render = render\n\nexport default script","<template>\n  <h1 v-if=\"!isAuthorized\">Only authorized users can view changes</h1>\n  <div v-else>\n    <div><b>id:</b> {{ route.params.id }}</div>\n    <div>\n      <b>timestamp:</b>\n      {{ new Date(change[\"timestamp\"]).toLocaleDateString() }}\n      {{ new Date(change[\"timestamp\"]).toLocaleTimeString() }}\n    </div>\n    <div><b>action:</b> {{ change[\"action\"] }}</div>\n    <div><b>node_id:</b> {{ change[\"node_id\"] }}</div>\n    <div><b>user_id:</b> {{ change[\"user_id\"] }}</div>\n    <b>value:</b>\n    <Markdown\n      v-if=\"['content', 'name'].indexOf(change['action']) != -1\"\n      :content=\"change['attributes']['value']\"\n      :rows=\"20\"\n    />\n    <div v-else>{{ JSON.stringify(change[\"attributes\"]) }}</div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { useRoute } from \"vue-router\";\nimport { useStore } from \"@/store\";\nimport { computed, watch, ref } from \"vue\";\nimport { doc, getDoc, getFirestore } from \"firebase/firestore\";\nimport Markdown from \"@/components/node_content/Markdown.vue\";\n\nexport default {\n  name: \"Change\",\n  components: { Markdown },\n\n  setup() {\n    const store = useStore();\n    const isAuthorized = computed(\n      () => store.state.user.user && !store.state.user.user.isAnonymous\n    );\n    const route = useRoute();\n    const change = ref({});\n\n    watch(\n      () => isAuthorized.value,\n      async () => {\n        if (isAuthorized.value) {\n          // fetch change from firestore\n          const docRef = doc(\n            getFirestore(),\n            \"changes\",\n            route.params.id as string\n          );\n          const docSnap = await getDoc(docRef);\n\n          if (docSnap.exists()) {\n            change.value = docSnap.data();\n          }\n        }\n      },\n      {\n        immediate: true\n      }\n    );\n\n    return {\n      isAuthorized,\n      route,\n      change\n    };\n  }\n};\n</script>\n","\nimport { useRoute } from \"vue-router\";\nimport { useStore } from \"@/store\";\nimport { computed, watch, ref } from \"vue\";\nimport { doc, getDoc, getFirestore } from \"firebase/firestore\";\nimport Markdown from \"@/components/node_content/Markdown.vue\";\n\nexport default {\n  name: \"Change\",\n  components: { Markdown },\n\n  setup() {\n    const store = useStore();\n    const isAuthorized = computed(\n      () => store.state.user.user && !store.state.user.user.isAnonymous\n    );\n    const route = useRoute();\n    const change = ref({});\n\n    watch(\n      () => isAuthorized.value,\n      async () => {\n        if (isAuthorized.value) {\n          // fetch change from firestore\n          const docRef = doc(\n            getFirestore(),\n            \"changes\",\n            route.params.id as string\n          );\n          const docSnap = await getDoc(docRef);\n\n          if (docSnap.exists()) {\n            change.value = docSnap.data();\n          }\n        }\n      },\n      {\n        immediate: true\n      }\n    );\n\n    return {\n      isAuthorized,\n      route,\n      change\n    };\n  }\n};\n","import { render } from \"./Change.vue?vue&type=template&id=14f8614f\"\nimport script from \"./Change.vue?vue&type=script&lang=ts\"\nexport * from \"./Change.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<template>\n  <h1 v-if=\"!isAuthorized\">Please, <a href=\"#\" @click=\"store.dispatch(`user/${userActions.signIn}`)\">Sign in</a> to unsubscribe</h1>\n  <div v-else>\n    You successfully unsubscribed from scimap.org digest!\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport {store, useStore} from \"@/store\";\nimport {computed, watch} from \"vue\";\nimport {actions as userActions} from \"@/store/user\";\n\nexport default {\n  name: \"UnsubscribeDigest\",\n  computed: {\n    store() {\n      return store\n    },\n    userActions() {\n      return userActions\n    }\n  },\n\n  setup() {\n    const store = useStore();\n    const isAuthorized = computed(\n        () => store.state.user.user && !store.state.user.user.isAnonymous\n    );\n\n    watch(\n        () => store.state.user.user && !store.state.user.user.isAnonymous,\n        () => {\n          if (isAuthorized.value) {\n            store.dispatch(`user/${userActions.setSubscribePeriod}`, 'on pause')\n          }\n        },\n        { immediate: true }\n    );\n\n    return {\n      isAuthorized,\n    };\n  }\n};\n</script>\n","\nimport {store, useStore} from \"@/store\";\nimport {computed, watch} from \"vue\";\nimport {actions as userActions} from \"@/store/user\";\n\nexport default {\n  name: \"UnsubscribeDigest\",\n  computed: {\n    store() {\n      return store\n    },\n    userActions() {\n      return userActions\n    }\n  },\n\n  setup() {\n    const store = useStore();\n    const isAuthorized = computed(\n        () => store.state.user.user && !store.state.user.user.isAnonymous\n    );\n\n    watch(\n        () => store.state.user.user && !store.state.user.user.isAnonymous,\n        () => {\n          if (isAuthorized.value) {\n            store.dispatch(`user/${userActions.setSubscribePeriod}`, 'on pause')\n          }\n        },\n        { immediate: true }\n    );\n\n    return {\n      isAuthorized,\n    };\n  }\n};\n","import { render } from \"./UnsubscribeDigest.vue?vue&type=template&id=41e17b94\"\nimport script from \"./UnsubscribeDigest.vue?vue&type=script&lang=ts\"\nexport * from \"./UnsubscribeDigest.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<template>\n  <h1 v-if=\"!isAuthorized\">Only authorized users can view node profile</h1>\n  <div v-else>\n    <div><b>id:</b> {{ route.params.id }}</div>\n    <div><b>is removed from map:</b> {{ node[\"is_in_trash\"] }}</div>\n    <div>\n      <b>parent_id:</b>\n      <a target=\"_blank\" :href=\"node['map']['parentID']\">{{\n        node[\"map\"][\"parentID\"]\n      }}</a>\n    </div>\n    <div><b>name:</b> {{ node[\"map\"][\"name\"] }}</div>\n    <b>content:</b>\n    <Markdown\n      :content=\"node['node_content'] ? node['node_content']['content'] : ''\"\n      :rows=\"20\"\n    />\n    <div>\n      <b>precondition:</b>\n      <div v-for=\"id of node['precondition']\" :key=\"id\">\n        <a target=\"_blank\" :href=\"id\">{{ id }}</a>\n      </div>\n    </div>\n    <div>\n      <b>children:</b>\n      <div v-for=\"id of node['map']['children']\" :key=\"id\">\n        <a target=\"_blank\" :href=\"id\">{{ id }}</a>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { useRoute } from \"vue-router\";\nimport { useStore } from \"@/store\";\nimport { computed, watch, ref } from \"vue\";\nimport Markdown from \"@/components/node_content/Markdown.vue\";\nimport firebase from \"firebase/compat\";\n\nexport default {\n  name: \"NodeDescription\",\n  components: { Markdown },\n\n  setup() {\n    const store = useStore();\n    const isAuthorized = computed(\n      () => store.state.user.user && !store.state.user.user.isAnonymous\n    );\n    const route = useRoute();\n    const node = ref({} as any);\n\n    watch(\n      () => isAuthorized.value,\n      async () => {\n        if (isAuthorized.value) {\n          // fetch change from firestore\n          const docRef = firebase\n            .database()\n            .ref(`/map/${route.params.id}`)\n            .once(\"value\", data => {\n              if (data.exists()) {\n                // not in /trash, try to get from /map, /node_content, /precondition\n                node.value[\"is_in_trash\"] = false;\n\n                // map\n                node.value[\"map\"] = data.val();\n\n                // node_content\n                firebase\n                    .database()\n                    .ref(`/node_content/${route.params.id}`)\n                    .once(\"value\", data => {\n                      if (data.exists()) {\n                        node.value[\"node_content\"] = data.val();\n                      }\n                    });\n\n                // precondition\n                firebase\n                    .database()\n                    .ref(`/precondition/${route.params.id}`)\n                    .once(\"value\", data => {\n                      if (data.exists()) {\n                        node.value[\"precondition\"] = data.val();\n                      }\n                    });\n              } else {\n                firebase\n                    .database()\n                    .ref(`/trash/${route.params.id}`)\n                    .once(\"value\", data => {\n                      if (data.exists()) {\n                        node.value = data.val();\n                        node.value[\"is_in_trash\"] = true;\n                      }\n                    });\n              }\n            });\n        }\n      },\n      {\n        immediate: true\n      }\n    );\n\n    return {\n      isAuthorized: isAuthorized,\n      route,\n      node\n    };\n  }\n};\n</script>\n","\nimport { useRoute } from \"vue-router\";\nimport { useStore } from \"@/store\";\nimport { computed, watch, ref } from \"vue\";\nimport Markdown from \"@/components/node_content/Markdown.vue\";\nimport firebase from \"firebase/compat\";\n\nexport default {\n  name: \"NodeDescription\",\n  components: { Markdown },\n\n  setup() {\n    const store = useStore();\n    const isAuthorized = computed(\n      () => store.state.user.user && !store.state.user.user.isAnonymous\n    );\n    const route = useRoute();\n    const node = ref({} as any);\n\n    watch(\n      () => isAuthorized.value,\n      async () => {\n        if (isAuthorized.value) {\n          // fetch change from firestore\n          const docRef = firebase\n            .database()\n            .ref(`/map/${route.params.id}`)\n            .once(\"value\", data => {\n              if (data.exists()) {\n                // not in /trash, try to get from /map, /node_content, /precondition\n                node.value[\"is_in_trash\"] = false;\n\n                // map\n                node.value[\"map\"] = data.val();\n\n                // node_content\n                firebase\n                    .database()\n                    .ref(`/node_content/${route.params.id}`)\n                    .once(\"value\", data => {\n                      if (data.exists()) {\n                        node.value[\"node_content\"] = data.val();\n                      }\n                    });\n\n                // precondition\n                firebase\n                    .database()\n                    .ref(`/precondition/${route.params.id}`)\n                    .once(\"value\", data => {\n                      if (data.exists()) {\n                        node.value[\"precondition\"] = data.val();\n                      }\n                    });\n              } else {\n                firebase\n                    .database()\n                    .ref(`/trash/${route.params.id}`)\n                    .once(\"value\", data => {\n                      if (data.exists()) {\n                        node.value = data.val();\n                        node.value[\"is_in_trash\"] = true;\n                      }\n                    });\n              }\n            });\n        }\n      },\n      {\n        immediate: true\n      }\n    );\n\n    return {\n      isAuthorized: isAuthorized,\n      route,\n      node\n    };\n  }\n};\n","import { render } from \"./NodeDescription.vue?vue&type=template&id=1c35b6c0\"\nimport script from \"./NodeDescription.vue?vue&type=script&lang=ts\"\nexport * from \"./NodeDescription.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<template>\n  <h1>Oops, it looks like the page you're looking for doesn't exist.</h1>\n</template>\n","import { render } from \"./NotFound.vue?vue&type=template&id=600d9e34\"\nconst script = {}\nscript.render = render\n\nexport default script","<template>\n  <div style=\"padding: 2em 2em 2em 2em\">\n    <h1>Sorry, SciMap do not ready for mobile yet, please reopen it on you laptop/desktop</h1>\n\n    You can\n    <ul>\n      <li>still <a :href=\"url\">try desktop version on mobile</a> without any warranties</li>\n      <li>or watch video about SciMap</li>\n    </ul>\n    <div style=\"text-align: center;\">\n      <iframe src=\"https://www.youtube.com/embed/DuiTlnrK6G4?si=HuVA4cs5U86H9E3l\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen></iframe>\n    </div>\n  </div>\n</template>\n<script lang=\"ts\">\nexport default {\n  setup() {\n    const urlParams = new URLSearchParams(window.location.search);\n\n    const from = new URL(decodeURI(urlParams.get('from')!));\n    from.searchParams.append('forceDesktopOnMobile', 'true');\n\n    return {\n      url: from.href,\n    };\n  }\n}\n</script>\n","\nexport default {\n  setup() {\n    const urlParams = new URLSearchParams(window.location.search);\n\n    const from = new URL(decodeURI(urlParams.get('from')!));\n    from.searchParams.append('forceDesktopOnMobile', 'true');\n\n    return {\n      url: from.href,\n    };\n  }\n}\n","import { render } from \"./MobileWarning.vue?vue&type=template&id=43fe06b3\"\nimport script from \"./MobileWarning.vue?vue&type=script&lang=ts\"\nexport * from \"./MobileWarning.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","import { createRouter, createWebHistory, RouteRecordRaw } from \"vue-router\";\nimport PasswordLogin from \"../views/PasswordLogin.vue\";\nimport Home from \"../views/Home.vue\";\nimport Change from \"../views/Change.vue\";\nimport UnsubscribeDigest from \"../views/UnsubscribeDigest.vue\";\nimport NodeDescription from \"../views/NodeDescription.vue\";\nimport NotFound from \"../views/NotFound.vue\";\nimport MobileWarning from \"../views/MobileWarning.vue\";\n\nconst routes: Array<RouteRecordRaw> = [\n  {\n    path: \"/passwordLogin\",\n    component: PasswordLogin\n  },\n  {\n    path: \"/mobile_warning\",\n    component: MobileWarning\n  },\n  {\n    path: \"/node_description/:id?\",\n    name: \"node_description\",\n    component: NodeDescription\n  },\n  {\n    path: \"/change/:id?\",\n    name: \"change\",\n    component: Change\n  },\n  {\n    path: \"/unsubscribe_digest\",\n    name: \"unsubscribe_digest\",\n    component: UnsubscribeDigest\n  },\n  {\n    path: \"/:id?\",\n    name: \"node\",\n    component: Home\n  },\n  {\n    path: \"/:catchAll(.*)\",\n    component: NotFound\n  }\n];\n\nconst router = createRouter({\n  history: createWebHistory(process.env.BASE_URL),\n  routes\n});\n\nexport default router;\n","import { createApp } from \"vue\";\nimport App from \"./App.vue\";\nimport PrimeVue from \"primevue/config\";\nimport ConfirmationService from \"primevue/confirmationservice\";\nimport ToastService from \"primevue/toastservice\";\nimport router from \"./router\";\nimport { store, key } from \"./store\";\n// primevue ui stuff\nimport \"primevue/resources/themes/aura-light-green/theme.css\"; //theme\nimport \"primevue/resources/primevue.min.css\"; //core css\nimport \"primeicons/primeicons.css\"; //icons\nimport \"primeflex/primeflex.css\";\nimport Tooltip from 'primevue/tooltip';\n\ncreateApp(App)\n  .use(store, key)\n  .use(router)\n  .use(PrimeVue)\n  .use(ConfirmationService)\n  .use(ToastService)\n  .directive('tooltip', Tooltip)\n  .mount(\"#app\");\n","var map = {\n\t\"./bmp\": \"0dcc\",\n\t\"./bmp.js\": \"0dcc\",\n\t\"./gif\": \"c416\",\n\t\"./gif.js\": \"c416\",\n\t\"./jpg\": \"135b\",\n\t\"./jpg.js\": \"135b\",\n\t\"./png\": \"e9ef\",\n\t\"./png.js\": \"e9ef\",\n\t\"./psd\": \"520c\",\n\t\"./psd.js\": \"520c\",\n\t\"./svg\": \"b0bf\",\n\t\"./svg.js\": \"b0bf\",\n\t\"./tiff\": \"f270\",\n\t\"./tiff.js\": \"f270\",\n\t\"./webp\": \"cf1e\",\n\t\"./webp.js\": \"cf1e\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"cd50\";","module.exports = __webpack_public_path__ + \"img/eye-off.d2cfd862.svg\";","export { default } from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-0-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-0-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Index.vue?vue&type=style&index=0&id=cf7d7f8c&module=true&lang=css\"; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-0-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-0-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Index.vue?vue&type=style&index=0&id=cf7d7f8c&module=true&lang=css\"","export { default } from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-0-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-0-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Textsearch.vue?vue&type=style&index=0&id=01a2cb92&module=true&lang=css\"; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-0-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-0-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Textsearch.vue?vue&type=style&index=0&id=01a2cb92&module=true&lang=css\"","module.exports = __webpack_public_path__ + \"img/move.bbe00c47.svg\";","module.exports = __webpack_public_path__ + \"img/add-off.32a0c20b.svg\";","module.exports = __webpack_public_path__ + \"img/question.df174033.svg\";"],"sourceRoot":""}